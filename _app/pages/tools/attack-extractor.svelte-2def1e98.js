import{S as je,i as Ge,s as Ue,a7 as _e,w as me,k as C,e as u,t as w,x as be,m as K,c as h,a as d,h as y,d as s,b as g,y as Ee,g as H,I as r,a1 as ye,N as fe,a8 as ze,q as ie,o as ue,B as ke,Y as Le,R as Me,v as Ye,f as ge,j as te,E as ee,l as he,n as Xe,p as $e,X as Te,V as Ne}from"../../chunks/index-a02da30e.js";import{a as Je}from"../../chunks/extract-98765c01.js";import{G as qe,d as pe,e as Ie,h as ce}from"../../chunks/lib-09c47a26.js";import{T as Qe}from"../../chunks/Title-1d23c88f.js";import{H as We}from"../../chunks/Header-47fd749a.js";import{A as Ze}from"../../chunks/Alert-12c40fb9.js";import{p as xe}from"../../chunks/stores-cf129ad8.js";import"../../chunks/marked.esm-8ab30116.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";/* empty css                                                       */function Ce(c,e,t){const l=c.slice();return l[21]=e[t],l}function Ke(c,e,t){const l=c.slice();return l[25]=e[t],l}function He(c,e,t){const l=c.slice();return l[29]=e[t],l}function et(c){let e,t=c[28].message+"",l;return{c(){e=u("p"),l=w(t),this.h()},l(a){e=h(a,"P",{style:!0});var n=d(e);l=y(n,t),n.forEach(s),this.h()},h(){ge(e,"color","red")},m(a,n){H(a,e,n),r(e,l)},p(a,n){n[0]&32&&t!==(t=a[28].message+"")&&te(l,t)},i:ee,o:ee,d(a){a&&s(e)}}}function tt(c){let e,t,l,a;const n=[at,lt],o=[];function _(v,T){return v[20].length>0?0:!v[3]&&v[20].length<1?1:-1}return~(e=_(c))&&(t=o[e]=n[e](c)),{c(){t&&t.c(),l=he()},l(v){t&&t.l(v),l=he()},m(v,T){~e&&o[e].m(v,T),H(v,l,T),a=!0},p(v,T){let k=e;e=_(v),e===k?~e&&o[e].p(v,T):(t&&(Xe(),ue(o[k],1,1,()=>{o[k]=null}),$e()),~e?(t=o[e],t?t.p(v,T):(t=o[e]=n[e](v),t.c()),ie(t,1),t.m(l.parentNode,l)):t=null)},i(v){a||(ie(t),a=!0)},o(v){ue(t),a=!1},d(v){~e&&o[e].d(v),v&&s(l)}}}function lt(c){let e,t;return{c(){e=u("div"),t=w("No ATT&CK techniques found in text."),this.h()},l(l){e=h(l,"DIV",{class:!0});var a=d(e);t=y(a,"No ATT&CK techniques found in text."),a.forEach(s),this.h()},h(){g(e,"class","card")},m(l,a){H(l,e,a),r(e,t)},p:ee,i:ee,o:ee,d(l){l&&s(e)}}}function at(c){let e,t,l,a,n,o,_,v,T,k,p,i,b,E,R,J,G,V,O,Y,Q,q,I,F,M,U,W,L,D,P,S,m=c[0]&&Re(c);a=new Ze({props:{$$slots:{default:[rt]},$$scope:{ctx:c}}});function z(f,N){return f[2]?st:ot}let B=z(c),X=B(c),Z=c[20],A=[];for(let f=0;f<Z.length;f+=1)A[f]=Pe(Ce(c,Z,f));return{c(){e=u("div"),m&&m.c(),t=C(),l=u("div"),me(a.$$.fragment),n=C(),o=u("div"),_=u("div"),v=u("b"),T=u("i"),k=w("Mapping Results:"),p=C(),i=u("div"),b=u("div"),X.c(),E=C(),R=u("button"),J=w("copy"),G=C(),V=u("table"),O=u("thead"),Y=u("th"),Q=w("ATT&CK ID"),q=C(),I=u("th"),F=w("ATT&CK Name"),M=C(),U=u("th"),W=w("Related D3FEND Techniques"),L=C();for(let f=0;f<A.length;f+=1)A[f].c();this.h()},l(f){e=h(f,"DIV",{class:!0});var N=d(e);m&&m.l(N),N.forEach(s),t=K(f),l=h(f,"DIV",{class:!0});var j=d(l);be(a.$$.fragment,j),j.forEach(s),n=K(f),o=h(f,"DIV",{class:!0});var $=d(o);_=h($,"DIV",{});var x=d(_);v=h(x,"B",{});var re=d(v);T=h(re,"I",{});var le=d(T);k=y(le,"Mapping Results:"),le.forEach(s),re.forEach(s),x.forEach(s),p=K($),i=h($,"DIV",{class:!0});var oe=d(i);b=h(oe,"DIV",{class:!0});var se=d(b);X.l(se),E=K(se),R=h(se,"BUTTON",{});var de=d(R);J=y(de,"copy"),de.forEach(s),se.forEach(s),G=K(oe),V=h(oe,"TABLE",{id:!0,class:!0});var ne=d(V);O=h(ne,"THEAD",{});var ae=d(O);Y=h(ae,"TH",{class:!0});var De=d(Y);Q=y(De,"ATT&CK ID"),De.forEach(s),q=K(ae),I=h(ae,"TH",{});var Ae=d(I);F=y(Ae,"ATT&CK Name"),Ae.forEach(s),M=K(ae),U=h(ae,"TH",{});var we=d(U);W=y(we,"Related D3FEND Techniques"),we.forEach(s),ae.forEach(s),L=K(ne);for(let ve=0;ve<A.length;ve+=1)A[ve].l(ne);ne.forEach(s),oe.forEach(s),$.forEach(s),this.h()},h(){g(e,"class","card"),g(l,"class","card"),g(b,"class","text-right"),g(Y,"class","stretch"),g(V,"id","mappings"),g(V,"class","table-auto"),g(i,"class","results-wrap center svelte-1wbelz3"),g(o,"class","card")},m(f,N){H(f,e,N),m&&m.m(e,null),H(f,t,N),H(f,l,N),Ee(a,l,null),H(f,n,N),H(f,o,N),r(o,_),r(_,v),r(v,T),r(T,k),r(o,p),r(o,i),r(i,b),X.m(b,null),r(b,E),r(b,R),r(R,J),r(i,G),r(i,V),r(V,O),r(O,Y),r(Y,Q),r(O,q),r(O,I),r(I,F),r(O,M),r(O,U),r(U,W),r(V,L);for(let j=0;j<A.length;j+=1)A[j].m(V,null);D=!0,P||(S=fe(R,"click",_t),P=!0)},p(f,N){f[0]?m?m.p(f,N):(m=Re(f),m.c(),m.m(e,null)):m&&(m.d(1),m=null);const j={};if(N[1]&2&&(j.$$scope={dirty:N,ctx:f}),a.$set(j),B===(B=z(f))&&X?X.p(f,N):(X.d(1),X=B(f),X&&(X.c(),X.m(b,E))),N[0]&48){Z=f[20];let $;for($=0;$<Z.length;$+=1){const x=Ce(f,Z,$);A[$]?A[$].p(x,N):(A[$]=Pe(x),A[$].c(),A[$].m(V,null))}for(;$<A.length;$+=1)A[$].d(1);A.length=Z.length}},i(f){D||(ie(a.$$.fragment,f),D=!0)},o(f){ue(a.$$.fragment,f),D=!1},d(f){f&&s(e),m&&m.d(),f&&s(t),f&&s(l),ke(a),f&&s(n),f&&s(o),X.d(),Te(A,f),P=!1,S()}}}function Re(c){let e,t,l,a,n=c[0].length+"",o,_,v,T,k=c[0],p=[];for(let i=0;i<k.length;i+=1)p[i]=Be(He(c,k,i));return{c(){e=u("div"),t=u("b"),l=u("i"),a=w("Extracted "),o=w(n),_=w(" unique IDs:"),v=C(),T=u("dl");for(let i=0;i<p.length;i+=1)p[i].c();this.h()},l(i){e=h(i,"DIV",{class:!0});var b=d(e);t=h(b,"B",{});var E=d(t);l=h(E,"I",{});var R=d(l);a=y(R,"Extracted "),o=y(R,n),_=y(R," unique IDs:"),R.forEach(s),E.forEach(s),v=K(b),T=h(b,"DL",{class:!0});var J=d(T);for(let G=0;G<p.length;G+=1)p[G].l(J);J.forEach(s),b.forEach(s),this.h()},h(){g(T,"class","flex flex-wrap svelte-1wbelz3"),g(e,"class","")},m(i,b){H(i,e,b),r(e,t),r(t,l),r(l,a),r(l,o),r(l,_),r(e,v),r(e,T);for(let E=0;E<p.length;E+=1)p[E].m(T,null)},p(i,b){if(b[0]&1&&n!==(n=i[0].length+"")&&te(o,n),b[0]&1){k=i[0];let E;for(E=0;E<k.length;E+=1){const R=He(i,k,E);p[E]?p[E].p(R,b):(p[E]=Be(R),p[E].c(),p[E].m(T,null))}for(;E<p.length;E+=1)p[E].d(1);p.length=k.length}},d(i){i&&s(e),Te(p,i)}}}function Be(c){let e,t,l=c[29]+"",a,n;return{c(){e=u("dd"),t=u("a"),a=w(l),this.h()},l(o){e=h(o,"DD",{});var _=d(e);t=h(_,"A",{href:!0});var v=d(t);a=y(v,l),v.forEach(s),_.forEach(s),this.h()},h(){g(t,"href",n=pe(c[29]))},m(o,_){H(o,e,_),r(e,t),r(t,a)},p(o,_){_[0]&1&&l!==(l=o[29]+"")&&te(a,l),_[0]&1&&n!==(n=pe(o[29]))&&g(t,"href",n)},d(o){o&&s(e)}}}function rt(c){let e,t,l;return{c(){e=u("b"),t=w("Note: "),l=w("These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},l(a){e=h(a,"B",{});var n=d(e);t=y(n,"Note: "),n.forEach(s),l=y(a,"These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},m(a,n){H(a,e,n),r(e,t),H(a,l,n)},p:ee,d(a){a&&s(e),a&&s(l)}}}function ot(c){let e,t,l,a;return{c(){e=u("button"),t=w("select"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var o=d(e);t=y(o,"select"),o.forEach(s),this.h()},h(){g(e,"class","selector svelte-1wbelz3")},m(n,o){H(n,e,o),r(e,t),l||(a=fe(e,"click",c[8]),l=!0)},p:ee,d(n){n&&s(e),l=!1,a()}}}function st(c){let e,t,l,a;return{c(){e=u("button"),t=w("deselect"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var o=d(e);t=y(o,"deselect"),o.forEach(s),this.h()},h(){g(e,"class","selector svelte-1wbelz3")},m(n,o){H(n,e,o),r(e,t),l||(a=fe(e,"click",c[7]),l=!0)},p:ee,d(n){n&&s(e),l=!1,a()}}}function nt(c){let e,t=c[28].message+"",l;return{c(){e=u("p"),l=w(t),this.h()},l(a){e=h(a,"P",{style:!0});var n=d(e);l=y(n,t),n.forEach(s),this.h()},h(){ge(e,"color","red")},m(a,n){H(a,e,n),r(e,l)},p(a,n){n[0]&32&&t!==(t=a[28].message+"")&&te(l,t)},d(a){a&&s(e)}}}function ct(c){let e;function t(n,o){return n[24].description.graph[0]?it:ft}let l=t(c),a=l(c);return{c(){a.c(),e=he()},l(n){a.l(n),e=he()},m(n,o){a.m(n,o),H(n,e,o)},p(n,o){l===(l=t(n))&&a?a.p(n,o):(a.d(1),a=l(n),a&&(a.c(),a.m(e.parentNode,e)))},d(n){a.d(n),n&&s(e)}}}function ft(c){let e,t,l=c[24].id+"",a,n,o,_,v,T,k;return{c(){e=u("td"),t=u("a"),a=w(l),o=C(),_=u("td"),v=w("not found in D3FEND graph"),T=C(),k=u("td"),this.h()},l(p){e=h(p,"TD",{class:!0});var i=d(e);t=h(i,"A",{style:!0,href:!0});var b=d(t);a=y(b,l),b.forEach(s),i.forEach(s),o=K(p),_=h(p,"TD",{});var E=d(_);v=y(E,"not found in D3FEND graph"),E.forEach(s),T=K(p),k=h(p,"TD",{}),d(k).forEach(s),this.h()},h(){ge(t,"color","red"),g(t,"href",n=Ie(c[24].id)),g(e,"class","text-center")},m(p,i){H(p,e,i),r(e,t),r(t,a),H(p,o,i),H(p,_,i),r(_,v),H(p,T,i),H(p,k,i)},p(p,i){i[0]&32&&l!==(l=p[24].id+"")&&te(a,l),i[0]&32&&n!==(n=Ie(p[24].id))&&g(t,"href",n)},d(p){p&&s(e),p&&s(o),p&&s(_),p&&s(T),p&&s(k)}}}function it(c){let e,t,l=c[24].description.graph[0]["d3f:attack-id"]+"",a,n,o,_,v=c[24].description.graph[0]["rdfs:label"]+"",T,k,p,i,b,E,R,J,G,V,O,Y,Q,q,I,F,M,U,W,L,D=Se(c[24].off_to_def.results.bindings),P=[];for(let m=0;m<D.length;m+=1)P[m]=Oe(Ke(c,D,m));let S=null;return D.length||(S=Ve()),{c(){e=u("th"),t=u("a"),a=w(l),o=C(),_=u("td"),T=w(v),k=C(),p=u("td"),i=u("table"),b=u("thead"),E=u("th"),R=w("off rel"),J=C(),G=u("th"),V=w("off artifact"),O=C(),Y=u("th"),Q=w("D3FEND Technique"),q=C(),I=u("th"),F=w("def rel"),M=C(),U=u("th"),W=w("def artifact"),L=C();for(let m=0;m<P.length;m+=1)P[m].c();S&&S.c(),this.h()},l(m){e=h(m,"TH",{class:!0,scope:!0});var z=d(e);t=h(z,"A",{href:!0});var B=d(t);a=y(B,l),B.forEach(s),z.forEach(s),o=K(m),_=h(m,"TD",{});var X=d(_);T=y(X,v),X.forEach(s),k=K(m),p=h(m,"TD",{});var Z=d(p);i=h(Z,"TABLE",{class:!0});var A=d(i);b=h(A,"THEAD",{class:!0});var f=d(b);E=h(f,"TH",{scope:!0});var N=d(E);R=y(N,"off rel"),N.forEach(s),J=K(f),G=h(f,"TH",{scope:!0});var j=d(G);V=y(j,"off artifact"),j.forEach(s),O=K(f),Y=h(f,"TH",{scope:!0});var $=d(Y);Q=y($,"D3FEND Technique"),$.forEach(s),q=K(f),I=h(f,"TH",{scope:!0});var x=d(I);F=y(x,"def rel"),x.forEach(s),M=K(f),U=h(f,"TH",{scope:!0});var re=d(U);W=y(re,"def artifact"),re.forEach(s),f.forEach(s),L=K(A);for(let le=0;le<P.length;le+=1)P[le].l(A);S&&S.l(A),A.forEach(s),Z.forEach(s),this.h()},h(){g(t,"href",n=pe(c[24].id)),g(e,"class","text-center"),g(e,"scope","row"),g(E,"scope","col"),g(G,"scope","col"),g(Y,"scope","col"),g(I,"scope","col"),g(U,"scope","col"),g(b,"class","svelte-1wbelz3"),Ne(b,"hide",c[4]),g(i,"class","table-auto w100 svelte-1wbelz3")},m(m,z){H(m,e,z),r(e,t),r(t,a),H(m,o,z),H(m,_,z),r(_,T),H(m,k,z),H(m,p,z),r(p,i),r(i,b),r(b,E),r(E,R),r(b,J),r(b,G),r(G,V),r(b,O),r(b,Y),r(Y,Q),r(b,q),r(b,I),r(I,F),r(b,M),r(b,U),r(U,W),r(i,L);for(let B=0;B<P.length;B+=1)P[B].m(i,null);S&&S.m(i,null)},p(m,z){if(z[0]&32&&l!==(l=m[24].description.graph[0]["d3f:attack-id"]+"")&&te(a,l),z[0]&32&&n!==(n=pe(m[24].id))&&g(t,"href",n),z[0]&32&&v!==(v=m[24].description.graph[0]["rdfs:label"]+"")&&te(T,v),z[0]&16&&Ne(b,"hide",m[4]),z[0]&32){D=Se(m[24].off_to_def.results.bindings);let B;for(B=0;B<D.length;B+=1){const X=Ke(m,D,B);P[B]?P[B].p(X,z):(P[B]=Oe(X),P[B].c(),P[B].m(i,null))}for(;B<P.length;B+=1)P[B].d(1);P.length=D.length,!D.length&&S?S.p(m,z):D.length?S&&(S.d(1),S=null):(S=Ve(),S.c(),S.m(i,null))}},d(m){m&&s(e),m&&s(o),m&&s(_),m&&s(k),m&&s(p),Te(P,m),S&&S.d()}}}function Ve(c){let e,t,l,a,n;return{c(){e=u("td"),t=w("no defensive relations "),l=u("a"),a=w("yet"),n=C(),this.h()},l(o){e=h(o,"TD",{colspan:!0});var _=d(e);t=y(_,"no defensive relations "),l=h(_,"A",{href:!0});var v=d(l);a=y(v,"yet"),v.forEach(s),n=K(_),_.forEach(s),this.h()},h(){g(l,"href","/contribute"),g(e,"colspan","5")},m(o,_){H(o,e,_),r(e,t),r(e,l),r(l,a),r(e,n)},p:ee,d(o){o&&s(e)}}}function Fe(c){let e,t,l=c[25].off_artifact_rel_label.value+"",a,n,o,_,v=c[25].off_artifact_label.value+"",T,k,p,i,b,E=c[25].def_tech_label.value+"",R,J,G,V,O=c[25].def_artifact_rel_label.value+"",Y,Q,q,I,F=c[25].def_artifact_label.value+"",M,U,W;return{c(){e=u("tr"),t=u("td"),a=w(l),n=C(),o=u("td"),_=u("a"),T=w(v),p=C(),i=u("td"),b=u("a"),R=w(E),G=C(),V=u("td"),Y=w(O),Q=C(),q=u("td"),I=u("a"),M=w(F),W=C(),this.h()},l(L){e=h(L,"TR",{});var D=d(e);t=h(D,"TD",{});var P=d(t);a=y(P,l),P.forEach(s),n=K(D),o=h(D,"TD",{});var S=d(o);_=h(S,"A",{href:!0});var m=d(_);T=y(m,v),m.forEach(s),S.forEach(s),p=K(D),i=h(D,"TD",{});var z=d(i);b=h(z,"A",{href:!0});var B=d(b);R=y(B,E),B.forEach(s),z.forEach(s),G=K(D),V=h(D,"TD",{});var X=d(V);Y=y(X,O),X.forEach(s),Q=K(D),q=h(D,"TD",{});var Z=d(q);I=h(Z,"A",{href:!0});var A=d(I);M=y(A,F),A.forEach(s),Z.forEach(s),W=K(D),D.forEach(s),this.h()},h(){g(_,"href",k="/dao/artifact/"+ce(c[25].off_artifact.value)),g(b,"href",J="/technique/"+ce(c[25].def_tech.value)),g(I,"href",U="/dao/artifact/"+ce(c[25].def_artifact.value))},m(L,D){H(L,e,D),r(e,t),r(t,a),r(e,n),r(e,o),r(o,_),r(_,T),r(e,p),r(e,i),r(i,b),r(b,R),r(e,G),r(e,V),r(V,Y),r(e,Q),r(e,q),r(q,I),r(I,M),r(e,W)},p(L,D){D[0]&32&&l!==(l=L[25].off_artifact_rel_label.value+"")&&te(a,l),D[0]&32&&v!==(v=L[25].off_artifact_label.value+"")&&te(T,v),D[0]&32&&k!==(k="/dao/artifact/"+ce(L[25].off_artifact.value))&&g(_,"href",k),D[0]&32&&E!==(E=L[25].def_tech_label.value+"")&&te(R,E),D[0]&32&&J!==(J="/technique/"+ce(L[25].def_tech.value))&&g(b,"href",J),D[0]&32&&O!==(O=L[25].def_artifact_rel_label.value+"")&&te(Y,O),D[0]&32&&F!==(F=L[25].def_artifact_label.value+"")&&te(M,F),D[0]&32&&U!==(U="/dao/artifact/"+ce(L[25].def_artifact.value))&&g(I,"href",U)},d(L){L&&s(e)}}}function Oe(c){let e,t=c[25].def_tech&&Fe(c);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,a){t&&t.m(l,a),H(l,e,a)},p(l,a){l[25].def_tech?t?t.p(l,a):(t=Fe(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&s(e)}}}function ut(c){let e;return{c(){e=w("loading...")},l(t){e=y(t,"loading...")},m(t,l){H(t,e,l)},p:ee,d(t){t&&s(e)}}}function Pe(c){let e,t,l,a={ctx:c,current:null,token:null,hasCatch:!0,pending:ut,then:ct,catch:nt,value:24,error:28};return _e(t=c[21],a),{c(){e=u("tr"),a.block.c(),l=C()},l(n){e=h(n,"TR",{});var o=d(e);a.block.l(o),l=K(o),o.forEach(s)},m(n,o){H(n,e,o),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,r(e,l)},p(n,o){c=n,a.ctx=c,o[0]&32&&t!==(t=c[21])&&_e(t,a)||ze(a,c,o)},d(n){n&&s(e),a.block.d(),a.token=null,a=null}}}function ht(c){let e;return{c(){e=w("enter text and click go")},l(t){e=y(t,"enter text and click go")},m(t,l){H(t,e,l)},p:ee,i:ee,o:ee,d(t){t&&s(e)}}}function dt(c){let e,t,l,a,n,o,_,v,T,k,p,i,b,E,R,J,G,V,O,Y,Q,q,I,F,M,U,W,L,D,P,S,m,z,B,X,Z;e=new Qe({props:{title:"ATT&CK Extractor | Tools | "}}),a=new We({});let A={ctx:c,current:null,token:null,hasCatch:!0,pending:ht,then:tt,catch:et,value:20,error:28,blocks:[,,,]};return _e(z=c[5],A),{c(){me(e.$$.fragment),t=C(),l=u("section"),me(a.$$.fragment),n=C(),o=u("div"),_=u("h1"),v=w("ATT&CK Extractor"),T=C(),k=u("p"),p=w("Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),i=u("a"),b=w("D3FEND Extractor"),E=w(" or the "),R=u("a"),J=w("Artifact Extractor."),G=C(),V=u("p"),O=u("i"),Y=w("Paste any text containing ATT&CK IDs:"),Q=C(),q=u("div"),I=u("textarea"),F=C(),M=u("div"),U=u("button"),W=w("GO"),L=C(),D=u("br"),P=C(),S=u("br"),m=C(),A.block.c(),this.h()},l(f){be(e.$$.fragment,f),t=K(f),l=h(f,"SECTION",{class:!0});var N=d(l);be(a.$$.fragment,N),n=K(N),o=h(N,"DIV",{class:!0});var j=d(o);_=h(j,"H1",{});var $=d(_);v=y($,"ATT&CK Extractor"),$.forEach(s),T=K(j),k=h(j,"P",{});var x=d(k);p=y(x,"Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),i=h(x,"A",{href:!0});var re=d(i);b=y(re,"D3FEND Extractor"),re.forEach(s),E=y(x," or the "),R=h(x,"A",{href:!0});var le=d(R);J=y(le,"Artifact Extractor."),le.forEach(s),x.forEach(s),G=K(j),V=h(j,"P",{class:!0});var oe=d(V);O=h(oe,"I",{});var se=d(O);Y=y(se,"Paste any text containing ATT&CK IDs:"),se.forEach(s),oe.forEach(s),Q=K(j),q=h(j,"DIV",{});var de=d(q);I=h(de,"TEXTAREA",{class:!0}),d(I).forEach(s),de.forEach(s),F=K(j),M=h(j,"DIV",{});var ne=d(M);U=h(ne,"BUTTON",{class:!0});var ae=d(U);W=y(ae,"GO"),ae.forEach(s),ne.forEach(s),L=K(j),D=h(j,"BR",{}),j.forEach(s),P=K(N),S=h(N,"BR",{}),m=K(N),A.block.l(N),N.forEach(s),this.h()},h(){g(i,"href","/tools/d3fend-extractor"),g(R,"href","/tools/artifact-extractor"),g(V,"class","text-2"),g(I,"class","svelte-1wbelz3"),g(U,"class","button"),g(o,"class","card"),g(l,"class"," svelte-1wbelz3")},m(f,N){Ee(e,f,N),H(f,t,N),H(f,l,N),Ee(a,l,null),r(l,n),r(l,o),r(o,_),r(_,v),r(o,T),r(o,k),r(k,p),r(k,i),r(i,b),r(k,E),r(k,R),r(R,J),r(o,G),r(o,V),r(V,O),r(O,Y),r(o,Q),r(o,q),r(q,I),ye(I,c[1]),r(o,F),r(o,M),r(M,U),r(U,W),r(o,L),r(o,D),r(l,P),r(l,S),r(l,m),A.block.m(l,A.anchor=null),A.mount=()=>l,A.anchor=null,B=!0,X||(Z=[fe(I,"input",c[11]),fe(I,"keypress",c[9]),fe(U,"click",c[6])],X=!0)},p(f,N){c=f,N[0]&2&&ye(I,c[1]),A.ctx=c,N[0]&32&&z!==(z=c[5])&&_e(z,A)||ze(A,c,N)},i(f){B||(ie(e.$$.fragment,f),ie(a.$$.fragment,f),ie(A.block),B=!0)},o(f){ue(e.$$.fragment,f),ue(a.$$.fragment,f);for(let N=0;N<3;N+=1){const j=A.blocks[N];ue(j)}B=!1},d(f){ke(e,f),f&&s(t),f&&s(l),ke(a),A.block.d(),A.token=null,A=null,X=!1,Le(Z)}}}async function Nt({params:c,fetch:e}){c.technique;const t=await e("/api/offensive-technique/all.json"),l=await t.json();return t.status===200?{props:{techniques:l}}:{status:t.status,error:new Error(l.message)}}function _t(){document.execCommand("copy")}function Se(c){let e=new Set,t=[];return c.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function pt(c,e,t){let l;Me(c,xe,q=>t(15,l=q));let{techniques:a}=e,n=new qe(a,{index:!0,index_key:"d3f:attack-id"}),o,_="",v=!1,T=!0,k,p=[];function i(){t(0,o=[]),t(2,v=!1),t(3,T=!0),p=[]}k=l.url.searchParams.get("q"),console.log("Found params: "+k);let b=!1;async function E(q){let I="/api/offensive-technique/attack/"+q+".json";const F=await fetch(I);if(F.status==404)return{id:q,off_to_def:[],description:{graph:[]},status:F.status};if(F.ok){const M=await F.json();return{id:q,off_to_def:M.off_to_def,description:new qe(M.description)}}else throw new Error(_)}async function R(){i();let q=t(0,o=Array.from(new Set(Je(_,n))));return q?(q.forEach(function(I){let F;F=E(I),F&&p.push(F)}),l.url.searchParams.set("q",JSON.stringify(q)),history.replaceState(null,"mapping",l.url)):(i(),console.debug("no matches")),p}let J=R();function G(){t(5,J=R()),t(3,T=!1)}function V(){window.getSelection().removeAllRanges(),t(2,v=!1),t(4,b=!1)}function O(){t(4,b=!0);let q="mappings";const I=window.getSelection();I.removeAllRanges();let F=document.getElementById(q);const M=document.createRange();M.selectNodeContents(F),I.addRange(M),t(2,v=!0)}function Y(q){q.ctrlKey==!0&&q.keyCode==13&&G()}Ye(async()=>{k?(t(1,_=k),console.log("handlingclick"),G()):(console.log("starting blank"),t(1,_=""))});function Q(){_=this.value,t(1,_)}return c.$$set=q=>{"techniques"in q&&t(10,a=q.techniques)},[o,_,v,T,b,J,G,V,O,Y,a,Q]}class qt extends je{constructor(e){super(),Ge(this,e,pt,dt,Ue,{techniques:10},null,[-1,-1])}}export{qt as default,Nt as load};
