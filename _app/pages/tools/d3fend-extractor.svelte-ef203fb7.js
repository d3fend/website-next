var Ze=Object.defineProperty;var Be=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var Ke=(s,e,t)=>e in s?Ze(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,be=(s,e)=>{for(var t in e||(e={}))xe.call(e,t)&&Ke(s,t,e[t]);if(Be)for(var t of Be(e))et.call(e,t)&&Ke(s,t,e[t]);return s};import{S as tt,i as lt,s as at,a7 as Te,w as De,k as F,e as c,t as w,x as qe,m as R,c as f,a as u,h as y,d as o,b as g,y as we,g as O,I as a,a1 as Oe,N as ce,a8 as Qe,q as he,o as ue,B as ye,Y as We,R as rt,v as ot,f as Ne,j as ae,E as re,l as de,n as st,p as nt,X as Ae,V as Ve}from"../../chunks/index-a02da30e.js";import{H as it}from"../../chunks/Header-826dac44.js";import{T as ct}from"../../chunks/Title-1d23c88f.js";import{A as ft}from"../../chunks/Alert-12c40fb9.js";import{b as ht}from"../../chunks/extract-487bbbcb.js";import{G as Pe,g as ie,b as je,e as Ee,d as ge}from"../../chunks/lib-c0e834da.js";import{p as ut}from"../../chunks/stores-cf129ad8.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";/* empty css                                                       */import"../../chunks/marked.esm-8ab30116.js";var dt={name:"D3FEND Countermeasure Coverage",domain:"enterprise-attack",description:""};class _t{constructor(e){this.layer=be({},dt),this.layer.techniques=new Array,this.tech_index={},e&&(this.options=be(be({},this.options),e))}add_technique(e){this.tech_index.hasOwnProperty(e.techniqueID)?this.tech_index[e.techniqueID].comment&&this.tech_index[e.techniqueID].comment.indexOf(e.comment)==-1&&(this.tech_index[e.techniqueID].comment+=e.comment):this.tech_index[e.techniqueID]=e}json(){for(let e in this.tech_index)this.layer.techniques.push(this.tech_index[e]);return this.layer}}function Le(s,e,t){const l=s.slice();return l[20]=e[t],l}function Se(s,e,t){const l=s.slice();return l[24]=e[t],l}function $e(s,e,t){const l=s.slice();return l[28]=e[t],l}function pt(s){let e,t=s[27].message+"",l;return{c(){e=c("p"),l=w(t),this.h()},l(r){e=f(r,"P",{style:!0});var n=u(e);l=y(n,t),n.forEach(o),this.h()},h(){Ne(e,"color","red")},m(r,n){O(r,e,n),a(e,l)},p(r,n){n[0]&32&&t!==(t=r[27].message+"")&&ae(l,t)},i:re,o:re,d(r){r&&o(e)}}}function vt(s){let e,t,l,r;const n=[bt,mt],i=[];function v(p,A){return p[19].length>0?0:!p[3]&&p[19].length<1?1:-1}return~(e=v(s))&&(t=i[e]=n[e](s)),{c(){t&&t.c(),l=de()},l(p){t&&t.l(p),l=de()},m(p,A){~e&&i[e].m(p,A),O(p,l,A),r=!0},p(p,A){let k=e;e=v(p),e===k?~e&&i[e].p(p,A):(t&&(st(),ue(i[k],1,1,()=>{i[k]=null}),nt()),~e?(t=i[e],t?t.p(p,A):(t=i[e]=n[e](p),t.c()),he(t,1),t.m(l.parentNode,l)):t=null)},i(p){r||(he(t),r=!0)},o(p){ue(t),r=!1},d(p){~e&&i[e].d(p),p&&o(l)}}}function mt(s){let e,t;return{c(){e=c("div"),t=w("No D3FEND techniques found in text."),this.h()},l(l){e=f(l,"DIV",{class:!0});var r=u(e);t=y(r,"No D3FEND techniques found in text."),r.forEach(o),this.h()},h(){g(e,"class","card")},m(l,r){O(l,e,r),a(e,t)},p:re,i:re,o:re,d(l){l&&o(e)}}}function bt(s){let e,t,l,r,n,i,v,p,A,k,_,d,b,T,P,U,V,J,Y,Q,te,E,D,B,S,G,Z,W,X,x,le,z,j,q,h,I=s[0]&&Ue(s);r=new ft({props:{$$slots:{default:[Et]},$$scope:{ctx:s}}});function N(m,M){return m[2]?Tt:gt}let K=N(s),C=K(s),L=s[19],H=[];for(let m=0;m<L.length;m+=1)H[m]=Xe(Le(s,L,m));return{c(){e=c("div"),I&&I.c(),t=F(),l=c("div"),De(r.$$.fragment),n=F(),i=c("div"),v=c("div"),p=c("button"),A=w("Download ATT&CK Navigator Layer"),k=F(),_=c("div"),d=c("b"),b=c("i"),T=w("Mapping Results:"),P=F(),U=c("div"),V=c("div"),C.c(),J=F(),Y=c("button"),Q=w("copy"),te=F(),E=c("table"),D=c("thead"),B=c("th"),S=w("D3FEND ID"),G=F(),Z=c("th"),W=w("D3FEND Name"),X=F(),x=c("th"),le=w("Related ATT&CK Techniques"),z=F();for(let m=0;m<H.length;m+=1)H[m].c();this.h()},l(m){e=f(m,"DIV",{class:!0});var M=u(e);I&&I.l(M),M.forEach(o),t=R(m),l=f(m,"DIV",{class:!0});var ee=u(l);qe(r.$$.fragment,ee),ee.forEach(o),n=R(m),i=f(m,"DIV",{class:!0});var $=u(i);v=f($,"DIV",{class:!0});var oe=u(v);p=f(oe,"BUTTON",{class:!0,title:!0});var ne=u(p);A=y(ne,"Download ATT&CK Navigator Layer"),ne.forEach(o),oe.forEach(o),k=R($),_=f($,"DIV",{});var se=u(_);d=f(se,"B",{});var _e=u(d);b=f(_e,"I",{});var Ie=u(b);T=y(Ie,"Mapping Results:"),Ie.forEach(o),_e.forEach(o),se.forEach(o),P=R($),U=f($,"DIV",{class:!0});var pe=u(U);V=f(pe,"DIV",{class:!0});var ve=u(V);C.l(ve),J=R(ve),Y=f(ve,"BUTTON",{});var Ce=u(Y);Q=y(Ce,"copy"),Ce.forEach(o),ve.forEach(o),te=R(pe),E=f(pe,"TABLE",{id:!0,class:!0});var me=u(E);D=f(me,"THEAD",{});var fe=u(D);B=f(fe,"TH",{class:!0});var Fe=u(B);S=y(Fe,"D3FEND ID"),Fe.forEach(o),G=R(fe),Z=f(fe,"TH",{});var Re=u(Z);W=y(Re,"D3FEND Name"),Re.forEach(o),X=R(fe),x=f(fe,"TH",{});var He=u(x);le=y(He,"Related ATT&CK Techniques"),He.forEach(o),fe.forEach(o),z=R(me);for(let ke=0;ke<H.length;ke+=1)H[ke].l(me);me.forEach(o),pe.forEach(o),$.forEach(o),this.h()},h(){g(e,"class","card"),g(l,"class","card"),g(p,"class","small button"),g(p,"title","Load into Navigator to see related TTPs"),g(v,"class","text-right"),g(V,"class","text-right"),g(B,"class","stretch"),g(E,"id","mappings"),g(E,"class","table-auto"),g(U,"class","results-wrap center svelte-wn74lb"),g(i,"class","card")},m(m,M){O(m,e,M),I&&I.m(e,null),O(m,t,M),O(m,l,M),we(r,l,null),O(m,n,M),O(m,i,M),a(i,v),a(v,p),a(p,A),a(i,k),a(i,_),a(_,d),a(d,b),a(b,T),a(i,P),a(i,U),a(U,V),C.m(V,null),a(V,J),a(V,Y),a(Y,Q),a(U,te),a(U,E),a(E,D),a(D,B),a(B,S),a(D,G),a(D,Z),a(Z,W),a(D,X),a(D,x),a(x,le),a(E,z);for(let ee=0;ee<H.length;ee+=1)H[ee].m(E,null);j=!0,q||(h=[ce(p,"click",s[6]),ce(Y,"click",It)],q=!0)},p(m,M){m[0]?I?I.p(m,M):(I=Ue(m),I.c(),I.m(e,null)):I&&(I.d(1),I=null);const ee={};if(M[1]&1&&(ee.$$scope={dirty:M,ctx:m}),r.$set(ee),K===(K=N(m))&&C?C.p(m,M):(C.d(1),C=K(m),C&&(C.c(),C.m(V,J))),M[0]&48){L=m[19];let $;for($=0;$<L.length;$+=1){const oe=Le(m,L,$);H[$]?H[$].p(oe,M):(H[$]=Xe(oe),H[$].c(),H[$].m(E,null))}for(;$<H.length;$+=1)H[$].d(1);H.length=L.length}},i(m){j||(he(r.$$.fragment,m),j=!0)},o(m){ue(r.$$.fragment,m),j=!1},d(m){m&&o(e),I&&I.d(),m&&o(t),m&&o(l),ye(r),m&&o(n),m&&o(i),C.d(),Ae(H,m),q=!1,We(h)}}}function Ue(s){let e,t,l,r,n=s[0].length+"",i,v,p,A,k=s[0],_=[];for(let d=0;d<k.length;d+=1)_[d]=Ge($e(s,k,d));return{c(){e=c("div"),t=c("b"),l=c("i"),r=w("Extracted "),i=w(n),v=w(" unique IDs:"),p=F(),A=c("dl");for(let d=0;d<_.length;d+=1)_[d].c();this.h()},l(d){e=f(d,"DIV",{class:!0});var b=u(e);t=f(b,"B",{});var T=u(t);l=f(T,"I",{});var P=u(l);r=y(P,"Extracted "),i=y(P,n),v=y(P," unique IDs:"),P.forEach(o),T.forEach(o),p=R(b),A=f(b,"DL",{class:!0});var U=u(A);for(let V=0;V<_.length;V+=1)_[V].l(U);U.forEach(o),b.forEach(o),this.h()},h(){g(A,"class","flex flex-wrap svelte-wn74lb"),g(e,"class","")},m(d,b){O(d,e,b),a(e,t),a(t,l),a(l,r),a(l,i),a(l,v),a(e,p),a(e,A);for(let T=0;T<_.length;T+=1)_[T].m(A,null)},p(d,b){if(b[0]&1&&n!==(n=d[0].length+"")&&ae(i,n),b[0]&1){k=d[0];let T;for(T=0;T<k.length;T+=1){const P=$e(d,k,T);_[T]?_[T].p(P,b):(_[T]=Ge(P),_[T].c(),_[T].m(A,null))}for(;T<_.length;T+=1)_[T].d(1);_.length=k.length}},d(d){d&&o(e),Ae(_,d)}}}function Ge(s){let e,t=s[28]+"",l;return{c(){e=c("dd"),l=w(t)},l(r){e=f(r,"DD",{});var n=u(e);l=y(n,t),n.forEach(o)},m(r,n){O(r,e,n),a(e,l)},p(r,n){n[0]&1&&t!==(t=r[28]+"")&&ae(l,t)},d(r){r&&o(e)}}}function Et(s){let e;return{c(){e=w("These relationships are generated based on the digital artifacts specified for the offensive and defensive techniques. These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},l(t){e=y(t,"These relationships are generated based on the digital artifacts specified for the offensive and defensive techniques. These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},m(t,l){O(t,e,l)},d(t){t&&o(e)}}}function gt(s){let e,t,l,r;return{c(){e=c("button"),t=w("select"),this.h()},l(n){e=f(n,"BUTTON",{class:!0});var i=u(e);t=y(i,"select"),i.forEach(o),this.h()},h(){g(e,"class","selector svelte-wn74lb")},m(n,i){O(n,e,i),a(e,t),l||(r=ce(e,"click",s[9]),l=!0)},p:re,d(n){n&&o(e),l=!1,r()}}}function Tt(s){let e,t,l,r;return{c(){e=c("button"),t=w("deselect"),this.h()},l(n){e=f(n,"BUTTON",{class:!0});var i=u(e);t=y(i,"deselect"),i.forEach(o),this.h()},h(){g(e,"class","selector svelte-wn74lb")},m(n,i){O(n,e,i),a(e,t),l||(r=ce(e,"click",s[8]),l=!0)},p:re,d(n){n&&o(e),l=!1,r()}}}function kt(s){let e,t=s[27].message+"",l;return{c(){e=c("p"),l=w(t),this.h()},l(r){e=f(r,"P",{style:!0});var n=u(e);l=y(n,t),n.forEach(o),this.h()},h(){Ne(e,"color","red")},m(r,n){O(r,e,n),a(e,l)},p(r,n){n[0]&32&&t!==(t=r[27].message+"")&&ae(l,t)},d(r){r&&o(e)}}}function Dt(s){let e;function t(n,i){return n[23].description.graph[0]?wt:qt}let l=t(s),r=l(s);return{c(){r.c(),e=de()},l(n){r.l(n),e=de()},m(n,i){r.m(n,i),O(n,e,i)},p(n,i){l===(l=t(n))&&r?r.p(n,i):(r.d(1),r=l(n),r&&(r.c(),r.m(e.parentNode,e)))},d(n){r.d(n),n&&o(e)}}}function qt(s){let e,t,l=s[23].id+"",r,n,i,v,p,A,k;return{c(){e=c("td"),t=c("a"),r=w(l),i=F(),v=c("td"),p=w("not found in D3FEND graph"),A=F(),k=c("td"),this.h()},l(_){e=f(_,"TD",{class:!0});var d=u(e);t=f(d,"A",{style:!0,href:!0});var b=u(t);r=y(b,l),b.forEach(o),d.forEach(o),i=R(_),v=f(_,"TD",{});var T=u(v);p=y(T,"not found in D3FEND graph"),T.forEach(o),A=R(_),k=f(_,"TD",{}),u(k).forEach(o),this.h()},h(){Ne(t,"color","red"),g(t,"href",n=je(s[23].id)),g(e,"class","text-center")},m(_,d){O(_,e,d),a(e,t),a(t,r),O(_,i,d),O(_,v,d),a(v,p),O(_,A,d),O(_,k,d)},p(_,d){d[0]&32&&l!==(l=_[23].id+"")&&ae(r,l),d[0]&32&&n!==(n=je(_[23].id))&&g(t,"href",n)},d(_){_&&o(e),_&&o(i),_&&o(v),_&&o(A),_&&o(k)}}}function wt(s){let e,t,l=s[23].description.graph[0]["d3f:d3fend-id"]+"",r,n,i,v,p=s[23].description.graph[0]["rdfs:label"]+"",A,k,_,d,b,T,P,U,V,J,Y,Q,te,E,D,B,S,G,Z,W,X,x,le,z=ze(s[23].def_to_off.results.bindings),j=[];for(let h=0;h<z.length;h+=1)j[h]=Je(Se(s,z,h));let q=null;return z.length||(q=Me()),{c(){e=c("th"),t=c("a"),r=w(l),i=F(),v=c("td"),A=w(p),k=F(),_=c("td"),d=c("table"),b=c("thead"),T=c("th"),P=w("defensive verb"),U=F(),V=c("th"),J=w("defensive artifact"),Y=F(),Q=c("th"),te=w("ATT&CK Technique"),E=F(),D=c("th"),B=w("offensive verb"),S=F(),G=c("th"),Z=w("offensive artifact"),W=F(),X=c("th"),x=w("ATT&CK ID"),le=F();for(let h=0;h<j.length;h+=1)j[h].c();q&&q.c(),this.h()},l(h){e=f(h,"TH",{class:!0,scope:!0});var I=u(e);t=f(I,"A",{href:!0});var N=u(t);r=y(N,l),N.forEach(o),I.forEach(o),i=R(h),v=f(h,"TD",{});var K=u(v);A=y(K,p),K.forEach(o),k=R(h),_=f(h,"TD",{});var C=u(_);d=f(C,"TABLE",{class:!0});var L=u(d);b=f(L,"THEAD",{class:!0});var H=u(b);T=f(H,"TH",{scope:!0});var m=u(T);P=y(m,"defensive verb"),m.forEach(o),U=R(H),V=f(H,"TH",{scope:!0});var M=u(V);J=y(M,"defensive artifact"),M.forEach(o),Y=R(H),Q=f(H,"TH",{scope:!0});var ee=u(Q);te=y(ee,"ATT&CK Technique"),ee.forEach(o),E=R(H),D=f(H,"TH",{scope:!0});var $=u(D);B=y($,"offensive verb"),$.forEach(o),S=R(H),G=f(H,"TH",{scope:!0});var oe=u(G);Z=y(oe,"offensive artifact"),oe.forEach(o),W=R(H),X=f(H,"TH",{scope:!0});var ne=u(X);x=y(ne,"ATT&CK ID"),ne.forEach(o),H.forEach(o),le=R(L);for(let se=0;se<j.length;se+=1)j[se].l(L);q&&q.l(L),L.forEach(o),C.forEach(o),this.h()},h(){g(t,"href",n="/technique/"+s[23].description.graph[0]["@id"]),g(e,"class","text-center"),g(e,"scope","row"),g(T,"scope","col"),g(V,"scope","col"),g(Q,"scope","col"),g(D,"scope","col"),g(G,"scope","col"),g(X,"scope","col"),g(b,"class","svelte-wn74lb"),Ve(b,"hide",s[4]),g(d,"class","table-auto w100 svelte-wn74lb")},m(h,I){O(h,e,I),a(e,t),a(t,r),O(h,i,I),O(h,v,I),a(v,A),O(h,k,I),O(h,_,I),a(_,d),a(d,b),a(b,T),a(T,P),a(b,U),a(b,V),a(V,J),a(b,Y),a(b,Q),a(Q,te),a(b,E),a(b,D),a(D,B),a(b,S),a(b,G),a(G,Z),a(b,W),a(b,X),a(X,x),a(d,le);for(let N=0;N<j.length;N+=1)j[N].m(d,null);q&&q.m(d,null)},p(h,I){if(I[0]&32&&l!==(l=h[23].description.graph[0]["d3f:d3fend-id"]+"")&&ae(r,l),I[0]&32&&n!==(n="/technique/"+h[23].description.graph[0]["@id"])&&g(t,"href",n),I[0]&32&&p!==(p=h[23].description.graph[0]["rdfs:label"]+"")&&ae(A,p),I[0]&16&&Ve(b,"hide",h[4]),I[0]&32){z=ze(h[23].def_to_off.results.bindings);let N;for(N=0;N<z.length;N+=1){const K=Se(h,z,N);j[N]?j[N].p(K,I):(j[N]=Je(K),j[N].c(),j[N].m(d,null))}for(;N<j.length;N+=1)j[N].d(1);j.length=z.length,!z.length&&q?q.p(h,I):z.length?q&&(q.d(1),q=null):(q=Me(),q.c(),q.m(d,null))}},d(h){h&&o(e),h&&o(i),h&&o(v),h&&o(k),h&&o(_),Ae(j,h),q&&q.d()}}}function Me(s){let e,t,l,r,n;return{c(){e=c("td"),t=w("no defensive relations "),l=c("a"),r=w("yet"),n=F(),this.h()},l(i){e=f(i,"TD",{colspan:!0});var v=u(e);t=y(v,"no defensive relations "),l=f(v,"A",{href:!0});var p=u(l);r=y(p,"yet"),p.forEach(o),n=R(v),v.forEach(o),this.h()},h(){g(l,"href","/contribute"),g(e,"colspan","5")},m(i,v){O(i,e,v),a(e,t),a(e,l),a(l,r),a(e,n)},p:re,d(i){i&&o(e)}}}function Ye(s){let e,t,l=s[24].def_artifact_rel_label.value+"",r,n,i,v,p=s[24].def_artifact_label.value+"",A,k,_,d,b,T=s[24].off_tech_label.value+"",P,U,V,J,Y=s[24].off_artifact_rel_label.value+"",Q,te,E,D,B=s[24].off_artifact_label.value+"",S,G,Z,W,X,x=ie(s[24].off_tech.value)+"",le,z,j;return{c(){e=c("tr"),t=c("td"),r=w(l),n=F(),i=c("td"),v=c("a"),A=w(p),_=F(),d=c("td"),b=c("a"),P=w(T),V=F(),J=c("td"),Q=w(Y),te=F(),E=c("td"),D=c("a"),S=w(B),Z=F(),W=c("td"),X=c("a"),le=w(x),j=F(),this.h()},l(q){e=f(q,"TR",{});var h=u(e);t=f(h,"TD",{});var I=u(t);r=y(I,l),I.forEach(o),n=R(h),i=f(h,"TD",{});var N=u(i);v=f(N,"A",{href:!0});var K=u(v);A=y(K,p),K.forEach(o),N.forEach(o),_=R(h),d=f(h,"TD",{});var C=u(d);b=f(C,"A",{href:!0});var L=u(b);P=y(L,T),L.forEach(o),C.forEach(o),V=R(h),J=f(h,"TD",{});var H=u(J);Q=y(H,Y),H.forEach(o),te=R(h),E=f(h,"TD",{});var m=u(E);D=f(m,"A",{href:!0});var M=u(D);S=y(M,B),M.forEach(o),m.forEach(o),Z=R(h),W=f(h,"TD",{});var ee=u(W);X=f(ee,"A",{href:!0});var $=u(X);le=y($,x),$.forEach(o),ee.forEach(o),j=R(h),h.forEach(o),this.h()},h(){g(v,"href",k="/dao/artifact/"+Ee(s[24].def_artifact.value)),g(b,"href",U=ge(ie(s[24].off_tech.value))),g(D,"href",G="/dao/artifact/"+Ee(s[24].off_artifact.value)),g(X,"href",z=ge(ie(s[24].off_tech.value)))},m(q,h){O(q,e,h),a(e,t),a(t,r),a(e,n),a(e,i),a(i,v),a(v,A),a(e,_),a(e,d),a(d,b),a(b,P),a(e,V),a(e,J),a(J,Q),a(e,te),a(e,E),a(E,D),a(D,S),a(e,Z),a(e,W),a(W,X),a(X,le),a(e,j)},p(q,h){h[0]&32&&l!==(l=q[24].def_artifact_rel_label.value+"")&&ae(r,l),h[0]&32&&p!==(p=q[24].def_artifact_label.value+"")&&ae(A,p),h[0]&32&&k!==(k="/dao/artifact/"+Ee(q[24].def_artifact.value))&&g(v,"href",k),h[0]&32&&T!==(T=q[24].off_tech_label.value+"")&&ae(P,T),h[0]&32&&U!==(U=ge(ie(q[24].off_tech.value)))&&g(b,"href",U),h[0]&32&&Y!==(Y=q[24].off_artifact_rel_label.value+"")&&ae(Q,Y),h[0]&32&&B!==(B=q[24].off_artifact_label.value+"")&&ae(S,B),h[0]&32&&G!==(G="/dao/artifact/"+Ee(q[24].off_artifact.value))&&g(D,"href",G),h[0]&32&&x!==(x=ie(q[24].off_tech.value)+"")&&ae(le,x),h[0]&32&&z!==(z=ge(ie(q[24].off_tech.value)))&&g(X,"href",z)},d(q){q&&o(e)}}}function Je(s){let e,t=s[24].def_tech&&Ye(s);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,r){t&&t.m(l,r),O(l,e,r)},p(l,r){l[24].def_tech?t?t.p(l,r):(t=Ye(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&o(e)}}}function yt(s){let e;return{c(){e=w("loading...")},l(t){e=y(t,"loading...")},m(t,l){O(t,e,l)},p:re,d(t){t&&o(e)}}}function Xe(s){let e,t,l,r={ctx:s,current:null,token:null,hasCatch:!0,pending:yt,then:Dt,catch:kt,value:23,error:27};return Te(t=s[20],r),{c(){e=c("tr"),r.block.c(),l=F()},l(n){e=f(n,"TR",{});var i=u(e);r.block.l(i),l=R(i),i.forEach(o)},m(n,i){O(n,e,i),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=l,a(e,l)},p(n,i){s=n,r.ctx=s,i[0]&32&&t!==(t=s[20])&&Te(t,r)||Qe(r,s,i)},d(n){n&&o(e),r.block.d(),r.token=null,r=null}}}function Nt(s){let e;return{c(){e=w("enter text and click go")},l(t){e=y(t,"enter text and click go")},m(t,l){O(t,e,l)},p:re,i:re,o:re,d(t){t&&o(e)}}}function At(s){let e,t,l,r,n,i,v,p,A,k,_,d,b,T,P,U,V,J,Y,Q,te,E,D,B,S,G,Z,W,X,x,le,z,j,q,h,I;e=new ct({props:{title:"D3FEND Extractor | Tools | "}}),r=new it({});let N={ctx:s,current:null,token:null,hasCatch:!0,pending:Nt,then:vt,catch:pt,value:19,error:27,blocks:[,,,]};return Te(j=s[5],N),{c(){De(e.$$.fragment),t=F(),l=c("section"),De(r.$$.fragment),n=F(),i=c("div"),v=c("h1"),p=w("D3FEND Extractor"),A=F(),k=c("p"),_=w("Extracts D3FEND techniques from blobs of text and identifies "),d=c("i"),b=w("related"),T=w(" ATT&CK Techniques. You may also want to try the "),P=c("a"),U=w("ATT&CK Extractor."),V=F(),J=c("p"),Y=c("i"),Q=w("Paste any text containing D3FEND techniques:"),te=F(),E=c("div"),D=c("textarea"),B=F(),S=c("div"),G=c("button"),Z=w("GO"),W=F(),X=c("br"),x=F(),le=c("br"),z=F(),N.block.c(),this.h()},l(K){qe(e.$$.fragment,K),t=R(K),l=f(K,"SECTION",{class:!0});var C=u(l);qe(r.$$.fragment,C),n=R(C),i=f(C,"DIV",{class:!0});var L=u(i);v=f(L,"H1",{});var H=u(v);p=y(H,"D3FEND Extractor"),H.forEach(o),A=R(L),k=f(L,"P",{});var m=u(k);_=y(m,"Extracts D3FEND techniques from blobs of text and identifies "),d=f(m,"I",{});var M=u(d);b=y(M,"related"),M.forEach(o),T=y(m," ATT&CK Techniques. You may also want to try the "),P=f(m,"A",{href:!0});var ee=u(P);U=y(ee,"ATT&CK Extractor."),ee.forEach(o),m.forEach(o),V=R(L),J=f(L,"P",{class:!0});var $=u(J);Y=f($,"I",{});var oe=u(Y);Q=y(oe,"Paste any text containing D3FEND techniques:"),oe.forEach(o),$.forEach(o),te=R(L),E=f(L,"DIV",{});var ne=u(E);D=f(ne,"TEXTAREA",{class:!0}),u(D).forEach(o),ne.forEach(o),B=R(L),S=f(L,"DIV",{});var se=u(S);G=f(se,"BUTTON",{class:!0});var _e=u(G);Z=y(_e,"GO"),_e.forEach(o),se.forEach(o),W=R(L),X=f(L,"BR",{}),L.forEach(o),x=R(C),le=f(C,"BR",{}),z=R(C),N.block.l(C),C.forEach(o),this.h()},h(){g(P,"href","/tools/attack-extractor"),g(J,"class","text-2"),g(D,"class","svelte-wn74lb"),g(G,"class","button"),g(i,"class","card"),g(l,"class"," svelte-wn74lb")},m(K,C){we(e,K,C),O(K,t,C),O(K,l,C),we(r,l,null),a(l,n),a(l,i),a(i,v),a(v,p),a(i,A),a(i,k),a(k,_),a(k,d),a(d,b),a(k,T),a(k,P),a(P,U),a(i,V),a(i,J),a(J,Y),a(Y,Q),a(i,te),a(i,E),a(E,D),Oe(D,s[1]),a(i,B),a(i,S),a(S,G),a(G,Z),a(i,W),a(i,X),a(l,x),a(l,le),a(l,z),N.block.m(l,N.anchor=null),N.mount=()=>l,N.anchor=null,q=!0,h||(I=[ce(D,"input",s[12]),ce(D,"keypress",s[10]),ce(G,"click",s[7])],h=!0)},p(K,C){s=K,C[0]&2&&Oe(D,s[1]),N.ctx=s,C[0]&32&&j!==(j=s[5])&&Te(j,N)||Qe(N,s,C)},i(K){q||(he(e.$$.fragment,K),he(r.$$.fragment,K),he(N.block),q=!0)},o(K){ue(e.$$.fragment,K),ue(r.$$.fragment,K);for(let C=0;C<3;C+=1){const L=N.blocks[C];ue(L)}q=!1},d(K){ye(e,K),K&&o(t),K&&o(l),ye(r),N.block.d(),N.token=null,N=null,h=!1,We(I)}}}async function Ut({params:s,fetch:e}){s.technique;const t=await e("/api/technique/all.json"),l=await t.json();return t.status===200?{props:{techniques:l}}:{status:t.status,error:new Error(l.message)}}function It(){document.execCommand("copy")}function ze(s){let e=new Set,t=[];return s.forEach(function(l){l.hasOwnProperty("off_tech_label")&&(e.has(l.off_tech_label.value)||(e.add(l.off_tech_label.value),t.push(l)))}),t}function Ct(s,e,t){let l;rt(s,ut,E=>t(14,l=E));let{techniques:r}=e,n=new Pe(r,{index:!0,index_key:"d3f:d3fend-id"}),i,v="",p=!1,A=!0,k;k=l.url.searchParams.get("q"),console.log("Found params: "+k);let _=!1,d=[];async function b(){let E=new _t,D=await Promise.all(d);D.forEach(function(Z){Z.def_to_off.results.bindings.forEach(function(W){E.add_technique({techniqueID:ie(W.off_tech.value),comment:`
`+W.def_tech_label.value+`
`,color:"#9ecae1"})})});let B=`"Navigator_Layer-${D.length}-D3FEND-Techniques.json"`;const S=document.createElement("a"),G=new Blob([JSON.stringify(E.json())],{type:"application/json;charset=utf-8"});S.href=URL.createObjectURL(G),S.download=B,S.click()}async function T(E){let D="/api/technique/"+E+".json";const B=await fetch(D);if(B.status==404)return{id:E,def_to_off:[],description:{graph:[]},status:B.status};if(B.ok){const S=await B.json();return{id:E,def_to_off:S.def_to_off,description:new Pe(S.description)}}else throw new Error(v)}async function P(){let E=t(0,i=Array.from(new Set(ht(v,n))));return E&&(E.forEach(function(D){let B;B=T(D),B&&d.push(B)}),l.url.searchParams.set("q",JSON.stringify(E)),history.replaceState(null,"mapping",l.url)),d}let U=P();function V(){t(5,U=P()),t(3,A=!1)}function J(){window.getSelection().removeAllRanges(),t(2,p=!1),t(4,_=!1)}function Y(){t(4,_=!0);let E="mappings";const D=window.getSelection();D.removeAllRanges();let B=document.getElementById(E);const S=document.createRange();S.selectNodeContents(B),D.addRange(S),t(2,p=!0)}function Q(E){E.ctrlKey==!0&&E.keyCode==13&&V()}ot(async()=>{k?(t(1,v=k),console.log("handlingclick"),V()):(console.log("starting blank"),t(1,v=""))});function te(){v=this.value,t(1,v)}return s.$$set=E=>{"techniques"in E&&t(11,r=E.techniques)},[i,v,p,A,_,U,b,V,J,Y,Q,r,te]}class Gt extends tt{constructor(e){super(),lt(this,e,Ct,At,at,{techniques:11},null,[-1,-1])}}export{Gt as default,Ut as load};
