import{S as yt,i as xt,s as Nt,a7 as ct,w as ft,k as T,e as d,t as x,x as ut,m as C,c as _,a as m,h as N,d as i,b as q,y as ht,g as S,I as n,a1 as dt,N as W,a8 as wt,q as _t,o as pt,B as mt,Y as At,R as qt,v as Ft,f as It,j as Z,l as Et,E as kt,X as Tt}from"../../chunks/index-a02da30e.js";import{H as Ct}from"../../chunks/Header-47fd749a.js";import{T as Pt}from"../../chunks/Title-1d23c88f.js";/* empty css                                                       */import{e as St}from"../../chunks/extract-98765c01.js";import{G as vt}from"../../chunks/lib-09c47a26.js";import{p as Vt}from"../../chunks/stores-cf129ad8.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";import"../../chunks/marked.esm-8ab30116.js";function gt(o,t,e){const a=o.slice();return a[19]=t[e],a}function jt(o){let t,e=o[22].message+"",a;return{c(){t=d("p"),a=x(e),this.h()},l(r){t=_(r,"P",{style:!0});var l=m(t);a=N(l,e),l.forEach(i),this.h()},h(){It(t,"color","red")},m(r,l){S(r,t,l),n(t,a)},p(r,l){l&8&&e!==(e=r[22].message+"")&&Z(a,e)},d(r){r&&i(t)}}}function Bt(o){let t;function e(l,s){if(l[18].length>0)return Gt;if(!l[2]&&l[18].length<1)return Ot}let a=e(o),r=a&&a(o);return{c(){r&&r.c(),t=Et()},l(l){r&&r.l(l),t=Et()},m(l,s){r&&r.m(l,s),S(l,t,s)},p(l,s){a===(a=e(l))&&r?r.p(l,s):(r&&r.d(1),r=a&&a(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){r&&r.d(l),l&&i(t)}}}function Ot(o){let t,e;return{c(){t=d("div"),e=x("No D3FEND Artifacts found in text."),this.h()},l(a){t=_(a,"DIV",{class:!0});var r=m(t);e=N(r,"No D3FEND Artifacts found in text."),r.forEach(i),this.h()},h(){q(t,"class","card")},m(a,r){S(a,t,r),n(t,e)},p:kt,d(a){a&&i(t)}}}function Gt(o){let t,e=o[0]&&bt(o);return{c(){t=d("div"),e&&e.c(),this.h()},l(a){t=_(a,"DIV",{class:!0});var r=m(t);e&&e.l(r),r.forEach(i),this.h()},h(){q(t,"class","card")},m(a,r){S(a,t,r),e&&e.m(t,null)},p(a,r){a[0]?e?e.p(a,r):(e=bt(a),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(a){a&&i(t),e&&e.d()}}}function bt(o){let t,e,a,r,l=o[0].length+"",s,u,w,b,v=o[0],p=[];for(let c=0;c<v.length;c+=1)p[c]=Dt(gt(o,v,c));return{c(){t=d("div"),e=d("b"),a=d("i"),r=x("Extracted "),s=x(l),u=x(" unique IDs:"),w=T(),b=d("dl");for(let c=0;c<p.length;c+=1)p[c].c();this.h()},l(c){t=_(c,"DIV",{class:!0});var g=m(t);e=_(g,"B",{});var f=m(e);a=_(f,"I",{});var D=m(a);r=N(D,"Extracted "),s=N(D,l),u=N(D," unique IDs:"),D.forEach(i),f.forEach(i),w=C(g),b=_(g,"DL",{class:!0});var V=m(b);for(let h=0;h<p.length;h+=1)p[h].l(V);V.forEach(i),g.forEach(i),this.h()},h(){q(b,"class","flex flex-wrap svelte-pega28"),q(t,"class","")},m(c,g){S(c,t,g),n(t,e),n(e,a),n(a,r),n(a,s),n(a,u),n(t,w),n(t,b);for(let f=0;f<p.length;f+=1)p[f].m(b,null)},p(c,g){if(g&1&&l!==(l=c[0].length+"")&&Z(s,l),g&1){v=c[0];let f;for(f=0;f<v.length;f+=1){const D=gt(c,v,f);p[f]?p[f].p(D,g):(p[f]=Dt(D),p[f].c(),p[f].m(b,null))}for(;f<p.length;f+=1)p[f].d(1);p.length=v.length}},d(c){c&&i(t),Tt(p,c)}}}function Dt(o){let t,e,a=o[19]+"",r,l;return{c(){t=d("dd"),e=d("a"),r=x(a),this.h()},l(s){t=_(s,"DD",{});var u=m(t);e=_(u,"A",{href:!0});var w=m(e);r=N(w,a),w.forEach(i),u.forEach(i),this.h()},h(){q(e,"href",l="/dao/artifact/"+o[19])},m(s,u){S(s,t,u),n(t,e),n(e,r)},p(s,u){u&1&&a!==(a=s[19]+"")&&Z(r,a),u&1&&l!==(l="/dao/artifact/"+s[19])&&q(e,"href",l)},d(s){s&&i(t)}}}function Kt(o){let t;return{c(){t=x("enter text and click go")},l(e){t=N(e,"enter text and click go")},m(e,a){S(e,t,a)},p:kt,d(e){e&&i(t)}}}function Rt(o){let t,e,a,r,l,s,u,w,b,v,p,c,g,f,D,V,h,I,y,j,R,O,P,X,G,B,J,L,M,U,$,z,H,Y,Q,tt;t=new Pt({props:{title:"D3FEND Artifact Extractor | Tools | "}}),r=new Ct({});let A={ctx:o,current:null,token:null,hasCatch:!0,pending:Kt,then:Bt,catch:jt,value:18,error:22};return ct(H=o[3],A),{c(){ft(t.$$.fragment),e=T(),a=d("section"),ft(r.$$.fragment),l=T(),s=d("div"),u=d("h1"),w=x("D3FEND Artifact Extractor"),b=T(),v=d("p"),p=x("Extracts D3FEND artifacts from blobs of text. You may also want to try the "),c=d("a"),g=x("D3FEND Extractor"),f=x(" or "),D=d("a"),V=x("ATT&CK Extractor."),h=T(),I=d("p"),y=d("i"),j=x("Paste any text containing D3FEND Artifacts:"),R=T(),O=d("div"),P=d("textarea"),X=T(),G=d("div"),B=d("button"),J=x("GO"),L=T(),M=d("br"),U=T(),$=d("br"),z=T(),A.block.c(),this.h()},l(E){ut(t.$$.fragment,E),e=C(E),a=_(E,"SECTION",{class:!0});var k=m(a);ut(r.$$.fragment,k),l=C(k),s=_(k,"DIV",{class:!0});var F=m(s);u=_(F,"H1",{});var et=m(u);w=N(et,"D3FEND Artifact Extractor"),et.forEach(i),b=C(F),v=_(F,"P",{});var K=m(v);p=N(K,"Extracts D3FEND artifacts from blobs of text. You may also want to try the "),c=_(K,"A",{href:!0});var at=m(c);g=N(at,"D3FEND Extractor"),at.forEach(i),f=N(K," or "),D=_(K,"A",{href:!0});var rt=m(D);V=N(rt,"ATT&CK Extractor."),rt.forEach(i),K.forEach(i),h=C(F),I=_(F,"P",{class:!0});var lt=m(I);y=_(lt,"I",{});var st=m(y);j=N(st,"Paste any text containing D3FEND Artifacts:"),st.forEach(i),lt.forEach(i),R=C(F),O=_(F,"DIV",{});var nt=m(O);P=_(nt,"TEXTAREA",{class:!0}),m(P).forEach(i),nt.forEach(i),X=C(F),G=_(F,"DIV",{});var ot=m(G);B=_(ot,"BUTTON",{class:!0});var it=m(B);J=N(it,"GO"),it.forEach(i),ot.forEach(i),L=C(F),M=_(F,"BR",{}),F.forEach(i),U=C(k),$=_(k,"BR",{}),z=C(k),A.block.l(k),k.forEach(i),this.h()},h(){q(c,"href","/tools/d3fend-extractor"),q(D,"href","/tools/attack-extractor"),q(I,"class","text-2"),q(P,"class","svelte-pega28"),q(B,"class","button"),q(s,"class","card"),q(a,"class"," svelte-pega28")},m(E,k){ht(t,E,k),S(E,e,k),S(E,a,k),ht(r,a,null),n(a,l),n(a,s),n(s,u),n(u,w),n(s,b),n(s,v),n(v,p),n(v,c),n(c,g),n(v,f),n(v,D),n(D,V),n(s,h),n(s,I),n(I,y),n(y,j),n(s,R),n(s,O),n(O,P),dt(P,o[1]),n(s,X),n(s,G),n(G,B),n(B,J),n(s,L),n(s,M),n(a,U),n(a,$),n(a,z),A.block.m(a,A.anchor=null),A.mount=()=>a,A.anchor=null,Y=!0,Q||(tt=[W(P,"input",o[7]),W(P,"keypress",o[5]),W(B,"click",o[4])],Q=!0)},p(E,[k]){o=E,k&2&&dt(P,o[1]),A.ctx=o,k&8&&H!==(H=o[3])&&ct(H,A)||wt(A,o,k)},i(E){Y||(_t(t.$$.fragment,E),_t(r.$$.fragment,E),Y=!0)},o(E){pt(t.$$.fragment,E),pt(r.$$.fragment,E),Y=!1},d(E){mt(t,E),E&&i(e),E&&i(a),mt(r),A.block.d(),A.token=null,A=null,Q=!1,At(tt)}}}async function Zt({params:o,fetch:t}){o.technique;const e=await t("/api/dao/artifacts.json"),a=await e.json();return e.status===200?{props:{techniques:a}}:{status:e.status,error:new Error(a.message)}}function Ht(o,t,e){let a;qt(o,Vt,h=>e(11,a=h));let{techniques:r}=t,l=new vt(r,{index:!0,index_key:"d3f:d3fend-id"}),s,u="",w=!0,b;b=a.url.searchParams.get("q"),console.log("Found params: "+b);let v=[];async function p(h){let I="/api/dao/artifact/"+h+".json";const y=await fetch(I);if(y.status==404)return{id:h,def_to_off:[],description:{graph:[]},status:y.status};if(y.ok){const j=await y.json();return{id:h,def_to_off:j.def_to_off,description:new vt(j.description)}}else throw new Error(u)}async function c(){let h=e(0,s=Array.from(new Set(St(u,l))));return h&&(h.forEach(function(I){let y;y=p(I),y&&v.push(y)}),a.url.searchParams.set("q",JSON.stringify(h)),history.replaceState(null,"mapping",a.url)),v}let g=c();function f(){e(3,g=c()),e(2,w=!1)}function D(h){h.ctrlKey==!0&&h.keyCode==13&&f()}Ft(async()=>{b?(e(1,u=b),console.log("handlingclick"),f()):(console.log("starting blank"),e(1,u=""))});function V(){u=this.value,e(1,u)}return o.$$set=h=>{"techniques"in h&&e(6,r=h.techniques)},[s,u,w,g,f,D,r,V]}class te extends yt{constructor(t){super(),xt(this,t,Ht,Rt,Nt,{techniques:6})}}export{te as default,Zt as load};
