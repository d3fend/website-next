import{S as $e,i as je,s as Ge,a7 as de,w as pe,k as K,e as i,t as N,x as ve,m as H,c as u,a as h,h as I,d as o,b as y,y as me,g as B,I as r,a1 as Ae,N as se,a8 as ze,q as ne,o as ce,B as be,Y as Ue,R as Le,v as Me,f as Ee,j as x,E as ee,l as fe,n as Ye,p as Xe,X as ke,V as ye}from"../../chunks/index-a02da30e.js";import{G as qe,e as Je,b as Ne,f as oe,d as Ie}from"../../chunks/lib-c1de3c87.js";import{T as Qe}from"../../chunks/Title-1d23c88f.js";import{H as We}from"../../chunks/Header-826dac44.js";import{A as Ze}from"../../chunks/Alert-0c17ca36.js";import{p as xe}from"../../chunks/stores-cf129ad8.js";import"../../chunks/marked.esm-8ab30116.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";function Ce(c,e,t){const l=c.slice();return l[18]=e[t],l}function Ke(c,e,t){const l=c.slice();return l[22]=e[t],l}function He(c,e,t){const l=c.slice();return l[26]=e[t],l}function et(c){let e,t=c[25].message+"",l;return{c(){e=i("p"),l=N(t),this.h()},l(a){e=u(a,"P",{style:!0});var s=h(e);l=I(s,t),s.forEach(o),this.h()},h(){Ee(e,"color","red")},m(a,s){B(a,e,s),r(e,l)},p(a,s){s&32&&t!==(t=a[25].message+"")&&x(l,t)},i:ee,o:ee,d(a){a&&o(e)}}}function tt(c){let e,t,l,a;const s=[at,lt],n=[];function v(m,g){return m[17].length>0?0:!m[3]&&m[17].length<1?1:-1}return~(e=v(c))&&(t=n[e]=s[e](c)),{c(){t&&t.c(),l=fe()},l(m){t&&t.l(m),l=fe()},m(m,g){~e&&n[e].m(m,g),B(m,l,g),a=!0},p(m,g){let T=e;e=v(m),e===T?~e&&n[e].p(m,g):(t&&(Ye(),ce(n[T],1,1,()=>{n[T]=null}),Xe()),~e?(t=n[e],t?t.p(m,g):(t=n[e]=s[e](m),t.c()),ne(t,1),t.m(l.parentNode,l)):t=null)},i(m){a||(ne(t),a=!0)},o(m){ce(t),a=!1},d(m){~e&&n[e].d(m),m&&o(l)}}}function lt(c){let e,t;return{c(){e=i("div"),t=N("No ATT&CK techniques found in text."),this.h()},l(l){e=u(l,"DIV",{class:!0});var a=h(e);t=I(a,"No ATT&CK techniques found in text."),a.forEach(o),this.h()},h(){y(e,"class","card")},m(l,a){B(l,e,a),r(e,t)},p:ee,i:ee,o:ee,d(l){l&&o(e)}}}function at(c){let e,t,l,a,s,n,v,m,g,T,d,f,b,E,R,Y,U,O,V,w,G,F,C,J,Q,X,W,j,D,P,z,_=c[0]&&Re(c);a=new Ze({props:{$$slots:{default:[rt]},$$scope:{ctx:c}}});function q(p,M){return p[2]?st:ot}let k=q(c),A=k(c),$=c[17],S=[];for(let p=0;p<$.length;p+=1)S[p]=Pe(Ce(c,$,p));return{c(){e=i("div"),_&&_.c(),t=K(),l=i("div"),pe(a.$$.fragment),s=K(),n=i("div"),v=i("div"),m=i("b"),g=i("i"),T=N("Mapping Results:"),d=K(),f=i("div"),b=i("div"),A.c(),E=K(),R=i("button"),Y=N("copy"),U=K(),O=i("table"),V=i("thead"),w=i("th"),G=N("ATT&CK ID"),F=K(),C=i("th"),J=N("ATT&CK Name"),Q=K(),X=i("th"),W=N("Related D3FEND Techniques"),j=K();for(let p=0;p<S.length;p+=1)S[p].c();this.h()},l(p){e=u(p,"DIV",{class:!0});var M=h(e);_&&_.l(M),M.forEach(o),t=H(p),l=u(p,"DIV",{class:!0});var Z=h(l);ve(a.$$.fragment,Z),Z.forEach(o),s=H(p),n=u(p,"DIV",{class:!0});var L=h(n);v=u(L,"DIV",{});var te=h(v);m=u(te,"B",{});var le=h(m);g=u(le,"I",{});var ae=h(g);T=I(ae,"Mapping Results:"),ae.forEach(o),le.forEach(o),te.forEach(o),d=H(L),f=u(L,"DIV",{class:!0});var ie=h(f);b=u(ie,"DIV",{class:!0});var ue=h(b);A.l(ue),E=H(ue),R=u(ue,"BUTTON",{});var ge=h(R);Y=I(ge,"copy"),ge.forEach(o),ue.forEach(o),U=H(ie),O=u(ie,"TABLE",{id:!0,class:!0});var he=h(O);V=u(he,"THEAD",{});var re=h(V);w=u(re,"TH",{class:!0});var Te=h(w);G=I(Te,"ATT&CK ID"),Te.forEach(o),F=H(re),C=u(re,"TH",{});var De=h(C);J=I(De,"ATT&CK Name"),De.forEach(o),Q=H(re),X=u(re,"TH",{});var we=h(X);W=I(we,"Related D3FEND Techniques"),we.forEach(o),re.forEach(o),j=H(he);for(let _e=0;_e<S.length;_e+=1)S[_e].l(he);he.forEach(o),ie.forEach(o),L.forEach(o),this.h()},h(){y(e,"class","card"),y(l,"class","card"),y(b,"class","text-right"),y(w,"class","stretch"),y(O,"id","mappings"),y(O,"class","table-auto"),y(f,"class","results-wrap center svelte-1wbelz3"),y(n,"class","card")},m(p,M){B(p,e,M),_&&_.m(e,null),B(p,t,M),B(p,l,M),me(a,l,null),B(p,s,M),B(p,n,M),r(n,v),r(v,m),r(m,g),r(g,T),r(n,d),r(n,f),r(f,b),A.m(b,null),r(b,E),r(b,R),r(R,Y),r(f,U),r(f,O),r(O,V),r(V,w),r(w,G),r(V,F),r(V,C),r(C,J),r(V,Q),r(V,X),r(X,W),r(O,j);for(let Z=0;Z<S.length;Z+=1)S[Z].m(O,null);D=!0,P||(z=se(R,"click",_t),P=!0)},p(p,M){p[0]?_?_.p(p,M):(_=Re(p),_.c(),_.m(e,null)):_&&(_.d(1),_=null);const Z={};if(M&536870912&&(Z.$$scope={dirty:M,ctx:p}),a.$set(Z),k===(k=q(p))&&A?A.p(p,M):(A.d(1),A=k(p),A&&(A.c(),A.m(b,E))),M&48){$=p[17];let L;for(L=0;L<$.length;L+=1){const te=Ce(p,$,L);S[L]?S[L].p(te,M):(S[L]=Pe(te),S[L].c(),S[L].m(O,null))}for(;L<S.length;L+=1)S[L].d(1);S.length=$.length}},i(p){D||(ne(a.$$.fragment,p),D=!0)},o(p){ce(a.$$.fragment,p),D=!1},d(p){p&&o(e),_&&_.d(),p&&o(t),p&&o(l),be(a),p&&o(s),p&&o(n),A.d(),ke(S,p),P=!1,z()}}}function Re(c){let e,t,l,a,s=c[0].length+"",n,v,m,g,T=c[0],d=[];for(let f=0;f<T.length;f+=1)d[f]=Be(He(c,T,f));return{c(){e=i("div"),t=i("b"),l=i("i"),a=N("Extracted "),n=N(s),v=N(" unique IDs:"),m=K(),g=i("dl");for(let f=0;f<d.length;f+=1)d[f].c();this.h()},l(f){e=u(f,"DIV",{class:!0});var b=h(e);t=u(b,"B",{});var E=h(t);l=u(E,"I",{});var R=h(l);a=I(R,"Extracted "),n=I(R,s),v=I(R," unique IDs:"),R.forEach(o),E.forEach(o),m=H(b),g=u(b,"DL",{class:!0});var Y=h(g);for(let U=0;U<d.length;U+=1)d[U].l(Y);Y.forEach(o),b.forEach(o),this.h()},h(){y(g,"class","flex flex-wrap svelte-1wbelz3"),y(e,"class","")},m(f,b){B(f,e,b),r(e,t),r(t,l),r(l,a),r(l,n),r(l,v),r(e,m),r(e,g);for(let E=0;E<d.length;E+=1)d[E].m(g,null)},p(f,b){if(b&1&&s!==(s=f[0].length+"")&&x(n,s),b&1){T=f[0];let E;for(E=0;E<T.length;E+=1){const R=He(f,T,E);d[E]?d[E].p(R,b):(d[E]=Be(R),d[E].c(),d[E].m(g,null))}for(;E<d.length;E+=1)d[E].d(1);d.length=T.length}},d(f){f&&o(e),ke(d,f)}}}function Be(c){let e,t=c[26]+"",l;return{c(){e=i("dd"),l=N(t)},l(a){e=u(a,"DD",{});var s=h(e);l=I(s,t),s.forEach(o)},m(a,s){B(a,e,s),r(e,l)},p(a,s){s&1&&t!==(t=a[26]+"")&&x(l,t)},d(a){a&&o(e)}}}function rt(c){let e;return{c(){e=N("These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},l(t){e=I(t,"These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},m(t,l){B(t,e,l)},d(t){t&&o(e)}}}function ot(c){let e,t,l,a;return{c(){e=i("button"),t=N("select"),this.h()},l(s){e=u(s,"BUTTON",{class:!0});var n=h(e);t=I(n,"select"),n.forEach(o),this.h()},h(){y(e,"class","selector svelte-1wbelz3")},m(s,n){B(s,e,n),r(e,t),l||(a=se(e,"click",c[8]),l=!0)},p:ee,d(s){s&&o(e),l=!1,a()}}}function st(c){let e,t,l,a;return{c(){e=i("button"),t=N("deselect"),this.h()},l(s){e=u(s,"BUTTON",{class:!0});var n=h(e);t=I(n,"deselect"),n.forEach(o),this.h()},h(){y(e,"class","selector svelte-1wbelz3")},m(s,n){B(s,e,n),r(e,t),l||(a=se(e,"click",c[7]),l=!0)},p:ee,d(s){s&&o(e),l=!1,a()}}}function nt(c){let e,t=c[25].message+"",l;return{c(){e=i("p"),l=N(t),this.h()},l(a){e=u(a,"P",{style:!0});var s=h(e);l=I(s,t),s.forEach(o),this.h()},h(){Ee(e,"color","red")},m(a,s){B(a,e,s),r(e,l)},p(a,s){s&32&&t!==(t=a[25].message+"")&&x(l,t)},d(a){a&&o(e)}}}function ct(c){let e;function t(s,n){return s[21].description.graph[0]?it:ft}let l=t(c),a=l(c);return{c(){a.c(),e=fe()},l(s){a.l(s),e=fe()},m(s,n){a.m(s,n),B(s,e,n)},p(s,n){l===(l=t(s))&&a?a.p(s,n):(a.d(1),a=l(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){a.d(s),s&&o(e)}}}function ft(c){let e,t,l=c[21].id+"",a,s,n,v,m,g,T;return{c(){e=i("td"),t=i("a"),a=N(l),n=K(),v=i("td"),m=N("not found in D3FEND graph"),g=K(),T=i("td"),this.h()},l(d){e=u(d,"TD",{class:!0});var f=h(e);t=u(f,"A",{style:!0,href:!0});var b=h(t);a=I(b,l),b.forEach(o),f.forEach(o),n=H(d),v=u(d,"TD",{});var E=h(v);m=I(E,"not found in D3FEND graph"),E.forEach(o),g=H(d),T=u(d,"TD",{}),h(T).forEach(o),this.h()},h(){Ee(t,"color","red"),y(t,"href",s=Ne(c[21].id)),y(e,"class","text-center")},m(d,f){B(d,e,f),r(e,t),r(t,a),B(d,n,f),B(d,v,f),r(v,m),B(d,g,f),B(d,T,f)},p(d,f){f&32&&l!==(l=d[21].id+"")&&x(a,l),f&32&&s!==(s=Ne(d[21].id))&&y(t,"href",s)},d(d){d&&o(e),d&&o(n),d&&o(v),d&&o(g),d&&o(T)}}}function it(c){let e,t,l=c[21].description.graph[0]["d3f:attack-id"]+"",a,s,n,v,m=c[21].description.graph[0]["rdfs:label"]+"",g,T,d,f,b,E,R,Y,U,O,V,w,G,F,C,J,Q,X,W,j,D=Se(c[21].off_to_def.results.bindings),P=[];for(let _=0;_<D.length;_+=1)P[_]=Oe(Ke(c,D,_));let z=null;return D.length||(z=Ve()),{c(){e=i("th"),t=i("a"),a=N(l),n=K(),v=i("td"),g=N(m),T=K(),d=i("td"),f=i("table"),b=i("thead"),E=i("th"),R=N("off rel"),Y=K(),U=i("th"),O=N("off artifact"),V=K(),w=i("th"),G=N("D3FEND Technique"),F=K(),C=i("th"),J=N("def rel"),Q=K(),X=i("th"),W=N("def artifact"),j=K();for(let _=0;_<P.length;_+=1)P[_].c();z&&z.c(),this.h()},l(_){e=u(_,"TH",{class:!0,scope:!0});var q=h(e);t=u(q,"A",{href:!0});var k=h(t);a=I(k,l),k.forEach(o),q.forEach(o),n=H(_),v=u(_,"TD",{});var A=h(v);g=I(A,m),A.forEach(o),T=H(_),d=u(_,"TD",{});var $=h(d);f=u($,"TABLE",{class:!0});var S=h(f);b=u(S,"THEAD",{class:!0});var p=h(b);E=u(p,"TH",{scope:!0});var M=h(E);R=I(M,"off rel"),M.forEach(o),Y=H(p),U=u(p,"TH",{scope:!0});var Z=h(U);O=I(Z,"off artifact"),Z.forEach(o),V=H(p),w=u(p,"TH",{scope:!0});var L=h(w);G=I(L,"D3FEND Technique"),L.forEach(o),F=H(p),C=u(p,"TH",{scope:!0});var te=h(C);J=I(te,"def rel"),te.forEach(o),Q=H(p),X=u(p,"TH",{scope:!0});var le=h(X);W=I(le,"def artifact"),le.forEach(o),p.forEach(o),j=H(S);for(let ae=0;ae<P.length;ae+=1)P[ae].l(S);z&&z.l(S),S.forEach(o),$.forEach(o),this.h()},h(){y(t,"href",s=Ie(c[21].id)),y(e,"class","text-center"),y(e,"scope","row"),y(E,"scope","col"),y(U,"scope","col"),y(w,"scope","col"),y(C,"scope","col"),y(X,"scope","col"),y(b,"class","svelte-1wbelz3"),ye(b,"hide",c[4]),y(f,"class","table-auto w100 svelte-1wbelz3")},m(_,q){B(_,e,q),r(e,t),r(t,a),B(_,n,q),B(_,v,q),r(v,g),B(_,T,q),B(_,d,q),r(d,f),r(f,b),r(b,E),r(E,R),r(b,Y),r(b,U),r(U,O),r(b,V),r(b,w),r(w,G),r(b,F),r(b,C),r(C,J),r(b,Q),r(b,X),r(X,W),r(f,j);for(let k=0;k<P.length;k+=1)P[k].m(f,null);z&&z.m(f,null)},p(_,q){if(q&32&&l!==(l=_[21].description.graph[0]["d3f:attack-id"]+"")&&x(a,l),q&32&&s!==(s=Ie(_[21].id))&&y(t,"href",s),q&32&&m!==(m=_[21].description.graph[0]["rdfs:label"]+"")&&x(g,m),q&16&&ye(b,"hide",_[4]),q&32){D=Se(_[21].off_to_def.results.bindings);let k;for(k=0;k<D.length;k+=1){const A=Ke(_,D,k);P[k]?P[k].p(A,q):(P[k]=Oe(A),P[k].c(),P[k].m(f,null))}for(;k<P.length;k+=1)P[k].d(1);P.length=D.length,!D.length&&z?z.p(_,q):D.length?z&&(z.d(1),z=null):(z=Ve(),z.c(),z.m(f,null))}},d(_){_&&o(e),_&&o(n),_&&o(v),_&&o(T),_&&o(d),ke(P,_),z&&z.d()}}}function Ve(c){let e,t,l,a,s;return{c(){e=i("td"),t=N("no defensive relations "),l=i("a"),a=N("yet"),s=K(),this.h()},l(n){e=u(n,"TD",{colspan:!0});var v=h(e);t=I(v,"no defensive relations "),l=u(v,"A",{href:!0});var m=h(l);a=I(m,"yet"),m.forEach(o),s=H(v),v.forEach(o),this.h()},h(){y(l,"href","/contribute"),y(e,"colspan","5")},m(n,v){B(n,e,v),r(e,t),r(e,l),r(l,a),r(e,s)},p:ee,d(n){n&&o(e)}}}function Fe(c){let e,t,l=c[22].off_artifact_rel_label.value+"",a,s,n,v,m=c[22].off_artifact_label.value+"",g,T,d,f,b,E=c[22].def_tech_label.value+"",R,Y,U,O,V=c[22].def_artifact_rel_label.value+"",w,G,F,C,J=c[22].def_artifact_label.value+"",Q,X,W;return{c(){e=i("tr"),t=i("td"),a=N(l),s=K(),n=i("td"),v=i("a"),g=N(m),d=K(),f=i("td"),b=i("a"),R=N(E),U=K(),O=i("td"),w=N(V),G=K(),F=i("td"),C=i("a"),Q=N(J),W=K(),this.h()},l(j){e=u(j,"TR",{});var D=h(e);t=u(D,"TD",{});var P=h(t);a=I(P,l),P.forEach(o),s=H(D),n=u(D,"TD",{});var z=h(n);v=u(z,"A",{href:!0});var _=h(v);g=I(_,m),_.forEach(o),z.forEach(o),d=H(D),f=u(D,"TD",{});var q=h(f);b=u(q,"A",{href:!0});var k=h(b);R=I(k,E),k.forEach(o),q.forEach(o),U=H(D),O=u(D,"TD",{});var A=h(O);w=I(A,V),A.forEach(o),G=H(D),F=u(D,"TD",{});var $=h(F);C=u($,"A",{href:!0});var S=h(C);Q=I(S,J),S.forEach(o),$.forEach(o),W=H(D),D.forEach(o),this.h()},h(){y(v,"href",T="/dao/artifact/"+oe(c[22].off_artifact.value)),y(b,"href",Y="/technique/"+oe(c[22].def_tech.value)),y(C,"href",X="/dao/artifact/"+oe(c[22].def_artifact.value))},m(j,D){B(j,e,D),r(e,t),r(t,a),r(e,s),r(e,n),r(n,v),r(v,g),r(e,d),r(e,f),r(f,b),r(b,R),r(e,U),r(e,O),r(O,w),r(e,G),r(e,F),r(F,C),r(C,Q),r(e,W)},p(j,D){D&32&&l!==(l=j[22].off_artifact_rel_label.value+"")&&x(a,l),D&32&&m!==(m=j[22].off_artifact_label.value+"")&&x(g,m),D&32&&T!==(T="/dao/artifact/"+oe(j[22].off_artifact.value))&&y(v,"href",T),D&32&&E!==(E=j[22].def_tech_label.value+"")&&x(R,E),D&32&&Y!==(Y="/technique/"+oe(j[22].def_tech.value))&&y(b,"href",Y),D&32&&V!==(V=j[22].def_artifact_rel_label.value+"")&&x(w,V),D&32&&J!==(J=j[22].def_artifact_label.value+"")&&x(Q,J),D&32&&X!==(X="/dao/artifact/"+oe(j[22].def_artifact.value))&&y(C,"href",X)},d(j){j&&o(e)}}}function Oe(c){let e,t=c[22].def_tech&&Fe(c);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,a){t&&t.m(l,a),B(l,e,a)},p(l,a){l[22].def_tech?t?t.p(l,a):(t=Fe(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&o(e)}}}function ut(c){let e;return{c(){e=N("loading...")},l(t){e=I(t,"loading...")},m(t,l){B(t,e,l)},p:ee,d(t){t&&o(e)}}}function Pe(c){let e,t,l,a={ctx:c,current:null,token:null,hasCatch:!0,pending:ut,then:ct,catch:nt,value:21,error:25};return de(t=c[18],a),{c(){e=i("tr"),a.block.c(),l=K()},l(s){e=u(s,"TR",{});var n=h(e);a.block.l(n),l=H(n),n.forEach(o)},m(s,n){B(s,e,n),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,r(e,l)},p(s,n){c=s,a.ctx=c,n&32&&t!==(t=c[18])&&de(t,a)||ze(a,c,n)},d(s){s&&o(e),a.block.d(),a.token=null,a=null}}}function ht(c){let e;return{c(){e=N("enter text and click go")},l(t){e=I(t,"enter text and click go")},m(t,l){B(t,e,l)},p:ee,i:ee,o:ee,d(t){t&&o(e)}}}function dt(c){let e,t,l,a,s,n,v,m,g,T,d,f,b,E,R,Y,U,O,V,w,G,F,C,J,Q,X,W,j,D,P,z,_;e=new Qe({props:{title:"ATT&CK Extractor | Tools | "}}),a=new We({});let q={ctx:c,current:null,token:null,hasCatch:!0,pending:ht,then:tt,catch:et,value:17,error:25,blocks:[,,,]};return de(D=c[5],q),{c(){pe(e.$$.fragment),t=K(),l=i("section"),pe(a.$$.fragment),s=K(),n=i("div"),v=i("h1"),m=N("ATT&CK Extractor"),g=K(),T=i("p"),d=N("Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),f=i("a"),b=N("D3FEND Extractor."),E=K(),R=i("p"),Y=N("Paste any text containing ATT&CK IDs:"),U=K(),O=i("div"),V=i("textarea"),w=K(),G=i("div"),F=i("button"),C=N("GO"),J=K(),Q=i("br"),X=K(),W=i("br"),j=K(),q.block.c(),this.h()},l(k){ve(e.$$.fragment,k),t=H(k),l=u(k,"SECTION",{class:!0});var A=h(l);ve(a.$$.fragment,A),s=H(A),n=u(A,"DIV",{class:!0});var $=h(n);v=u($,"H1",{});var S=h(v);m=I(S,"ATT&CK Extractor"),S.forEach(o),g=H($),T=u($,"P",{});var p=h(T);d=I(p,"Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),f=u(p,"A",{href:!0});var M=h(f);b=I(M,"D3FEND Extractor."),M.forEach(o),p.forEach(o),E=H($),R=u($,"P",{});var Z=h(R);Y=I(Z,"Paste any text containing ATT&CK IDs:"),Z.forEach(o),U=H($),O=u($,"DIV",{});var L=h(O);V=u(L,"TEXTAREA",{class:!0}),h(V).forEach(o),L.forEach(o),w=H($),G=u($,"DIV",{});var te=h(G);F=u(te,"BUTTON",{class:!0});var le=h(F);C=I(le,"GO"),le.forEach(o),te.forEach(o),J=H($),Q=u($,"BR",{}),$.forEach(o),X=H(A),W=u(A,"BR",{}),j=H(A),q.block.l(A),A.forEach(o),this.h()},h(){y(f,"href","/tools/d3fend-extractor"),y(V,"class","svelte-1wbelz3"),y(F,"class","button"),y(n,"class","card"),y(l,"class"," svelte-1wbelz3")},m(k,A){me(e,k,A),B(k,t,A),B(k,l,A),me(a,l,null),r(l,s),r(l,n),r(n,v),r(v,m),r(n,g),r(n,T),r(T,d),r(T,f),r(f,b),r(n,E),r(n,R),r(R,Y),r(n,U),r(n,O),r(O,V),Ae(V,c[1]),r(n,w),r(n,G),r(G,F),r(F,C),r(n,J),r(n,Q),r(l,X),r(l,W),r(l,j),q.block.m(l,q.anchor=null),q.mount=()=>l,q.anchor=null,P=!0,z||(_=[se(V,"input",c[11]),se(V,"keypress",c[9]),se(F,"click",c[6])],z=!0)},p(k,[A]){c=k,A&2&&Ae(V,c[1]),q.ctx=c,A&32&&D!==(D=c[5])&&de(D,q)||ze(q,c,A)},i(k){P||(ne(e.$$.fragment,k),ne(a.$$.fragment,k),ne(q.block),P=!0)},o(k){ce(e.$$.fragment,k),ce(a.$$.fragment,k);for(let A=0;A<3;A+=1){const $=q.blocks[A];ce($)}P=!1},d(k){be(e,k),k&&o(t),k&&o(l),be(a),q.block.d(),q.token=null,q=null,z=!1,Ue(_)}}}async function At({params:c,fetch:e}){c.technique;const t=await e("/api/offensive-technique/all.json"),l=await t.json();return t.status===200?{props:{techniques:l}}:{status:t.status,error:new Error(l.message)}}function _t(){document.execCommand("copy")}function Se(c){let e=new Set,t=[];return c.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function pt(c,e,t){let l;Le(c,xe,w=>t(13,l=w));let{techniques:a}=e,s=new qe(a,{index:!0,index_key:"d3f:attack-id"}),n,v="",m=!1,g=!0,T;T=l.url.searchParams.get("q"),console.log("Found params: "+T);let d=!1;async function f(w){let G="/api/offensive-technique/attack/"+w+".json";const F=await fetch(G);if(F.status==404)return{id:w,off_to_def:[],description:{graph:[]},status:F.status};if(F.ok){const C=await F.json();return{id:w,off_to_def:C.off_to_def,description:new qe(C.description)}}else throw new Error(v)}async function b(){let w=t(0,n=Array.from(new Set(Je(v,s)))),G=[];return w&&(w.forEach(function(F){let C;C=f(F),C&&G.push(C)}),l.url.searchParams.set("q",JSON.stringify(w)),history.replaceState(null,"mapping",l.url)),G}let E=b();function R(){t(5,E=b()),t(3,g=!1)}function Y(){window.getSelection().removeAllRanges(),t(2,m=!1),t(4,d=!1)}function U(){t(4,d=!0);let w="mappings";const G=window.getSelection();G.removeAllRanges();let F=document.getElementById(w);const C=document.createRange();C.selectNodeContents(F),G.addRange(C),t(2,m=!0)}function O(w){w.ctrlKey==!0&&w.keyCode==13&&R()}Me(async()=>{T?(t(1,v=T),console.log("handlingclick"),R()):(console.log("starting blank"),t(1,v=""))});function V(){v=this.value,t(1,v)}return c.$$set=w=>{"techniques"in w&&t(10,a=w.techniques)},[n,v,m,g,d,E,R,Y,U,O,a,V]}class yt extends $e{constructor(e){super(),je(this,e,pt,dt,Ge,{techniques:10})}}export{yt as default,At as load};
