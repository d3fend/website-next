import{S as yt,i as wt,s as xt,a7 as ct,w as ft,k as T,e as d,t as w,x as ut,m as C,c as _,a as m,h as x,d as i,b as q,y as ht,g as S,I as n,a1 as dt,N as W,a8 as Nt,q as _t,o as pt,B as mt,Y as At,R as qt,v as Ft,f as It,j as Z,l as Et,E as kt,X as Tt}from"../../chunks/index-a02da30e.js";import{H as Ct}from"../../chunks/Header-826dac44.js";import{T as Pt}from"../../chunks/Title-1d23c88f.js";/* empty css                                                       */import{e as St}from"../../chunks/extract-71b4e4e9.js";import{G as vt}from"../../chunks/lib-c0e834da.js";import{p as Vt}from"../../chunks/stores-cf129ad8.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";import"../../chunks/marked.esm-8ab30116.js";function bt(o,t,e){const a=o.slice();return a[19]=t[e],a}function jt(o){let t,e=o[22].message+"",a;return{c(){t=d("p"),a=w(e),this.h()},l(r){t=_(r,"P",{style:!0});var l=m(t);a=x(l,e),l.forEach(i),this.h()},h(){It(t,"color","red")},m(r,l){S(r,t,l),n(t,a)},p(r,l){l&8&&e!==(e=r[22].message+"")&&Z(a,e)},d(r){r&&i(t)}}}function Bt(o){let t;function e(l,s){if(l[18].length>0)return Gt;if(!l[2]&&l[18].length<1)return Ot}let a=e(o),r=a&&a(o);return{c(){r&&r.c(),t=Et()},l(l){r&&r.l(l),t=Et()},m(l,s){r&&r.m(l,s),S(l,t,s)},p(l,s){a===(a=e(l))&&r?r.p(l,s):(r&&r.d(1),r=a&&a(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){r&&r.d(l),l&&i(t)}}}function Ot(o){let t,e;return{c(){t=d("div"),e=w("No D3FEND Artifacts found in text."),this.h()},l(a){t=_(a,"DIV",{class:!0});var r=m(t);e=x(r,"No D3FEND Artifacts found in text."),r.forEach(i),this.h()},h(){q(t,"class","card")},m(a,r){S(a,t,r),n(t,e)},p:kt,d(a){a&&i(t)}}}function Gt(o){let t,e=o[0]&&gt(o);return{c(){t=d("div"),e&&e.c(),this.h()},l(a){t=_(a,"DIV",{class:!0});var r=m(t);e&&e.l(r),r.forEach(i),this.h()},h(){q(t,"class","card")},m(a,r){S(a,t,r),e&&e.m(t,null)},p(a,r){a[0]?e?e.p(a,r):(e=gt(a),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(a){a&&i(t),e&&e.d()}}}function gt(o){let t,e,a,r,l=o[0].length+"",s,u,N,g,v=o[0],p=[];for(let c=0;c<v.length;c+=1)p[c]=Dt(bt(o,v,c));return{c(){t=d("div"),e=d("b"),a=d("i"),r=w("Extracted "),s=w(l),u=w(" unique IDs:"),N=T(),g=d("dl");for(let c=0;c<p.length;c+=1)p[c].c();this.h()},l(c){t=_(c,"DIV",{class:!0});var b=m(t);e=_(b,"B",{});var f=m(e);a=_(f,"I",{});var D=m(a);r=x(D,"Extracted "),s=x(D,l),u=x(D," unique IDs:"),D.forEach(i),f.forEach(i),N=C(b),g=_(b,"DL",{class:!0});var V=m(g);for(let h=0;h<p.length;h+=1)p[h].l(V);V.forEach(i),b.forEach(i),this.h()},h(){q(g,"class","flex flex-wrap svelte-1wbelz3"),q(t,"class","")},m(c,b){S(c,t,b),n(t,e),n(e,a),n(a,r),n(a,s),n(a,u),n(t,N),n(t,g);for(let f=0;f<p.length;f+=1)p[f].m(g,null)},p(c,b){if(b&1&&l!==(l=c[0].length+"")&&Z(s,l),b&1){v=c[0];let f;for(f=0;f<v.length;f+=1){const D=bt(c,v,f);p[f]?p[f].p(D,b):(p[f]=Dt(D),p[f].c(),p[f].m(g,null))}for(;f<p.length;f+=1)p[f].d(1);p.length=v.length}},d(c){c&&i(t),Tt(p,c)}}}function Dt(o){let t,e,a=o[19]+"",r,l;return{c(){t=d("dd"),e=d("a"),r=w(a),this.h()},l(s){t=_(s,"DD",{});var u=m(t);e=_(u,"A",{href:!0});var N=m(e);r=x(N,a),N.forEach(i),u.forEach(i),this.h()},h(){q(e,"href",l="/dao/artifact/"+o[19])},m(s,u){S(s,t,u),n(t,e),n(e,r)},p(s,u){u&1&&a!==(a=s[19]+"")&&Z(r,a),u&1&&l!==(l="/dao/artifact/"+s[19])&&q(e,"href",l)},d(s){s&&i(t)}}}function Kt(o){let t;return{c(){t=w("enter text and click go")},l(e){t=x(e,"enter text and click go")},m(e,a){S(e,t,a)},p:kt,d(e){e&&i(t)}}}function Rt(o){let t,e,a,r,l,s,u,N,g,v,p,c,b,f,D,V,h,I,y,j,R,O,P,Y,G,B,X,J,L,M,U,$,z,H,Q,tt;t=new Pt({props:{title:"D3FEND Artifact Extractor | Tools | "}}),r=new Ct({});let A={ctx:o,current:null,token:null,hasCatch:!0,pending:Kt,then:Bt,catch:jt,value:18,error:22};return ct(z=o[3],A),{c(){ft(t.$$.fragment),e=T(),a=d("section"),ft(r.$$.fragment),l=T(),s=d("div"),u=d("h1"),N=w("D3FEND Artifact Extractor"),g=T(),v=d("p"),p=w("Extracts D3FEND artifacts from blobs of text. You may also want to try the "),c=d("a"),b=w("D3FEND Extractor"),f=w(" or "),D=d("a"),V=w("ATT&CK Extractor."),h=T(),I=d("p"),y=d("i"),j=w("Paste any text containing D3FEND Artifacts:"),R=T(),O=d("div"),P=d("textarea"),Y=T(),G=d("div"),B=d("button"),X=w("GO"),J=T(),L=d("br"),M=T(),U=d("br"),$=T(),A.block.c(),this.h()},l(E){ut(t.$$.fragment,E),e=C(E),a=_(E,"SECTION",{class:!0});var k=m(a);ut(r.$$.fragment,k),l=C(k),s=_(k,"DIV",{class:!0});var F=m(s);u=_(F,"H1",{});var et=m(u);N=x(et,"D3FEND Artifact Extractor"),et.forEach(i),g=C(F),v=_(F,"P",{});var K=m(v);p=x(K,"Extracts D3FEND artifacts from blobs of text. You may also want to try the "),c=_(K,"A",{href:!0});var at=m(c);b=x(at,"D3FEND Extractor"),at.forEach(i),f=x(K," or "),D=_(K,"A",{href:!0});var rt=m(D);V=x(rt,"ATT&CK Extractor."),rt.forEach(i),K.forEach(i),h=C(F),I=_(F,"P",{class:!0});var lt=m(I);y=_(lt,"I",{});var st=m(y);j=x(st,"Paste any text containing D3FEND Artifacts:"),st.forEach(i),lt.forEach(i),R=C(F),O=_(F,"DIV",{});var nt=m(O);P=_(nt,"TEXTAREA",{class:!0}),m(P).forEach(i),nt.forEach(i),Y=C(F),G=_(F,"DIV",{});var ot=m(G);B=_(ot,"BUTTON",{class:!0});var it=m(B);X=x(it,"GO"),it.forEach(i),ot.forEach(i),J=C(F),L=_(F,"BR",{}),F.forEach(i),M=C(k),U=_(k,"BR",{}),$=C(k),A.block.l(k),k.forEach(i),this.h()},h(){q(c,"href","/tools/d3fend-extractor"),q(D,"href","/tools/attack-extractor"),q(I,"class","text-2"),q(P,"class","svelte-1wbelz3"),q(B,"class","button"),q(s,"class","card"),q(a,"class"," svelte-1wbelz3")},m(E,k){ht(t,E,k),S(E,e,k),S(E,a,k),ht(r,a,null),n(a,l),n(a,s),n(s,u),n(u,N),n(s,g),n(s,v),n(v,p),n(v,c),n(c,b),n(v,f),n(v,D),n(D,V),n(s,h),n(s,I),n(I,y),n(y,j),n(s,R),n(s,O),n(O,P),dt(P,o[1]),n(s,Y),n(s,G),n(G,B),n(B,X),n(s,J),n(s,L),n(a,M),n(a,U),n(a,$),A.block.m(a,A.anchor=null),A.mount=()=>a,A.anchor=null,H=!0,Q||(tt=[W(P,"input",o[7]),W(P,"keypress",o[5]),W(B,"click",o[4])],Q=!0)},p(E,[k]){o=E,k&2&&dt(P,o[1]),A.ctx=o,k&8&&z!==(z=o[3])&&ct(z,A)||Nt(A,o,k)},i(E){H||(_t(t.$$.fragment,E),_t(r.$$.fragment,E),H=!0)},o(E){pt(t.$$.fragment,E),pt(r.$$.fragment,E),H=!1},d(E){mt(t,E),E&&i(e),E&&i(a),mt(r),A.block.d(),A.token=null,A=null,Q=!1,At(tt)}}}async function Zt({params:o,fetch:t}){o.technique;const e=await t("/api/dao/artifacts.json"),a=await e.json();return e.status===200?{props:{techniques:a}}:{status:e.status,error:new Error(a.message)}}function zt(o,t,e){let a;qt(o,Vt,h=>e(11,a=h));let{techniques:r}=t,l=new vt(r,{index:!0,index_key:"d3f:d3fend-id"}),s,u="",N=!0,g;g=a.url.searchParams.get("q"),console.log("Found params: "+g);let v=[];async function p(h){let I="/api/dao/artifact/"+h+".json";const y=await fetch(I);if(y.status==404)return{id:h,def_to_off:[],description:{graph:[]},status:y.status};if(y.ok){const j=await y.json();return{id:h,def_to_off:j.def_to_off,description:new vt(j.description)}}else throw new Error(u)}async function c(){let h=e(0,s=Array.from(new Set(St(u,l))));return h&&(h.forEach(function(I){let y;y=p(I),y&&v.push(y)}),a.url.searchParams.set("q",JSON.stringify(h)),history.replaceState(null,"mapping",a.url)),v}let b=c();function f(){e(3,b=c()),e(2,N=!1)}function D(h){h.ctrlKey==!0&&h.keyCode==13&&f()}Ft(async()=>{g?(e(1,u=g),console.log("handlingclick"),f()):(console.log("starting blank"),e(1,u=""))});function V(){u=this.value,e(1,u)}return o.$$set=h=>{"techniques"in h&&e(6,r=h.techniques)},[s,u,N,b,f,D,r,V]}class te extends yt{constructor(t){super(),wt(this,t,zt,Rt,xt,{techniques:6})}}export{te as default,Zt as load};
