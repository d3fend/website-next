var K=typeof global=="object"&&global&&global.Object===Object&&global,Q=K,X=typeof self=="object"&&self&&self.Object===Object&&self,ee=Q||X||Function("return this")(),re=ee,ue=re.Symbol,d=ue,T=Object.prototype,ne=T.hasOwnProperty,te=T.toString,b=d?d.toStringTag:void 0;function ae(e){var r=ne.call(e,b),u=e[b];try{e[b]=void 0;var n=!0}catch{}var t=te.call(e);return n&&(r?e[b]=u:delete e[b]),t}var oe=Object.prototype,fe=oe.toString;function se(e){return fe.call(e)}var ce="[object Null]",ie="[object Undefined]",v=d?d.toStringTag:void 0;function de(e){return e==null?e===void 0?ie:ce:v&&v in Object(e)?ae(e):se(e)}function le(e){return e!=null&&typeof e=="object"}var be="[object Symbol]";function ge(e){return typeof e=="symbol"||le(e)&&de(e)==be}function xe(e,r){for(var u=-1,n=e==null?0:e.length,t=Array(n);++u<n;)t[u]=r(e[u],u,e);return t}var me=Array.isArray,he=me,pe=1/0,$=d?d.prototype:void 0,A=$?$.toString:void 0;function E(e){if(typeof e=="string")return e;if(he(e))return xe(e,E)+"";if(ge(e))return A?A.call(e):"";var r=e+"";return r=="0"&&1/e==-pe?"-0":r}function y(e){return e==null?"":E(e)}function ye(e,r,u){var n=-1,t=e.length;r<0&&(r=-r>t?0:t+r),u=u>t?t:u,u<0&&(u+=t),t=r>u?0:u-r>>>0,r>>>=0;for(var a=Array(t);++n<t;)a[n]=e[n+r];return a}function Re(e,r,u){var n=e.length;return u=u===void 0?n:u,!r&&u>=n?e:ye(e,r,u)}var _e="\\ud800-\\udfff",ve="\\u0300-\\u036f",$e="\\ufe20-\\ufe2f",Ae="\\u20d0-\\u20ff",Se=ve+$e+Ae,Oe="\\ufe0e\\ufe0f",je="\\u200d",Ce=RegExp("["+je+_e+Se+Oe+"]");function U(e){return Ce.test(e)}function Te(e){return e.split("")}var w="\\ud800-\\udfff",Ee="\\u0300-\\u036f",Ue="\\ufe20-\\ufe2f",we="\\u20d0-\\u20ff",Me=Ee+Ue+we,ke="\\ufe0e\\ufe0f",Le="["+w+"]",h="["+Me+"]",p="\\ud83c[\\udffb-\\udfff]",ze="(?:"+h+"|"+p+")",M="[^"+w+"]",k="(?:\\ud83c[\\udde6-\\uddff]){2}",L="[\\ud800-\\udbff][\\udc00-\\udfff]",Ie="\\u200d",z=ze+"?",I="["+ke+"]?",Ne="(?:"+Ie+"(?:"+[M,k,L].join("|")+")"+I+z+")*",Ze=I+z+Ne,De="(?:"+[M+h+"?",h,k,L,Le].join("|")+")",Pe=RegExp(p+"(?="+p+")|"+De+Ze,"g");function We(e){return e.match(Pe)||[]}function Ge(e){return U(e)?We(e):Te(e)}function He(e){return function(r){r=y(r);var u=U(r)?Ge(r):void 0,n=u?u[0]:r.charAt(0),t=u?Re(u,1).join(""):r.slice(1);return n[e]()+t}}var Fe=He("toUpperCase"),Je=Fe;function Ve(e,r,u,n){var t=-1,a=e==null?0:e.length;for(n&&a&&(u=e[++t]);++t<a;)u=r(u,e[t],t,e);return u}function Ye(e){return function(r){return e==null?void 0:e[r]}}var qe={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Be=Ye(qe),Ke=Be,Qe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xe="\\u0300-\\u036f",er="\\ufe20-\\ufe2f",rr="\\u20d0-\\u20ff",ur=Xe+er+rr,nr="["+ur+"]",tr=RegExp(nr,"g");function R(e){return e=y(e),e&&e.replace(Qe,Ke).replace(tr,"")}var ar=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function or(e){return e.match(ar)||[]}var fr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function sr(e){return fr.test(e)}var N="\\ud800-\\udfff",cr="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",dr="\\u20d0-\\u20ff",lr=cr+ir+dr,Z="\\u2700-\\u27bf",D="a-z\\xdf-\\xf6\\xf8-\\xff",br="\\xac\\xb1\\xd7\\xf7",gr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",xr="\\u2000-\\u206f",mr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",P="A-Z\\xc0-\\xd6\\xd8-\\xde",hr="\\ufe0e\\ufe0f",W=br+gr+xr+mr,G="['\u2019]",S="["+W+"]",pr="["+lr+"]",H="\\d+",yr="["+Z+"]",F="["+D+"]",J="[^"+N+W+H+Z+D+P+"]",Rr="\\ud83c[\\udffb-\\udfff]",_r="(?:"+pr+"|"+Rr+")",vr="[^"+N+"]",V="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",i="["+P+"]",$r="\\u200d",O="(?:"+F+"|"+J+")",Ar="(?:"+i+"|"+J+")",j="(?:"+G+"(?:d|ll|m|re|s|t|ve))?",C="(?:"+G+"(?:D|LL|M|RE|S|T|VE))?",q=_r+"?",B="["+hr+"]?",Sr="(?:"+$r+"(?:"+[vr,V,Y].join("|")+")"+B+q+")*",Or="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",jr="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Cr=B+q+Sr,Tr="(?:"+[yr,V,Y].join("|")+")"+Cr,Er=RegExp([i+"?"+F+"+"+j+"(?="+[S,i,"$"].join("|")+")",Ar+"+"+C+"(?="+[S,i+O,"$"].join("|")+")",i+"?"+O+"+"+j,i+"+"+C,jr,Or,H,Tr].join("|"),"g");function Ur(e){return e.match(Er)||[]}function wr(e,r,u){return e=y(e),r=u?void 0:r,r===void 0?sr(e)?Ur(e):or(e):e.match(r)||[]}var Mr="['\u2019]",kr=RegExp(Mr,"g");function Lr(e){return function(r){return Ve(wr(R(r).replace(kr,"")),e,"")}}var zr=Lr(function(e,r,u){return e+(u?" ":"")+Je(r)}),l=zr;function Ir(e){return e}function _(e,r,u,{match_key:n="rdfs:label",return_key:t="@id",normalizer_f:a=Ir,anycasematch:c=!0}={}){if(r.length<1)return[];console.debug(`"Processing ${r.length} terms"`);let o=r.join("|"),f=new RegExp(o,"gi"),m=e.match(f)||[],g=[];return m.forEach(function(x){let s;c?s=u.get_multi_value_anycase(n,a(x)):s=u.get_multi_value(n,a(x)),s?g.push(s[t]):console.debug(a(x)+" Not found in Graph")}),g}function Nr(e,r,u){return _(e,r,u,{match_key:"@id"})}function Zr(e,r,u){return _(e,r,u,{match_key:"d3f:synonym",normalizer_f:l})}function Dr(e,r){let u=r.graph.map(o=>o["rdfs:label"]),n=e.match(/(T|t)([0-9]{4})((\.|\/|\\)([0-9]{3}))?/g)||[],t=e.match(new RegExp(u.join("|"),"ig"))||[],a=[];return t.forEach(function(o){r.get("rdfs:label",l(o))&&a.push(r.get("rdfs:label",l(o))["d3f:attack-id"])}),n&&(n=n.map(o=>o.replace(/(\\|\/)/,".")),n=n.map(o=>o.toUpperCase())),[...n,...a]}function Pr(e,r){if(!r.index)throw"Graph object expects index by d3fend-id";e=R(e);let u=r.graph.map(s=>s["rdfs:label"]),n=r.get_all_values("d3f:synonym"),t=e.match(/D3-[A-z]*/g)||[],a=e.match(/d3f:[A-z,-]*/g)||[],c=e.match(new RegExp(u.join("|"),"gi"))||[];console.debug("_id_matches "+t.length),console.debug("_frag_matches "+a.length),console.debug("_label_matches "+c.length);let o=[];t.forEach(function(s){r.i(s)&&o.push(r.i(s)["@id"])});let f=_(e,c,r,{normalizer_f:l}),m=Nr(e,a,r),g=Zr(e,n,r);return[...m,...o,...f,...g]}function Wr(e,r){e=R(e);let u=r.graph.map(f=>f["rdfs:label"]),n=e.match(/d3f:[A-z,-]*/g)||[],t=e.match(new RegExp(u.join("|"),"gi"))||[],a=[];t.forEach(function(f){r.get("rdfs:label",l(f))&&a.push(r.get("rdfs:label",l(f))["@id"])});let c=[];return n.forEach(function(f){r.get("@id",f)&&a.push(r.get("@id",f)["@id"])}),[...c,...a]}export{Dr as a,Pr as b,Wr as e};
