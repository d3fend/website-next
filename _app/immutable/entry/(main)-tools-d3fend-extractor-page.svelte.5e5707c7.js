import{S as rt,b as st,s as ot,J as Ie,y as Ee,j as $,f,h as T,z as ge,p as F,k as c,l as h,m as k,o as s,G as p,A as De,q as R,v as a,a2 as Oe,P as _e,K as xe,t as ce,e as he,B as Te,r as et,x as nt,C as it,H as Ce,w as ne,n as ie,E as pe,N as tt,O as lt,I as $e,X as Pe}from"../chunks/index.43e07aca.js";import{H as ft}from"../chunks/Header.f71f0103.js";import{T as ct}from"../chunks/Title.0ec6725c.js";import{A as ht}from"../chunks/Alert.5292fb99.js";import{b as ut,S as at}from"../chunks/extract.4561e1ab.js";import{G as Se,h as de,g as Le,a as qe,f as Ae}from"../chunks/lib.576aa631.js";import{p as dt}from"../chunks/stores.442b470b.js";var _t={name:"D3FEND Countermeasure Coverage",domain:"enterprise-attack",description:""};class vt{constructor(e){this.layer={..._t},this.layer.techniques=new Array,this.tech_index={},e&&(this.options={...this.options,...e})}add_technique(e){this.tech_index.hasOwnProperty(e.techniqueID)?this.tech_index[e.techniqueID].comment&&this.tech_index[e.techniqueID].comment.indexOf(e.comment)==-1&&(this.tech_index[e.techniqueID].comment+=e.comment):this.tech_index[e.techniqueID]=e}json(){for(let e in this.tech_index)this.layer.techniques.push(this.tech_index[e]);return this.layer}}function Ue(i,e,t){const l=i.slice();return l[22]=e[t],l}function Ge(i,e,t){const l=i.slice();return l[26]=e[t],l}function Je(i,e,t){const l=i.slice();return l[30]=e[t],l}function pt(i){let e,t=i[29].message+"",l;return{c(){e=f("p"),l=T(t),this.h()},l(r){e=c(r,"P",{style:!0});var n=h(e);l=k(n,t),n.forEach(s),this.h()},h(){Ce(e,"color","red")},m(r,n){R(r,e,n),a(e,l)},p(r,n){n[0]&32&&t!==(t=r[29].message+"")&&ne(l,t)},i:ie,o:ie,d(r){r&&s(e)}}}function mt(i){let e,t,l,r;const n=[Et,bt],o=[];function d(_,y){return _[21].length>0?0:!_[3]&&_[21].length<1?1:-1}return~(e=d(i))&&(t=o[e]=n[e](i)),{c(){t&&t.c(),l=pe()},l(_){t&&t.l(_),l=pe()},m(_,y){~e&&o[e].m(_,y),R(_,l,y),r=!0},p(_,y){let q=e;e=d(_),e===q?~e&&o[e].p(_,y):(t&&(tt(),he(o[q],1,1,()=>{o[q]=null}),lt()),~e?(t=o[e],t?t.p(_,y):(t=o[e]=n[e](_),t.c()),ce(t,1),t.m(l.parentNode,l)):t=null)},i(_){r||(ce(t),r=!0)},o(_){he(t),r=!1},d(_){~e&&o[e].d(_),_&&s(l)}}}function bt(i){let e,t;return{c(){e=f("div"),t=T("No D3FEND techniques found in text."),this.h()},l(l){e=c(l,"DIV",{class:!0});var r=h(e);t=k(r,"No D3FEND techniques found in text."),r.forEach(s),this.h()},h(){p(e,"class","card")},m(l,r){R(l,e,r),a(e,t)},p:ie,i:ie,o:ie,d(l){l&&s(e)}}}function Et(i){let e,t,l,r,n,o,d,_,y,q,E,D,b,O,X,C,v,H,G,A,B,z,g,P,S,w,Q,W,J,le,ee,x,M,I,u,Y,V,re,fe,N=i[0]&&Me(i);r=new ht({props:{$$slots:{default:[gt]},$$scope:{ctx:i}}}),y=new at({props:{url:i[6].url}});function j(m,Z){return m[2]?Tt:Dt}let L=j(i),K=L(i),se=i[21],U=[];for(let m=0;m<se.length;m+=1)U[m]=We(Ue(i,se,m));return{c(){e=f("div"),N&&N.c(),t=$(),l=f("div"),Ee(r.$$.fragment),n=$(),o=f("div"),d=f("div"),_=f("div"),Ee(y.$$.fragment),q=$(),E=f("div"),D=f("b"),b=f("i"),O=T("Mapping Results:"),X=$(),C=f("div"),v=f("button"),H=T("Download ATT&CK Navigator Layer"),G=$(),A=f("div"),B=f("div"),K.c(),z=$(),g=f("button"),P=T("copy"),S=$(),w=f("table"),Q=f("thead"),W=f("th"),J=T("D3FEND ID"),le=$(),ee=f("th"),x=T("D3FEND Name"),M=$(),I=f("th"),u=T("Related ATT&CK Techniques"),Y=$();for(let m=0;m<U.length;m+=1)U[m].c();this.h()},l(m){e=c(m,"DIV",{class:!0});var Z=h(e);N&&N.l(Z),Z.forEach(s),t=F(m),l=c(m,"DIV",{class:!0});var ae=h(l);ge(r.$$.fragment,ae),ae.forEach(s),n=F(m),o=c(m,"DIV",{class:!0});var oe=h(o);d=c(oe,"DIV",{class:!0});var te=h(d);_=c(te,"DIV",{class:!0});var ue=h(_);ge(y.$$.fragment,ue),ue.forEach(s),te.forEach(s),q=F(oe),E=c(oe,"DIV",{});var me=h(E);D=c(me,"B",{});var be=h(D);b=c(be,"I",{});var Fe=h(b);O=k(Fe,"Mapping Results:"),Fe.forEach(s),be.forEach(s),me.forEach(s),X=F(oe),C=c(oe,"DIV",{class:!0});var je=h(C);v=c(je,"BUTTON",{class:!0,title:!0});var He=h(v);H=k(He,"Download ATT&CK Navigator Layer"),He.forEach(s),je.forEach(s),G=F(oe),A=c(oe,"DIV",{class:!0});var ke=h(A);B=c(ke,"DIV",{class:!0});var Ne=h(B);K.l(Ne),z=F(Ne),g=c(Ne,"BUTTON",{});var Re=h(g);P=k(Re,"copy"),Re.forEach(s),Ne.forEach(s),S=F(ke),w=c(ke,"TABLE",{id:!0,class:!0});var ye=h(w);Q=c(ye,"THEAD",{});var ve=h(Q);W=c(ve,"TH",{class:!0});var Ve=h(W);J=k(Ve,"D3FEND ID"),Ve.forEach(s),le=F(ve),ee=c(ve,"TH",{});var Be=h(ee);x=k(Be,"D3FEND Name"),Be.forEach(s),M=F(ve),I=c(ve,"TH",{});var Ke=h(I);u=k(Ke,"Related ATT&CK Techniques"),Ke.forEach(s),ve.forEach(s),Y=F(ye);for(let we=0;we<U.length;we+=1)U[we].l(ye);ye.forEach(s),ke.forEach(s),oe.forEach(s),this.h()},h(){p(e,"class","card"),p(l,"class","card"),p(_,"class","text-right"),p(d,"class","stretch"),p(v,"class","small button"),p(v,"title","Load into Navigator to see related TTPs"),p(C,"class","text-right"),p(B,"class","text-right"),p(W,"class","stretch"),p(w,"id","mappings"),p(w,"class","table-auto"),p(A,"class","results-wrap center svelte-xumjr3"),p(o,"class","card")},m(m,Z){R(m,e,Z),N&&N.m(e,null),R(m,t,Z),R(m,l,Z),De(r,l,null),R(m,n,Z),R(m,o,Z),a(o,d),a(d,_),De(y,_,null),a(o,q),a(o,E),a(E,D),a(D,b),a(b,O),a(o,X),a(o,C),a(C,v),a(v,H),a(o,G),a(o,A),a(A,B),K.m(B,null),a(B,z),a(B,g),a(g,P),a(A,S),a(A,w),a(w,Q),a(Q,W),a(W,J),a(Q,le),a(Q,ee),a(ee,x),a(Q,M),a(Q,I),a(I,u),a(w,Y);for(let ae=0;ae<U.length;ae+=1)U[ae]&&U[ae].m(w,null);V=!0,re||(fe=[_e(v,"click",i[7]),_e(g,"click",Ct)],re=!0)},p(m,Z){m[0]?N?(N.p(m,Z),Z[0]&1&&ce(N,1)):(N=Me(m),N.c(),ce(N,1),N.m(e,null)):N&&(tt(),he(N,1,1,()=>{N=null}),lt());const ae={};Z[1]&4&&(ae.$$scope={dirty:Z,ctx:m}),r.$set(ae);const oe={};if(Z[0]&64&&(oe.url=m[6].url),y.$set(oe),L===(L=j(m))&&K?K.p(m,Z):(K.d(1),K=L(m),K&&(K.c(),K.m(B,z))),Z[0]&48){se=m[21];let te;for(te=0;te<se.length;te+=1){const ue=Ue(m,se,te);U[te]?U[te].p(ue,Z):(U[te]=We(ue),U[te].c(),U[te].m(w,null))}for(;te<U.length;te+=1)U[te].d(1);U.length=se.length}},i(m){V||(ce(N),ce(r.$$.fragment,m),ce(y.$$.fragment,m),V=!0)},o(m){he(N),he(r.$$.fragment,m),he(y.$$.fragment,m),V=!1},d(m){m&&s(e),N&&N.d(),m&&s(t),m&&s(l),Te(r),m&&s(n),m&&s(o),Te(y),K.d(),$e(U,m),re=!1,et(fe)}}}function Me(i){let e,t,l,r,n,o,d,_,y=i[0].length+"",q,E,D,b,O;l=new at({props:{url:i[6].url}});let X=i[0],C=[];for(let v=0;v<X.length;v+=1)C[v]=Xe(Je(i,X,v));return{c(){e=f("div"),t=f("div"),Ee(l.$$.fragment),r=$(),n=f("div"),o=f("b"),d=f("i"),_=T("Extracted "),q=T(y),E=T(" unique IDs:"),D=$(),b=f("dl");for(let v=0;v<C.length;v+=1)C[v].c();this.h()},l(v){e=c(v,"DIV",{class:!0});var H=h(e);t=c(H,"DIV",{class:!0});var G=h(t);ge(l.$$.fragment,G),G.forEach(s),H.forEach(s),r=F(v),n=c(v,"DIV",{class:!0});var A=h(n);o=c(A,"B",{});var B=h(o);d=c(B,"I",{});var z=h(d);_=k(z,"Extracted "),q=k(z,y),E=k(z," unique IDs:"),z.forEach(s),B.forEach(s),D=F(A),b=c(A,"DL",{class:!0});var g=h(b);for(let P=0;P<C.length;P+=1)C[P].l(g);g.forEach(s),A.forEach(s),this.h()},h(){p(t,"class","text-right"),p(e,"class","stretch"),p(b,"class","flex flex-wrap svelte-xumjr3"),p(n,"class","")},m(v,H){R(v,e,H),a(e,t),De(l,t,null),R(v,r,H),R(v,n,H),a(n,o),a(o,d),a(d,_),a(d,q),a(d,E),a(n,D),a(n,b);for(let G=0;G<C.length;G+=1)C[G]&&C[G].m(b,null);O=!0},p(v,H){const G={};if(H[0]&64&&(G.url=v[6].url),l.$set(G),(!O||H[0]&1)&&y!==(y=v[0].length+"")&&ne(q,y),H[0]&1){X=v[0];let A;for(A=0;A<X.length;A+=1){const B=Je(v,X,A);C[A]?C[A].p(B,H):(C[A]=Xe(B),C[A].c(),C[A].m(b,null))}for(;A<C.length;A+=1)C[A].d(1);C.length=X.length}},i(v){O||(ce(l.$$.fragment,v),O=!0)},o(v){he(l.$$.fragment,v),O=!1},d(v){v&&s(e),Te(l),v&&s(r),v&&s(n),$e(C,v)}}}function Xe(i){let e,t,l=i[30]+"",r,n;return{c(){e=f("dd"),t=f("a"),r=T(l),this.h()},l(o){e=c(o,"DD",{});var d=h(e);t=c(d,"A",{href:!0});var _=h(t);r=k(_,l),_.forEach(s),d.forEach(s),this.h()},h(){p(t,"href",n="/technique/"+i[30])},m(o,d){R(o,e,d),a(e,t),a(t,r)},p(o,d){d[0]&1&&l!==(l=o[30]+"")&&ne(r,l),d[0]&1&&n!==(n="/technique/"+o[30])&&p(t,"href",n)},d(o){o&&s(e)}}}function gt(i){let e,t,l;return{c(){e=f("b"),t=T("Note: "),l=T(`These relationships are generated based on the digital
          artifacts specified for the offensive and defensive techniques. They
          are designed to give you ideas, they are not designed to be exact
          matches or indicate precise coverage. They can be used to better
          understand the technologies, ask better questions, and develop test
          plans for your countermeasures.`)},l(r){e=c(r,"B",{});var n=h(e);t=k(n,"Note: "),n.forEach(s),l=k(r,`These relationships are generated based on the digital
          artifacts specified for the offensive and defensive techniques. They
          are designed to give you ideas, they are not designed to be exact
          matches or indicate precise coverage. They can be used to better
          understand the technologies, ask better questions, and develop test
          plans for your countermeasures.`)},m(r,n){R(r,e,n),a(e,t),R(r,l,n)},p:ie,d(r){r&&s(e),r&&s(l)}}}function Dt(i){let e,t,l,r;return{c(){e=f("button"),t=T("select"),this.h()},l(n){e=c(n,"BUTTON",{class:!0});var o=h(e);t=k(o,"select"),o.forEach(s),this.h()},h(){p(e,"class","selector svelte-xumjr3")},m(n,o){R(n,e,o),a(e,t),l||(r=_e(e,"click",i[10]),l=!0)},p:ie,d(n){n&&s(e),l=!1,r()}}}function Tt(i){let e,t,l,r;return{c(){e=f("button"),t=T("deselect"),this.h()},l(n){e=c(n,"BUTTON",{class:!0});var o=h(e);t=k(o,"deselect"),o.forEach(s),this.h()},h(){p(e,"class","selector svelte-xumjr3")},m(n,o){R(n,e,o),a(e,t),l||(r=_e(e,"click",i[9]),l=!0)},p:ie,d(n){n&&s(e),l=!1,r()}}}function kt(i){let e,t=i[29].message+"",l;return{c(){e=f("p"),l=T(t),this.h()},l(r){e=c(r,"P",{style:!0});var n=h(e);l=k(n,t),n.forEach(s),this.h()},h(){Ce(e,"color","red")},m(r,n){R(r,e,n),a(e,l)},p(r,n){n[0]&32&&t!==(t=r[29].message+"")&&ne(l,t)},d(r){r&&s(e)}}}function Nt(i){let e;function t(n,o){return n[25].description.graph[0]?qt:yt}let l=t(i),r=l(i);return{c(){r.c(),e=pe()},l(n){r.l(n),e=pe()},m(n,o){r.m(n,o),R(n,e,o)},p(n,o){l===(l=t(n))&&r?r.p(n,o):(r.d(1),r=l(n),r&&(r.c(),r.m(e.parentNode,e)))},d(n){r.d(n),n&&s(e)}}}function yt(i){let e,t,l=i[25].id+"",r,n,o,d,_,y,q;return{c(){e=f("td"),t=f("a"),r=T(l),o=$(),d=f("td"),_=T("not found in D3FEND graph"),y=$(),q=f("td"),this.h()},l(E){e=c(E,"TD",{class:!0});var D=h(e);t=c(D,"A",{style:!0,href:!0});var b=h(t);r=k(b,l),b.forEach(s),D.forEach(s),o=F(E),d=c(E,"TD",{});var O=h(d);_=k(O,"not found in D3FEND graph"),O.forEach(s),y=F(E),q=c(E,"TD",{}),h(q).forEach(s),this.h()},h(){Ce(t,"color","red"),p(t,"href",n=Le(i[25].id)),p(e,"class","text-center")},m(E,D){R(E,e,D),a(e,t),a(t,r),R(E,o,D),R(E,d,D),a(d,_),R(E,y,D),R(E,q,D)},p(E,D){D[0]&32&&l!==(l=E[25].id+"")&&ne(r,l),D[0]&32&&n!==(n=Le(E[25].id))&&p(t,"href",n)},d(E){E&&s(e),E&&s(o),E&&s(d),E&&s(y),E&&s(q)}}}function qt(i){let e,t,l=i[25].description.graph[0]["d3f:d3fend-id"]+"",r,n,o,d,_=i[25].description.graph[0]["rdfs:label"]+"",y,q,E,D,b,O,X,C,v,H,G,A,B,z,g,P,S,w,Q,W,J,le,ee,x=Ze(i[25].def_to_off.results.bindings),M=[];for(let u=0;u<x.length;u+=1)M[u]=Qe(Ge(i,x,u));let I=null;return x.length||(I=Ye()),{c(){e=f("th"),t=f("a"),r=T(l),o=$(),d=f("td"),y=T(_),q=$(),E=f("td"),D=f("table"),b=f("thead"),O=f("th"),X=T("defensive verb"),C=$(),v=f("th"),H=T("defensive artifact"),G=$(),A=f("th"),B=T("ATT&CK Technique"),z=$(),g=f("th"),P=T("offensive verb"),S=$(),w=f("th"),Q=T("offensive artifact"),W=$(),J=f("th"),le=T("ATT&CK ID"),ee=$();for(let u=0;u<M.length;u+=1)M[u].c();I&&I.c(),this.h()},l(u){e=c(u,"TH",{class:!0,scope:!0});var Y=h(e);t=c(Y,"A",{href:!0});var V=h(t);r=k(V,l),V.forEach(s),Y.forEach(s),o=F(u),d=c(u,"TD",{});var re=h(d);y=k(re,_),re.forEach(s),q=F(u),E=c(u,"TD",{});var fe=h(E);D=c(fe,"TABLE",{class:!0});var N=h(D);b=c(N,"THEAD",{class:!0});var j=h(b);O=c(j,"TH",{scope:!0});var L=h(O);X=k(L,"defensive verb"),L.forEach(s),C=F(j),v=c(j,"TH",{scope:!0});var K=h(v);H=k(K,"defensive artifact"),K.forEach(s),G=F(j),A=c(j,"TH",{scope:!0});var se=h(A);B=k(se,"ATT&CK Technique"),se.forEach(s),z=F(j),g=c(j,"TH",{scope:!0});var U=h(g);P=k(U,"offensive verb"),U.forEach(s),S=F(j),w=c(j,"TH",{scope:!0});var m=h(w);Q=k(m,"offensive artifact"),m.forEach(s),W=F(j),J=c(j,"TH",{scope:!0});var Z=h(J);le=k(Z,"ATT&CK ID"),Z.forEach(s),j.forEach(s),ee=F(N);for(let ae=0;ae<M.length;ae+=1)M[ae].l(N);I&&I.l(N),N.forEach(s),fe.forEach(s),this.h()},h(){p(t,"href",n="/technique/"+i[25].description.graph[0]["@id"]),p(e,"class","text-center"),p(e,"scope","row"),p(O,"scope","col"),p(v,"scope","col"),p(A,"scope","col"),p(g,"scope","col"),p(w,"scope","col"),p(J,"scope","col"),p(b,"class","svelte-xumjr3"),Pe(b,"hide",i[4]),p(D,"class","table-auto w100 svelte-xumjr3")},m(u,Y){R(u,e,Y),a(e,t),a(t,r),R(u,o,Y),R(u,d,Y),a(d,y),R(u,q,Y),R(u,E,Y),a(E,D),a(D,b),a(b,O),a(O,X),a(b,C),a(b,v),a(v,H),a(b,G),a(b,A),a(A,B),a(b,z),a(b,g),a(g,P),a(b,S),a(b,w),a(w,Q),a(b,W),a(b,J),a(J,le),a(D,ee);for(let V=0;V<M.length;V+=1)M[V]&&M[V].m(D,null);I&&I.m(D,null)},p(u,Y){if(Y[0]&32&&l!==(l=u[25].description.graph[0]["d3f:d3fend-id"]+"")&&ne(r,l),Y[0]&32&&n!==(n="/technique/"+u[25].description.graph[0]["@id"])&&p(t,"href",n),Y[0]&32&&_!==(_=u[25].description.graph[0]["rdfs:label"]+"")&&ne(y,_),Y[0]&16&&Pe(b,"hide",u[4]),Y[0]&32){x=Ze(u[25].def_to_off.results.bindings);let V;for(V=0;V<x.length;V+=1){const re=Ge(u,x,V);M[V]?M[V].p(re,Y):(M[V]=Qe(re),M[V].c(),M[V].m(D,null))}for(;V<M.length;V+=1)M[V].d(1);M.length=x.length,!x.length&&I?I.p(u,Y):x.length?I&&(I.d(1),I=null):(I=Ye(),I.c(),I.m(D,null))}},d(u){u&&s(e),u&&s(o),u&&s(d),u&&s(q),u&&s(E),$e(M,u),I&&I.d()}}}function Ye(i){let e,t,l,r,n;return{c(){e=f("td"),t=T("no defensive relations "),l=f("a"),r=T("yet"),n=$(),this.h()},l(o){e=c(o,"TD",{colspan:!0});var d=h(e);t=k(d,"no defensive relations "),l=c(d,"A",{href:!0});var _=h(l);r=k(_,"yet"),_.forEach(s),n=F(d),d.forEach(s),this.h()},h(){p(l,"href","/contribute"),p(e,"colspan","5")},m(o,d){R(o,e,d),a(e,t),a(e,l),a(l,r),a(e,n)},p:ie,d(o){o&&s(e)}}}function ze(i){let e,t,l=i[26].def_artifact_rel_label.value+"",r,n,o,d,_=i[26].def_artifact_label.value+"",y,q,E,D,b,O=i[26].off_tech_label.value+"",X,C,v,H,G=i[26].off_artifact_rel_label.value+"",A,B,z,g,P=i[26].off_artifact_label.value+"",S,w,Q,W,J,le=de(i[26].off_tech.value)+"",ee,x,M;return{c(){e=f("tr"),t=f("td"),r=T(l),n=$(),o=f("td"),d=f("a"),y=T(_),E=$(),D=f("td"),b=f("a"),X=T(O),v=$(),H=f("td"),A=T(G),B=$(),z=f("td"),g=f("a"),S=T(P),Q=$(),W=f("td"),J=f("a"),ee=T(le),M=$(),this.h()},l(I){e=c(I,"TR",{});var u=h(e);t=c(u,"TD",{});var Y=h(t);r=k(Y,l),Y.forEach(s),n=F(u),o=c(u,"TD",{});var V=h(o);d=c(V,"A",{href:!0});var re=h(d);y=k(re,_),re.forEach(s),V.forEach(s),E=F(u),D=c(u,"TD",{});var fe=h(D);b=c(fe,"A",{href:!0});var N=h(b);X=k(N,O),N.forEach(s),fe.forEach(s),v=F(u),H=c(u,"TD",{});var j=h(H);A=k(j,G),j.forEach(s),B=F(u),z=c(u,"TD",{});var L=h(z);g=c(L,"A",{href:!0});var K=h(g);S=k(K,P),K.forEach(s),L.forEach(s),Q=F(u),W=c(u,"TD",{});var se=h(W);J=c(se,"A",{href:!0});var U=h(J);ee=k(U,le),U.forEach(s),se.forEach(s),M=F(u),u.forEach(s),this.h()},h(){p(d,"href",q="/dao/artifact/"+qe(i[26].def_artifact.value)),p(b,"href",C=Ae(de(i[26].off_tech.value))),p(g,"href",w="/dao/artifact/"+qe(i[26].off_artifact.value)),p(J,"href",x=Ae(de(i[26].off_tech.value)))},m(I,u){R(I,e,u),a(e,t),a(t,r),a(e,n),a(e,o),a(o,d),a(d,y),a(e,E),a(e,D),a(D,b),a(b,X),a(e,v),a(e,H),a(H,A),a(e,B),a(e,z),a(z,g),a(g,S),a(e,Q),a(e,W),a(W,J),a(J,ee),a(e,M)},p(I,u){u[0]&32&&l!==(l=I[26].def_artifact_rel_label.value+"")&&ne(r,l),u[0]&32&&_!==(_=I[26].def_artifact_label.value+"")&&ne(y,_),u[0]&32&&q!==(q="/dao/artifact/"+qe(I[26].def_artifact.value))&&p(d,"href",q),u[0]&32&&O!==(O=I[26].off_tech_label.value+"")&&ne(X,O),u[0]&32&&C!==(C=Ae(de(I[26].off_tech.value)))&&p(b,"href",C),u[0]&32&&G!==(G=I[26].off_artifact_rel_label.value+"")&&ne(A,G),u[0]&32&&P!==(P=I[26].off_artifact_label.value+"")&&ne(S,P),u[0]&32&&w!==(w="/dao/artifact/"+qe(I[26].off_artifact.value))&&p(g,"href",w),u[0]&32&&le!==(le=de(I[26].off_tech.value)+"")&&ne(ee,le),u[0]&32&&x!==(x=Ae(de(I[26].off_tech.value)))&&p(J,"href",x)},d(I){I&&s(e)}}}function Qe(i){let e,t=i[26].def_tech&&ze(i);return{c(){t&&t.c(),e=pe()},l(l){t&&t.l(l),e=pe()},m(l,r){t&&t.m(l,r),R(l,e,r)},p(l,r){l[26].def_tech?t?t.p(l,r):(t=ze(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&s(e)}}}function At(i){let e;return{c(){e=T("loading...")},l(t){e=k(t,"loading...")},m(t,l){R(t,e,l)},p:ie,d(t){t&&s(e)}}}function We(i){let e,t,l,r={ctx:i,current:null,token:null,hasCatch:!0,pending:At,then:Nt,catch:kt,value:25,error:29};return Ie(t=i[22],r),{c(){e=f("tr"),r.block.c(),l=$()},l(n){e=c(n,"TR",{});var o=h(e);r.block.l(o),l=F(o),o.forEach(s)},m(n,o){R(n,e,o),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=l,a(e,l)},p(n,o){i=n,r.ctx=i,o[0]&32&&t!==(t=i[22])&&Ie(t,r)||xe(r,i,o)},d(n){n&&s(e),r.block.d(),r.token=null,r=null}}}function It(i){let e;return{c(){e=T("enter text and click go")},l(t){e=k(t,"enter text and click go")},m(t,l){R(t,e,l)},p:ie,i:ie,o:ie,d(t){t&&s(e)}}}function wt(i){let e,t,l,r,n,o,d,_,y,q,E,D,b,O,X,C,v,H,G,A,B,z,g,P,S,w,Q,W,J,le,ee,x,M,I,u,Y,V,re,fe;e=new ct({props:{title:"D3FEND Extractor | Tools | "}}),r=new ft({props:{header:"D3FEND Extractor"}});let N={ctx:i,current:null,token:null,hasCatch:!0,pending:It,then:mt,catch:pt,value:21,error:29,blocks:[,,,]};return Ie(Y=i[5],N),{c(){Ee(e.$$.fragment),t=$(),l=f("section"),Ee(r.$$.fragment),n=$(),o=f("div"),d=f("h1"),_=T("D3FEND Extractor"),y=$(),q=f("p"),E=T("Extracts D3FEND techniques from blobs of text and identifies "),D=f("i"),b=T("related"),O=T(`
      ATT&CK Techniques. You may also want to try the
      `),X=f("a"),C=T("ATT&CK Extractor"),v=T(`
      or the `),H=f("a"),G=T("Artifact Extractor."),A=$(),B=f("p"),z=f("i"),g=T("Paste any text containing D3FEND techniques:"),P=$(),S=f("div"),w=f("textarea"),Q=$(),W=f("div"),J=f("button"),le=T("GO"),ee=$(),x=f("br"),M=$(),I=f("br"),u=$(),N.block.c(),this.h()},l(j){ge(e.$$.fragment,j),t=F(j),l=c(j,"SECTION",{class:!0});var L=h(l);ge(r.$$.fragment,L),n=F(L),o=c(L,"DIV",{class:!0});var K=h(o);d=c(K,"H1",{});var se=h(d);_=k(se,"D3FEND Extractor"),se.forEach(s),y=F(K),q=c(K,"P",{});var U=h(q);E=k(U,"Extracts D3FEND techniques from blobs of text and identifies "),D=c(U,"I",{});var m=h(D);b=k(m,"related"),m.forEach(s),O=k(U,`
      ATT&CK Techniques. You may also want to try the
      `),X=c(U,"A",{href:!0});var Z=h(X);C=k(Z,"ATT&CK Extractor"),Z.forEach(s),v=k(U,`
      or the `),H=c(U,"A",{href:!0});var ae=h(H);G=k(ae,"Artifact Extractor."),ae.forEach(s),U.forEach(s),A=F(K),B=c(K,"P",{class:!0});var oe=h(B);z=c(oe,"I",{});var te=h(z);g=k(te,"Paste any text containing D3FEND techniques:"),te.forEach(s),oe.forEach(s),P=F(K),S=c(K,"DIV",{});var ue=h(S);w=c(ue,"TEXTAREA",{class:!0}),h(w).forEach(s),ue.forEach(s),Q=F(K),W=c(K,"DIV",{});var me=h(W);J=c(me,"BUTTON",{class:!0});var be=h(J);le=k(be,"GO"),be.forEach(s),me.forEach(s),ee=F(K),x=c(K,"BR",{}),K.forEach(s),M=F(L),I=c(L,"BR",{}),u=F(L),N.block.l(L),L.forEach(s),this.h()},h(){p(X,"href","/tools/attack-extractor"),p(H,"href","/tools/artifact-extractor"),p(B,"class","text-2"),p(w,"class","svelte-xumjr3"),p(J,"class","button"),p(o,"class","card"),p(l,"class"," svelte-xumjr3")},m(j,L){De(e,j,L),R(j,t,L),R(j,l,L),De(r,l,null),a(l,n),a(l,o),a(o,d),a(d,_),a(o,y),a(o,q),a(q,E),a(q,D),a(D,b),a(q,O),a(q,X),a(X,C),a(q,v),a(q,H),a(H,G),a(o,A),a(o,B),a(B,z),a(z,g),a(o,P),a(o,S),a(S,w),Oe(w,i[1]),a(o,Q),a(o,W),a(W,J),a(J,le),a(o,ee),a(o,x),a(l,M),a(l,I),a(l,u),N.block.m(l,N.anchor=null),N.mount=()=>l,N.anchor=null,V=!0,re||(fe=[_e(w,"input",i[13]),_e(w,"keypress",i[11]),_e(J,"click",i[8])],re=!0)},p(j,L){i=j,L[0]&2&&Oe(w,i[1]),N.ctx=i,L[0]&32&&Y!==(Y=i[5])&&Ie(Y,N)||xe(N,i,L)},i(j){V||(ce(e.$$.fragment,j),ce(r.$$.fragment,j),ce(N.block),V=!0)},o(j){he(e.$$.fragment,j),he(r.$$.fragment,j);for(let L=0;L<3;L+=1){const K=N.blocks[L];he(K)}V=!1},d(j){Te(e,j),j&&s(t),j&&s(l),Te(r),N.block.d(),N.token=null,N=null,re=!1,et(fe)}}}function Ct(){document.execCommand("copy")}function Ze(i){let e=new Set,t=[];return i.forEach(function(l){l.hasOwnProperty("off_tech_label")&&(e.has(l.off_tech_label.value)||(e.add(l.off_tech_label.value),t.push(l)))}),t}function $t(i,e,t){let l;nt(i,dt,g=>t(6,l=g));let{data:r}=e,n=new Se(r.techniques,{index:!0,index_key:"d3f:d3fend-id"}),o,d="",_=!1,y=!0,q,E=[];function D(){t(0,o=[]),t(2,_=!1),t(3,y=!0),E=[]}q=l.url.searchParams.get("q"),console.log("Found params: "+q);let b=!1;async function O(){let g=new vt,P=await Promise.all(E);P.forEach(function(W){W.def_to_off.results.bindings.forEach(function(J){g.add_technique({techniqueID:de(J.off_tech.value),comment:`
`+J.def_tech_label.value+`
`,color:"#9ecae1"})})});let S=`"Navigator_Layer-${P.length}-D3FEND-Techniques.json"`;const w=document.createElement("a"),Q=new Blob([JSON.stringify(g.json())],{type:"application/json;charset=utf-8"});w.href=URL.createObjectURL(Q),w.download=S,w.click()}async function X(g){let P="/api/technique/"+g+".json";const S=await fetch(P);if(S.status==404)return{id:g,def_to_off:[],description:{graph:[]},status:S.status};if(S.ok){const w=await S.json();return{id:g,def_to_off:w.def_to_off,description:new Se(w.description)}}else throw new Error(d)}async function C(){D();let g=t(0,o=Array.from(new Set(ut(d,n))));if(g)return g.forEach(function(P){let S;S=X(P),S&&E.push(S)}),l.url.searchParams.set("q",JSON.stringify(g)),history.replaceState(null,"mapping",l.url),E;D(),console.debug("no matches")}let v=C();function H(){t(5,v=C()),t(3,y=!1)}function G(){window.getSelection().removeAllRanges(),t(2,_=!1),t(4,b=!1)}function A(){t(4,b=!0);let g="mappings";const P=window.getSelection();P.removeAllRanges();let S=document.getElementById(g);const w=document.createRange();w.selectNodeContents(S),P.addRange(w),t(2,_=!0)}function B(g){g.ctrlKey==!0&&g.keyCode==13&&H()}it(async()=>{q?(t(1,d=q),console.log("handlingclick"),H()):(console.log("starting blank"),t(1,d=""))});function z(){d=this.value,t(1,d)}return i.$$set=g=>{"data"in g&&t(12,r=g.data)},[o,d,_,y,b,v,l,O,H,G,A,B,r,z]}class Ot extends rt{constructor(e){super(),st(this,e,$t,wt,ot,{data:12},null,[-1,-1])}}export{Ot as default};
