import{S as ke,b as we,s as Ee,f as $,Y as $e,h as W,k as N,l as I,Z as Ne,m as x,o as _,G as p,H as ie,q as V,v as E,P as ee,w as ve,n as Y,a1 as et,ar as at,j,p as z,a4 as Pe,r as Ce,x as ce,R as pe,T as ct,y as G,z as K,A as J,U as ut,t as y,e as A,B as X,D as re,N as _e,O as ge,af as Te,al as ft,am as dt,I as tt,X as se,as as st,ag as be,c as lt,u as nt,g as rt,d as ot,J as ye,K as mt,C as ht,aa as pt,E as Ae}from"../chunks/index.43e07aca.js";import{p as _t}from"../chunks/stores.442b470b.js";import{b as gt,g as Se}from"../chunks/navigation.6aa88e30.js";import{f as Fe,a as Ie,s as je}from"../chunks/index.14dc3a99.js";import{d as vt,w as bt}from"../chunks/index.a90181f6.js";import{f as kt}from"../chunks/consts.558b10bc.js";import{S as wt}from"../chunks/SimpleAutocomplete.a3205b95.js";import{T as Et,a as ne}from"../chunks/updateDefendTree.2777d231.js";/* empty css                             */import{D as Ct}from"../chunks/D3FMatrix.218ef1d2.js";import{T as Mt}from"../chunks/Title.0ec6725c.js";import{T as $t}from"../chunks/Technique.e583fee7.js";const ze={setting:"M19.5 12c0 .34-.03.66-.07.98l2.11 1.65c.19.15.24.42.12.64l-2 3.46c-.12.22-.38.31-.61.22l-2.49-1c-.52.39-1.08.73-1.69.98l-.38 2.65c-.03.24-.24.42-.49.42h-4c-.25 0-.46-.18-.49-.42l-.38-2.65c-.61-.25-1.17-.58-1.69-.98l-2.49 1c-.22.08-.49 0-.61-.22l-2-3.46a.505.505 0 0 1 .12-.64l2.11-1.65A7.93 7.93 0 0 1 4.5 12c0-.33.03-.66.07-.98L2.46 9.37a.493.493 0 0 1-.12-.64l2-3.46c.12-.22.38-.31.61-.22l2.49 1c.52-.39 1.08-.73 1.69-.98l.38-2.65c.03-.24.24-.42.49-.42h4c.25 0 .46.18.49.42l.38 2.65c.61.25 1.17.58 1.69.98l2.49-1c.22-.08.49 0 .61.22l2 3.46c.12.22.07.49-.12.64l-2.11 1.65c.04.32.07.64.07.98Zm-11 0c0 1.93 1.57 3.5 3.5 3.5s3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5-3.5 1.57-3.5 3.5Z",["color picker"]:"M12 3a9 9 0 0 0 0 18c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8Zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12ZM8 6.5C8 7.33 8.67 8 9.5 8S11 7.33 11 6.5 10.33 5 9.5 5 8 5.67 8 6.5ZM14.5 8c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8Zm1.5 2.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5S18.33 9 17.5 9s-1.5.67-1.5 1.5Z",create:"M20.71 5.63c.39.39.39 1.02 0 1.41l-1.83 1.83-3.75-3.75 1.83-1.83a.996.996 0 0 1 1.41 0l2.34 2.34ZM3 20.5v-3.04c0-.14.05-.26.15-.36L14.06 6.19l3.75 3.75L6.89 20.85a.47.47 0 0 1-.35.15H3.5c-.28 0-.5-.22-.5-.5Z",delete:"M15.5 4H18c.55 0 1 .45 1 1s-.45 1-1 1H6c-.55 0-1-.45-1-1s.45-1 1-1h2.5l.71-.71c.18-.18.44-.29.7-.29h4.18c.26 0 .52.11.7.29l.71.71ZM8 21c-1.1 0-2-.9-2-2V9c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H8Z",["create portfolio"]:"M12 6h8c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H4c-1.11 0-2-.89-2-2l.01-12c0-1.11.88-2 1.99-2h5.17c.53 0 1.04.21 1.42.59L12 6Zm4 8h2c.55 0 1-.45 1-1s-.45-1-1-1h-2v-2c0-.55-.45-1-1-1s-1 .45-1 1v2h-2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2Z",plus:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1Z"};function Nt(t){let e,l,s,o,i,r,d,u,h,c;return{c(){e=$("button"),l=$e("svg"),s=$e("title"),o=W(t[1]),i=$e("path"),d=$e("metadata"),u=W(t[1]),this.h()},l(n){e=N(n,"BUTTON",{style:!0,"data-icon":!0,class:!0,title:!0,"aria-label":!0});var a=I(e);l=Ne(a,"svg",{xmlns:!0,viewBox:!0});var m=I(l);s=Ne(m,"title",{});var f=I(s);o=x(f,t[1]),f.forEach(_),i=Ne(m,"path",{"fill-rule":!0,d:!0}),I(i).forEach(_),d=Ne(m,"metadata",{});var v=I(d);u=x(v,t[1]),v.forEach(_),m.forEach(_),a.forEach(_),this.h()},h(){p(i,"fill-rule","evenodd"),p(i,"d",r=ze[t[1]]),p(l,"xmlns","http://www.w3.org/2000/svg"),p(l,"viewBox","0 0 24 24"),ie(e,"--size",t[0]),p(e,"data-icon",t[1]),p(e,"class","fab svelte-gtchx5"),p(e,"title",t[1]),p(e,"aria-label","Create")},m(n,a){V(n,e,a),E(e,l),E(l,s),E(s,o),E(l,i),E(l,d),E(d,u),h||(c=ee(e,"click",t[2]),h=!0)},p(n,[a]){a&2&&ve(o,n[1]),a&2&&r!==(r=ze[n[1]])&&p(i,"d",r),a&2&&ve(u,n[1]),a&1&&ie(e,"--size",n[0]),a&2&&p(e,"data-icon",n[1]),a&2&&p(e,"title",n[1])},i:Y,o:Y,d(n){n&&_(e),h=!1,c()}}}function It(t,e,l){let{size:s}=e,{iconName:o}=e;const i=new et,r=()=>{i("iconClick")};return t.$$set=d=>{"size"in d&&l(0,s=d.size),"iconName"in d&&l(1,o=d.iconName)},[s,o,r]}class he extends ke{constructor(e){super(),we(this,e,It,Nt,Ee,{size:0,iconName:1})}}const Tt=(t,e)=>{const l={max:0,count:{},highlighted:{}};return vt([t,e],([s,o],i)=>{var h;if(!(o!=null&&o.tree.length)||!t){i(Et);return}l.count={},l.highlighted=Object.entries(l.highlighted).reduce((c,[n,a])=>(c[n]=!1,c),{});const{highlightedTechniques:r,techniqueColors:d}=it((h=s==null?void 0:s.portfolios[s.selectedPortfolio])==null?void 0:h.includedMeasures,s.measures),u=Object.entries(d).reduce((c,[n,a])=>(c[n]=[...new Set(a)],c),{});r.forEach(c=>{l.highlighted[c]=!0,l.count[c]?l.count[c]+=1:l.count[c]=1}),l.max=Object.values(l.count).reduce((c,n)=>c>n?c:n,-1/0),Object.entries(l.highlighted).forEach(([c,n])=>{if(n){const a=Lt[s.techniqueMappingMode]({colors:u[c],count:l.count,max:l.max,technique:c});o.treeMap[c].classes.isHighlighted=!0,o.treeMap[c].classes.color=a}else o.treeMap[c].classes.isHighlighted=!1,o.treeMap[c].classes.color=null}),i(o)})},Ot=t=>{const{colors:e}=t,l=e.length,s=l-1,o=(1/l*100).toFixed(1);if(l===1)return e[0];let i="linear-gradient( to right,";for(let r=0;r<l;r++){const d=e[r];if(r===0){i+=` ${d} ${o}%`;continue}if(r===s){i+=`, ${d} ${o*s}%`;continue}i+=`, ${d} ${o*r}% ${o*(r+1)}%`}return i+=")",i},Dt=t=>{const{count:e,max:l,technique:s}=t,o=e[s]/l*100;return`color-mix(in srgb, green ${o<20?20:o}%, white)`},Lt={multiColor:t=>Ot(t),heatMap:t=>Dt(t)},it=(t=[],e,l=[],s={},o="#0075FF")=>{for(let i=0;i<t.length;i++){const r=e[t[i]];r.checked&&(l.push(...r.techniques),r.techniques.forEach(d=>{(s[d]||(s[d]=[]))&&s[d].push(r.color||o)})),r.children&&it(r.children,e,l,s,r.color||o)}return{highlightedTechniques:l,techniqueColors:s}};var De={};function He(t){return t==="local"?localStorage:sessionStorage}function qt(t,e,l){const s=(l==null?void 0:l.serializer)??JSON,o=(l==null?void 0:l.storage)??"local",i=typeof window<"u"&&typeof document<"u";function r(d,u){i&&He(o).setItem(d,s.stringify(u))}if(!De[t]){const d=bt(e,c=>{const n=i?He(o).getItem(t):null;if(n&&c(s.parse(n)),i){const a=m=>{m.key===t&&c(m.newValue?s.parse(m.newValue):null)};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)}}),{subscribe:u,set:h}=d;De[t]={set(c){r(t,c),h(c)},update(c){const n=c(at(d));r(t,n),h(n)},subscribe:u}}return De[t]}const Pt=()=>{const{subscribe:t,update:e,set:l}=qt("d3fend-measures",kt);return{subscribe:t,update:e,set:l,createPortfolio:n=>e(a=>{const m=a.portfolios.length;return n.id=m,n.includedMeasures=[],a.portfolios.push(n),a.selectedPortfolio=m,a}),deletePortfolio:()=>e(n=>(n.portfolios=n.portfolios.filter((a,m)=>m!==n.selectedPortfolio),n.selectedPortfolio=n.portfolios.length?0:null,n)),addMeasure:n=>e(a=>{var f;const m=n.name.toLowerCase();return n.id=((f=Object.values(a.measures))==null?void 0:f.length)+1,n.techniques=[],n.checked=!1,n.color="#0075FF",a.measures[m]=n,a.portfolios[a.selectedPortfolio].includedMeasures.push(m),a}),addChild:(n,a)=>e(m=>{var k;const f=((k=Object.values(m.measures))==null?void 0:k.length)||-1,v=a.name.toLowerCase(),b=n.name.toLowerCase();return a.id=f+1,a.techniques=[],a.checked=!1,m.measures[v]=a,m.measures[b].children||(m.measures[b].children=[]),m.measures[b].children.push(v),m.measures[b].techniques=[],m}),deleteMeasure:n=>e(a=>{const m=a.selectedPortfolio;return a.portfolios=a.portfolios.reduce((f,v,b)=>{if(m===b){const k={...v};k.includedMeasures=k.includedMeasures.filter(w=>w!==n.name.toLowerCase()),f.push(k)}else f.push({...v});return f},[]),a}),deleteSubmeasure:(n,a)=>e(m=>{const f=n.name.toLowerCase();return m.measures[f].children=m.measures[f].children.filter(v=>v!==a.name.toLowerCase()),m}),saveTechniques:(n,a)=>e(m=>{const f=Object.values(n).reduce((b,k)=>(k.classes.isSelected&&b.push(k["@id"]),b),[]);return Object.entries(a).reduce((b,[k,w])=>(w&&b.push(k),b),[]).forEach(b=>{const k=[...new Set([...m.measures[b].techniques,...f])];m.measures[b].techniques=k,m.measures[b].checked=!0}),m}),saveMeasureColor:(n,a)=>e(m=>(m.measures[n.name.toLowerCase()].color=a,m))}},B=Pt();function Ve(t){var o;let e,l=((o=t[0])==null?void 0:o.name)+"",s;return{c(){e=$("h3"),s=W(l),this.h()},l(i){e=N(i,"H3",{class:!0});var r=I(e);s=x(r,l),r.forEach(_),this.h()},h(){p(e,"class","text-center")},m(i,r){V(i,e,r),E(e,s)},p(i,r){var d;r&1&&l!==(l=((d=i[0])==null?void 0:d.name)+"")&&ve(s,l)},d(i){i&&_(e)}}}function yt(t){let e,l,s,o,i,r,d,u,h,c,n,a,m,f,v,b,k,w,q,S,D,L,P,U,T,Z,te,C=t[0]&&Ve(t);return{c(){e=$("h2"),l=W(t[1]),s=j(),C&&C.c(),o=j(),i=$("div"),r=$("form"),d=$("label"),u=$("p"),h=W("NAME"),c=j(),n=$("input"),a=j(),m=$("label"),f=$("p"),v=W("Description"),b=j(),k=$("textarea"),w=j(),q=$("section"),S=$("button"),D=W("Save"),L=j(),P=$("form"),U=$("button"),T=W("Cancel"),this.h()},l(M){e=N(M,"H2",{class:!0});var F=I(e);l=x(F,t[1]),F.forEach(_),s=z(M),C&&C.l(M),o=z(M),i=N(M,"DIV",{id:!0,class:!0});var Q=I(i);r=N(Q,"FORM",{class:!0,autocomplete:!0});var R=I(r);d=N(R,"LABEL",{"aria-label":!0,for:!0});var le=I(d);u=N(le,"P",{});var ue=I(u);h=x(ue,"NAME"),ue.forEach(_),le.forEach(_),c=z(R),n=N(R,"INPUT",{id:!0,type:!0,name:!0,class:!0,"aria-describedby":!0,oninvalid:!0}),a=z(R),m=N(R,"LABEL",{"aria-label":!0,for:!0});var fe=I(m);f=N(fe,"P",{});var de=I(f);v=x(de,"Description"),de.forEach(_),fe.forEach(_),b=z(R),k=N(R,"TEXTAREA",{id:!0,name:!0,class:!0}),I(k).forEach(_),w=z(R),q=N(R,"SECTION",{id:!0,class:!0});var oe=I(q);S=N(oe,"BUTTON",{type:!0});var me=I(S);D=x(me,"Save"),me.forEach(_),L=z(oe),P=N(oe,"FORM",{method:!0});var g=I(P);U=N(g,"BUTTON",{});var O=I(U);T=x(O,"Cancel"),O.forEach(_),g.forEach(_),oe.forEach(_),R.forEach(_),Q.forEach(_),this.h()},h(){p(e,"class","text-center"),p(d,"aria-label","-measure input"),p(d,"for","measure-name"),p(n,"id","measure-name"),p(n,"type","text"),p(n,"name","Measure"),p(n,"class","measure-input svelte-lxji7x"),n.required=!0,p(n,"aria-describedby","measurename-error"),p(n,"oninvalid",t[3]("This field is required.")),p(m,"aria-label","-measure input"),p(m,"for","measure-input"),p(k,"id","measure-description"),p(k,"name","Description"),p(k,"class","measure-input svelte-lxji7x"),k.required=!0,p(S,"type","submit"),p(P,"method","dialog"),p(q,"id","measure-btns"),p(q,"class","svelte-lxji7x"),p(r,"class","measure-input-form svelte-lxji7x"),p(r,"autocomplete","off"),p(i,"id","container-measure-form"),p(i,"class","svelte-lxji7x")},m(M,F){V(M,e,F),E(e,l),V(M,s,F),C&&C.m(M,F),V(M,o,F),V(M,i,F),E(i,r),E(r,d),E(d,u),E(u,h),E(r,c),E(r,n),E(r,a),E(r,m),E(m,f),E(f,v),E(r,b),E(r,k),E(r,w),E(r,q),E(q,S),E(S,D),E(q,L),E(q,P),E(P,U),E(U,T),t[8](r),Z||(te=[ee(U,"click",t[7]),ee(r,"submit",Pe(t[4]))],Z=!0)},p(M,[F]){F&2&&ve(l,M[1]),M[0]?C?C.p(M,F):(C=Ve(M),C.c(),C.m(o.parentNode,o)):C&&(C.d(1),C=null)},i:Y,o:Y,d(M){M&&_(e),M&&_(s),C&&C.d(M),M&&_(o),M&&_(i),t[8](null),Z=!1,Ce(te)}}}function At(t,e,l){let s;ce(t,B,f=>l(9,s=f));let{dialog:o}=e,{parent:i}=e,{title:r}=e,{dispatchName:d="dispatch"}=e,u;const h=new et,c=f=>{console.log(f)},n=f=>{const v=f.target,b=new FormData(v),k=String(b.get("Measure")),w=k.toLocaleLowerCase();if(s.measures[w]){alert("Name must be unique");return}h(d,{dialogSubmitObject:{id:null,name:k},parent:i}),u.reset(),o.close()},a=()=>u.reset();function m(f){pe[f?"unshift":"push"](()=>{u=f,l(2,u)})}return t.$$set=f=>{"dialog"in f&&l(5,o=f.dialog),"parent"in f&&l(0,i=f.parent),"title"in f&&l(1,r=f.title),"dispatchName"in f&&l(6,d=f.dispatchName)},[i,r,u,c,n,o,d,a,m]}class Le extends ke{constructor(e){super(),we(this,e,At,yt,Ee,{dialog:5,parent:0,title:1,dispatchName:6})}}function St(t){var U;let e,l,s,o,i,r,d,u,h,c,n,a,m,f,v,b,k,w,q,S,D;r=new he({props:{size:33,iconName:"create portfolio"}}),r.$on("iconClick",t[10]);function L(T){t[12](T)}let P={inputClassName:"autocomplete-cursor-select",items:(U=t[3])==null?void 0:U.portfolios,readonly:!1,labelFieldName:"name",onChange:t[11]};return t[2]!==void 0&&(P.selectedItem=t[2]),u=new wt({props:P}),pe.push(()=>ct(u,"selectedItem",L)),a=new he({props:{size:33,iconName:"plus"}}),a.$on("iconClick",t[13]),f=new he({props:{size:33,iconName:"delete"}}),f.$on("iconClick",t[14]),k=new Le({props:{dialog:t[0],title:"Create Capability"}}),k.$on("dispatch",t[15]),S=new Le({props:{dialog:t[1],title:"Create Portfolio"}}),S.$on("dispatch",t[17]),{c(){e=$("section"),l=$("h2"),s=W("D3FEND PROFILE"),o=j(),i=$("div"),G(r.$$.fragment),d=j(),G(u.$$.fragment),c=j(),n=$("div"),G(a.$$.fragment),m=j(),G(f.$$.fragment),v=j(),b=$("dialog"),G(k.$$.fragment),w=j(),q=$("dialog"),G(S.$$.fragment),this.h()},l(T){e=N(T,"SECTION",{id:!0,class:!0});var Z=I(e);l=N(Z,"H2",{class:!0});var te=I(l);s=x(te,"D3FEND PROFILE"),te.forEach(_),o=z(Z),i=N(Z,"DIV",{id:!0,class:!0});var C=I(i);K(r.$$.fragment,C),d=z(C),K(u.$$.fragment,C),c=z(C),n=N(C,"DIV",{class:!0});var M=I(n);K(a.$$.fragment,M),m=z(M),K(f.$$.fragment,M),M.forEach(_),C.forEach(_),Z.forEach(_),v=z(T),b=N(T,"DIALOG",{});var F=I(b);K(k.$$.fragment,F),F.forEach(_),w=z(T),q=N(T,"DIALOG",{});var Q=I(q);K(S.$$.fragment,Q),Q.forEach(_),this.h()},h(){p(l,"class","text-center fancy-font"),p(n,"class","measure-btns"),p(i,"id","portfolio-controls"),p(i,"class","svelte-19y4ort"),p(e,"id","container-portfolio"),p(e,"class","svelte-19y4ort")},m(T,Z){V(T,e,Z),E(e,l),E(l,s),E(e,o),E(e,i),J(r,i,null),E(i,d),J(u,i,null),E(i,c),E(i,n),J(a,n,null),E(n,m),J(f,n,null),V(T,v,Z),V(T,b,Z),J(k,b,null),t[16](b),V(T,w,Z),V(T,q,Z),J(S,q,null),t[18](q),D=!0},p(T,[Z]){var F;const te={};Z&8&&(te.items=(F=T[3])==null?void 0:F.portfolios),!h&&Z&4&&(h=!0,te.selectedItem=T[2],ut(()=>h=!1)),u.$set(te);const C={};Z&1&&(C.dialog=T[0]),k.$set(C);const M={};Z&2&&(M.dialog=T[1]),S.$set(M)},i(T){D||(y(r.$$.fragment,T),y(u.$$.fragment,T),y(a.$$.fragment,T),y(f.$$.fragment,T),y(k.$$.fragment,T),y(S.$$.fragment,T),D=!0)},o(T){A(r.$$.fragment,T),A(u.$$.fragment,T),A(a.$$.fragment,T),A(f.$$.fragment,T),A(k.$$.fragment,T),A(S.$$.fragment,T),D=!1},d(T){T&&_(e),X(r),X(u),X(a),X(f),T&&_(v),T&&_(b),X(k),t[16](null),T&&_(w),T&&_(q),X(S),t[18](null)}}}function Ft(t,e,l){var L;let s;ce(t,B,P=>l(3,s=P));let o,i,r=((L=s==null?void 0:s.portfolios)==null?void 0:L[s==null?void 0:s.selectedPortfolio])||null;const d=P=>{var U;if(P){const T=s.portfolios.findIndex(({id:Z})=>Z===P.id);re(B,s.selectedPortfolio=T,s),l(2,r=((U=s==null?void 0:s.portfolios)==null?void 0:U[T])||null),ne.reset()}else re(B,s.selectedPortfolio=null,s),l(2,r=P)},u=()=>{i.showModal()},h=P=>{o.showModal()},c=P=>{const{dialogSubmitObject:U}=P.detail;B.addMeasure(U)},n=P=>{const{dialogSubmitObject:U}=P.detail;B.createPortfolio(U),l(2,r=s.portfolios[s.selectedPortfolio]||null)},a=P=>{confirm("Deleting Portfolio will delete whole portfolio.")&&(B.deletePortfolio(),l(2,r=s.portfolios[s.selectedPortfolio]||{name:""}))},m=P=>u(),f=P=>d(P);function v(P){r=P,l(2,r)}const b=P=>h(),k=P=>a(),w=P=>c(P);function q(P){pe[P?"unshift":"push"](()=>{o=P,l(0,o)})}const S=P=>n(P);function D(P){pe[P?"unshift":"push"](()=>{i=P,l(1,i)})}return[o,i,r,s,d,u,h,c,n,a,m,f,v,b,k,w,q,S,D]}class jt extends ke{constructor(e){super(),we(this,e,Ft,St,Ee,{})}}function Ze(t,e,l){const s=t.slice();return s[37]=e[l],s[38]=e,s[39]=l,s}function Ue(t,e,l){const s=t.slice();return s[40]=e[l],s}function Re(t){var m;let e,l,s,o,i,r,d,u,h,c=(m=t[6])==null?void 0:m.includedMeasures.map(t[19]),n=[];for(let f=0;f<c.length;f+=1)n[f]=Je(Ze(t,c,f));const a=f=>A(n[f],1,1,()=>{n[f]=null});return{c(){e=$("section");for(let f=0;f<n.length;f+=1)n[f].c();l=j(),s=$("section"),o=$("div"),i=$("button"),r=W("Save Techniques"),this.h()},l(f){e=N(f,"SECTION",{id:!0,class:!0});var v=I(e);for(let q=0;q<n.length;q+=1)n[q].l(v);v.forEach(_),l=z(f),s=N(f,"SECTION",{id:!0,class:!0});var b=I(s);o=N(b,"DIV",{id:!0,class:!0});var k=I(o);i=N(k,"BUTTON",{class:!0,type:!0});var w=I(i);r=x(w,"Save Techniques"),w.forEach(_),k.forEach(_),b.forEach(_),this.h()},h(){p(e,"id","container-measure"),p(e,"class","svelte-e6qrsp"),p(i,"class","control-btn svelte-e6qrsp"),p(i,"type","button"),i.disabled=t[5],p(o,"id","row-persist-btns"),p(o,"class","svelte-e6qrsp"),p(s,"id","container-btns"),p(s,"class","svelte-e6qrsp")},m(f,v){V(f,e,v);for(let b=0;b<n.length;b+=1)n[b]&&n[b].m(e,null);V(f,l,v),V(f,s,v),E(s,o),E(o,i),E(i,r),d=!0,u||(h=ee(i,"click",t[33]),u=!0)},p(f,v){var b;if(v[0]&225107){c=(b=f[6])==null?void 0:b.includedMeasures.map(f[19]);let k;for(k=0;k<c.length;k+=1){const w=Ze(f,c,k);n[k]?(n[k].p(w,v),y(n[k],1)):(n[k]=Je(w),n[k].c(),y(n[k],1),n[k].m(e,null))}for(_e(),k=c.length;k<n.length;k+=1)a(k);ge()}(!d||v[0]&32)&&(i.disabled=f[5])},i(f){if(!d){for(let v=0;v<c.length;v+=1)y(n[v]);d=!0}},o(f){n=n.filter(Boolean);for(let v=0;v<n.length;v+=1)A(n[v]);d=!1},d(f){f&&_(e),tt(n,f),f&&_(l),f&&_(s),u=!1,h()}}}function Be(t){let e,l,s,o,i,r,d,u,h,c=t[39],n,a,m,f;function v(...D){return t[21](t[37],t[39],...D)}l=new he({props:{size:30,iconName:"plus"}}),l.$on("iconClick",v);function b(...D){return t[22](t[37],t[39],...D)}o=new he({props:{size:30,iconName:"delete"}}),o.$on("iconClick",b);function k(...D){return t[23](t[37],t[39],...D)}r=new he({props:{size:30,iconName:"color picker"}}),r.$on("iconClick",k);const w=()=>t[24](u,c),q=()=>t[24](null,c);function S(...D){return t[25](t[37],t[39],...D)}return{c(){e=$("div"),G(l.$$.fragment),s=j(),G(o.$$.fragment),i=j(),G(r.$$.fragment),d=j(),u=$("input"),this.h()},l(D){e=N(D,"DIV",{class:!0});var L=I(e);K(l.$$.fragment,L),s=z(L),K(o.$$.fragment,L),i=z(L),K(r.$$.fragment,L),d=z(L),u=N(L,"INPUT",{type:!0,id:!0,name:!0,style:!0}),L.forEach(_),this.h()},h(){p(u,"type","color"),p(u,"id","head"),p(u,"name","head"),u.value=h=t[37].color,ie(u,"display","none"),p(e,"class","measure-btns svelte-e6qrsp")},m(D,L){V(D,e,L),J(l,e,null),E(e,s),J(o,e,null),E(e,i),J(r,e,null),E(e,d),E(e,u),w(),a=!0,m||(f=ee(u,"input",S),m=!0)},p(D,L){t=D,(!a||L[0]&66&&h!==(h=t[37].color))&&(u.value=h),c!==t[39]&&(q(),c=t[39],w())},i(D){a||(y(l.$$.fragment,D),y(o.$$.fragment,D),y(r.$$.fragment,D),Te(()=>{a&&(n||(n=be(e,Ie,{axis:"x",duration:100,x:10},!0)),n.run(1))}),a=!0)},o(D){A(l.$$.fragment,D),A(o.$$.fragment,D),A(r.$$.fragment,D),n||(n=be(e,Ie,{axis:"x",duration:100,x:10},!1)),n.run(0),a=!1},d(D){D&&_(e),X(l),X(o),X(r),q(),D&&n&&n.end(),m=!1,f()}}}function Ge(t){let e,l,s,o;function i(...r){return t[30](t[37],t[40],t[39],...r)}return l=new he({props:{size:28,iconName:"delete"}}),l.$on("iconClick",i),{c(){e=$("div"),G(l.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0});var d=I(e);K(l.$$.fragment,d),d.forEach(_),this.h()},h(){p(e,"class","measure-btns svelte-e6qrsp")},m(r,d){V(r,e,d),J(l,e,null),o=!0},p(r,d){t=r},i(r){o||(y(l.$$.fragment,r),Te(()=>{o&&(s||(s=be(e,Ie,{axis:"x",duration:200,x:10},!0)),s.run(1))}),o=!0)},o(r){A(l.$$.fragment,r),s||(s=be(e,Ie,{axis:"x",duration:200,x:10},!1)),s.run(0),o=!1},d(r){r&&_(e),X(l),r&&s&&s.end()}}}function Ke(t){let e,l,s,o,i,r,d=t[40].name+"",u,h,c=t[0][t[40].name.toLowerCase()],n,a,m;function f(...w){return t[29](t[40],t[37],...w)}let v=c&&Ge(t);function b(...w){return t[31](t[40],t[39],...w)}function k(...w){return t[32](t[40],...w)}return{c(){e=$("div"),l=$("div"),s=$("input"),i=j(),r=$("span"),u=W(d),h=j(),v&&v.c(),this.h()},l(w){e=N(w,"DIV",{class:!0,tabindex:!0,role:!0});var q=I(e);l=N(q,"DIV",{class:!0});var S=I(l);s=N(S,"INPUT",{class:!0,type:!0,name:!0,style:!0}),i=z(S),r=N(S,"SPAN",{class:!0});var D=I(r);u=x(D,d),D.forEach(_),S.forEach(_),h=z(q),v&&v.l(q),q.forEach(_),this.h()},h(){var w;p(s,"class","check-box svelte-e6qrsp"),p(s,"type","checkbox"),p(s,"name","include"),s.checked=o=(w=t[40])==null?void 0:w.checked,ie(s,"accent-color",t[37].color),p(r,"class","measure-text svelte-e6qrsp"),p(l,"class","child-row svelte-e6qrsp"),p(e,"class","measure-child measure-hover svelte-e6qrsp"),p(e,"tabindex","0"),p(e,"role","button"),se(e,"selected-measure",t[0][t[40].name.toLowerCase()])},m(w,q){V(w,e,q),E(e,l),E(l,s),E(l,i),E(l,r),E(r,u),E(e,h),v&&v.m(e,null),n=!0,a||(m=[ee(s,"click",st(f)),ee(e,"click",b),ee(e,"keydown",k)],a=!0)},p(w,q){var S;t=w,(!n||q[0]&66&&o!==(o=(S=t[40])==null?void 0:S.checked))&&(s.checked=o),(!n||q[0]&66)&&ie(s,"accent-color",t[37].color),(!n||q[0]&66)&&d!==(d=t[40].name+"")&&ve(u,d),q[0]&67&&(c=t[0][t[40].name.toLowerCase()]),c?v?(v.p(t,q),q[0]&67&&y(v,1)):(v=Ge(t),v.c(),y(v,1),v.m(e,null)):v&&(_e(),A(v,1,1,()=>{v=null}),ge()),(!n||q[0]&67)&&se(e,"selected-measure",t[0][t[40].name.toLowerCase()])},i(w){n||(y(v),n=!0)},o(w){A(v),n=!1},d(w){w&&_(e),v&&v.d(),a=!1,Ce(m)}}}function Je(t){var U,T,Z,te;let e,l,s,o,i,r,d=t[37].name+"",u,h,c=t[0][t[37].name.toLowerCase()]||((T=(U=t[37])==null?void 0:U.children)==null?void 0:T.some(t[18])),n,a,m,f,v,b;function k(...C){return t[20](t[37],...C)}let w=c&&Be(t);function q(...C){return t[26](t[37],t[39],...C)}function S(...C){return t[27](t[37],...C)}let D=((te=(Z=t[37])==null?void 0:Z.children)==null?void 0:te.map(t[28]))||[],L=[];for(let C=0;C<D.length;C+=1)L[C]=Ke(Ue(t,D,C));const P=C=>A(L[C],1,1,()=>{L[C]=null});return{c(){e=$("div"),l=$("form"),s=$("input"),i=j(),r=$("span"),u=W(d),h=j(),w&&w.c(),n=j(),a=$("article");for(let C=0;C<L.length;C+=1)L[C].c();m=j(),this.h()},l(C){e=N(C,"DIV",{class:!0,tabindex:!0,role:!0});var M=I(e);l=N(M,"FORM",{});var F=I(l);s=N(F,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0,style:!0}),F.forEach(_),i=z(M),r=N(M,"SPAN",{class:!0});var Q=I(r);u=x(Q,d),Q.forEach(_),h=z(M),w&&w.l(M),M.forEach(_),n=z(C),a=N(C,"ARTICLE",{class:!0});var R=I(a);for(let le=0;le<L.length;le+=1)L[le].l(R);m=z(R),R.forEach(_),this.h()},h(){var C,M,F,Q,R;p(s,"class","check-box svelte-e6qrsp"),p(s,"type","checkbox"),p(s,"name","include"),s.checked=o=(C=t[37])==null?void 0:C.checked,p(s,"tabindex","0"),ie(s,"accent-color",t[37].color),p(r,"class","measure-text svelte-e6qrsp"),se(r,"parent-measure",((F=(M=t[37])==null?void 0:M.children)==null?void 0:F.length)>0),p(e,"class","measure-parent svelte-e6qrsp"),p(e,"tabindex","0"),p(e,"role","button"),se(e,"selected-measure",t[0][t[37].name.toLowerCase()]),se(e,"measure-hover",!((R=(Q=t[37])==null?void 0:Q.children)!=null&&R.length)),p(a,"class","container-measure-child svelte-e6qrsp")},m(C,M){V(C,e,M),E(e,l),E(l,s),E(e,i),E(e,r),E(r,u),E(e,h),w&&w.m(e,null),V(C,n,M),V(C,a,M);for(let F=0;F<L.length;F+=1)L[F]&&L[F].m(a,null);E(a,m),f=!0,v||(b=[ee(s,"click",st(k)),ee(e,"click",q),ee(e,"keydown",S)],v=!0)},p(C,M){var F,Q,R,le,ue,fe,de,oe,me;if(t=C,(!f||M[0]&66&&o!==(o=(F=t[37])==null?void 0:F.checked))&&(s.checked=o),(!f||M[0]&66)&&ie(s,"accent-color",t[37].color),(!f||M[0]&66)&&d!==(d=t[37].name+"")&&ve(u,d),(!f||M[0]&66)&&se(r,"parent-measure",((R=(Q=t[37])==null?void 0:Q.children)==null?void 0:R.length)>0),M[0]&67&&(c=t[0][t[37].name.toLowerCase()]||((ue=(le=t[37])==null?void 0:le.children)==null?void 0:ue.some(t[18]))),c?w?(w.p(t,M),M[0]&67&&y(w,1)):(w=Be(t),w.c(),y(w,1),w.m(e,null)):w&&(_e(),A(w,1,1,()=>{w=null}),ge()),(!f||M[0]&67)&&se(e,"selected-measure",t[0][t[37].name.toLowerCase()]),(!f||M[0]&66)&&se(e,"measure-hover",!((de=(fe=t[37])==null?void 0:fe.children)!=null&&de.length)),M[0]&18243){D=((me=(oe=t[37])==null?void 0:oe.children)==null?void 0:me.map(t[28]))||[];let g;for(g=0;g<D.length;g+=1){const O=Ue(t,D,g);L[g]?(L[g].p(O,M),y(L[g],1)):(L[g]=Ke(O),L[g].c(),y(L[g],1),L[g].m(a,m))}for(_e(),g=D.length;g<L.length;g+=1)P(g);ge()}},i(C){if(!f){y(w);for(let M=0;M<D.length;M+=1)y(L[M]);f=!0}},o(C){A(w),L=L.filter(Boolean);for(let M=0;M<L.length;M+=1)A(L[M]);f=!1},d(C){C&&_(e),w&&w.d(),C&&_(n),C&&_(a),tt(L,C),v=!1,Ce(b)}}}function zt(t){let e,l,s,o,i,r,d,u,h,c;s=new jt({});let n=t[6]&&Re(t);return d=new Le({props:{dialog:t[2],parent:t[3],title:"Create child capability of:"}}),d.$on("dispatch",t[34]),{c(){e=$("main"),l=$("section"),G(s.$$.fragment),o=j(),n&&n.c(),i=j(),r=$("dialog"),G(d.$$.fragment),this.h()},l(a){e=N(a,"MAIN",{class:!0});var m=I(e);l=N(m,"SECTION",{id:!0,class:!0});var f=I(l);K(s.$$.fragment,f),f.forEach(_),o=z(m),n&&n.l(m),i=z(m),r=N(m,"DIALOG",{});var v=I(r);K(d.$$.fragment,v),v.forEach(_),m.forEach(_),this.h()},h(){p(l,"id","container-header"),p(l,"class","svelte-e6qrsp"),p(e,"class","svelte-e6qrsp")},m(a,m){V(a,e,m),E(e,l),J(s,l,null),E(e,o),n&&n.m(e,null),E(e,i),E(e,r),J(d,r,null),t[35](r),c=!0},p(a,m){a[6]?n?(n.p(a,m),m[0]&64&&y(n,1)):(n=Re(a),n.c(),y(n,1),n.m(e,i)):n&&(_e(),A(n,1,1,()=>{n=null}),ge());const f={};m[0]&4&&(f.dialog=a[2]),m[0]&8&&(f.parent=a[3]),d.$set(f)},i(a){c||(y(s.$$.fragment,a),y(n),y(d.$$.fragment,a),Te(()=>{c&&(h&&h.end(1),u=ft(e,Fe,{delay:400}),u.start())}),c=!0)},o(a){A(s.$$.fragment,a),A(n),A(d.$$.fragment,a),u&&u.invalidate(),h=dt(e,Fe,{duration:100}),c=!1},d(a){a&&_(e),X(s),n&&n.d(),X(d),t[35](null),a&&h&&h.end()}}}function Ht(t,e,l){let s,o,i;ce(t,B,g=>l(1,o=g)),ce(t,ne,g=>l(7,i=g));let r,d,u=[],h=!0,c={};const n=(g,O)=>{var ae;if(o.readonly||(ae=O==null?void 0:O.children)!=null&&ae.length)return;const H=O.name.toLowerCase();if(g.shiftKey)l(0,c[H]=!c[H],c);else{const Me=c[H];Object.entries(c).forEach(([Oe])=>{l(0,c[Oe]=!1,c)}),l(0,c[H]=!Me,c)}},a=(g,O,H)=>{g.code==="Enter"&&O(g,H)},m=(g,O,H)=>{var Me;const ae=(Me=o.measures[O.name.toLowerCase()])==null?void 0:Me.checked;re(B,o.measures[O.name.toLowerCase()].checked=!ae,o),O.children&&O.children.forEach(Oe=>{re(B,o.measures[Oe.toLowerCase()].checked=!ae,o)})},f=(g,O)=>{l(3,d=g),r.showModal()},v=g=>{const{parent:O,dialogSubmitObject:H}=g.detail;B.addChild(O,H)},b=(g,O,H)=>{B.deleteMeasure(O)},k=(g,O,H,ae)=>{B.deleteSubmeasure(O,H)},w=(g,O,H)=>{B.saveTechniques(O,H),ne.reset()},q=(g,O,H)=>{H.click()},S=(g,O)=>{B.saveMeasureColor(O,g.srcElement.value)},D=g=>c[g],L=g=>o.measures[g.toLowerCase()],P=(g,O)=>m(O,g),U=(g,O,H)=>f(g),T=(g,O,H)=>b(H,g),Z=(g,O,H)=>q(H,g,u[O]);function te(g,O){pe[g?"unshift":"push"](()=>{u[O]=g,l(4,u)})}const C=(g,O,H)=>S(H,g,u[O]),M=(g,O,H)=>n(H,g),F=(g,O)=>a(O,n,g),Q=g=>o.measures[g.toLowerCase()],R=(g,O,H)=>m(H,g),le=(g,O,H,ae)=>k(ae,g,O),ue=(g,O,H)=>n(H,g),fe=(g,O)=>a(O,n,g),de=g=>w(g,i.treeMap,c),oe=g=>v(g);function me(g){pe[g?"unshift":"push"](()=>{r=g,l(2,r)})}return t.$$.update=()=>{var g;t.$$.dirty[0]&2&&l(6,s=(g=o==null?void 0:o.portfolios)==null?void 0:g[o==null?void 0:o.selectedPortfolio]),t.$$.dirty[0]&1&&l(5,h=!Object.values(c).some(O=>O))},[c,o,r,d,u,h,s,i,n,a,m,f,v,b,k,w,q,S,D,L,P,U,T,Z,te,C,M,F,Q,R,le,ue,fe,de,oe,me]}class Vt extends ke{constructor(e){super(),we(this,e,Ht,zt,Ee,{},null,[-1,-1])}}const Zt=t=>({}),Xe=t=>({id:"matrix-slot"}),Ut=t=>({}),Qe=t=>({});function Ye(t){let e,l,s;const o=t[4].drawer,i=lt(o,t,t[3],Qe);return{c(){e=$("aside"),i&&i.c(),this.h()},l(r){e=N(r,"ASIDE",{id:!0,class:!0});var d=I(e);i&&i.l(d),d.forEach(_),this.h()},h(){p(e,"id","container-drawer"),p(e,"class","svelte-7kkfa5"),se(e,"drawer-closed",!t[0].isDrawerOpen)},m(r,d){V(r,e,d),i&&i.m(e,null),s=!0},p(r,d){t=r,i&&i.p&&(!s||d&8)&&nt(i,o,t,t[3],s?ot(o,t[3],d,Ut):rt(t[3]),Qe),(!s||d&1)&&se(e,"drawer-closed",!t[0].isDrawerOpen)},i(r){s||(y(i,r),Te(()=>{s&&(l||(l=be(e,je,{axis:"x",duration:qe},!0)),l.run(1))}),s=!0)},o(r){A(i,r),l||(l=be(e,je,{axis:"x",duration:qe},!1)),l.run(0),s=!1},d(r){r&&_(e),i&&i.d(r),r&&l&&l.end()}}}function We(t){let e,l,s,o,i,r,d,u,h;return{c(){e=$("div"),l=$("div"),s=$("button"),o=W("Drawer"),i=j(),r=$("button"),d=W("Select None"),this.h()},l(c){e=N(c,"DIV",{id:!0,class:!0});var n=I(e);l=N(n,"DIV",{id:!0});var a=I(l);s=N(a,"BUTTON",{class:!0});var m=I(s);o=x(m,"Drawer"),m.forEach(_),i=z(a),r=N(a,"BUTTON",{class:!0});var f=I(r);d=x(f,"Select None"),f.forEach(_),a.forEach(_),n.forEach(_),this.h()},h(){p(s,"class","svelte-7kkfa5"),p(r,"class","svelte-7kkfa5"),p(l,"id","matrix-btns"),p(e,"id","container-btns"),p(e,"class","svelte-7kkfa5")},m(c,n){V(c,e,n),E(e,l),E(l,s),E(s,o),E(l,i),E(l,r),E(r,d),u||(h=[ee(s,"click",t[1]),ee(r,"click",t[2])],u=!0)},p:Y,d(c){c&&_(e),u=!1,Ce(h)}}}function Rt(t){let e,l,s,o,i,r=t[0].isDrawerOpen&&Ye(t);const d=t[4].matrix,u=lt(d,t,t[3],Xe);let h=!t[0].isReadonly&&We(t);return{c(){e=$("main"),r&&r.c(),l=j(),s=$("section"),u&&u.c(),o=j(),h&&h.c(),this.h()},l(c){e=N(c,"MAIN",{style:!0,class:!0});var n=I(e);r&&r.l(n),l=z(n),s=N(n,"SECTION",{id:!0,class:!0});var a=I(s);u&&u.l(a),o=z(a),h&&h.l(a),a.forEach(_),n.forEach(_),this.h()},h(){p(s,"id","container-matrix"),p(s,"class","svelte-7kkfa5"),se(s,"expand-matrix",t[0].isDrawerOpen),ie(e,"--drawer-width",Bt),ie(e,"--ANIMATION_TIMING",qe),p(e,"class","svelte-7kkfa5")},m(c,n){V(c,e,n),r&&r.m(e,null),E(e,l),E(e,s),u&&u.m(s,null),E(s,o),h&&h.m(s,null),i=!0},p(c,[n]){c[0].isDrawerOpen?r?(r.p(c,n),n&1&&y(r,1)):(r=Ye(c),r.c(),y(r,1),r.m(e,l)):r&&(_e(),A(r,1,1,()=>{r=null}),ge()),u&&u.p&&(!i||n&8)&&nt(u,d,c,c[3],i?ot(d,c[3],n,Zt):rt(c[3]),Xe),c[0].isReadonly?h&&(h.d(1),h=null):h?h.p(c,n):(h=We(c),h.c(),h.m(s,null)),(!i||n&1)&&se(s,"expand-matrix",c[0].isDrawerOpen)},i(c){i||(y(r),y(u,c),i=!0)},o(c){A(r),A(u,c),i=!1},d(c){c&&_(e),r&&r.d(),u&&u.d(c),h&&h.d()}}}const qe=1e3;let Bt="25vw";function Gt(t,e,l){let s;ce(t,B,u=>l(0,s=u));let{$$slots:o={},$$scope:i}=e;const r=()=>{re(B,s.isDrawerOpen=!s.isDrawerOpen,s)},d=()=>{ne.reset("test")};return t.$$set=u=>{"$$scope"in u&&l(3,i=u.$$scope)},[s,r,d,i,o]}class Kt extends ke{constructor(e){super(),we(this,e,Gt,Rt,Ee,{})}}const{window:Jt}=pt;function Xt(t){let e,l;return e=new Vt({props:{slot:"drawer"}}),{c(){G(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,o){J(e,s,o),l=!0},p:Y,i(s){l||(y(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){X(e,s)}}}function Qt(t){let e,l;return e=new Ct({props:{treeStore:t[2],theme:"poster",slot:"matrix"}}),e.$on("elementClick",t[5]),{c(){G(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,o){J(e,s,o),l=!0},p(s,o){const i={};o&4&&(i.treeStore=s[2]),e.$set(i)},i(s){l||(y(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){X(e,s)}}}function Yt(t){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function Wt(t){let e,l,s=t[3]&&xe(t);return{c(){s&&s.c(),e=Ae()},l(o){s&&s.l(o),e=Ae()},m(o,i){s&&s.m(o,i),V(o,e,i),l=!0},p(o,i){o[3]?s?(s.p(o,i),i&8&&y(s,1)):(s=xe(o),s.c(),y(s,1),s.m(e.parentNode,e)):s&&(_e(),A(s,1,1,()=>{s=null}),ge())},i(o){l||(y(s),l=!0)},o(o){A(s),l=!1},d(o){s&&s.d(o),o&&_(e)}}}function xe(t){let e,l,s,o,i,r,d;return o=new $t({props:{technique_id:t[0].technique_id,technique:t[13]}}),{c(){e=$("button"),l=W("esc"),s=j(),G(o.$$.fragment)},l(u){e=N(u,"BUTTON",{});var h=I(e);l=x(h,"esc"),h.forEach(_),s=z(u),K(o.$$.fragment,u)},m(u,h){V(u,e,h),E(e,l),V(u,s,h),J(o,u,h),i=!0,r||(d=ee(e,"click",Pe(t[6])),r=!0)},p(u,h){const c={};h&1&&(c.technique_id=u[0].technique_id),h&8&&(c.technique=u[13]),o.$set(c)},i(u){i||(y(o.$$.fragment,u),i=!0)},o(u){A(o.$$.fragment,u),i=!1},d(u){u&&_(e),u&&_(s),X(o,u),r=!1,d()}}}function xt(t){let e,l;return{c(){e=$("span"),l=W("loading...")},l(s){e=N(s,"SPAN",{});var o=I(e);l=x(o,"loading..."),o.forEach(_)},m(s,o){V(s,e,o),E(e,l)},p:Y,i:Y,o:Y,d(s){s&&_(e)}}}function es(t){let e,l,s,o,i,r,d,u,h,c;e=new Mt({props:{title:"Embedded D3FEND Matrix",og_title:"MITRE Embedded D3FEND Measures",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Measures Analysis."}}),o=new Kt({props:{$$slots:{matrix:[Qt],drawer:[Xt]},$$scope:{ctx:t}}});let n={ctx:t,current:null,token:null,hasCatch:!1,pending:xt,then:Wt,catch:Yt,value:13,blocks:[,,,]};return ye(d=t[3],n),{c(){G(e.$$.fragment),l=j(),s=$("main"),G(o.$$.fragment),i=j(),r=$("dialog"),n.block.c(),this.h()},l(a){K(e.$$.fragment,a),l=z(a),s=N(a,"MAIN",{});var m=I(s);K(o.$$.fragment,m),i=z(m),r=N(m,"DIALOG",{class:!0});var f=I(r);n.block.l(f),f.forEach(_),m.forEach(_),this.h()},h(){p(r,"class","technique-dialog")},m(a,m){J(e,a,m),V(a,l,m),V(a,s,m),J(o,s,null),E(s,i),E(s,r),n.block.m(r,n.anchor=null),n.mount=()=>r,n.anchor=null,t[9](r),u=!0,h||(c=[ee(Jt,"message",t[4]),ee(r,"close",Pe(t[6]))],h=!0)},p(a,[m]){t=a;const f={};m&16388&&(f.$$scope={dirty:m,ctx:t}),o.$set(f),n.ctx=t,m&8&&d!==(d=t[3])&&ye(d,n)||mt(n,t,m)},i(a){u||(y(e.$$.fragment,a),y(o.$$.fragment,a),y(n.block),u=!0)},o(a){A(e.$$.fragment,a),A(o.$$.fragment,a);for(let m=0;m<3;m+=1){const f=n.blocks[m];A(f)}u=!1},d(a){X(e,a),a&&_(l),a&&_(s),X(o),n.block.d(),n.token=null,n=null,t[9](null),h=!1,Ce(c)}}}function ts(t,e,l){let s,o,i;ce(t,ne,b=>l(10,s=b)),ce(t,B,b=>l(11,o=b)),ce(t,_t,b=>l(8,i=b));let{data:r}=e,d,u=null,h,c;ht(()=>{l(2,d=Tt(B,ne)),window.parent.postMessage({call:"FromParent",value:o},"*"),l(7,h=document.getElementsByTagName("body")[0])}),gt(()=>{h==null||h.classList.remove("scroll--none")});const n=b=>{re(B,o=b.data.value,o)},a=b=>{const k=b.detail.element["@id"];if(console.log({event:b}),!b.detail.event.ctrlKey&&!b.detail.event.metaKey){const w=b.detail.element["@id"];l(3,u=f(w)),Se(`/profile?technique_id=${w}`);return}s.treeMap[k].classes.isSelected?(re(ne,s.treeMap[k].classes.select="",s),re(ne,s.treeMap[k].classes.isSelected=!1,s)):(re(ne,s.treeMap[k].classes.select="3px solid red",s),re(ne,s.treeMap[k].classes.isSelected=!0,s))},m=()=>{c.close(),Se("/profile")},f=async b=>{const k=await fetch(`/api/technique/${b}.json`),w=await k.json();if(k.ok)return w;throw new Error(w)};function v(b){pe[b?"unshift":"push"](()=>{c=b,l(1,c)})}return t.$$set=b=>{"data"in b&&l(0,r=b.data)},t.$$.update=()=>{t.$$.dirty&386&&(c&&i.url.searchParams.size?(c.showModal(),h==null||h.classList.add("scroll--none")):c&&(c.close(),h==null||h.classList.remove("scroll--none")))},[r,c,d,u,n,a,m,h,i,v]}class hs extends ke{constructor(e){super(),we(this,e,ts,es,Ee,{data:0})}}export{hs as default};
