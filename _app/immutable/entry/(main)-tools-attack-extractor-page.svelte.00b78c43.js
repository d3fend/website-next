import{S as Qe,b as We,s as Ze,J as Te,y as pe,j as H,f as u,h as D,z as ve,p as K,k as h,l as _,m as A,o,G as T,A as me,q as R,v as r,a3 as He,P as he,K as Je,t as ne,e as fe,B as be,r as xe,x as et,C as tt,H as we,w as ae,n as se,E as _e,N as Xe,O as Ye,I as Ne,X as Ke}from"../chunks/index.f8777a79.js";import{a as lt,S as ze}from"../chunks/extract.0c35dabe.js";import{G as Ve,f as De,g as Re,a as ue}from"../chunks/lib.576aa631.js";import{T as rt}from"../chunks/Title.b950d120.js";import{H as at}from"../chunks/Header.ce4cf16f.js";import{A as st}from"../chunks/Alert.eb4712db.js";import{p as ot}from"../chunks/stores.ceda234b.js";function Be(f,e,t){const l=f.slice();return l[21]=e[t],l}function Fe(f,e,t){const l=f.slice();return l[25]=e[t],l}function je(f,e,t){const l=f.slice();return l[29]=e[t],l}function nt(f){let e,t,l=f[28].message+"",s;return{c(){e=u("p"),t=D("error with promise: "),s=D(l),this.h()},l(n){e=h(n,"P",{style:!0});var a=_(e);t=A(a,"error with promise: "),s=A(a,l),a.forEach(o),this.h()},h(){we(e,"color","red")},m(n,a){R(n,e,a),r(e,t),r(e,s)},p(n,a){a[0]&32&&l!==(l=n[28].message+"")&&ae(s,l)},i:se,o:se,d(n){n&&o(e)}}}function ft(f){let e,t,l,s;const n=[it,ct],a=[];function i(c,v){return c[20].length>0?0:!c[3]&&c[20].length<1?1:-1}return~(e=i(f))&&(t=a[e]=n[e](f)),{c(){t&&t.c(),l=_e()},l(c){t&&t.l(c),l=_e()},m(c,v){~e&&a[e].m(c,v),R(c,l,v),s=!0},p(c,v){let y=e;e=i(c),e===y?~e&&a[e].p(c,v):(t&&(Xe(),fe(a[y],1,1,()=>{a[y]=null}),Ye()),~e?(t=a[e],t?t.p(c,v):(t=a[e]=n[e](c),t.c()),ne(t,1),t.m(l.parentNode,l)):t=null)},i(c){s||(ne(t),s=!0)},o(c){fe(t),s=!1},d(c){~e&&a[e].d(c),c&&o(l)}}}function ct(f){let e,t;return{c(){e=u("div"),t=D("No ATT&CK techniques found in text."),this.h()},l(l){e=h(l,"DIV",{class:!0});var s=_(e);t=A(s,"No ATT&CK techniques found in text."),s.forEach(o),this.h()},h(){T(e,"class","card")},m(l,s){R(l,e,s),r(e,t)},p:se,i:se,o:se,d(l){l&&o(e)}}}function it(f){let e,t,l,s,n,a,i,c,v,y,E,g,k,G,M,I,d,F,j,q,z,b,N,P,X,J,Q,ee,Z,x,le,S,m,L,w,$=f[0]&&Pe(f);s=new st({props:{$$slots:{default:[ut]},$$scope:{ctx:f}}}),v=new ze({props:{url:f[6].url}});function C(p,Y){return p[2]?_t:ht}let O=C(f),V=O(f),U=f[20],B=[];for(let p=0;p<U.length;p+=1)B[p]=Le(Be(f,U,p));return{c(){e=u("div"),$&&$.c(),t=H(),l=u("div"),pe(s.$$.fragment),n=H(),a=u("div"),i=u("div"),c=u("div"),pe(v.$$.fragment),y=H(),E=u("div"),g=u("b"),k=u("i"),G=D("Mapping Results:"),M=H(),I=u("div"),d=u("div"),V.c(),F=H(),j=u("button"),q=D("copy"),z=H(),b=u("table"),N=u("thead"),P=u("th"),X=D("ATT&CK ID"),J=H(),Q=u("th"),ee=D("ATT&CK Name"),Z=H(),x=u("th"),le=D("Related D3FEND Techniques"),S=H();for(let p=0;p<B.length;p+=1)B[p].c();this.h()},l(p){e=h(p,"DIV",{class:!0});var Y=_(e);$&&$.l(Y),Y.forEach(o),t=K(p),l=h(p,"DIV",{class:!0});var te=_(l);ve(s.$$.fragment,te),te.forEach(o),n=K(p),a=h(p,"DIV",{class:!0});var re=_(a);i=h(re,"DIV",{class:!0});var W=_(i);c=h(W,"DIV",{class:!0});var oe=_(c);ve(v.$$.fragment,oe),oe.forEach(o),W.forEach(o),y=K(re),E=h(re,"DIV",{});var ce=_(E);g=h(ce,"B",{});var de=_(g);k=h(de,"I",{});var Ie=_(k);G=A(Ie,"Mapping Results:"),Ie.forEach(o),de.forEach(o),ce.forEach(o),M=K(re),I=h(re,"DIV",{class:!0});var Ee=_(I);d=h(Ee,"DIV",{class:!0});var ge=_(d);V.l(ge),F=K(ge),j=h(ge,"BUTTON",{});var $e=_(j);q=A($e,"copy"),$e.forEach(o),ge.forEach(o),z=K(Ee),b=h(Ee,"TABLE",{id:!0,class:!0});var ke=_(b);N=h(ke,"THEAD",{});var ie=_(N);P=h(ie,"TH",{class:!0});var ye=_(P);X=A(ye,"ATT&CK ID"),ye.forEach(o),J=K(ie),Q=h(ie,"TH",{});var Ce=_(Q);ee=A(Ce,"ATT&CK Name"),Ce.forEach(o),Z=K(ie),x=h(ie,"TH",{});var qe=_(x);le=A(qe,"Related D3FEND Techniques"),qe.forEach(o),ie.forEach(o),S=K(ke);for(let Ae=0;Ae<B.length;Ae+=1)B[Ae].l(ke);ke.forEach(o),Ee.forEach(o),re.forEach(o),this.h()},h(){T(e,"class","card"),T(l,"class","card"),T(c,"class","text-right"),T(i,"class","stretch"),T(d,"class","text-right"),T(P,"class","stretch"),T(b,"id","mappings"),T(b,"class","table-auto"),T(I,"class","results-wrap center svelte-xumjr3"),T(a,"class","card")},m(p,Y){R(p,e,Y),$&&$.m(e,null),R(p,t,Y),R(p,l,Y),me(s,l,null),R(p,n,Y),R(p,a,Y),r(a,i),r(i,c),me(v,c,null),r(a,y),r(a,E),r(E,g),r(g,k),r(k,G),r(a,M),r(a,I),r(I,d),V.m(d,null),r(d,F),r(d,j),r(j,q),r(I,z),r(I,b),r(b,N),r(N,P),r(P,X),r(N,J),r(N,Q),r(Q,ee),r(N,Z),r(N,x),r(x,le),r(b,S);for(let te=0;te<B.length;te+=1)B[te]&&B[te].m(b,null);m=!0,L||(w=he(j,"click",kt),L=!0)},p(p,Y){p[0]?$?($.p(p,Y),Y[0]&1&&ne($,1)):($=Pe(p),$.c(),ne($,1),$.m(e,null)):$&&(Xe(),fe($,1,1,()=>{$=null}),Ye());const te={};Y[1]&2&&(te.$$scope={dirty:Y,ctx:p}),s.$set(te);const re={};if(Y[0]&64&&(re.url=p[6].url),v.$set(re),O===(O=C(p))&&V?V.p(p,Y):(V.d(1),V=O(p),V&&(V.c(),V.m(d,F))),Y[0]&48){U=p[20];let W;for(W=0;W<U.length;W+=1){const oe=Be(p,U,W);B[W]?B[W].p(oe,Y):(B[W]=Le(oe),B[W].c(),B[W].m(b,null))}for(;W<B.length;W+=1)B[W].d(1);B.length=U.length}},i(p){m||(ne($),ne(s.$$.fragment,p),ne(v.$$.fragment,p),m=!0)},o(p){fe($),fe(s.$$.fragment,p),fe(v.$$.fragment,p),m=!1},d(p){p&&o(e),$&&$.d(),p&&o(t),p&&o(l),be(s),p&&o(n),p&&o(a),be(v),V.d(),Ne(B,p),L=!1,w()}}}function Pe(f){let e,t,l,s,n,a,i,c,v=f[0].length+"",y,E,g,k,G;l=new ze({props:{url:f[6].url}});let M=f[0],I=[];for(let d=0;d<M.length;d+=1)I[d]=Se(je(f,M,d));return{c(){e=u("div"),t=u("div"),pe(l.$$.fragment),s=H(),n=u("div"),a=u("b"),i=u("i"),c=D("Extracted "),y=D(v),E=D(" unique IDs:"),g=H(),k=u("dl");for(let d=0;d<I.length;d+=1)I[d].c();this.h()},l(d){e=h(d,"DIV",{class:!0});var F=_(e);t=h(F,"DIV",{class:!0});var j=_(t);ve(l.$$.fragment,j),j.forEach(o),F.forEach(o),s=K(d),n=h(d,"DIV",{class:!0});var q=_(n);a=h(q,"B",{});var z=_(a);i=h(z,"I",{});var b=_(i);c=A(b,"Extracted "),y=A(b,v),E=A(b," unique IDs:"),b.forEach(o),z.forEach(o),g=K(q),k=h(q,"DL",{class:!0});var N=_(k);for(let P=0;P<I.length;P+=1)I[P].l(N);N.forEach(o),q.forEach(o),this.h()},h(){T(t,"class","text-right"),T(e,"class","stretch"),T(k,"class","flex flex-wrap svelte-xumjr3"),T(n,"class","")},m(d,F){R(d,e,F),r(e,t),me(l,t,null),R(d,s,F),R(d,n,F),r(n,a),r(a,i),r(i,c),r(i,y),r(i,E),r(n,g),r(n,k);for(let j=0;j<I.length;j+=1)I[j]&&I[j].m(k,null);G=!0},p(d,F){const j={};if(F[0]&64&&(j.url=d[6].url),l.$set(j),(!G||F[0]&1)&&v!==(v=d[0].length+"")&&ae(y,v),F[0]&1){M=d[0];let q;for(q=0;q<M.length;q+=1){const z=je(d,M,q);I[q]?I[q].p(z,F):(I[q]=Se(z),I[q].c(),I[q].m(k,null))}for(;q<I.length;q+=1)I[q].d(1);I.length=M.length}},i(d){G||(ne(l.$$.fragment,d),G=!0)},o(d){fe(l.$$.fragment,d),G=!1},d(d){d&&o(e),be(l),d&&o(s),d&&o(n),Ne(I,d)}}}function Se(f){let e,t,l=f[29]+"",s,n;return{c(){e=u("dd"),t=u("a"),s=D(l),this.h()},l(a){e=h(a,"DD",{});var i=_(e);t=h(i,"A",{href:!0});var c=_(t);s=A(c,l),c.forEach(o),i.forEach(o),this.h()},h(){T(t,"href",n=De(f[29]))},m(a,i){R(a,e,i),r(e,t),r(t,s)},p(a,i){i[0]&1&&l!==(l=a[29]+"")&&ae(s,l),i[0]&1&&n!==(n=De(a[29]))&&T(t,"href",n)},d(a){a&&o(e)}}}function ut(f){let e,t,l;return{c(){e=u("b"),t=D("Note: "),l=D(`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},l(s){e=h(s,"B",{});var n=_(e);t=A(n,"Note: "),n.forEach(o),l=A(s,`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},m(s,n){R(s,e,n),r(e,t),R(s,l,n)},p:se,d(s){s&&o(e),s&&o(l)}}}function ht(f){let e,t,l,s;return{c(){e=u("button"),t=D("select"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var a=_(e);t=A(a,"select"),a.forEach(o),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(n,a){R(n,e,a),r(e,t),l||(s=he(e,"click",f[9]),l=!0)},p:se,d(n){n&&o(e),l=!1,s()}}}function _t(f){let e,t,l,s;return{c(){e=u("button"),t=D("deselect"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var a=_(e);t=A(a,"deselect"),a.forEach(o),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(n,a){R(n,e,a),r(e,t),l||(s=he(e,"click",f[8]),l=!0)},p:se,d(n){n&&o(e),l=!1,s()}}}function dt(f){let e,t,l=f[28].message+"",s,n,a=console.log(f[28])+"",i;return{c(){e=u("p"),t=D("error with row: "),s=D(l),n=H(),i=D(a),this.h()},l(c){e=h(c,"P",{style:!0});var v=_(e);t=A(v,"error with row: "),s=A(v,l),v.forEach(o),n=K(c),i=A(c,a),this.h()},h(){we(e,"color","red")},m(c,v){R(c,e,v),r(e,t),r(e,s),R(c,n,v),R(c,i,v)},p(c,v){v[0]&32&&l!==(l=c[28].message+"")&&ae(s,l),v[0]&32&&a!==(a=console.log(c[28])+"")&&ae(i,a)},d(c){c&&o(e),c&&o(n),c&&o(i)}}}function pt(f){let e;function t(n,a){return n[24].description.graph[0]?mt:vt}let l=t(f),s=l(f);return{c(){s.c(),e=_e()},l(n){s.l(n),e=_e()},m(n,a){s.m(n,a),R(n,e,a)},p(n,a){l===(l=t(n))&&s?s.p(n,a):(s.d(1),s=l(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){s.d(n),n&&o(e)}}}function vt(f){let e,t,l=f[24].id+"",s,n,a,i,c,v,y;return{c(){e=u("td"),t=u("a"),s=D(l),a=H(),i=u("td"),c=D("not found in D3FEND graph"),v=H(),y=u("td"),this.h()},l(E){e=h(E,"TD",{class:!0});var g=_(e);t=h(g,"A",{style:!0,href:!0});var k=_(t);s=A(k,l),k.forEach(o),g.forEach(o),a=K(E),i=h(E,"TD",{});var G=_(i);c=A(G,"not found in D3FEND graph"),G.forEach(o),v=K(E),y=h(E,"TD",{}),_(y).forEach(o),this.h()},h(){we(t,"color","red"),T(t,"href",n=Re(f[24].id)),T(e,"class","text-center")},m(E,g){R(E,e,g),r(e,t),r(t,s),R(E,a,g),R(E,i,g),r(i,c),R(E,v,g),R(E,y,g)},p(E,g){g[0]&32&&l!==(l=E[24].id+"")&&ae(s,l),g[0]&32&&n!==(n=Re(E[24].id))&&T(t,"href",n)},d(E){E&&o(e),E&&o(a),E&&o(i),E&&o(v),E&&o(y)}}}function mt(f){let e,t,l=f[24].description.graph[0]["d3f:attack-id"]+"",s,n,a,i,c=f[24].description.graph[0]["rdfs:label"]+"",v,y,E,g,k,G,M,I,d,F,j,q,z,b,N,P,X,J,Q,ee,Z,x,le,S=Me(f[24].off_to_def.results.bindings),m=[];for(let w=0;w<S.length;w+=1)m[w]=Ue(Fe(f,S,w));let L=null;return S.length||(L=Oe()),{c(){e=u("th"),t=u("a"),s=D(l),a=H(),i=u("td"),v=D(c),y=H(),E=u("td"),g=u("table"),k=u("thead"),G=u("th"),M=D("off rel"),I=H(),d=u("th"),F=D("off artifact"),j=H(),q=u("th"),z=D("D3FEND Tactic"),b=H(),N=u("th"),P=D("D3FEND Technique"),X=H(),J=u("th"),Q=D("def rel"),ee=H(),Z=u("th"),x=D("def artifact"),le=H();for(let w=0;w<m.length;w+=1)m[w].c();L&&L.c(),this.h()},l(w){e=h(w,"TH",{class:!0,scope:!0});var $=_(e);t=h($,"A",{href:!0});var C=_(t);s=A(C,l),C.forEach(o),$.forEach(o),a=K(w),i=h(w,"TD",{});var O=_(i);v=A(O,c),O.forEach(o),y=K(w),E=h(w,"TD",{});var V=_(E);g=h(V,"TABLE",{class:!0});var U=_(g);k=h(U,"THEAD",{class:!0});var B=_(k);G=h(B,"TH",{scope:!0});var p=_(G);M=A(p,"off rel"),p.forEach(o),I=K(B),d=h(B,"TH",{scope:!0});var Y=_(d);F=A(Y,"off artifact"),Y.forEach(o),j=K(B),q=h(B,"TH",{scope:!0});var te=_(q);z=A(te,"D3FEND Tactic"),te.forEach(o),b=K(B),N=h(B,"TH",{scope:!0});var re=_(N);P=A(re,"D3FEND Technique"),re.forEach(o),X=K(B),J=h(B,"TH",{scope:!0});var W=_(J);Q=A(W,"def rel"),W.forEach(o),ee=K(B),Z=h(B,"TH",{scope:!0});var oe=_(Z);x=A(oe,"def artifact"),oe.forEach(o),B.forEach(o),le=K(U);for(let ce=0;ce<m.length;ce+=1)m[ce].l(U);L&&L.l(U),U.forEach(o),V.forEach(o),this.h()},h(){T(t,"href",n=De(f[24].id)),T(e,"class","text-center"),T(e,"scope","row"),T(G,"scope","col"),T(d,"scope","col"),T(q,"scope","col"),T(N,"scope","col"),T(J,"scope","col"),T(Z,"scope","col"),T(k,"class","svelte-xumjr3"),Ke(k,"hide",f[4]),T(g,"class","table-auto w100 svelte-xumjr3")},m(w,$){R(w,e,$),r(e,t),r(t,s),R(w,a,$),R(w,i,$),r(i,v),R(w,y,$),R(w,E,$),r(E,g),r(g,k),r(k,G),r(G,M),r(k,I),r(k,d),r(d,F),r(k,j),r(k,q),r(q,z),r(k,b),r(k,N),r(N,P),r(k,X),r(k,J),r(J,Q),r(k,ee),r(k,Z),r(Z,x),r(g,le);for(let C=0;C<m.length;C+=1)m[C]&&m[C].m(g,null);L&&L.m(g,null)},p(w,$){if($[0]&32&&l!==(l=w[24].description.graph[0]["d3f:attack-id"]+"")&&ae(s,l),$[0]&32&&n!==(n=De(w[24].id))&&T(t,"href",n),$[0]&32&&c!==(c=w[24].description.graph[0]["rdfs:label"]+"")&&ae(v,c),$[0]&16&&Ke(k,"hide",w[4]),$[0]&32){S=Me(w[24].off_to_def.results.bindings);let C;for(C=0;C<S.length;C+=1){const O=Fe(w,S,C);m[C]?m[C].p(O,$):(m[C]=Ue(O),m[C].c(),m[C].m(g,null))}for(;C<m.length;C+=1)m[C].d(1);m.length=S.length,!S.length&&L?L.p(w,$):S.length?L&&(L.d(1),L=null):(L=Oe(),L.c(),L.m(g,null))}},d(w){w&&o(e),w&&o(a),w&&o(i),w&&o(y),w&&o(E),Ne(m,w),L&&L.d()}}}function Oe(f){let e,t,l,s,n;return{c(){e=u("td"),t=D("no defensive relations "),l=u("a"),s=D("yet"),n=H(),this.h()},l(a){e=h(a,"TD",{colspan:!0});var i=_(e);t=A(i,"no defensive relations "),l=h(i,"A",{href:!0});var c=_(l);s=A(c,"yet"),c.forEach(o),n=K(i),i.forEach(o),this.h()},h(){T(l,"href","/contribute"),T(e,"colspan","5")},m(a,i){R(a,e,i),r(e,t),r(e,l),r(l,s),r(e,n)},p:se,d(a){a&&o(e)}}}function Ge(f){let e,t,l=f[25].off_artifact_rel_label.value+"",s,n,a,i,c=f[25].off_artifact_label.value+"",v,y,E,g,k=f[25].def_tactic_label.value+"",G,M,I,d,F=f[25].def_tech_label.value+"",j,q,z,b,N=f[25].def_artifact_rel_label.value+"",P,X,J,Q,ee=f[25].def_artifact_label.value+"",Z,x,le;return{c(){e=u("tr"),t=u("td"),s=D(l),n=H(),a=u("td"),i=u("a"),v=D(c),E=H(),g=u("td"),G=D(k),M=H(),I=u("td"),d=u("a"),j=D(F),z=H(),b=u("td"),P=D(N),X=H(),J=u("td"),Q=u("a"),Z=D(ee),le=H(),this.h()},l(S){e=h(S,"TR",{});var m=_(e);t=h(m,"TD",{});var L=_(t);s=A(L,l),L.forEach(o),n=K(m),a=h(m,"TD",{});var w=_(a);i=h(w,"A",{href:!0});var $=_(i);v=A($,c),$.forEach(o),w.forEach(o),E=K(m),g=h(m,"TD",{});var C=_(g);G=A(C,k),C.forEach(o),M=K(m),I=h(m,"TD",{});var O=_(I);d=h(O,"A",{href:!0});var V=_(d);j=A(V,F),V.forEach(o),O.forEach(o),z=K(m),b=h(m,"TD",{});var U=_(b);P=A(U,N),U.forEach(o),X=K(m),J=h(m,"TD",{});var B=_(J);Q=h(B,"A",{href:!0});var p=_(Q);Z=A(p,ee),p.forEach(o),B.forEach(o),le=K(m),m.forEach(o),this.h()},h(){T(i,"href",y="/dao/artifact/"+ue(f[25].off_artifact.value)),T(d,"href",q="/technique/"+ue(f[25].def_tech.value)),T(Q,"href",x="/dao/artifact/"+ue(f[25].def_artifact.value))},m(S,m){R(S,e,m),r(e,t),r(t,s),r(e,n),r(e,a),r(a,i),r(i,v),r(e,E),r(e,g),r(g,G),r(e,M),r(e,I),r(I,d),r(d,j),r(e,z),r(e,b),r(b,P),r(e,X),r(e,J),r(J,Q),r(Q,Z),r(e,le)},p(S,m){m[0]&32&&l!==(l=S[25].off_artifact_rel_label.value+"")&&ae(s,l),m[0]&32&&c!==(c=S[25].off_artifact_label.value+"")&&ae(v,c),m[0]&32&&y!==(y="/dao/artifact/"+ue(S[25].off_artifact.value))&&T(i,"href",y),m[0]&32&&k!==(k=S[25].def_tactic_label.value+"")&&ae(G,k),m[0]&32&&F!==(F=S[25].def_tech_label.value+"")&&ae(j,F),m[0]&32&&q!==(q="/technique/"+ue(S[25].def_tech.value))&&T(d,"href",q),m[0]&32&&N!==(N=S[25].def_artifact_rel_label.value+"")&&ae(P,N),m[0]&32&&ee!==(ee=S[25].def_artifact_label.value+"")&&ae(Z,ee),m[0]&32&&x!==(x="/dao/artifact/"+ue(S[25].def_artifact.value))&&T(Q,"href",x)},d(S){S&&o(e)}}}function Ue(f){let e,t=f[25].def_tech&&Ge(f);return{c(){t&&t.c(),e=_e()},l(l){t&&t.l(l),e=_e()},m(l,s){t&&t.m(l,s),R(l,e,s)},p(l,s){l[25].def_tech?t?t.p(l,s):(t=Ge(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&o(e)}}}function bt(f){let e;return{c(){e=D("loading...")},l(t){e=A(t,"loading...")},m(t,l){R(t,e,l)},p:se,d(t){t&&o(e)}}}function Le(f){let e,t,l,s={ctx:f,current:null,token:null,hasCatch:!0,pending:bt,then:pt,catch:dt,value:24,error:28};return Te(t=f[21],s),{c(){e=u("tr"),s.block.c(),l=H()},l(n){e=h(n,"TR",{});var a=_(e);s.block.l(a),l=K(a),a.forEach(o)},m(n,a){R(n,e,a),s.block.m(e,s.anchor=null),s.mount=()=>e,s.anchor=l,r(e,l)},p(n,a){f=n,s.ctx=f,a[0]&32&&t!==(t=f[21])&&Te(t,s)||Je(s,f,a)},d(n){n&&o(e),s.block.d(),s.token=null,s=null}}}function Et(f){let e;return{c(){e=D("enter text and click go")},l(t){e=A(t,"enter text and click go")},m(t,l){R(t,e,l)},p:se,i:se,o:se,d(t){t&&o(e)}}}function gt(f){let e,t,l,s,n,a,i,c,v,y,E,g,k,G,M,I,d,F,j,q,z,b,N,P,X,J,Q,ee,Z,x,le,S,m,L,w,$;e=new rt({props:{title:"ATT&CK Extractor | Tools | "}}),s=new at({});let C={ctx:f,current:null,token:null,hasCatch:!0,pending:Et,then:ft,catch:nt,value:20,error:28,blocks:[,,,]};return Te(m=f[5],C),{c(){pe(e.$$.fragment),t=H(),l=u("section"),pe(s.$$.fragment),n=H(),a=u("div"),i=u("h1"),c=D("ATT&CK Extractor"),v=H(),y=u("p"),E=D(`Extracts ATT&CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the `),g=u("a"),k=D("D3FEND Extractor"),G=D(`
      or the `),M=u("a"),I=D("Artifact Extractor."),d=H(),F=u("p"),j=u("i"),q=D("Paste any text containing ATT&CK IDs:"),z=H(),b=u("div"),N=u("textarea"),P=H(),X=u("div"),J=u("button"),Q=D("GO"),ee=H(),Z=u("br"),x=H(),le=u("br"),S=H(),C.block.c(),this.h()},l(O){ve(e.$$.fragment,O),t=K(O),l=h(O,"SECTION",{class:!0});var V=_(l);ve(s.$$.fragment,V),n=K(V),a=h(V,"DIV",{class:!0});var U=_(a);i=h(U,"H1",{});var B=_(i);c=A(B,"ATT&CK Extractor"),B.forEach(o),v=K(U),y=h(U,"P",{});var p=_(y);E=A(p,`Extracts ATT&CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the `),g=h(p,"A",{href:!0});var Y=_(g);k=A(Y,"D3FEND Extractor"),Y.forEach(o),G=A(p,`
      or the `),M=h(p,"A",{href:!0});var te=_(M);I=A(te,"Artifact Extractor."),te.forEach(o),p.forEach(o),d=K(U),F=h(U,"P",{class:!0});var re=_(F);j=h(re,"I",{});var W=_(j);q=A(W,"Paste any text containing ATT&CK IDs:"),W.forEach(o),re.forEach(o),z=K(U),b=h(U,"DIV",{});var oe=_(b);N=h(oe,"TEXTAREA",{class:!0}),_(N).forEach(o),oe.forEach(o),P=K(U),X=h(U,"DIV",{});var ce=_(X);J=h(ce,"BUTTON",{class:!0});var de=_(J);Q=A(de,"GO"),de.forEach(o),ce.forEach(o),ee=K(U),Z=h(U,"BR",{}),U.forEach(o),x=K(V),le=h(V,"BR",{}),S=K(V),C.block.l(V),V.forEach(o),this.h()},h(){T(g,"href","/tools/d3fend-extractor"),T(M,"href","/tools/artifact-extractor"),T(F,"class","text-2"),T(N,"class","svelte-xumjr3"),T(J,"class","button"),T(a,"class","card"),T(l,"class"," svelte-xumjr3")},m(O,V){me(e,O,V),R(O,t,V),R(O,l,V),me(s,l,null),r(l,n),r(l,a),r(a,i),r(i,c),r(a,v),r(a,y),r(y,E),r(y,g),r(g,k),r(y,G),r(y,M),r(M,I),r(a,d),r(a,F),r(F,j),r(j,q),r(a,z),r(a,b),r(b,N),He(N,f[1]),r(a,P),r(a,X),r(X,J),r(J,Q),r(a,ee),r(a,Z),r(l,x),r(l,le),r(l,S),C.block.m(l,C.anchor=null),C.mount=()=>l,C.anchor=null,L=!0,w||($=[he(N,"input",f[12]),he(N,"keypress",f[10]),he(J,"click",f[7])],w=!0)},p(O,V){f=O,V[0]&2&&He(N,f[1]),C.ctx=f,V[0]&32&&m!==(m=f[5])&&Te(m,C)||Je(C,f,V)},i(O){L||(ne(e.$$.fragment,O),ne(s.$$.fragment,O),ne(C.block),L=!0)},o(O){fe(e.$$.fragment,O),fe(s.$$.fragment,O);for(let V=0;V<3;V+=1){const U=C.blocks[V];fe(U)}L=!1},d(O){be(e,O),O&&o(t),O&&o(l),be(s),C.block.d(),C.token=null,C=null,w=!1,xe($)}}}function kt(){document.execCommand("copy")}function Me(f){let e=new Set,t=[];return f.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function Tt(f,e,t){let l;et(f,ot,b=>t(6,l=b));let{data:s}=e;const n=new Ve(s.techniques,{index:!0,index_key:"d3f:attack-id"});let a,i="",c=!1,v=!0,y,E=[];function g(){t(0,a=[]),t(2,c=!1),t(3,v=!0),E=[]}y=l.url.searchParams.get("q"),console.log("Found params: "+y);let k=!1;async function G(b){let N="/api/offensive-technique/attack/"+b+".json";const P=await fetch(N);if(P.status==404)return{id:b,off_to_def:[],description:{graph:[]},status:P.status};if(P.ok){const X=await P.json();return{id:b,off_to_def:X.off_to_def,description:new Ve(X.description)}}else throw console.log(`Error processing ${b}, response status: ${P.status}`),console.dir(P),new Error(`Error processing ${b}, response status: ${P.status}`)}async function M(){return g(),t(0,a=Array.from(new Set(lt(i,n)))),a?(a.forEach(function(b){let N;N=G(b),N&&E.push(N)}),l.url.searchParams.set("q",JSON.stringify(a)),history.replaceState(null,"mapping",l.url)):(g(),console.debug("no matches")),E}let I=M();function d(){t(5,I=M()),t(3,v=!1)}function F(){window.getSelection().removeAllRanges(),t(2,c=!1),t(4,k=!1)}function j(){t(4,k=!0);let b="mappings";const N=window.getSelection();N.removeAllRanges();let P=document.getElementById(b);const X=document.createRange();X.selectNodeContents(P),N.addRange(X),t(2,c=!0)}function q(b){b.ctrlKey==!0&&b.keyCode==13&&d()}tt(async()=>{y?(t(1,i=y),console.log("handlingclick"),d()):(console.log("starting blank"),t(1,i=""))});function z(){i=this.value,t(1,i)}return f.$$set=b=>{"data"in b&&t(11,s=b.data)},[a,i,c,v,k,I,l,d,F,j,q,s,z]}class Ct extends Qe{constructor(e){super(),We(this,e,Tt,gt,Ze,{data:11},null,[-1,-1])}}export{Ct as default};
