import{S as se,i as ae,s as re,G as H,k as R,a as C,q as M,l as E,m as A,h as v,c as k,r as L,n as j,T as D,b as T,H as _,M as Z,J as W,K as V,L as J,f as I,t as N,W as ke,ag as Se,E as Ue,F as ye,w as Oe,x as Me,y as Le,I as Te,z as we,u as ze}from"./index-9e687d76.js";import{i as je}from"./lib-470e6689.js";import{t as P}from"./toString-18da276d.js";function De(e,u,t){var s=-1,a=e.length;u<0&&(u=-u>a?0:a+u),t=t>a?a:t,t<0&&(t+=a),a=u>t?0:t-u>>>0,u>>>=0;for(var n=Array(a);++s<a;)n[s]=e[s+u];return n}function Ie(e,u,t){var s=e.length;return t=t===void 0?s:t,!u&&t>=s?e:De(e,u,t)}var Ne="\\ud800-\\udfff",Ze="\\u0300-\\u036f",He="\\ufe20-\\ufe2f",We="\\u20d0-\\u20ff",Ve=Ze+He+We,Je="\\ufe0e\\ufe0f",Be="\\u200d",Ge=RegExp("["+Be+Ne+Ve+Je+"]");function ne(e){return Ge.test(e)}function Pe(e){return e.split("")}var oe="\\ud800-\\udfff",Fe="\\u0300-\\u036f",qe="\\ufe20-\\ufe2f",Ye="\\u20d0-\\u20ff",Ke=Fe+qe+Ye,Qe="\\ufe0e\\ufe0f",Xe="["+oe+"]",B="["+Ke+"]",G="\\ud83c[\\udffb-\\udfff]",eu="(?:"+B+"|"+G+")",le="[^"+oe+"]",fe="(?:\\ud83c[\\udde6-\\uddff]){2}",ie="[\\ud800-\\udbff][\\udc00-\\udfff]",uu="\\u200d",de=eu+"?",ce="["+Qe+"]?",tu="(?:"+uu+"(?:"+[le,fe,ie].join("|")+")"+ce+de+")*",su=ce+de+tu,au="(?:"+[le+B+"?",B,fe,ie,Xe].join("|")+")",ru=RegExp(G+"(?="+G+")|"+au+su,"g");function nu(e){return e.match(ru)||[]}function ou(e){return ne(e)?nu(e):Pe(e)}function lu(e){return function(u){u=P(u);var t=ne(u)?ou(u):void 0,s=t?t[0]:u.charAt(0),a=t?Ie(t,1).join(""):u.slice(1);return s[e]()+a}}var fu=lu("toUpperCase");const iu=fu;function du(e,u,t,s){var a=-1,n=e==null?0:e.length;for(s&&n&&(t=e[++a]);++a<n;)t=u(t,e[a],a,e);return t}function cu(e){return function(u){return e==null?void 0:e[u]}}var hu={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},_u=cu(hu);const mu=_u;var bu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gu="\\u0300-\\u036f",pu="\\ufe20-\\ufe2f",xu="\\u20d0-\\u20ff",vu=gu+pu+xu,Ru="["+vu+"]",Eu=RegExp(Ru,"g");function F(e){return e=P(e),e&&e.replace(bu,mu).replace(Eu,"")}var $u=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Cu(e){return e.match($u)||[]}var Au=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function ku(e){return Au.test(e)}var he="\\ud800-\\udfff",Su="\\u0300-\\u036f",Uu="\\ufe20-\\ufe2f",yu="\\u20d0-\\u20ff",Ou=Su+Uu+yu,_e="\\u2700-\\u27bf",me="a-z\\xdf-\\xf6\\xf8-\\xff",Mu="\\xac\\xb1\\xd7\\xf7",Lu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Tu="\\u2000-\\u206f",wu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",be="A-Z\\xc0-\\xd6\\xd8-\\xde",zu="\\ufe0e\\ufe0f",ge=Mu+Lu+Tu+wu,pe="['’]",K="["+ge+"]",ju="["+Ou+"]",xe="\\d+",Du="["+_e+"]",ve="["+me+"]",Re="[^"+he+ge+xe+_e+me+be+"]",Iu="\\ud83c[\\udffb-\\udfff]",Nu="(?:"+ju+"|"+Iu+")",Zu="[^"+he+"]",Ee="(?:\\ud83c[\\udde6-\\uddff]){2}",$e="[\\ud800-\\udbff][\\udc00-\\udfff]",O="["+be+"]",Hu="\\u200d",Q="(?:"+ve+"|"+Re+")",Wu="(?:"+O+"|"+Re+")",X="(?:"+pe+"(?:d|ll|m|re|s|t|ve))?",ee="(?:"+pe+"(?:D|LL|M|RE|S|T|VE))?",Ce=Nu+"?",Ae="["+zu+"]?",Vu="(?:"+Hu+"(?:"+[Zu,Ee,$e].join("|")+")"+Ae+Ce+")*",Ju="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Bu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gu=Ae+Ce+Vu,Pu="(?:"+[Du,Ee,$e].join("|")+")"+Gu,Fu=RegExp([O+"?"+ve+"+"+X+"(?="+[K,O,"$"].join("|")+")",Wu+"+"+ee+"(?="+[K,O+Q,"$"].join("|")+")",O+"?"+Q+"+"+X,O+"+"+ee,Bu,Ju,xe,Pu].join("|"),"g");function qu(e){return e.match(Fu)||[]}function Yu(e,u,t){return e=P(e),u=t?void 0:u,u===void 0?ku(e)?qu(e):Cu(e):e.match(u)||[]}var Ku="['’]",Qu=RegExp(Ku,"g");function Xu(e){return function(u){return du(Yu(F(u).replace(Qu,"")),e,"")}}var et=Xu(function(e,u,t){return e+(t?" ":"")+iu(u)});const w=et;const ut=e=>({}),ue=e=>({}),tt=e=>({}),te=e=>({});function st(e){let u,t,s,a,n,d,f,o,g,b,l,i,m,S,z;const $=e[3].header,c=H($,e,e[2],te),U=e[3].default,p=H(U,e,e[2],null),y=e[3].footer,x=H(y,e,e[2],ue);return{c(){u=R("div"),t=C(),s=R("div"),c&&c.c(),a=C(),n=R("br"),d=C(),p&&p.c(),f=C(),o=R("br"),g=C(),b=R("button"),l=M("close"),i=C(),x&&x.c(),this.h()},l(r){u=E(r,"DIV",{class:!0}),A(u).forEach(v),t=k(r),s=E(r,"DIV",{class:!0});var h=A(s);c&&c.l(h),a=k(h),n=E(h,"BR",{}),d=k(h),p&&p.l(h),f=k(h),o=E(h,"BR",{}),g=k(h),b=E(h,"BUTTON",{class:!0});var Y=A(b);l=L(Y,"close"),Y.forEach(v),i=k(h),x&&x.l(h),h.forEach(v),this.h()},h(){j(u,"class","modal-background svelte-k8bp8l"),D(u,"hidden",e[0]),j(b,"class","svelte-k8bp8l"),j(s,"class","modal svelte-k8bp8l"),D(s,"hidden",e[0])},m(r,h){T(r,u,h),T(r,t,h),T(r,s,h),c&&c.m(s,null),_(s,a),_(s,n),_(s,d),p&&p.m(s,null),_(s,f),_(s,o),_(s,g),_(s,b),_(b,l),_(s,i),x&&x.m(s,null),m=!0,S||(z=[Z(u,"click",e[1]),Z(b,"click",e[1])],S=!0)},p(r,[h]){(!m||h&1)&&D(u,"hidden",r[0]),c&&c.p&&(!m||h&4)&&W(c,$,r,r[2],m?J($,r[2],h,tt):V(r[2]),te),p&&p.p&&(!m||h&4)&&W(p,U,r,r[2],m?J(U,r[2],h,null):V(r[2]),null),x&&x.p&&(!m||h&4)&&W(x,y,r,r[2],m?J(y,r[2],h,ut):V(r[2]),ue),(!m||h&1)&&D(s,"hidden",r[0])},i(r){m||(I(c,r),I(p,r),I(x,r),m=!0)},o(r){N(c,r),N(p,r),N(x,r),m=!1},d(r){r&&v(u),r&&v(t),r&&v(s),c&&c.d(r),p&&p.d(r),x&&x.d(r),S=!1,ke(z)}}}function at(e,u,t){let{$$slots:s={},$$scope:a}=u;const n=Se();let{hidden:d=!1}=u;function f(){console.info("Modal.svelte: closing modal"),n("close"),t(0,d=!0)}return e.$$set=o=>{"hidden"in o&&t(0,d=o.hidden),"$$scope"in o&&t(2,a=o.$$scope)},[d,f,a,s]}class rt extends se{constructor(u){super(),ae(this,u,at,st,re,{hidden:0})}}function nt(e){let u,t,s,a,n,d,f,o,g,b,l,i,m,S,z;return{c(){u=R("div"),t=R("h2"),s=M("Share Extractor Results:"),a=C(),n=R("code"),d=M(e[1]),f=C(),o=R("span"),g=R("button"),b=M("copy"),l=C(),i=R("p"),m=M("Copy the URL above to share the results."),this.h()},l($){u=E($,"DIV",{class:!0});var c=A(u);t=E(c,"H2",{});var U=A(t);s=L(U,"Share Extractor Results:"),U.forEach(v),a=k(c),n=E(c,"CODE",{});var p=A(n);d=L(p,e[1]),p.forEach(v),f=k(c),o=E(c,"SPAN",{});var y=A(o);g=E(y,"BUTTON",{});var x=A(g);b=L(x,"copy"),x.forEach(v),y.forEach(v),l=k(c),i=E(c,"P",{});var r=A(i);m=L(r,"Copy the URL above to share the results."),r.forEach(v),c.forEach(v),this.h()},h(){j(u,"class","content center text-center")},m($,c){T($,u,c),_(u,t),_(t,s),_(u,a),_(u,n),_(n,d),_(u,f),_(u,o),_(o,g),_(g,b),_(u,l),_(u,i),_(i,m),S||(z=Z(g,"click",e[2]),S=!0)},p($,c){c&2&&ze(d,$[1])},d($){$&&v(u),S=!1,z()}}}function ot(e){let u,t,s,a,n,d,f,o;function g(l){e[3](l)}let b={$$slots:{default:[nt]},$$scope:{ctx:e}};return e[0]!==void 0&&(b.hidden=e[0]),u=new rt({props:b}),Ue.push(()=>ye(u,"hidden",g)),{c(){Oe(u.$$.fragment),s=C(),a=R("button"),n=M("Share These Results"),this.h()},l(l){Me(u.$$.fragment,l),s=k(l),a=E(l,"BUTTON",{class:!0});var i=A(a);n=L(i,"Share These Results"),i.forEach(v),this.h()},h(){j(a,"class","button")},m(l,i){Le(u,l,i),T(l,s,i),T(l,a,i),_(a,n),d=!0,f||(o=Z(a,"click",e[4]),f=!0)},p(l,[i]){const m={};i&34&&(m.$$scope={dirty:i,ctx:l}),!t&&i&1&&(t=!0,m.hidden=l[0],Te(()=>t=!1)),u.$set(m)},i(l){d||(I(u.$$.fragment,l),d=!0)},o(l){N(u.$$.fragment,l),d=!1},d(l){we(u,l),l&&v(s),l&&v(a),f=!1,o()}}}function lt(e,u,t){let{url:s}=u,{hidden:a=!0}=u;const n=()=>je(s);function d(o){a=o,t(0,a)}const f=()=>t(0,a=!a);return e.$$set=o=>{"url"in o&&t(1,s=o.url),"hidden"in o&&t(0,a=o.hidden)},[a,s,n,d,f]}class mt extends se{constructor(u){super(),ae(this,u,lt,ot,re,{url:1,hidden:0})}}function ft(e){return e}function q(e,u,t,{match_key:s="rdfs:label",return_key:a="@id",normalizer_f:n=ft,anycasematch:d=!0}={}){if(u.length<1)return[];console.debug(`"Processing ${u.length} terms"`);let f=u.join("|"),o=new RegExp(f,"gi"),g=e.match(o)||[],b=[];return g.forEach(function(l){let i;d?i=t.get_multi_value_anycase(s,n(l)):i=t.get_multi_value(s,n(l)),i?b.push(i[a]):console.debug(n(l)+" Not found in Graph")}),b}function it(e,u,t){return q(e,u,t,{match_key:"@id"})}function dt(e,u,t){return q(e,u,t,{match_key:"d3f:synonym",normalizer_f:w})}function bt(e,u){let t=u.graph.map(f=>f["rdfs:label"]),s=e.match(/(T|t)([0-9]{4})((\.|\/|\\)([0-9]{3}))?/g)||[],a=e.match(new RegExp(t.join("|"),"ig"))||[],n=[];return a.forEach(function(f){u.get("rdfs:label",w(f))&&n.push(u.get("rdfs:label",w(f))["d3f:attack-id"])}),s&&(s=s.map(f=>f.replace(/(\\|\/)/,".")),s=s.map(f=>f.toUpperCase())),[...s,...n]}function gt(e,u){if(!u.index)throw"Graph object expects index by d3fend-id";e=F(e);let t=u.graph.map(i=>i["rdfs:label"]),s=u.get_all_values("d3f:synonym"),a=e.match(/D3-[A-z]*/g)||[],n=e.match(/d3f:[A-z,-]*/g)||[],d=e.match(new RegExp(t.join("|"),"gi"))||[];console.debug("_id_matches "+a.length),console.debug("_frag_matches "+n.length),console.debug("_label_matches "+d.length);let f=[];a.forEach(function(i){u.i(i)&&f.push(u.i(i)["@id"])});let o=q(e,d,u,{normalizer_f:w}),g=it(e,n,u),b=dt(e,s,u);return[...g,...f,...o,...b]}function pt(e,u){e=F(e);let t=u.graph.map(o=>o["rdfs:label"]),s=e.match(/d3f:[A-z,-]*/g)||[],a=e.match(new RegExp(t.join("|"),"gi"))||[],n=[];a.forEach(function(o){u.get("rdfs:label",w(o))&&n.push(u.get("rdfs:label",w(o))["@id"])});let d=[];return s.forEach(function(o){u.get("@id",o)&&n.push(u.get("@id",o)["@id"])}),[...d,...n]}export{mt as S,bt as a,gt as b,pt as e};
