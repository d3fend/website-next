import{w as Mr}from"./index.BQBQGMgF.js";import{c as _t}from"./utils.xEKteSAW.js";var Ft={local:{},session:{}};function Ir(e){return e==="local"?localStorage:sessionStorage}function Dr(e,t,n){var o,c,p,y,q,g;const v=(o=void 0)!=null?o:JSON,E=(c=void 0)!=null?c:"local",Y=(p=void 0)!=null?p:!0,H=(q=(y=void 0)!=null?y:void 0)!=null?q:D=>console.error(`Error when writing value from persisted store "${e}" to ${E}`,D),F=(g=void 0)!=null?g:(D,K)=>console.error(`Error when parsing ${D?'"'+D+'"':"value"} from persisted store "${e}"`,K),T=typeof window<"u"&&typeof document<"u",O=T?Ir(E):null;function x(D,K){try{O==null||O.setItem(D,v.stringify(K))}catch(ne){H(ne)}}function C(){const D=O==null?void 0:O.getItem(e);if(D)try{return v.parse(D)}catch(K){F(D,K)}return t}if(!Ft[E][e]){const D=C(),K=Mr(D,ye=>{if(T&&E=="local"&&Y){const Oe=ue=>{if(ue.key===e){let We;try{We=ue.newValue?v.parse(ue.newValue):null}catch(h){F(ue.newValue,h);return}ye(We)}};return window.addEventListener("storage",Oe),()=>window.removeEventListener("storage",Oe)}}),{subscribe:ne,set:te}=K;Ft[E][e]={set(ye){te(ye),x(e,ye)},update(ye){return K.update(Oe=>{const ue=ye(Oe);return x(e,ue),ue})},subscribe:ne}}return Ft[E][e]}class ct extends String{}const zr=new Set(["<",">","<=",">="]),Rr=e=>`\\u${e.toString(16).padStart(4,"0")}`,Cr=e=>{if([1/0,-1/0,NaN,void 0,null].includes(e))return`${e}`;if(!["string","boolean","number"].includes(typeof e)){if(typeof e!="object")throw new Error("Unexpected value type");const n=Object.getPrototypeOf(e);if(!(n===Array.prototype&&Array.isArray(e)||n===Object.prototype))throw new Error("Unexpected object given as value")}return JSON.stringify(e).replace(/([{,])"__proto__":/g,'$1["__proto__"]:').replace(/[^\\]"__proto__":/g,()=>{throw new Error("Unreachable")}).replace(/[\u2028\u2029]/g,n=>Rr(n.charCodeAt(0)))},At=(e,...t)=>{const n=e.replace(/%[%drscjw]/g,o=>{if(o==="%%")return"%";if(t.length===0)throw new Error("Unexpected arguments count");const c=t.shift();switch(o){case"%d":if(typeof c=="number")return c;throw new Error("Expected a number");case"%r":if(c instanceof RegExp)return At("new RegExp(%j, %j)",c.source,c.flags);throw new Error("Expected a RegExp instance");case"%s":if(c instanceof ct)return c;throw new Error("Expected a safe string");case"%c":if(zr.has(c))return c;throw new Error("Expected a compare op");case"%j":return Cr(c);case"%w":if(Number.isInteger(c)&&c>=0)return" ".repeat(c);throw new Error("Expected a non-negative integer for indentation")}throw new Error("Unreachable")});if(t.length!==0)throw new Error("Unexpected arguments count");return new ct(n)},Gt=e=>{if(!/^[a-z][a-z0-9_]*$/i.test(e))throw new Error("Does not look like a safe id");return new ct(e)},Ln=e=>(...t)=>{if(!t.every(n=>n instanceof ct))throw new Error("Unsafe arguments");return new ct(e(...t))},Nr=e=>/^[a-z][a-z0-9_().]*$/i.test(e)||/^\([^()]+\)$/i.test(e)?e:At("(%s)",e),Ur=Ln((...e)=>e.some(t=>`${t}`=="true")?"true":e.join(" || ")||"false"),Lr=Ln((...e)=>e.some(t=>`${t}`=="false")?"false":e.join(" && ")||"true"),_n=e=>`${e}`=="true"?Gt("false"):`${e}`=="false"?Gt("true"):At("!%s",Nr(e)),_r=(...e)=>_n(Ur(...e));var St={format:At,safe:Gt,safeand:Lr,safenot:_n,safenotor:_r};const{safe:qn}=St,Wt=new WeakMap,Fr=e=>{Wt.has(e)||Wt.set(e,{sym:new Map,ref:new Map,format:new Map,pattern:new Map});const t=Wt.get(e),n=g=>{t.sym.get(g)||t.sym.set(g,0);const v=t.sym.get(g);return t.sym.set(g,v+1),qn(`${g}${v}`)},o=g=>{if(t.pattern.has(g))return t.pattern.get(g);const v=n("pattern");return e[v]=new RegExp(g,"u"),t.pattern.set(g,v),v};return t.loop||(t.loop="ijklmnopqrstuvxyz".split("")),{gensym:n,genpattern:o,genloop:()=>{const g=t.loop.shift();return t.loop.push(`${g}${g[0]}`),qn(g)},getref:g=>t.ref.get(g),genref:g=>{const v=n("ref");return t.ref.set(g,v),v},genformat:g=>{let v=t.format.get(g);return v||(v=n("format"),e[v]=g,t.format.set(g,v)),v}}};var Fn={scopeMethods:Fr};const Wr=e=>/[\uD800-\uDFFF]/.test(e)?[...e].length:e.length,Jr=(e,t,n,o)=>{if(e%t===0)return!0;let c=e*n;if((c===1/0||c===-1/0)&&(c=e),c%o===0)return!0;const p=Math.floor(c+.5);return p/n===e&&p%o===0},lt=(e,t)=>{if(e===t)return!0;if(!e||!t||typeof e!=typeof t||e!==t&&typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n!==Object.getPrototypeOf(t))return!1;if(n===Array.prototype)return!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length?!1:e.every((o,c)=>lt(o,t[c]));if(n===Object.prototype){const[o,c]=[Object.keys(e),Object.keys(t)];return o.length!==c.length?!1:new Set([...o,...c]).size===o.length&&o.every(y=>lt(e[y],t[y]))}return!1},Vr=e=>{if(e.length<2)return!0;if(e.length===2)return!lt(e[0],e[1]);const t=[],n=e.length>20?new Set:null;let o=0,c=0;for(const p of e){if(typeof p=="object")t.push(p);else if(n){if(n.add(p),n.size!==++o)return!1}else if(e.indexOf(p,c+1)!==-1)return!1;c++}for(let p=1;p<t.length;p++)for(let y=0;y<p;y++)if(lt(t[p],t[y]))return!1;return!0},Kr=e=>{if(typeof Buffer<"u")return Buffer.from(e,"base64").toString("utf-8");const t=atob(e);return new TextDecoder("utf-8").decode(new Uint8Array(t.length).map((n,o)=>t.charCodeAt(o)))},Wn=Function.prototype.call.bind(Object.prototype.hasOwnProperty);Wn[Symbol.for("toJayString")]="Function.prototype.call.bind(Object.prototype.hasOwnProperty)";const Jn=e=>/~\//.test(e)?`${e}`.replace(/~/g,"~0").replace(/\//g,"~1"):e,Hr=e=>e.length===0?"#":`#/${e.map(Jn).join("/")}`,Zr=({keywordLocation:e,instanceLocation:t},n,o)=>({keywordLocation:`${n}${e.slice(1)}`,instanceLocation:`${o}${t.slice(1)}`}),Gr=(e,[t,n])=>t.includes(!0)||t.some(o=>o===e)||n.some(o=>new RegExp(o,"u").test(e)),Yr=(e,t)=>(e.filter(n=>n[t])[0]||{})[t],Qr={toPointer:Hr,pointerPart:Jn,errorMerge:Zr,propertyIn:Gr,dynamicResolve:Yr};var tn={stringLength:Wr,isMultipleOf:Jr,deepEqual:lt,unique:Vr,deBase64:Kr,hasOwn:Wn,...Qr};const{format:I,safe:Xr}=St,{scopeMethods:Br}=Fn,bt=tn,Yt=new Map(Object.entries({null:e=>I("%s === null",e),boolean:e=>I('typeof %s === "boolean"',e),array:e=>I("Array.isArray(%s)",e),object:e=>I('typeof %s === "object" && %s && !Array.isArray(%s)',e,e,e),number:e=>I('typeof %s === "number"',e),integer:e=>I("Number.isInteger(%s)",e),string:e=>I('typeof %s === "string"',e)})),Le=({name:e,parent:t,keyval:n,keyname:o})=>{if(e){if(t||n||o)throw new Error("name can be used only stand-alone");return e}if(!t)throw new Error("Can not use property of undefined parent!");const c=Le(t);if(n!==void 0){if(o)throw new Error("Can not use key value and name together");if(!["string","number"].includes(typeof n))throw new Error("Invalid property path");return/^[a-z][a-z0-9_]*$/i.test(n)?I("%s.%s",c,Xr(n)):I("%s[%j]",c,n)}else if(o)return I("%s[%s]",c,o);throw new Error("Unreachable")},ei=new Set([].concat(...[Object,Array,String,Number,Boolean].map(e=>Object.getOwnPropertyNames(e.prototype)))),ti=(e,t,n,{unmodifiedPrototypes:o,isJSON:c},p)=>{const{gensym:y,genpattern:q,genloop:g}=Br(t,n);return{present:T=>{const O=Le(T),{parent:x,keyval:C,keyname:D,inKeys:K,checked:ne}=T;if(ne||K&&c)throw new Error("Unreachable: useless check for undefined");if(K)return I("%s !== undefined",O);if(x&&D){t.hasOwn=bt.hasOwn;const te=Le(x);return c?I("%s !== undefined && hasOwn(%s, %s)",O,te,D):I("%s in %s && hasOwn(%s, %s)",D,te,te,D)}else if(x&&C!==void 0){if(o&&c&&!ei.has(`${C}`))return I("%s !== undefined",O);t.hasOwn=bt.hasOwn;const te=Le(x);return c?I("%s !== undefined && hasOwn(%s, %j)",O,te,C):I("%j in %s && hasOwn(%s, %j)",C,te,te,C)}throw new Error("Unreachable: present() check without parent")},forObjectKeys:(T,O)=>{const x=y("key");e.block(I("for (const %s of Object.keys(%s))",x,Le(T)),()=>{O(n(T,x,!0),x)})},forArray:(T,O,x)=>{const C=g(),D=Le(T);e.block(I("for (let %s = %s; %s < %s.length; %s++)",C,O,C,D,C),()=>{x(n(T,C,o,!0),C)})},patternTest:(T,O)=>{const x=T.replace(/[.^$|*+?(){}[\]\\]/gu,"");if(T===`^${x}$`)return I("(%s === %j)",O,T.slice(1,-1));if(p.has(T))return I("true");if([x,`${x}+`,`${x}.*`,`.*${x}.*`].includes(T))return I("%s.includes(%j)",O,x);if([`^${x}`,`^${x}+`,`^${x}.*`].includes(T))return I("%s.startsWith(%j)",O,x);if([`${x}$`,`.*${x}$`].includes(T))return I("%s.endsWith(%j)",O,x);const C=[...x].slice(0,-1).join("");return[`${x}*`,`${x}?`].includes(T)?C.length===0?I("true"):I("%s.includes(%j)",O,C):[`^${x}*`,`^${x}?`].includes(T)?C.length===0?I("true"):I("%s.startsWith(%j)",O,C):I("%s.test(%s)",q(T),O)},compare:(T,O)=>{if(!O||typeof O!="object")return I("%s === %j",T,O);let x;const C=D=>D.length<=3&&D.every(K=>!K||typeof K!="object");if(Array.isArray(O)){if(x=Yt.get("array")(T),C(O)){let D=I("%s.length === %d",T,O.length);for(let K=0;K<O.length;K++)D=I("%s && %s[%d] === %j",D,T,K,O[K]);return I("%s && %s",x,D)}}else{x=Yt.get("object")(T);const[D,K]=[Object.keys(O),Object.values(O)];if(C(K)){let ne=I("Object.keys(%s).length === %d",T,D.length);D.length>0&&(t.hasOwn=bt.hasOwn);for(const te of D)ne=I("%s && hasOwn(%s, %j)",ne,T,te);for(const te of D)ne=I("%s && %s[%j] === %j",ne,T,te,O[te]);return I("%s && %s",x,ne)}}return t.deepEqual=bt.deepEqual,I("%s && deepEqual(%s, %j)",x,T,O)},propvar:n}},ni=/^\([^)]*\) *=>/,ri=/^[^=]*=>/,Tn=Symbol.for("toJayString");function ii(e){if(typeof e=="function"){if(e[Tn])return e[Tn];if(Object.getPrototypeOf(e)!==Function.prototype)throw new Error("Can not stringify: a function with unexpected prototype");const t=`${e}`;if(e.prototype){if(!/^function[ (]/.test(t))throw new Error("Unexpected function");return t}if(ni.test(t)||ri.test(t))return t;throw new Error("Can not stringify: only either normal or arrow functions are supported")}else if(typeof e=="object"){const t=Object.getPrototypeOf(e);if(e instanceof RegExp&&t===RegExp.prototype)return I("%r",e);throw new Error("Can not stringify: an object with unexpected prototype")}throw new Error(`Can not stringify: unknown type ${typeof e}`)}var Vn={types:Yt,buildName:Le,jsHelpers:ti,jaystring:ii};const{format:vt,safe:si,safenot:oi}=St,{jaystring:ai}=Vn,ci=/[{[]/,li=/[}\]]/;var Kn=()=>{const e=[];let t=0;const n=p=>{li.test(p.trim()[0])&&t--,e.push({indent:t,code:p}),ci.test(p[p.length-1])&&t++},o=()=>{if(t!==0)throw new Error("Unexpected indent at build()");const p=e.map(y=>vt("%w%s",y.indent*2,y.code)).join(`
`);return/^[a-z][a-z0-9]*$/i.test(p)?`return ${p}`:`return (${p})`},c=p=>{const y=Object.entries(p);for(const[q,g]of y){if(!/^[a-z][a-z0-9]*$/i.test(q))throw new Error("Unexpected scope key!");if(!(typeof g=="function"||g instanceof RegExp))throw new Error("Unexpected scope value!")}return y};return{optimizedOut:!1,size:()=>e.length,write(p,...y){if(typeof p!="string")throw new Error("Format must be a string!");if(p.includes(`
`))throw new Error("Only single lines are supported");return n(vt(p,...y)),!0},block(p,y,q=!1){const g=t;this.write("%s {",p);const v=e.length;if(y(),v===e.length)return e.pop(),t=g,!1;if(v===e.length-1&&!q){const{code:E}=e[e.length-1];if(!/^(if|for) /.test(E))return e.length-=2,t=g,this.write("%s %s",p,E)}return this.write("}")},if(p,y,q){`${p}`=="false"?(q&&q(),y&&(this.optimizedOut=!0)):`${p}`=="true"?(y&&y(),q&&(this.optimizedOut=!0)):y&&this.block(vt("if (%s)",p),y,!!q)?q&&this.block(vt("else"),q):q&&this.if(oi(p),q)},makeModule(p={}){return`(function() {
'use strict'
${c(p).map(([q,g])=>`const ${si(q)} = ${ai(g)};`).join(`
`)}
${o()}})()`},makeFunction(p={}){const y=c(p),q=y.map(v=>v[0]),g=y.map(v=>v[1]);return Function(...q,`'use strict'
${o()}`)(...g)}}};const di=["$schema","$vocabulary","id","$id","$anchor","$ref","definitions","$defs","$recursiveRef","$recursiveAnchor","$dynamicAnchor","$dynamicRef","type","required","default","enum","const","not","allOf","anyOf","oneOf","if","then","else","maximum","minimum","exclusiveMaximum","exclusiveMinimum","multipleOf","divisibleBy","items","maxItems","minItems","additionalItems","prefixItems","contains","minContains","maxContains","uniqueItems","maxLength","minLength","format","pattern","contentEncoding","contentMediaType","contentSchema","properties","maxProperties","minProperties","additionalProperties","patternProperties","propertyNames","dependencies","dependentRequired","dependentSchemas","propertyDependencies","unevaluatedProperties","unevaluatedItems","title","description","deprecated","readOnly","writeOnly","examples","$comment","example","discriminator","removeAdditional"],fi=["draft/next","draft/2020-12","draft/2019-09","draft-07","draft-06","draft-04","draft-03"],ui=fi.map(e=>`https://json-schema.org/${e}/schema`),pi=["core","applicator","validation","meta-data","format","content"],mi=["core","applicator","unevaluated","validation","meta-data","format-annotation","format-assertion","content"],hi=[...pi.map(e=>`https://json-schema.org/draft/2019-09/vocab/${e}`),...mi.map(e=>`https://json-schema.org/draft/2020-12/vocab/${e}`)];var Hn={knownKeywords:di,schemaVersions:ui,knownVocabularies:hi};const{knownKeywords:Zn}=Hn;function Gn(e,t,n,o="keys"){if(!e.has(t))return e.set(t,n);if(e.get(t)!==n)throw new Error(`Conflicting duplicate ${o}: ${t}`)}function yi(e){return e.includes("~")?e.replace(/~[01]/g,t=>{switch(t){case"~1":return"/";case"~0":return"~"}throw new Error("Unreachable")}):e}function Qt(e,t,n){if(typeof e!="object")throw new Error("Invalid input object");if(typeof t!="string")throw new Error("Invalid JSON pointer");const o=t.split("/");if(!["","#"].includes(o.shift()))throw new Error("Invalid JSON pointer");if(o.length===0)return e;let c=e;for(const p of o){if(typeof p!="string")throw new Error("Invalid JSON pointer");n&&n.push(c);const y=yi(p);if(typeof c!="object"||!Object.prototype.hasOwnProperty.call(c,y))return;c=c[y]}return c}const Pn=/^https?:\/\//;function _e(e,t){if(typeof e!="string"||typeof t!="string")throw new Error("Unexpected path!");if(t.length===0)return e;const n=e.replace(/#.*/,"");return t.startsWith("#")?`${n}${t}`:!n.includes("/")||Pn.test(t)?t:Pn.test(n)?`${new URL(t,n)}`:t.startsWith("/")?t:[...n.split("/").slice(0,-1),t].join("/")}function Mn(e){return e.map(n=>n&&(n.$id||n.id)||"").filter(n=>n&&typeof n=="string").reduce(_e,"")}const Yn=["properties","patternProperties","$defs","definitions"],Qn=["const","enum","examples","example","comment"],Xn=Symbol("skip");function nn(e,t){const n=(o,c=!1)=>{if(!o||typeof o!="object")return;const p=t(o);if(p!==void 0)return p===Xn?void 0:p;for(const y of Object.keys(o)){if(!c&&!Array.isArray(o)&&!Zn.includes(y)||!c&&Qn.includes(y))continue;const q=n(o[y],!c&&Yn.includes(y));if(q!==void 0)return q}};return n(e)}function Bn(e,t,n,o=""){const c=_e(o,n),p=[],[y,q=""]=c.split("#"),g=decodeURI(q),v=(E,Y,H=!1,F=!1)=>{if(!E||typeof E!="object")return;const T=E.$id||E.id;let O=Y;if(T&&typeof T=="string"){if(O=_e(O,T),O===c||O===y&&g==="")p.push([E,e,Y]);else if(O===y&&g[0]==="/"){const C=[],D=Qt(E,g,C);D!==void 0&&p.push([D,e,_e(Y,Mn(C))])}}const x=F?E.$dynamicAnchor:E.$anchor;if(x&&typeof x=="string"){if(x.includes("#"))throw new Error("$anchor can't include '#'");if(x.startsWith("/"))throw new Error("$anchor can't start with '/'");O=_e(O,`#${x}`),O===c&&p.push([E,e,Y])}for(const C of Object.keys(E))!H&&!Array.isArray(E)&&!Zn.includes(C)||!H&&Qn.includes(C)||v(E[C],O,!H&&Yn.includes(C));!F&&E.$dynamicAnchor&&v(E,Y,H,!0)};if(v(e,y),y===o.replace(/#$/,"")&&(g[0]==="/"||g==="")){const E=[],Y=Qt(e,g,E);Y!==void 0&&p.push([Y,e,Mn(E)])}if(t.has(y)&&t.get(y)!==e){const E=Bn(t.get(y),t,`#${q}`,y);p.push(...E.map(([Y,H,F])=>[Y,H,_e(y,F)]))}return t.has(c)&&p.push([t.get(c),t.get(c),c]),p}function gi(e){const t=new Map;return nn(e,n=>{if(n!==e&&(n.$id||n.id))return Xn;const o=n.$dynamicAnchor;if(o&&typeof o=="string"){if(o.includes("#"))throw new Error("$dynamicAnchor can't include '#'");if(!/^[a-zA-Z0-9_-]+$/.test(o))throw new Error(`Unsupported $dynamicAnchor: ${o}`);Gn(t,o,n,"$dynamicAnchor")}}),t}const wi=(e,t)=>nn(e,n=>Object.keys(n).some(o=>t.includes(o))||void 0)||!1,In=(e,t,n=!1)=>{if(!Array.isArray(t))throw new Error("Expected an array of schemas");for(const o of t)nn(o,c=>{const p=c.$id||c.id,y=p&&typeof p=="string"?p.replace(/#$/,""):null;if(y&&y.includes("://")&&!y.includes("#"))Gn(e,y,c,"schema $id in 'schemas'");else if(c===o&&!n)throw new Error("Schema with missing or invalid $id in 'schemas'")});return e},er=(e,t)=>{if(t)return In(er(e),t,!0);if(e)switch(Object.getPrototypeOf(e)){case Object.prototype:return new Map(Object.entries(e));case Map.prototype:return new Map(e);case Array.prototype:return In(new Map,e)}throw new Error("Unexpected value for 'schemas' option")};var tr={get:Qt,joinPath:_e,resolveReference:Bn,getDynamicAnchors:gi,hasKeywords:wi,buildSchemas:er};const Xt={email:e=>{if(e.length>318)return!1;if(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,20}(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,21}){0,2}@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,60}[a-z0-9])?){0,3}$/i.test(e))return!0;if(!e.includes("@")||/(^\.|^"|\.@|\.\.)/.test(e))return!1;const[n,o,...c]=e.split("@");return!n||!o||c.length!==0||n.length>64||o.length>253||!/^[a-z0-9.-]+$/i.test(o)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(n)?!1:o.split(".").every(p=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(p))},hostname:e=>e.length>(e.endsWith(".")?254:253)?!1:/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*\.?$/i.test(e),date:e=>{if(e.length!==10)return!1;if(e[5]==="0"&&e[6]==="2"){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)$/.test(e))return!0;const t=e.match(/^(\d\d\d\d)-02-29$/);if(!t)return!1;const n=t[1]|0;return n%16===0||n%4===0&&n%25!==0}return e.endsWith("31")?/^\d\d\d\d-(?:0[13578]|1[02])-31$/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)$/.test(e)},time:e=>{if(e.length>27||!/^(?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)?$/i.test(e))return!1;if(!/:60/.test(e))return!0;const n=e.match(/([0-9.]+|[^0-9.])/g);let o=Number(n[0])*60+Number(n[2]);return n[5]==="+"?o+=24*60-Number(n[6]||0)*60-Number(n[8]||0):n[5]==="-"&&(o+=Number(n[6]||0)*60+Number(n[8]||0)),o%(24*60)===23*60+59},"date-time":e=>{if(e.length>38)return!1;const t=/^\d\d\d\d-(?:0[1-9]|1[0-2])-(?:[0-2]\d|3[01])[t\s](?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)$/i,n=e[5]==="0"&&e[6]==="2";if(n&&e[8]==="3"||!t.test(e))return!1;if(e[17]==="6"){const o=e.slice(11).match(/([0-9.]+|[^0-9.])/g);let c=Number(o[0])*60+Number(o[2]);if(o[5]==="+"?c+=24*60-Number(o[6]||0)*60-Number(o[8]||0):o[5]==="-"&&(c+=Number(o[6]||0)*60+Number(o[8]||0)),c%(24*60)!==23*60+59)return!1}if(n){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)/.test(e))return!0;const o=e.match(/^(\d\d\d\d)-02-29/);if(!o)return!1;const c=o[1]|0;return c%16===0||c%4===0&&c%25!==0}return e[8]==="3"&&e[9]==="1"?/^\d\d\d\d-(?:0[13578]|1[02])-31/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)/.test(e)},ipv4:e=>e.length<=15&&/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)$/.test(e),ipv6:e=>{if(e.length>45||e.length<2)return!1;let t=0,n=0,o=0,c=!1,p=!1,y=0,q=!0;for(let v=0;v<e.length;v++){const E=e.charCodeAt(v);if(v===1&&y===58&&E!==58)return!1;if(E>=48&&E<=57){if(++o>4)return!1}else if(E===46){if(t>6||n>=3||o===0||p)return!1;n++,o=0}else if(E===58){if(n>0||t>=7)return!1;if(y===58){if(c)return!1;c=!0}else v===0&&(q=!1);t++,o=0,p=!1}else if(E>=97&&E<=102||E>=65&&E<=70){if(n>0||++o>4)return!1;p=!0}else return!1;y=E}if(t<2||n>0&&(n!==3||o===0))return!1;if(c&&e.length===2)return!0;if(n>0&&!/(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}$/.test(e))return!1;const g=n>0?6:7;return c?(q||o>0)&&t<g:t===g&&q&&o>0},uri:/^[a-z][a-z0-9+\-.]*:(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)?(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2}|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,"json-pointer":/^(?:|\/(?:[^~]|~0|~1)*)$/,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:|#|\/(?:[^~]|~0|~1)*)$/,uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e))},bi={alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"hex-digits":/^[0-9a-f]+$/i,"hex-digits-prefixed":/^0x[0-9a-f]+$/i,"hex-bytes":/^([0-9a-f][0-9a-f])+$/i,"hex-bytes-prefixed":/^0x([0-9a-f][0-9a-f])+$/i,base64:e=>e.length%4===0&&/^[a-z0-9+/]*={0,3}$/i.test(e),"json-pointer-uri-fragment":/^#(|\/(\/|[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)$/i,"host-name":Xt.hostname,"ip-address":Xt.ipv4,color:/^(#[0-9A-Fa-f]{3,6}|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\(\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*\)|rgb\(\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*\))$/},vi={regex:e=>{if(e.length>1e5||/[^\\]\\Z/.test(e))return!1;try{return new RegExp(e,"u"),!0}catch{return!1}}};var ki={core:Xt,extra:bi,weak:vi};const fe=(e,t)=>[...new Set([...e,...t])].sort(),nr=(e,t)=>e.filter(n=>t.includes(n)),$i=e=>(...t)=>e(...t.map(xt)),rr=e=>(...t)=>xt(e(...t.map(xt))),de=(e,t)=>e&&!e.includes(t),xt=({type:e=null,dyn:t={},...n})=>({type:e&&[...e].sort(),items:de(e,"array")?1/0:n.items||0,properties:de(e,"object")?[!0]:[...n.properties||[]].sort(),patterns:de(e,"object")?[]:[...n.patterns||[]].sort(),required:de(e,"object")?[]:[...n.required||[]].sort(),fullstring:de(e,"string")||n.fullstring||!1,dyn:{item:de(e,"array")?!1:t.item||!1,items:de(e,"array")?0:Math.max(n.items||0,t.items||0),properties:de(e,"object")?[]:fe(n.properties||[],t.properties||[]),patterns:de(e,"object")?[]:fe(n.patterns||[],t.patterns||[])},unknown:n.unknown&&!(de(e,"object")&&de(e,"array"))||!1}),ji=()=>xt({}),ir=rr((e,t)=>({type:e.type&&t.type?nr(e.type,t.type):e.type||t.type||null,items:Math.max(e.items,t.items),properties:fe(e.properties,t.properties),patterns:fe(e.patterns,t.patterns),required:fe(e.required,t.required),fullstring:e.fullstring||t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:fe(e.dyn.properties,t.dyn.properties),patterns:fe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Bt=(e,t)=>t!==!0&&new RegExp(e,"u").test(t),Oi=({properties:e,patterns:t},{properties:n,patterns:o})=>{const c=e.filter(g=>n.includes(g)||n.includes(!0)||o.some(v=>Bt(v,g))),p=n.filter(g=>e.includes(g)||e.includes(!0)||t.some(v=>Bt(v,g))),y=t.filter(g=>o.includes(g)||n.includes(!0)),q=o.filter(g=>t.includes(g)||e.includes(!0));return{properties:fe(c,p),patterns:fe(y,q)}},sr=({properties:e,patterns:t},{properties:n,patterns:o})=>n.every(c=>e.includes(c)||e.includes(!0)||t.some(p=>Bt(p,c)))&&o.every(c=>t.includes(c)||e.includes(!0)),xi=rr((e,t)=>({type:e.type&&t.type?fe(e.type,t.type):null,items:Math.min(e.items,t.items),...Oi(e,t),required:de(e.type,"object")&&t.required||de(t.type,"object")&&e.required||nr(e.required,t.required),fullstring:e.fullstring&&t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:fe(e.dyn.properties,t.dyn.properties),patterns:fe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Ei=(e,t)=>Object.assign(e,ir(e,t)),Ai=$i(({unknown:e,items:t,dyn:n,...o})=>({items:t!==1/0&&(e||n.items>t||n.item),properties:!o.properties.includes(!0)&&(e||!sr(o,n))}));var Si={initTracing:ji,andDelta:ir,orDelta:xi,applyDelta:Ei,isDynamic:Ai,inProperties:sr};const{format:k,safe:Dn,safeand:kt,safenot:Ue,safenotor:$t}=St,qi=Kn,{resolveReference:et,joinPath:zn,getDynamicAnchors:Ti,hasKeywords:Rn}=tr,jt=ki,{toPointer:Jt,...Z}=tn,{scopeMethods:or}=Fn,{buildName:Vt,types:ve,jsHelpers:Pi}=Vn,{knownKeywords:Mi,schemaVersions:Et,knownVocabularies:Ii}=Hn,{initTracing:Di,andDelta:Cn,orDelta:Pe,applyDelta:zi,isDynamic:ke,inProperties:Ri}=Si,Kt=new Set(["^[\\s\\S]*$","^[\\S\\s]*$","^[^]*$","",".*","^","$"]),Ht=["null","boolean","number","integer","string"],en=new Map(Object.entries({boolean:e=>typeof e=="boolean",array:e=>Array.isArray(e)&&Object.getPrototypeOf(e)===Array.prototype,object:e=>e&&Object.getPrototypeOf(e)===Object.prototype,finite:e=>Number.isFinite(e),natural:e=>Number.isInteger(e)&&e>=0,string:e=>typeof e=="string",jsonval:e=>Z.deepEqual(e,JSON.parse(JSON.stringify(e)))})),Fe=en.get("object"),Nn=e=>Fe(e)||typeof e=="boolean",Ci=e=>Z.deepEqual(e,{type:[]}),Me=(e,t)=>Et.indexOf(e)>Et.indexOf(`https://json-schema.org/${t}/schema`),Ni=(e,t)=>{const n=`${e}`.replace(/^http:\/\//,"https://").replace(/#$/,"");return Et.includes(n)?Me(n,t):!0},Ui=(e,t,n=!1,o=!1)=>Object.freeze({parent:e,keyname:t,inKeys:n,number:o}),Li=(e,t,n=!1)=>Object.freeze({parent:e,keyval:t,checked:n}),Zt=Symbol("evaluatedStatic"),Ie=Symbol("optDynamic"),tt=Symbol("optDynAnchors"),at=Symbol("optRecAnchors"),_i=e=>{if(typeof e=="boolean")return e;if(Fe(e)&&Object.keys(e).length===0)return!0},De=new Set,dt=new Map,Fi=(e,t,n,o)=>{if(t){const c=t.replace(/^http:\/\//,"https://").replace(/#$/,"");n(Et.includes(c),"Unexpected schema version:",c),dt.set(e,{exclusiveRefs:Me(c,"draft/2019-09"),contentValidation:Me(c,"draft/2019-09"),dependentUnsupported:Me(c,"draft/2019-09"),newItemsSyntax:!Me(c,"draft/2020-12"),containsEvaluates:!Me(c,"draft/2020-12"),objectContains:!Me(c,"draft/next"),bookending:Me(c,"draft/next")})}else n(!o,"[requireSchema] $schema is required"),dt.set(e,{})},ar=(e,t,n,o,c="")=>{const{mode:p="default",useDefaults:y=!1,removeAdditional:q=!1,includeErrors:g=!1,allErrors:v=!1,contentValidation:E,dryRun:Y,lint:H=!1,allowUnusedKeywords:F=n.mode==="lax"||n.mode==="spec",allowUnreachable:T=n.mode==="lax"||n.mode==="spec",requireSchema:O=n.mode==="strong",requireValidation:x=n.mode==="strong",requireStringValidation:C=n.mode==="strong",forbidNoopValues:D=n.mode==="strong",complexityChecks:K=n.mode==="strong",unmodifiedPrototypes:ne=!1,isJSON:te=!1,$schemaDefault:ye=null,formatAssertion:Oe=n.mode!=="spec"||Ni(t.$schema,"draft/2019-09"),formats:ue={},weakFormats:We=n.mode!=="strong",extraFormats:h=!1,schemas:m,...$}=n,b={...jt.core,...We?jt.weak:{},...h?jt.extra:{},...ue};if(Object.keys($).length!==0)throw new Error(`Unknown options: ${Object.keys($).join(", ")}`);if(!["strong","lax","default","spec"].includes(p))throw new Error(`Invalid mode: ${p}`);if(!g&&v)throw new Error("allErrors requires includeErrors to be enabled");if(O&&ye)throw new Error("requireSchema forbids $schemaDefault");if(p==="strong"){const oe={...{requireValidation:x,requireStringValidation:C},formatAssertion:Oe,complexityChecks:K,requireSchema:O},A={weakFormats:We,allowUnusedKeywords:F};for(const[l,ee]of Object.entries(oe))if(!ee)throw new Error(`Strong mode demands ${l}`);for(const[l,ee]of Object.entries(A))if(ee)throw new Error(`Strong mode forbids ${l}`)}const{gensym:z,getref:X,genref:L,genformat:B}=or(o),re=se=>{const oe=[];let A=se;for(;A;)A.name||oe.unshift(A),A=A.parent||A.errorParent;if(oe.every(me=>me.keyval!==void 0))return k("%j",Jt(oe.map(me=>me.keyval)));const l=["#"],ee=()=>{const me=l.map(Z.pointerPart).join("/");return l.length=0,me};let ge=null;for(const{keyname:me,keyval:mt,number:Re}of oe)if(me){Re||(o.pointerPart=Z.pointerPart);const Ve=Re?me:k("pointerPart(%s)",me),N=`${ee()}/`;ge=ge?k("%s+%j+%s",ge,N,Ve):k("%j+%s",N,Ve)}else mt&&l.push(mt);return l.length>0?k("%s+%j",ge,`/${ee()}`):ge},pe=L(e);let ft=null;const on=(...se)=>{const oe=ft(...se);return on.errors=ft.errors,oe};o[pe]=on;const lr=Rn(e,["$ref","$recursiveRef","$dynamicRef"]),qt=n[tt]&&lr&&Rn(e,["$dynamicAnchor"]),dr=()=>n[tt]?k(qt?", dynAnchors = []":", dynAnchors"):k(""),fr=n[at]?k(", recursive"):k(""),f=qi();f.write("function validate(data%s%s) {",fr,dr()),g&&f.write("validate.errors = null"),v&&f.write("let errorCount = 0"),n[Ie]&&f.write("validate.evaluatedDynamic = null");let an=n[tt]?k(", dynAnchors"):k("");qt&&(f.write("const dynLocal = [{}]"),an=k(", [...dynAnchors, dynLocal[0] || []]"));const ur=Pi(f,o,Ui,{unmodifiedPrototypes:ne,isJSON:te},Kt),{present:$e,forObjectKeys:ut,forArray:Tt,patternTest:pr,compare:Pt}=ur,ze=[],ie=()=>dt.get(t),Je=c?[c]:[],Mt=(se,oe,A,l,ee,ge={},{constProp:me}={})=>{const mt=oe.length>0&&oe[oe.length-1].prop===A,Re=()=>oe.filter(r=>r.prop===A),Ve=!A.parent||A.checked||A.inKeys&&te||Re().length>0,N=Vt(A),Ce=(...r)=>Li(A,...r),xe=({path:r=[],prop:s=A,source:a,suberr:d})=>{const i=Jt([...ee,...r]),u=g?re(s):null;if(g===!0&&se&&a){o.errorMerge=Z.errorMerge;const w=[a,i,u];v?(f.write("if (validate.errors === null) validate.errors = []"),f.write("validate.errors.push(...%s.map(e => errorMerge(e, %j, %s)))",...w)):f.write("validate.errors = [errorMerge(%s[0], %j, %s)]",...w)}else if(g===!0&&se){const w=k("{ keywordLocation: %j, instanceLocation: %s }",i,u);v?(f.write("if (%s === null) %s = []",se,se),f.write("%s.push(%s)",se,w)):f.write("%s = [%s]",se,w)}d&&vn(d),v?f.write("errorCount++"):f.write("return false")},ce=(r,s)=>f.if(r,()=>xe(s));H&&!o.lintErrors&&(o.lintErrors=[]);const je=(r,s)=>{const a=s!==void 0?` ${JSON.stringify(s)}`:"",d=zn(c,Jt(ee)),i=`${r}${a} at ${d}`;if(H)return o.lintErrors.push({message:i,keywordLocation:d,schema:e});throw new Error(i)},Dt=(r,s)=>{try{return pr(r,s)}catch(a){return je(a.message),k("false")}},P=(r,...s)=>r||je(...s),nt=(r,...s)=>P(p==="lax"||p==="spec"||r,...s),Ee=(r,s)=>nt(!(l[s]<l[r]),`Invalid ${r} / ${s} combination`),Ae=(r,s="should be specified")=>P(!x,`[requireValidation] ${r} ${s}`),Q=(...r)=>[...ee,...r],Ke=r=>P(!q&&!y,`[removeAdditional/useDefaults] uncertain: ${r}`),cn=(r,s)=>P(!K,`[complexityChecks] ${r}`,s),ln=r=>Fi(t,r||ye,P,O),M=Di(),_=r=>zi(M,r);if(typeof l=="boolean")return l===!0?(Ae("schema = true","is not allowed"),{stat:M}):(ce(Ve||A.inKeys?!0:$e(A),{}),_({type:[]}),{stat:M});P(Fe(l),"Schema is not an object");for(const r of Object.keys(l))P(Mi.includes(r)||F,"Keyword not supported:",r);if(Object.keys(l).length===0)return Ae("empty rules node","is not allowed"),{stat:M};const Se=new Set(Object.keys(l)),dn=new Set,qe=(r,...s)=>{P(dn.has(r)||Se.has(r),"Unexpected double consumption:",r),P(Z.hasOwn(l,r),"Is not an own property:",r),P(s.every(a=>en.has(a)),"Invalid type used in consume"),P(s.some(a=>en.get(a)(l[r])),"Unexpected type for",r),Se.delete(r)},fn=(r,...s)=>(l[r]!==void 0&&qe(r,...s),l[r]),j=(r,s,a,d={})=>{if(l[r]===void 0)return!1;if(qe(r,...s),a!==null)try{const i=a(l[r]);i!==null&&ce(i,{path:[r],...d})}catch(i){if(H&&!i.message.startsWith("[opt] "))je(i.message);else throw i}return!0};if(l===t?(ln(fn("$schema","string")),j("$vocabulary",["object"],r=>{for(const[s,a]of Object.entries(r))a!==!1&&P(a===!0&&Ii.includes(s),"Unknown vocabulary:",s);return null})):ie()||ln(t.$schema),ie().objectContains)for(const r of["contains","minContains","maxContains"])dn.add(r);j("examples",["array"],null),j("example",["jsonval"],null);for(const r of["title","description","$comment"])j(r,["string"],null);for(const r of["deprecated","readOnly","writeOnly"])j(r,["boolean"],null);j("$defs",["object"],null)||j("definitions",["object"],null);const rt=(r,s,a)=>r===e?Dn("validate"):X(r)||ar(r,s,n,o,a),Te=()=>Je.length>0?Je[Je.length-1]:"",mr=Je.length,un=r=>(Je.push(zn(Te(),r)),null);(!ie().exclusiveRefs||!l.$ref)&&(j("$id",["string"],un)||j("id",["string"],un),j("$anchor",["string"],null),j("$dynamicAnchor",["string"],null),(l.$recursiveAnchor||!D)&&j("$recursiveAnchor",["boolean"],r=>(r&&ze.push([l,t,Te()]),null)));const pn=qt&&(l===e||l.id||l.$id);if(pn){const r=Ti(l);l!==e&&f.write("dynLocal.unshift({})");for(const[s,a]of r){const d=et(t,m,`#${s}`,Te()),[i,u,w]=d[0]||[];P(i===a,`Unexpected $dynamicAnchor resolution: ${s}`);const S=rt(i,u,w);f.write("dynLocal[0][%j] = %s",`#${s}`,S)}}const zt=r=>n[Ie]&&(l[r]||l[r]===!1||l===e),le=Object.freeze({item:zt("unevaluatedItems")?z("evaluatedItem"):null,items:zt("unevaluatedItems")?z("evaluatedItems"):null,props:zt("unevaluatedProperties")?z("evaluatedProps"):null}),V=Object.freeze({item:le.item||ge.item,items:le.items||ge.items,props:le.props||ge.props}),mn=()=>(!V.items||M.items===1/0)&&(!V.props||M.properties.includes(!0)),we=r=>{if(V.item&&r.item&&M.items!==1/0&&f.write("%s.push(%s)",V.item,r.item),V.items&&r.items>M.items&&f.write("%s.push(%d)",V.items,r.items),V.props&&(r.properties||[]).includes(!0)&&!M.properties.includes(!0))f.write("%s[0].push(true)",V.props);else if(V.props){const s=(i,u)=>Ri(M,{properties:i,patterns:u}),a=(r.properties||[]).filter(i=>!s([i],[])),d=(r.patterns||[]).filter(i=>!s([],[i]));a.length>0&&f.write("%s[0].push(...%j)",V.props,a),d.length>0&&f.write("%s[1].push(...%j)",V.props,d);for(const i of r.propertiesVars||[])f.write("%s[0].push(%s)",V.props,i)}},hn=(r,s,a,d)=>{ke(M).items&&r.item&&s&&f.write("%s.push(...%s)",r.item,s),ke(M).items&&r.items&&a&&f.write("%s.push(...%s)",r.items,a),ke(M).properties&&r.props&&d&&(f.write("%s[0].push(...%s[0])",r.props,d),f.write("%s[1].push(...%s[1])",r.props,d))},hr=()=>n[at]?ze.length===0?k(", recursive"):k(", recursive || %s",rt(...ze[0])):k(""),ht=(r,s)=>{const a=o[r]&&o[r][Zt]||{unknown:!0};_(a);const d=k("%s(%s%s%s)",r,N,hr(),an);if(!g&&mn())return k("!%s",d);const i=z("res"),u=z("err"),w=z("suberr");return g&&f.write("const %s = validate.errors",u),f.write("const %s = %s",i,d),g&&f.write("const %s = %s.errors",w,r),g&&f.write("validate.errors = %s",u),ce(Ue(i),{...s,source:w}),f.if(i,()=>{const S=ke(a).items?k("%s.evaluatedDynamic[0]",r):null,R=ke(a).items?k("%s.evaluatedDynamic[1]",r):null,U=ke(a).properties?k("%s.evaluatedDynamic[2]",r):null;hn(V,S,R,U)}),null},yn=(r,s)=>r&&r.every(a=>s.includes(a)),gn=(r,s)=>s.some(a=>r===null||r.includes(a)),wn=(...r)=>Re().some(s=>yn(s.stat.type,r)),yr=(...r)=>yn(M.type,r)||wn(...r),He=(...r)=>gn(M.type,r)&&Re().every(s=>gn(s.stat.type,r)),Rt=(r,s=l)=>{P(typeof r=="string","Invalid pattern:",r),(x||C)&&P(/^\^.*\$$/.test(r),"Should start with ^ and end with $:",r),/([{+*].*[{+*]|\)[{+*]|^[^^].*[{+*].)/.test(r)&&s.maxLength===void 0&&cn("maxLength should be specified for pattern:",r)},gr=l.pattern&&!Kt.has(l.pattern),wr=l.uniqueItems||gr||l.patternProperties||l.format,yt=v&&wr?z("prev"):null,gt=(r,s)=>f.if(r&&yt!==null?k("errorCount === %s",yt):!0,s),bn=()=>[...oe,{stat:M,prop:A}],ae=(...r)=>Mt(se,bn(),...r).stat,Ne=(r,...s)=>{if(s[0]===A){const i=_i(s[1]);if(i===!0)return{sub:k("true"),delta:{}};if(i===!1)return{sub:k("false"),delta:{type:[]}}}const a=z("sub");f.write("const %s = (() => {",a),v&&f.write("let errorCount = 0");const{stat:d}=Mt(r,bn(),...s);return v?f.write("return errorCount === 0"):f.write("return true"),f.write("})()"),{sub:a,delta:d}},Ct=()=>{const r=g&&v?z("suberr"):null;return r&&f.write("let %s = null",r),r},vn=r=>{se===null||r===null||f.if(r,()=>f.write("%s.push(...%s)",se,r))},kn=()=>{if(!q)return!1;if(q===!0)return!0;if(q==="keyword")return l.removeAdditional?(qe("removeAdditional","boolean"),!0):!1;throw new Error(`Invalid removeAdditional: ${q}`)},wt=(r,s,a)=>{j(r,["object","boolean"],i=>i===!1&&kn()?(f.write("if (%s.length > %s) %s.length = %s",N,s,N,s),null):i===!1&&!a?k("%s.length > %s",N,s):(Tt(A,s,(u,w)=>(a&&f.write("if (%s) continue",a(w)),ae(u,i,Q(r)))),null))&&_({items:1/0})},Nt=(r,s)=>{j(r,["object","boolean"],d=>(ut(A,(i,u)=>{f.if(s(u),()=>{d===!1&&kn()?f.write("delete %s[%s]",N,u):ae(i,d,Q(r))})}),null))&&_({properties:[!0]})},$n=(r,s,a)=>kt(...s.map(d=>k("%s !== %j",r,d)),...a.map(d=>Ue(Dt(d,r)))),jn=(r,s)=>{const a=s.map(i=>new RegExp(i,"u")),d=i=>r.includes(i)||a.some(u=>u.test(i));for(const i of M.required)P(d(i),"Unknown required property:",i)},On=[],br=()=>{const r=(a,d)=>k("!(%d %c %s)",a,d,N);Number.isFinite(l.exclusiveMinimum)?j("exclusiveMinimum",["finite"],a=>r(a,"<")):(j("minimum",["finite"],a=>r(a,l.exclusiveMinimum?"<":"<=")),j("exclusiveMinimum",["boolean"],null)),Number.isFinite(l.exclusiveMaximum)?(j("exclusiveMaximum",["finite"],a=>r(a,">")),Ee("minimum","exclusiveMaximum"),Ee("exclusiveMinimum","exclusiveMaximum")):l.maximum!==void 0&&(j("maximum",["finite"],a=>r(a,l.exclusiveMaximum?">":">=")),j("exclusiveMaximum",["boolean"],null),Ee("minimum","maximum"),Ee("exclusiveMinimum","maximum"));const s=l.multipleOf===void 0?"divisibleBy":"multipleOf";j(s,["finite"],a=>{P(a>0,`Invalid ${s}:`,a);const[d,i]=`${a}`.split("e-"),w=`${d}.`.split(".")[1].length+(i?Number(i):0);if(Number.isInteger(a*2**w))return k("%s %% %d !== 0",N,a);o.isMultipleOf=Z.isMultipleOf;const S=[N,a,w,Math.round(a*Math.pow(10,w))];return k("!isMultipleOf(%s, %d, 1e%d, %d)",...S)})},vr=()=>{j("maxLength",["natural"],r=>(o.stringLength=Z.stringLength,k("%s.length > %d && stringLength(%s) > %d",N,r,N,r))),j("minLength",["natural"],r=>(o.stringLength=Z.stringLength,k("%s.length < %d || stringLength(%s) < %d",N,r,N,r))),Ee("minLength","maxLength"),gt(!0,()=>{const r=(i,u,w=b)=>{const S=typeof i=="string"&&Z.hasOwn(w,i);P(S,"Unrecognized format used:",i);const R=w[i],U=R instanceof RegExp||typeof R=="function";return P(U,"Invalid format used:",i),Oe?R instanceof RegExp?(Z.hasOwn(ue,i)&&Rt(R.source),k("!%s.test(%s)",B(R),u)):k("!%s(%s)",B(R),u):null};j("format",["string"],i=>(_({fullstring:!0}),r(i,N))),j("pattern",["string"],i=>(Rt(i),_({fullstring:!0}),Kt.has(i)?null:Ue(Dt(i,N)))),P(l.contentSchema!==!1,"contentSchema cannot be set to false");const s=E===void 0?ie().contentValidation:E,a=l.contentEncoding||l.contentMediaType||l.contentSchema;if(P(!a||s||F,'"content*" keywords are disabled by default per spec, enable with { contentValidation = true } option (see doc/Options.md for more info)'),a&&s){const i=z("dec");l.contentMediaType&&f.write("let %s = %s",i,N),l.contentEncoding==="base64"?(ce(r("base64",N,jt.extra),{path:["contentEncoding"]}),l.contentMediaType&&(o.deBase64=Z.deBase64,f.write("try {"),f.write("%s = deBase64(%s)",i,i)),qe("contentEncoding","string")):P(!l.contentEncoding,"Unknown contentEncoding:",l.contentEncoding);let u=!1;if(l.contentMediaType==="application/json"?(f.write("try {"),f.write("%s = JSON.parse(%s)",i,i),u=!0,qe("contentMediaType","string")):P(!l.contentMediaType,"Unknown contentMediaType:",l.contentMediaType),l.contentSchema){P(u,"contentSchema requires contentMediaType application/json");const w=Object.freeze({name:i,errorParent:A});ae(w,l.contentSchema,Q("contentSchema")),qe("contentSchema","object","array"),_({fullstring:!0})}l.contentMediaType&&(f.write("} catch (e) {"),xe({path:["contentMediaType"]}),f.write("}"),l.contentEncoding&&(f.write("} catch (e) {"),xe({path:["contentEncoding"]}),f.write("}")))}})},kr=()=>{j("maxItems",["natural"],i=>{const u=ie().newItemsSyntax?"prefixItems":"items";return Array.isArray(l[u])&&l[u].length>i&&je(`Invalid maxItems: ${i} is less than ${u} array length`),k("%s.length > %d",N,i)}),j("minItems",["natural"],i=>k("%s.length < %d",N,i)),Ee("minItems","maxItems");const r=i=>{for(let u=0;u<i.length;u++)ae(Ce(u),i[u],Q(`${u}`));return _({items:i.length}),null};ie().newItemsSyntax?(j("prefixItems",["array"],r),wt("items",k("%d",(l.prefixItems||[]).length))):Array.isArray(l.items)?(j("items",["array"],r),wt("additionalItems",k("%d",l.items.length))):j("items",["object","boolean"],i=>(Tt(A,k("0"),u=>ae(u,i,Q("items"))),_({items:1/0}),null)),xn(i=>{Tt(A,k("0"),(u,w)=>{i(u,()=>{_({dyn:{item:!0}}),we({item:w})})})});const s=i=>{if(!Fe(i))return!1;if(i.enum||Z.hasOwn(i,"const")||i.type&&(Array.isArray(i.type)?i.type:[i.type]).every(w=>Ht.includes(w)))return!0;if(i.$ref){const[u]=et(t,m,i.$ref,Te())[0]||[];if(s(u))return!0}return!1},a=i=>i===!1||s(i),d=()=>!!(l.maxItems!==void 0||a(l.items)||Array.isArray(l.items)&&a(l.additionalItems));gt(!0,()=>{j("uniqueItems",["boolean"],i=>i===!1?null:(d()||cn("maxItems should be specified for non-primitive uniqueItems"),Object.assign(o,{unique:Z.unique,deepEqual:Z.deepEqual}),k("!unique(%s)",N)))})},Ze=r=>!v&&(M.required.includes(r)||Re().some(s=>s.stat.required.includes(r))),$r=()=>{const r=k("Object.keys(%s).length",N);j("maxProperties",["natural"],s=>k("%s > %d",r,s)),j("minProperties",["natural"],s=>k("%s < %d",r,s)),Ee("minProperties","maxProperties"),j("propertyNames",["object","boolean"],s=>(ut(A,(a,d)=>{const i=typeof s=="object"&&!s.$ref?{type:"string",...s}:s,u=Object.freeze({name:d,errorParent:a,type:"string"});ae(u,i,Q("propertyNames"))}),null)),j("required",["array"],s=>{for(const a of s){if(Ze(a))continue;const d=Ce(a);ce(Ue($e(d)),{path:["required"],prop:d})}return _({required:s}),null});for(const s of["dependencies","dependentRequired","dependentSchemas"])s!=="dependencies"&&ie().dependentUnsupported||j(s,["object"],a=>{for(const d of Object.keys(a)){const i=typeof a[d]=="string"?[a[d]]:a[d],u=Ce(d,Ze(d));if(Array.isArray(i)&&s!=="dependentSchemas"){const w=i.filter(U=>!Ze(U)).map(U=>$e(Ce(U))),S=Ue(kt(...w)),R={path:[s,d]};w.length===0||(u.checked?(ce(S,R),_({required:i})):ce(kt($e(u),S),R))}else Nn(i)&&s!=="dependentRequired"?(Ke(s),f.if(u.checked?!0:$e(u),()=>{const w=ae(A,i,Q(s,d),V);_(Pe({},w)),we(w)})):je(`Unexpected ${s} entry`)}return null});j("propertyDependencies",["object"],s=>{for(const[a,d]of Object.entries(s)){P(Fe(d),"propertyDependencies must be an object"),Ke("propertyDependencies");const i=Ce(a,Ze(a));f.if(i.checked?!0:$e(i),()=>{for(const[u,w]of Object.entries(d))P(Nn(w),"propertyDependencies must contain schemas"),f.if(Pt(Vt(i),u),()=>{const S=ae(A,w,Q("propertyDependencies",a,u),V);_(Pe({},S)),we(S)})})}return null}),j("properties",["object"],s=>{for(const a of Object.keys(s))me!==a&&ae(Ce(a,Ze(a)),s[a],Q("properties",a));return _({properties:Object.keys(s)}),null}),gt(l.patternProperties,()=>{if(j("patternProperties",["object"],s=>(ut(A,(a,d)=>{for(const i of Object.keys(s))Rt(i,l.propertyNames||{}),f.if(Dt(i,d),()=>{ae(a,s[i],Q("patternProperties",i))})}),_({patterns:Object.keys(s)}),null)),l.additionalProperties||l.additionalProperties===!1){const s=Object.keys(l.properties||{}),a=Object.keys(l.patternProperties||{});l.additionalProperties===!1&&On.push(()=>jn(s,a)),Nt("additionalProperties",i=>$n(i,s,a))}}),ie().objectContains&&xn(s=>{ut(A,(a,d)=>{s(a,()=>{_({dyn:{properties:[!0]}}),we({propertiesVars:[d]})})})})},jr=()=>{const r=j("const",["jsonval"],a=>Ue(Pt(N,a)));if(r&&!F)return!0;const s=j("enum",["array"],a=>{const d=a.filter(u=>u&&typeof u=="object"),i=a.filter(u=>!(u&&typeof u=="object"));return $t(...[...i,...d].map(u=>Pt(N,u)))});return r||s},xn=r=>{j("contains",["object","boolean"],()=>{Ke("contains"),ie().objectContains&&He("array")&&He("object")&&Ae("possible type confusion in 'contains',","forbid 'object' or 'array'");const s=z("passes");f.write("let %s = 0",s);const a=Ct();return r((d,i)=>{const{sub:u}=Ne(a,d,l.contains,Q("contains"));f.if(u,()=>{f.write("%s++",s),ie().containsEvaluates&&(P(!q,`Can't use removeAdditional with draft2020+ "contains"`),i())})}),j("minContains",["natural"],d=>k("%s < %d",s,d),{suberr:a})||ce(k("%s < 1",s),{path:["contains"],suberr:a}),j("maxContains",["natural"],d=>k("%s > %d",s,d)),Ee("minContains","maxContains"),null})},Or=()=>{j("not",["object","boolean"],i=>Ne(null,A,i,Q("not")).sub),l.not&&Ke("not"),(l.then||l.then===!1||l.else||l.else===!1||F)&&j("if",["object","boolean"],i=>{Ke("if/then/else");const{sub:u,delta:w}=Ne(null,A,i,Q("if"),V);let S,R,U,W;return j("else",["object","boolean"],J=>(S=()=>{U=ae(A,J,Q("else"),V),we(U)},null)),j("then",["object","boolean"],J=>(R=()=>{W=ae(A,J,Q("then"),V),we(Cn(w,W))},null)),!R&&!Ci(w)&&(R=()=>we(w)),f.if(u,R,S),_(Pe(U||{},Cn(w,W||{}))),null});const s=(i,u="allOf")=>{P(i.length>0,`${u} cannot be empty`);for(const[w,S]of Object.entries(i))_(ae(A,S,Q(u,w),V));return null};j("allOf",["array"],i=>s(i));let a=null;j("discriminator",["object"],i=>{const u=new Set,w=(G,Ye,Qe)=>P(G,`[discriminator]: ${Ye}`,Qe),{propertyName:S,mapping:R,...U}=i,W=Ce(S);w(S&&!l.oneOf!=!l.anyOf,"need propertyName, oneOf OR anyOf"),w(Object.keys(U).length===0,'only "propertyName" and "mapping" are supported');const J=G=>Fe(G)?Object.keys(G).length:null;return a=(G,Ye)=>{const Qe=()=>{f.write("switch (%s) {",Vt(W));let Xe;for(const[Ar,Be]of Object.entries(G)){const{const:Ut,enum:Sn,...Sr}=(Be.properties||{})[S]||{};let st=Ut!==void 0?[Ut]:Sn;if(!st&&Be.$ref){const[be]=et(t,m,Be.$ref,Te())[0]||[];P(Fe(be),"failed to resolve $ref:",Be.$ref);const ot=(be.properties||{})[S]||{};st=ot.const!==void 0?[ot.const]:ot.enum}const qr=Array.isArray(st)&&st.length>0;w(qr,"branches should have unique string const or enum values for [propertyName]");const Tr=Object.keys(Sr).length===0&&(!Ut||!Sn);w(Tr,"only const OR enum rules are allowed on [propertyName] in branches");for(const be of st){const ot=!R||Z.hasOwn(R,be)&&R[be]===Be.$ref;w(ot,"mismatching mapping for",be);const Pr=typeof be=="string"&&!u.has(be);w(Pr,"const/enum values for [propertyName] should be unique strings"),u.add(be),f.write("case %j:",be)}const Lt=ae(A,Be,Q(Ye,Ar),V,{constProp:S});we(Lt),Xe=Xe?Pe(Xe,Lt):Lt,f.write("break")}w(R===void 0||J(R)===u.size,"mismatching mapping size"),_(Xe),f.write("default:"),xe({path:[Ye]}),f.write("}")},it=()=>{if(Ze(S))Qe();else{const Xe=["discriminator","propertyName"];f.if($e(W),Qe,()=>xe({path:Xe,prop:W}))}};return v||!Z.deepEqual(M.type,["object"])?f.if(ve.get("object")(N),it,()=>xe({path:["discriminator"]})):it(),w(Z.deepEqual(M.type,["object"]),"has to be checked for type:","object"),w(M.required.includes(S),"propertyName should be placed in required:",S),null},null});const d=(i,u)=>{const w=u.map(U=>U.type||(Array.isArray(U.const)?"array":typeof U.const)),S=w.filter(U=>!Ht.includes(U)&&U!=="array").length,R=w.filter(U=>!Ht.includes(U)&&U!=="object").length;(S>1||R>1)&&Ke(`${i}, use discriminator to make it certain`)};j("anyOf",["array"],i=>{if(P(i.length>0,"anyOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"anyOf");const u=Ct();if(!mn()){d("anyOf",i);const W=Object.entries(i).map(([J,G])=>Ne(u,A,G,Q("anyOf",J),V));_(W.map(J=>J.delta).reduce((J,G)=>Pe(J,G))),ce($t(...W.map(({sub:J})=>J)),{path:["anyOf"],suberr:u});for(const{delta:J,sub:G}of W)f.if(G,()=>we(J));return null}const w=i.filter(W=>Z.hasOwn(W,"const")),S=i.filter(W=>!Z.hasOwn(W,"const"));d("anyOf",S);const R=[...w,...S];let U;if(ie().exclusiveRefs){let W=()=>xe({path:["anyOf"],suberr:u});for(const[J,G]of Object.entries(R).reverse()){const Ye=W;W=()=>{const{sub:Qe,delta:it}=Ne(u,A,G,Q("anyOf",J));f.if(Ue(Qe),Ye),U=U?Pe(U,it):it}}W()}else{const W=Object.entries(i).map(([J,G])=>Ne(u,A,G,Q("anyOf",J),V));U=W.map(J=>J.delta).reduce((J,G)=>Pe(J,G)),ce($t(...W.map(({sub:J})=>J)),{path:["anyOf"],suberr:u})}return _(U),null}),j("oneOf",["array"],i=>{if(P(i.length>0,"oneOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"oneOf");d("oneOf",i);const u=z("passes");f.write("let %s = 0",u);const w=Ct();let S,R=0;const U=Object.entries(i).map(([W,J])=>{!g&&R++>1&&ce(k("%s > 1",u),{path:["oneOf"]});const G=Ne(w,A,J,Q("oneOf",W),V);return f.if(G.sub,()=>f.write("%s++",u)),S=S?Pe(S,G.delta):G.delta,G});_(S),ce(k("%s !== 1",u),{path:["oneOf"]}),f.if(k("%s === 0",u),()=>vn(w));for(const W of U)f.if(W.sub,()=>we(W.delta));return null})},Ge=(r,s,a)=>{const[d,i]=[f.size(),Se.size];f.if(yr(...s)?!0:a,r),(d!==f.size()||i!==Se.size)&&P(He(...s),"Unexpected rules in type",l.type)},xr=()=>{if(M.items===1/0)l.unevaluatedItems===!1&&qe("unevaluatedItems","boolean");else if(l.unevaluatedItems||l.unevaluatedItems===!1)if(ke(M).items){if(!n[Ie])throw new Error("[opt] Dynamic unevaluated tracing not enabled");const r=k("Math.max(%d, ...%s)",M.items,V.items),s=a=>k("%s.includes(%s)",V.item,a);wt("unevaluatedItems",r,ie().containsEvaluates?s:null)}else wt("unevaluatedItems",k("%d",M.items))},Er=()=>{gt(M.patterns.length>0||M.dyn.patterns.length>0||M.unknown,()=>{if(M.properties.includes(!0))l.unevaluatedProperties===!1&&qe("unevaluatedProperties","boolean");else if(l.unevaluatedProperties||l.unevaluatedProperties===!1){const r=s=>$n(s,M.properties,M.patterns);if(ke(M).properties){if(!n[Ie])throw new Error("[opt] Dynamic unevaluated tracing not enabled");o.propertyIn=Z.propertyIn;const s=d=>k("!propertyIn(%s, %s)",d,V.props);Nt("unevaluatedProperties",d=>kt(r(d),s(d)))}else l.unevaluatedProperties===!1&&jn(M.properties,M.patterns),Nt("unevaluatedProperties",r)}})},En=()=>{if(yt!==null&&f.write("const %s = errorCount",yt),jr()){const r=[...ve.keys()];if(_({properties:[!0],items:1/0,type:r,fullstring:!0}),!F){P(Se.size===0,"Unexpected keywords mixed with const or enum:",[...Se]);return}}Ge(br,["number","integer"],ve.get("number")(N)),Ge(vr,["string"],ve.get("string")(N)),Ge(kr,["array"],ve.get("array")(N)),Ge($r,["object"],ve.get("object")(N)),Or(),Ge(xr,["array"],ve.get("array")(N)),Ge(Er,["object"],ve.get("object")(N));for(const r of On)r();hn(ge,le.item,le.items,le.props)},An=()=>{if(le.item&&f.write("const %s = []",le.item),le.items&&f.write("const %s = [0]",le.items),le.props&&f.write("const %s = [[], []]",le.props),j("$ref",["string"],s=>{const a=et(t,m,s,Te()),[d,i,u]=a[0]||[];if(!d&&d!==!1&&(je("failed to resolve $ref:",s),H))return null;const w=rt(d,i,u),S=d===e?pe:w;if(!o[S])throw new Error("Unexpected: coherence check failed");if(!o[S][Zt]&&d.type){const R=Array.isArray(d.type)?d.type:[d.type];_({type:R}),x&&(De.add(S),R.includes("array")&&_({items:1/0}),R.includes("object")&&_({properties:[!0]})),C&&R.includes("string")&&(De.add(S),_({fullstring:!0}))}return ht(w,{path:["$ref"]})}),ie().exclusiveRefs&&(P(!n[Ie],"unevaluated* is supported only on draft2019-09 and above"),l.$ref))return;j("$recursiveRef",["string"],s=>{if(!n[at])throw new Error("[opt] Recursive anchors are not enabled");P(s==="#",'Behavior of $recursiveRef is defined only for "#"');const a=et(t,m,"#",Te()),[d,i,u]=a[0];nt(d.$recursiveAnchor,"$recursiveRef without $recursiveAnchor");const w=rt(d,i,u),S=d.$recursiveAnchor?k("(recursive || %s)",w):w;return ht(S,{path:["$recursiveRef"]})}),j("$dynamicRef",["string"],s=>{if(!n[tt])throw new Error("[opt] Dynamic anchors are not enabled");nt(/^[^#]*#[a-zA-Z0-9_-]+$/.test(s),"Unsupported $dynamicRef format");const a=s.replace(/^[^#]+/,""),d=et(t,m,s,Te());if(!d[0]&&!ie().bookending){nt(!1,"$dynamicRef bookending resolution failed (even though not required)"),o.dynamicResolve=Z.dynamicResolve;const W=k("dynamicResolve(dynAnchors || [], %j)",a);return ht(W,{path:["$dynamicRef"]})}P(d[0],"$dynamicRef bookending resolution failed",s);const[i,u,w]=d[0],S=i.$dynamicAnchor&&`#${i.$dynamicAnchor}`===a;nt(S,"$dynamicRef without $dynamicAnchor in the same scope");const R=rt(i,u,w);o.dynamicResolve=Z.dynamicResolve;const U=S?k("(dynamicResolve(dynAnchors || [], %j) || %s)",a,R):R;return ht(U,{path:["$dynamicRef"]})});let r=null;j("type",["string","array"],s=>{const a=Array.isArray(s)?s:[s];for(const i of a)P(typeof i=="string"&&ve.has(i),"Unknown type:",i);if(A.type)return P(Z.deepEqual(a,[A.type]),"One type allowed:",A.type),_({type:[A.type]}),null;if(wn(...a))return null;const d=a.filter(i=>He(i));return d.length===0&&je("No valid types possible"),_({type:a}),r=$t(...d.map(i=>ve.get(i)(N))),null}),r&&v?f.if(r,()=>xe({path:["type"]}),En):(r&&ce(r,{path:["type"]}),En()),M.items<1/0&&l.maxItems<=M.items&&_({items:1/0})};if(l.default!==void 0&&y){Ve&&je("Can not apply default value here (e.g. at root)");const r=fn("default","jsonval");f.if($e(A),An,()=>f.write("%s = %j",N,r))}else j("default",["jsonval"],null),f.if(Ve?!0:$e(A),An);if(Je.length=mr,ze[0]&&ze[ze.length-1][0]===l&&ze.pop(),pn&&l!==e&&f.write("dynLocal.shift()"),T||P(!f.optimizedOut,"some checks are never reachable"),mt){const r=["not","if","then","else"].includes(ee[ee.length-1]),s=["oneOf","anyOf","allOf"].includes(ee[ee.length-2]),a=["dependencies","dependentSchemas"].includes(ee[ee.length-2]),d=["propertyDependencies"].includes(ee[ee.length-3]);P(r||s||a||d,"Unexpected logical path")}else if(!ee.includes("not")&&((!(e!==t&&l===e)||De.has(pe))&&(De.delete(pe),M.type||Ae("type"),He("array")&&M.items!==1/0&&Ae(l.items?"additionalItems or unevaluatedItems":"items rule"),He("object")&&!M.properties.includes(!0)&&Ae("additionalProperties or unevaluatedProperties"),!M.fullstring&&C&&je("[requireStringValidation] pattern, format or contentSchema should be specified for strings, use pattern: ^[\\s\\S]*$ to opt-out")),typeof l.propertyNames!="object"))for(const s of["additionalProperties","unevaluatedProperties"])l[s]&&Ae(`wild-card ${s}`,"requires propertyNames");return l.properties&&!l.required&&Ae("if properties is used, required"),P(Se.size===0||F,"Unprocessed keywords:",[...Se]),{stat:M,local:le}},{stat:It,local:pt}=Mt(k("validate.errors"),[],{name:Dn("data")},e,[]);if(De.has(pe))throw new Error("Unexpected: unvalidated cyclic ref");if(n[Ie]&&(ke(It).items||ke(It).properties)){if(!pt)throw new Error("Failed to trace dynamic properties");f.write("validate.evaluatedDynamic = [%s, %s, %s]",pt.item,pt.items,pt.props)}return v?f.write("return errorCount === 0"):f.write("return true"),f.write("}"),H||(ft=f.makeFunction(o),delete o[pe],o[pe]=ft),o[pe][Zt]=It,pe},Ot=(e,t)=>{if(!Array.isArray(e))throw new Error("Expected an array of schemas");try{const n=Object.create(null),{getref:o}=or(n);De.clear(),dt.clear();const c=e.map(p=>o(p)||ar(p,p,t,n));if(De.size!==0)throw new Error("Unexpected: not all refs are validated");return{scope:n,refs:c}}catch(n){if(!t[Ie]&&n.message==="[opt] Dynamic unevaluated tracing not enabled")return Ot(e,{...t,[Ie]:!0});if(!t[tt]&&n.message==="[opt] Dynamic anchors are not enabled")return Ot(e,{...t,[tt]:!0});if(!t[at]&&n.message==="[opt] Recursive anchors are not enabled")return Ot(e,{...t,[at]:!0});throw n}finally{De.clear(),dt.clear()}};var Wi={compile:Ot};const Ji=Kn,{buildSchemas:Vi}=tr,{compile:Ki}=Wi,{deepEqual:rn}=tn,Hi=e=>function t(n){if(!rn(n,JSON.parse(JSON.stringify(n))))return t.errors=[{instanceLocation:"#",error:"not JSON compatible"}],!1;const o=e(n);return t.errors=e.errors,o},Zi=e=>t=>rn(t,JSON.parse(JSON.stringify(t)))&&e(t),sn=(e,{parse:t=!1,multi:n=!1,jsonCheck:o=!1,isJSON:c=!1,schemas:p=[],...y}={})=>{if(o&&c)throw new Error("Can not specify both isJSON and jsonCheck options");if(t&&(o||c))throw new Error("jsonCheck and isJSON options are not applicable in parser mode");const q=t?"strong":"default",g=c||o||t,v=n?e:[e],E={mode:q,...y,schemas:Vi(p,v),isJSON:g},{scope:Y,refs:H}=Ki(v,E);if(y.dryRun)return;if(y.lint)return Y.lintErrors;const F=Ji();if(t?Y.parseWrap=y.includeErrors?Gi:Yi:o&&(Y.deepEqual=rn,Y.jsonCheckWrap=y.includeErrors?Hi:Zi),n){F.write("[");for(const O of H.slice(0,-1))F.write("%s,",O);H.length>0&&F.write("%s",H[H.length-1]),F.write("]"),t?F.write(".map(parseWrap)"):o&&F.write(".map(jsonCheckWrap)")}else t?F.write("parseWrap(%s)",H[0]):o?F.write("jsonCheckWrap(%s)",H[0]):F.write("%s",H[0]);const T=F.makeFunction(Y);return T.toModule=({semi:O=!0}={})=>F.makeModule(Y)+(O?";":""),T.toJSON=()=>e,T},Gi=e=>t=>{if(typeof t!="string")return{valid:!1,error:"Input is not a string"};try{const n=JSON.parse(t);if(!e(n)){const{keywordLocation:o,instanceLocation:c}=e.errors[0];return{valid:!1,error:`JSON validation failed for ${o.slice(o.lastIndexOf("/")+1)} at ${c}`,errors:e.errors}}return{valid:!0,value:n}}catch({message:n}){return{valid:!1,error:n}}},Yi=e=>t=>{if(typeof t!="string")return{valid:!1};try{const n=JSON.parse(t);return e(n)?{valid:!0,value:n}:{valid:!1}}catch{return{valid:!1}}},Qi=function(e,{parse:t=!0,...n}={}){if(!t)throw new Error("can not disable parse in parser");return sn(e,{parse:t,...n})},Xi=function(e,{lint:t=!0,...n}={}){if(!t)throw new Error("can not disable lint option in lint()");return sn(e,{lint:t,...n})};var Bi={validator:sn,parser:Qi,lint:Xi};const es="http://json-schema.org/draft-04/schema#",ts="object",ns={version:{type:"string"},isReadonly:{type:"boolean"},isDrawerOpen:{type:"boolean"},showLegend:{type:"boolean"},techniqueMappingMode:{type:"string"},selectedProfile:{type:"integer"},selectedStore:{type:"string"},containerSize:{type:"number"},matrixSize:{type:"integer"},associationMode:{type:"boolean"},matrixCommentMode:{type:"boolean"},localStorageWarning:{type:"boolean"},profiles:{type:"array",items:[{type:"object",properties:{id:{type:"integer"},description:{type:"string"},name:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","description","name","includedLayers"]}]},layers:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},color:{type:"string"},children:{type:"array",items:[{type:"string"}]},checked:{type:"boolean"}},additionalProperties:!1,required:["id","description","name","techniques","color","children","checked"]}}},attack:{type:"object",patternProperties:{".*":{type:"object",patternProperties:{".*":{type:"array",items:[{type:"object",properties:{id:{type:"string"},justification:{type:"string"},tactic:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","justification","tactic"]}]}}}}},rootTemplates:{type:"array",items:[{type:"string"}]},templates:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},checked:{type:"boolean"},color:{type:"string"},children:{type:"array",items:{}}},additionalProperties:!1,required:["id","description","name","techniques","checked","color","children"]}}},shownTactics:{type:"object",properties:{"d3f:Model":{type:"boolean"},"d3f:Harden":{type:"boolean"},"d3f:Detect":{type:"boolean"},"d3f:Isolate":{type:"boolean"},"d3f:Deceive":{type:"boolean"},"d3f:Evict":{type:"boolean"}},required:["d3f:Model","d3f:Harden","d3f:Detect","d3f:Isolate","d3f:Deceive","d3f:Evict"]}},rs=!1,is=["version","isReadonly","isDrawerOpen","showLegend","techniqueMappingMode","selectedProfile","selectedStore","containerSize","matrixSize","associationMode","matrixCommentMode","localStorageWarning","profiles","layers","attack","rootTemplates","templates","shownTactics"],ss={$schema:es,type:ts,properties:ns,additionalProperties:rs,required:is},he={layers:"layers",templates:"templates"},os={rootColor:"multiColor",heatMap:"heatMap",childrenMultiColor:"childrenMultiColor","ATT&CK":"ATT&CK"},ds={attack:"attack",controls:"controls",cwe:"cwe",act:"acf"},cr={version:"1",isReadonly:!1,isDrawerOpen:!0,showLegend:!0,techniqueMappingMode:os.childrenMultiColor,selectedProfile:0,selectedStore:he.layers,containerSize:.8,matrixSize:1,associationMode:!1,matrixCommentMode:!1,localStorageWarning:!0,profiles:[{id:0,description:"Testing the description",name:"Profile 1",includedLayers:["claimed-dkjndlkdj","tested-dnkljlkldjs","integration-jksieufnvdkd"]},{id:1,description:"Testing the description",name:"Profile 2",includedLayers:["zero-trust-kdjj2mvnvjkkd"]},{id:2,description:"Testing the description",name:"Profile 3",includedLayers:["next-generation-firewall-kjlknlkn","zero-trust-kdjj2mvnvjkkd"]}],layers:{"zero-trust-kdjj2mvnvjkkd":{id:"zero-trust-kdjj2mvnvjkkd",description:"Testing the description",name:"Zero-Trust",techniques:[],color:"#ef0b0b",children:["role-based-access-hdjkfkkbvgn","continuous-verification-jkqwwer","geo-location-ie83909"],checked:!0},"role-based-access-hdjkfkkbvgn":{id:"role-based-access-hdjkfkkbvgn",description:"Testing the description",name:"Role-Based Access",techniques:[{id:"d3f:DataInventory",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""},{id:"d3f:AssetInventory",comment:""}],children:[],color:"#ef0b0b",checked:!0},"least-priviledge-27kdjkdfkj":{id:"least-priviledge-27kdjkdfkj",description:"Testing the description",name:"Least Priviledge",techniques:[{id:"d3f:DNSAllowlisting",comment:""},{id:"d3f:DNSDenylisting",comment:""},{id:"d3f:ForwardResolutionDomainDenylisting",comment:""},{id:"d3f:HierarchicalDomainDenylisting",comment:""},{id:"d3f:HomoglyphDenylisting",comment:""},{id:"d3f:ForwardResolutionIPDenylisting",comment:""},{id:"d3f:ReverseResolutionIPDenylisting",comment:""},{id:"d3f:InboundTrafficFiltering",comment:""},{id:"d3f:OutboundTrafficFiltering",comment:""},{id:"d3f:AccountLocking",comment:""},{id:"d3f:ProcessTermination",comment:""}],color:"#bbc171",checked:!0,children:[]},"continuous-verification-jkqwwer":{id:"continuous-verification-jkqwwer",description:"Testing the description",name:"Continuous Verification",techniques:[],color:"#ef0b0b",children:[],checked:!1},"geo-location-ie83909":{id:"geo-location-ie83909",description:"Testing the description",name:"Geo Location",techniques:[{id:"d3f:TransferAgentAuthentication",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""}],color:"#ef0b0b",children:[],checked:!0},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[],children:[],color:"#ef0b0b",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",description:"Testing the description",name:"Web Filtering",techniques:[],color:"#ef0b0b",children:[],checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],color:"#ef0b0b",children:[],checked:!1},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",description:"Testing the description",name:"Threat Prevention",techniques:[],color:"#ef0b0b",children:[],checked:!0},"application-and-identiy-based-inspection-dkvn":{id:"application-and-identiy-based-inspection-dkvn",description:"Testing the description",name:"Application and Identiy-based Inspection",techniques:[{id:"d3f:HomoglyphDetection",comment:""},{id:"d3f:URLAnalysis",comment:""},{id:"d3f:CertificateAnalysis",comment:""},{id:"d3f:PassiveCertificateAnalysis",comment:""},{id:"d3f:IPCTrafficAnalysis",comment:""},{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:DomainAccountMonitoring",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:LocalAccountMonitoring",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""},{id:"d3f:SessionDurationAnalysis",comment:""},{id:"d3f:UserDataTransferAnalysis",comment:""},{id:"d3f:UserGeolocationLogonPatternAnalysis",comment:""},{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],color:"#817fcc",checked:!0,children:[]},"scalability-kdnvmv":{id:"scalability-kdnvmv",description:"Testing the description",name:"Scalability",techniques:[],color:"#ef0b0b",children:[],checked:!0},"next-generation-firewall-kjlknlkn":{id:"next-generation-firewall-kjlknlkn",description:"Testing the description",name:"Next-Generation Firewall",techniques:[],color:"#ef0b0b",children:["web-filtering-3iejkdfmv","sandboxing-kdnvmvmmv","threat-prevention-kdkvsaka"],checked:!1},"claimed-dkjndlkdj":{id:"claimed-dkjndlkdj",description:"Testing the description",name:"Claimed",checked:!0,techniques:[],color:"#98d0A9",children:["scalability-kdnvmv","application-and-identiy-based-inspection-dkvn"]},"tested-dnkljlkldjs":{id:"tested-dnkljlkldjs",description:"Testing the description",name:"Tested",checked:!0,techniques:[{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],children:[],color:"#7eec9f"},"integration-jksieufnvdkd":{id:"integration-jksieufnvdkd",description:"Testing the description",name:"Integration",techniques:[],children:["least-priviledge-27kdjkdfkj"],checked:!0,color:"#ffcc80"}},attack:{},rootTemplates:["firewall-kdjenyeurhg","threat-prevention-kdkvsaka"],templates:{"firewall-kdjenyeurhg":{id:"firewall-kdjenyeurhg",description:"Testing the description",name:"Firewall",techniques:[],checked:!0,color:"#7078A4",children:["bandwidth-control-and-monitoring-837fdrkdm"]},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[{id:"d3f:SoftwareUpdate",comment:""},{id:"d3f:ByteSequenceEmulation",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:NetworkTrafficFiltering",comment:""}],children:[],color:"#7078A4",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",name:"Web Filtering",description:"Testing the description",techniques:[],children:[],color:"#7078A4",checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],children:[],checked:!0,color:"#BB5883"},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",name:"Threat Prevention",description:"Testing the description",techniques:[],children:[],color:"#BB5883",checked:!0}},shownTactics:{"d3f:Model":!1,"d3f:Harden":!1,"d3f:Detect":!1,"d3f:Isolate":!1,"d3f:Deceive":!1,"d3f:Evict":!1}},Un={selected:"selected",editing:"editing",parent:"parent",root:"root",noop:"noop"};try{const e=Bi.parser(ss,{requireStringValidation:!1,mode:"lax",includeErrors:!0,allErrors:!0}),{valid:t,error:n,errors:o}=e(JSON.stringify(cr));if(!t)throw new AggregateError(o,`Error Parsing Initial Profile Layer: ${n}`)}catch(e){if(console.error(e.message),Array.isArray(e.errors))for(let t=0;t<e.errors.length;t++){const n=e.errors[t];console.error(n)}else console.error(e.errors);process.exit(1)}const as=e=>{const{subscribe:t,update:n,set:o}=Dr("d3fend-layers",e);return{subscribe:t,update:n,set:o,createProfile:h=>n(m=>{const $=m.profiles.length;return h.id=$,h.includedLayers=[],m.profiles.push(h),m.selectedProfile=$,m}),deleteProfile:()=>n(h=>(h.profiles=h.profiles.filter((m,$)=>$!==h.selectedProfile),h.selectedProfile=h.profiles.length?0:null,h)),addLayer:h=>n(m=>(m.layers[h.id]=h,m.profiles[m.selectedProfile].includedLayers.push(h.id),m)),bulkAddLayer:(h,m)=>n($=>{for(const b of h)$.layers[b.id]=b;return $.profiles[$.selectedProfile].includedLayers.push(m),$}),addTemplate:h=>n(m=>(m.templates[h.id]=h,m.rootTemplates.push(h.id),m)),copyFromTemplate:(h,m=he.layers)=>n($=>(h.id=_t(h.name),$[m][h.id]=h,$)),appendLayer:h=>n(m=>(m.layers[h]&&m.profiles[m.selectedProfile].includedLayers.push(h),m)),editName:(h,m,$=he.layers)=>n(b=>(b[$][h].name=m,b)),editLayerComment:(h,m,$=he.layers)=>n(b=>(b[$][h].comment=m,b)),addChild:(h,m,$=he.layers)=>n(b=>{const z=_t(m.name),X=h.id;return m.id=z,m.checked=!0,m.children=[],m.techniques=[...h.techniques],m.color=h.color,b[$][z]=m,b[$][X].children||(b[$][X].children=[]),b[$][X].children.push(z),b[$][X].techniques=[],b}),addNonRootChild:(h,m,$=he.layers)=>n(b=>{const z=_t(m.name);return m.id=z,m.checked=!0,m.techniques=[],m.children=[],m.color=h.color,b[$][z]=m,b[$][h.id].children.push(z),b}),deleteLayer:h=>n(m=>{const{[h]:$,...b}=m.layers,z=m.profiles.reduce((X,L,B)=>{if(m.selectedProfile===B){const re={...L,includedLayers:L.includedLayers.filter(pe=>pe!==h)};X.push(re)}else X.push(L);return X},[]);return{...m,profiles:z,layers:b}}),deleteTemplate:h=>n(m=>{const{[h]:$,...b}=m.templates,z=m.rootTemplates.filter(X=>h!==X);return{...m,templates:b,rootTemplates:z}}),deleteSublayer:(h,m,$=he.layers)=>n(b=>(b[$][m].children=b[$][m].children.filter(z=>z!==h.id),delete b[$][h.id],b)),saveTechniques:(h,m,$=he.layers)=>n(b=>{const z=Object.values(h).reduce((L,B)=>(B.classes.isSelected&&L.push(B["@id"]),L),[]);return Object.entries(m).reduce((L,[B,re])=>(re===Un.selected&&L.push(B),L),[]).forEach(L=>{const B=[...new Set([...b[$][L].techniques.map(re=>re.id),...z])];b[$][L].techniques=B.map(re=>({id:re,comment:""})),b[$][L].checked=!0}),b}),removeTechniques:(h,m,$=he.layers)=>n(b=>{const z=Object.values(h).reduce((L,B)=>(B.classes.isSelected&&L.push(B["@id"]),L),[]);return Object.entries(m).reduce((L,[B,re])=>(re===Un.selected&&L.push(B),L),[]).forEach(L=>{const B=b[$][L].techniques.filter(re=>!z.includes(re.id));b[$][L].techniques=B,b[$][L].checked=!0}),b}),saveLayerColor:(h,m,$=he.layers)=>n(b=>(b[$][h.id].color=m,b)),saveLayerTechniqueComment:(h,m,$,b=he.layers)=>n(z=>{const X=z[b][h].techniques.find(L=>L.id===m);return X.comment=$,z}),changeTechniqueMappingMode:(h,m)=>n($=>($.techniqueMappingMode=h,$.showLegend=m,$)),addUserAssociatedAttack:(h,m,$)=>n(b=>{if((b.attack[h]||(b.attack[h]={}))&&(b.attack[h][m]||(b.attack[h][m]=[]))){const z=`${$.id}${$.tactic}`;if(b.attack[h][m].findIndex(({id:L,tactic:B})=>`${L}${B}`===z)!==-1)return b;b.attack[h][m].push($)}return b}),editUserAssociatedAttack:(h,m,$)=>n(b=>(b.attack[h][m].justification=$,b)),deleteUserAssociatedAttack:(h,m,$)=>n(b=>{const z=b.attack[h][m].reduce((X,L)=>(L.id!==$&&X.push(L),X),[]);return b.attack[h][m]=z,b})}},fs=as(cr);export{os as M,he as P,Un as S,ds as T,ss as j,fs as l,Bi as s};
