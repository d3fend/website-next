import{w as Mr}from"./index.C6plYK4b.js";import{c as Ft}from"./utils.xEKteSAW.js";var _t={local:{},session:{}};function Dr(e){return e==="local"?localStorage:sessionStorage}function Rr(e,t,n){var o,c,m,y,x,g,$,P;const H=(o=void 0)!=null?o:JSON,F=(c=void 0)!=null?c:"local",W=(m=void 0)!=null?m:!0,q=(x=(y=void 0)!=null?y:void 0)!=null?x:ne=>console.error(`Error when writing value from persisted store "${e}" to ${F}`,ne),A=(g=void 0)!=null?g:(ne,le)=>console.error(`Error when parsing ${ne?'"'+ne+'"':"value"} from persisted store "${e}"`,le),O=($=void 0)!=null?$:ne=>ne,z=(P=void 0)!=null?P:ne=>ne,V=typeof window<"u"&&typeof document<"u",Q=V?Dr(F):null;function ce(ne,le){const ye=z(le);try{Q==null||Q.setItem(ne,H.stringify(ye))}catch(Oe){q(Oe)}}function te(){function ne(h){try{return H.parse(h)}catch(u){A(h,u)}}const le=Q==null?void 0:Q.getItem(e);if(le==null)return t;const ye=ne(le);return ye==null?t:O(ye)}if(!_t[F][e]){const ne=te(),le=Mr(ne,h=>{if(V&&F=="local"&&W){const u=w=>{if(w.key===e&&w.newValue){let v;try{v=H.parse(w.newValue)}catch(Y){A(w.newValue,Y);return}const D=O(v);h(D)}};return window.addEventListener("storage",u),()=>window.removeEventListener("storage",u)}}),{subscribe:ye,set:Oe}=le;_t[F][e]={set(h){Oe(h),ce(e,h)},update(h){return le.update(u=>{const w=h(u);return ce(e,w),w})},reset(){this.set(t)},subscribe:ye}}return _t[F][e]}class ct extends String{}const Ir=new Set(["<",">","<=",">="]),zr=e=>`\\u${e.toString(16).padStart(4,"0")}`,Cr=e=>{if([1/0,-1/0,NaN,void 0,null].includes(e))return`${e}`;if(!["string","boolean","number"].includes(typeof e)){if(typeof e!="object")throw new Error("Unexpected value type");const n=Object.getPrototypeOf(e);if(!(n===Array.prototype&&Array.isArray(e)||n===Object.prototype))throw new Error("Unexpected object given as value")}return JSON.stringify(e).replace(/([{,])"__proto__":/g,'$1["__proto__"]:').replace(/[^\\]"__proto__":/g,()=>{throw new Error("Unreachable")}).replace(/[\u2028\u2029]/g,n=>zr(n.charCodeAt(0)))},St=(e,...t)=>{const n=e.replace(/%[%drscjw]/g,o=>{if(o==="%%")return"%";if(t.length===0)throw new Error("Unexpected arguments count");const c=t.shift();switch(o){case"%d":if(typeof c=="number")return c;throw new Error("Expected a number");case"%r":if(c instanceof RegExp)return St("new RegExp(%j, %j)",c.source,c.flags);throw new Error("Expected a RegExp instance");case"%s":if(c instanceof ct)return c;throw new Error("Expected a safe string");case"%c":if(Ir.has(c))return c;throw new Error("Expected a compare op");case"%j":return Cr(c);case"%w":if(Number.isInteger(c)&&c>=0)return" ".repeat(c);throw new Error("Expected a non-negative integer for indentation")}throw new Error("Unreachable")});if(t.length!==0)throw new Error("Unexpected arguments count");return new ct(n)},Zt=e=>{if(!/^[a-z][a-z0-9_]*$/i.test(e))throw new Error("Does not look like a safe id");return new ct(e)},Ln=e=>(...t)=>{if(!t.every(n=>n instanceof ct))throw new Error("Unsafe arguments");return new ct(e(...t))},Nr=e=>/^[a-z][a-z0-9_().]*$/i.test(e)||/^\([^()]+\)$/i.test(e)?e:St("(%s)",e),Ur=Ln((...e)=>e.some(t=>`${t}`=="true")?"true":e.join(" || ")||"false"),Lr=Ln((...e)=>e.some(t=>`${t}`=="false")?"false":e.join(" && ")||"true"),Fn=e=>`${e}`=="true"?Zt("false"):`${e}`=="false"?Zt("true"):St("!%s",Nr(e)),Fr=(...e)=>Fn(Ur(...e));var xt={format:St,safe:Zt,safeand:Lr,safenot:Fn,safenotor:Fr};const{safe:Pn}=xt,Wt=new WeakMap,_r=e=>{Wt.has(e)||Wt.set(e,{sym:new Map,ref:new Map,format:new Map,pattern:new Map});const t=Wt.get(e),n=g=>{t.sym.get(g)||t.sym.set(g,0);const $=t.sym.get(g);return t.sym.set(g,$+1),Pn(`${g}${$}`)},o=g=>{if(t.pattern.has(g))return t.pattern.get(g);const $=n("pattern");return e[$]=new RegExp(g,"u"),t.pattern.set(g,$),$};return t.loop||(t.loop="ijklmnopqrstuvxyz".split("")),{gensym:n,genpattern:o,genloop:()=>{const g=t.loop.shift();return t.loop.push(`${g}${g[0]}`),Pn(g)},getref:g=>t.ref.get(g),genref:g=>{const $=n("ref");return t.ref.set(g,$),$},genformat:g=>{let $=t.format.get(g);return $||($=n("format"),e[$]=g,t.format.set(g,$)),$}}};var _n={scopeMethods:_r};const Wr=e=>/[\uD800-\uDFFF]/.test(e)?[...e].length:e.length,Vr=(e,t,n,o)=>{if(e%t===0)return!0;let c=e*n;if((c===1/0||c===-1/0)&&(c=e),c%o===0)return!0;const m=Math.floor(c+.5);return m/n===e&&m%o===0},lt=(e,t)=>{if(e===t)return!0;if(!e||!t||typeof e!=typeof t||e!==t&&typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n!==Object.getPrototypeOf(t))return!1;if(n===Array.prototype)return!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length?!1:e.every((o,c)=>lt(o,t[c]));if(n===Object.prototype){const[o,c]=[Object.keys(e),Object.keys(t)];return o.length!==c.length?!1:new Set([...o,...c]).size===o.length&&o.every(y=>lt(e[y],t[y]))}return!1},Jr=e=>{if(e.length<2)return!0;if(e.length===2)return!lt(e[0],e[1]);const t=[],n=e.length>20?new Set:null;let o=0,c=0;for(const m of e){if(typeof m=="object")t.push(m);else if(n){if(n.add(m),n.size!==++o)return!1}else if(e.indexOf(m,c+1)!==-1)return!1;c++}for(let m=1;m<t.length;m++)for(let y=0;y<m;y++)if(lt(t[m],t[y]))return!1;return!0},Kr=e=>{if(typeof Buffer<"u")return Buffer.from(e,"base64").toString("utf-8");const t=atob(e);return new TextDecoder("utf-8").decode(new Uint8Array(t.length).map((n,o)=>t.charCodeAt(o)))},Wn=Function.prototype.call.bind(Object.prototype.hasOwnProperty);Wn[Symbol.for("toJayString")]="Function.prototype.call.bind(Object.prototype.hasOwnProperty)";const Vn=e=>/~\//.test(e)?`${e}`.replace(/~/g,"~0").replace(/\//g,"~1"):e,Hr=e=>e.length===0?"#":`#/${e.map(Vn).join("/")}`,Gr=({keywordLocation:e,instanceLocation:t},n,o)=>({keywordLocation:`${n}${e.slice(1)}`,instanceLocation:`${o}${t.slice(1)}`}),Zr=(e,[t,n])=>t.includes(!0)||t.some(o=>o===e)||n.some(o=>new RegExp(o,"u").test(e)),Yr=(e,t)=>(e.filter(n=>n[t])[0]||{})[t],Qr={toPointer:Hr,pointerPart:Vn,errorMerge:Gr,propertyIn:Zr,dynamicResolve:Yr};var tn={stringLength:Wr,isMultipleOf:Vr,deepEqual:lt,unique:Jr,deBase64:Kr,hasOwn:Wn,...Qr};const{format:R,safe:Xr}=xt,{scopeMethods:Br}=_n,wt=tn,Yt=new Map(Object.entries({null:e=>R("%s === null",e),boolean:e=>R('typeof %s === "boolean"',e),array:e=>R("Array.isArray(%s)",e),object:e=>R('typeof %s === "object" && %s && !Array.isArray(%s)',e,e,e),number:e=>R('typeof %s === "number"',e),integer:e=>R("Number.isInteger(%s)",e),string:e=>R('typeof %s === "string"',e)})),Fe=({name:e,parent:t,keyval:n,keyname:o})=>{if(e){if(t||n||o)throw new Error("name can be used only stand-alone");return e}if(!t)throw new Error("Can not use property of undefined parent!");const c=Fe(t);if(n!==void 0){if(o)throw new Error("Can not use key value and name together");if(!["string","number"].includes(typeof n))throw new Error("Invalid property path");return/^[a-z][a-z0-9_]*$/i.test(n)?R("%s.%s",c,Xr(n)):R("%s[%j]",c,n)}else if(o)return R("%s[%s]",c,o);throw new Error("Unreachable")},ei=new Set([].concat(...[Object,Array,String,Number,Boolean].map(e=>Object.getOwnPropertyNames(e.prototype)))),ti=(e,t,n,{unmodifiedPrototypes:o,isJSON:c},m)=>{const{gensym:y,genpattern:x,genloop:g}=Br(t,n);return{present:q=>{const A=Fe(q),{parent:O,keyval:z,keyname:V,inKeys:Q,checked:ce}=q;if(ce||Q&&c)throw new Error("Unreachable: useless check for undefined");if(Q)return R("%s !== undefined",A);if(O&&V){t.hasOwn=wt.hasOwn;const te=Fe(O);return c?R("%s !== undefined && hasOwn(%s, %s)",A,te,V):R("%s in %s && hasOwn(%s, %s)",V,te,te,V)}else if(O&&z!==void 0){if(o&&c&&!ei.has(`${z}`))return R("%s !== undefined",A);t.hasOwn=wt.hasOwn;const te=Fe(O);return c?R("%s !== undefined && hasOwn(%s, %j)",A,te,z):R("%j in %s && hasOwn(%s, %j)",z,te,te,z)}throw new Error("Unreachable: present() check without parent")},forObjectKeys:(q,A)=>{const O=y("key");e.block(R("for (const %s of Object.keys(%s))",O,Fe(q)),()=>{A(n(q,O,!0),O)})},forArray:(q,A,O)=>{const z=g(),V=Fe(q);e.block(R("for (let %s = %s; %s < %s.length; %s++)",z,A,z,V,z),()=>{O(n(q,z,o,!0),z)})},patternTest:(q,A)=>{const O=q.replace(/[.^$|*+?(){}[\]\\]/gu,"");if(q===`^${O}$`)return R("(%s === %j)",A,q.slice(1,-1));if(m.has(q))return R("true");if([O,`${O}+`,`${O}.*`,`.*${O}.*`].includes(q))return R("%s.includes(%j)",A,O);if([`^${O}`,`^${O}+`,`^${O}.*`].includes(q))return R("%s.startsWith(%j)",A,O);if([`${O}$`,`.*${O}$`].includes(q))return R("%s.endsWith(%j)",A,O);const z=[...O].slice(0,-1).join("");return[`${O}*`,`${O}?`].includes(q)?z.length===0?R("true"):R("%s.includes(%j)",A,z):[`^${O}*`,`^${O}?`].includes(q)?z.length===0?R("true"):R("%s.startsWith(%j)",A,z):R("%s.test(%s)",x(q),A)},compare:(q,A)=>{if(!A||typeof A!="object")return R("%s === %j",q,A);let O;const z=V=>V.length<=3&&V.every(Q=>!Q||typeof Q!="object");if(Array.isArray(A)){if(O=Yt.get("array")(q),z(A)){let V=R("%s.length === %d",q,A.length);for(let Q=0;Q<A.length;Q++)V=R("%s && %s[%d] === %j",V,q,Q,A[Q]);return R("%s && %s",O,V)}}else{O=Yt.get("object")(q);const[V,Q]=[Object.keys(A),Object.values(A)];if(z(Q)){let ce=R("Object.keys(%s).length === %d",q,V.length);V.length>0&&(t.hasOwn=wt.hasOwn);for(const te of V)ce=R("%s && hasOwn(%s, %j)",ce,q,te);for(const te of V)ce=R("%s && %s[%j] === %j",ce,q,te,A[te]);return R("%s && %s",O,ce)}}return t.deepEqual=wt.deepEqual,R("%s && deepEqual(%s, %j)",O,q,A)},propvar:n}},ni=/^\([^)]*\) *=>/,ri=/^[^=]*=>/,qn=Symbol.for("toJayString");function ii(e){if(typeof e=="function"){if(e[qn])return e[qn];if(Object.getPrototypeOf(e)!==Function.prototype)throw new Error("Can not stringify: a function with unexpected prototype");const t=`${e}`;if(e.prototype){if(!/^function[ (]/.test(t))throw new Error("Unexpected function");return t}if(ni.test(t)||ri.test(t))return t;throw new Error("Can not stringify: only either normal or arrow functions are supported")}else if(typeof e=="object"){const t=Object.getPrototypeOf(e);if(e instanceof RegExp&&t===RegExp.prototype)return R("%r",e);throw new Error("Can not stringify: an object with unexpected prototype")}throw new Error(`Can not stringify: unknown type ${typeof e}`)}var Jn={types:Yt,buildName:Fe,jsHelpers:ti,jaystring:ii};const{format:vt,safe:si,safenot:oi}=xt,{jaystring:ai}=Jn,ci=/[{[]/,li=/[}\]]/;var Kn=()=>{const e=[];let t=0;const n=m=>{li.test(m.trim()[0])&&t--,e.push({indent:t,code:m}),ci.test(m[m.length-1])&&t++},o=()=>{if(t!==0)throw new Error("Unexpected indent at build()");const m=e.map(y=>vt("%w%s",y.indent*2,y.code)).join(`
`);return/^[a-z][a-z0-9]*$/i.test(m)?`return ${m}`:`return (${m})`},c=m=>{const y=Object.entries(m);for(const[x,g]of y){if(!/^[a-z][a-z0-9]*$/i.test(x))throw new Error("Unexpected scope key!");if(!(typeof g=="function"||g instanceof RegExp))throw new Error("Unexpected scope value!")}return y};return{optimizedOut:!1,size:()=>e.length,write(m,...y){if(typeof m!="string")throw new Error("Format must be a string!");if(m.includes(`
`))throw new Error("Only single lines are supported");return n(vt(m,...y)),!0},block(m,y,x=!1){const g=t;this.write("%s {",m);const $=e.length;if(y(),$===e.length)return e.pop(),t=g,!1;if($===e.length-1&&!x){const{code:P}=e[e.length-1];if(!/^(if|for) /.test(P))return e.length-=2,t=g,this.write("%s %s",m,P)}return this.write("}")},if(m,y,x){`${m}`=="false"?(x&&x(),y&&(this.optimizedOut=!0)):`${m}`=="true"?(y&&y(),x&&(this.optimizedOut=!0)):y&&this.block(vt("if (%s)",m),y,!!x)?x&&this.block(vt("else"),x):x&&this.if(oi(m),x)},makeModule(m={}){return`(function() {
'use strict'
${c(m).map(([x,g])=>`const ${si(x)} = ${ai(g)};`).join(`
`)}
${o()}})()`},makeFunction(m={}){const y=c(m),x=y.map($=>$[0]),g=y.map($=>$[1]);return Function(...x,`'use strict'
${o()}`)(...g)}}};const di=["$schema","$vocabulary","id","$id","$anchor","$ref","definitions","$defs","$recursiveRef","$recursiveAnchor","$dynamicAnchor","$dynamicRef","type","required","default","enum","const","not","allOf","anyOf","oneOf","if","then","else","maximum","minimum","exclusiveMaximum","exclusiveMinimum","multipleOf","divisibleBy","items","maxItems","minItems","additionalItems","prefixItems","contains","minContains","maxContains","uniqueItems","maxLength","minLength","format","pattern","contentEncoding","contentMediaType","contentSchema","properties","maxProperties","minProperties","additionalProperties","patternProperties","propertyNames","dependencies","dependentRequired","dependentSchemas","propertyDependencies","unevaluatedProperties","unevaluatedItems","title","description","deprecated","readOnly","writeOnly","examples","$comment","example","discriminator","removeAdditional"],fi=["draft/next","draft/2020-12","draft/2019-09","draft-07","draft-06","draft-04","draft-03"],ui=fi.map(e=>`https://json-schema.org/${e}/schema`),pi=["core","applicator","validation","meta-data","format","content"],mi=["core","applicator","unevaluated","validation","meta-data","format-annotation","format-assertion","content"],hi=[...pi.map(e=>`https://json-schema.org/draft/2019-09/vocab/${e}`),...mi.map(e=>`https://json-schema.org/draft/2020-12/vocab/${e}`)];var Hn={knownKeywords:di,schemaVersions:ui,knownVocabularies:hi};const{knownKeywords:Gn}=Hn;function Zn(e,t,n,o="keys"){if(!e.has(t))return e.set(t,n);if(e.get(t)!==n)throw new Error(`Conflicting duplicate ${o}: ${t}`)}function yi(e){return e.includes("~")?e.replace(/~[01]/g,t=>{switch(t){case"~1":return"/";case"~0":return"~"}throw new Error("Unreachable")}):e}function Qt(e,t,n){if(typeof e!="object")throw new Error("Invalid input object");if(typeof t!="string")throw new Error("Invalid JSON pointer");const o=t.split("/");if(!["","#"].includes(o.shift()))throw new Error("Invalid JSON pointer");if(o.length===0)return e;let c=e;for(const m of o){if(typeof m!="string")throw new Error("Invalid JSON pointer");n&&n.push(c);const y=yi(m);if(typeof c!="object"||!Object.prototype.hasOwnProperty.call(c,y))return;c=c[y]}return c}const Tn=/^https?:\/\//;function _e(e,t){if(typeof e!="string"||typeof t!="string")throw new Error("Unexpected path!");if(t.length===0)return e;const n=e.replace(/#.*/,"");return t.startsWith("#")?`${n}${t}`:!n.includes("/")||Tn.test(t)?t:Tn.test(n)?`${new URL(t,n)}`:t.startsWith("/")?t:[...n.split("/").slice(0,-1),t].join("/")}function Mn(e){return e.map(n=>n&&(n.$id||n.id)||"").filter(n=>n&&typeof n=="string").reduce(_e,"")}const Yn=["properties","patternProperties","$defs","definitions"],Qn=["const","enum","examples","example","comment"],Xn=Symbol("skip");function nn(e,t){const n=(o,c=!1)=>{if(!o||typeof o!="object")return;const m=t(o);if(m!==void 0)return m===Xn?void 0:m;for(const y of Object.keys(o)){if(!c&&!Array.isArray(o)&&!Gn.includes(y)||!c&&Qn.includes(y))continue;const x=n(o[y],!c&&Yn.includes(y));if(x!==void 0)return x}};return n(e)}function Bn(e,t,n,o=""){const c=_e(o,n),m=[],[y,x=""]=c.split("#"),g=decodeURI(x),$=(P,H,F=!1,W=!1)=>{if(!P||typeof P!="object")return;const q=P.$id||P.id;let A=H;if(q&&typeof q=="string"){if(A=_e(A,q),A===c||A===y&&g==="")m.push([P,e,H]);else if(A===y&&g[0]==="/"){const z=[],V=Qt(P,g,z);V!==void 0&&m.push([V,e,_e(H,Mn(z))])}}const O=W?P.$dynamicAnchor:P.$anchor;if(O&&typeof O=="string"){if(O.includes("#"))throw new Error("$anchor can't include '#'");if(O.startsWith("/"))throw new Error("$anchor can't start with '/'");A=_e(A,`#${O}`),A===c&&m.push([P,e,H])}for(const z of Object.keys(P))!F&&!Array.isArray(P)&&!Gn.includes(z)||!F&&Qn.includes(z)||$(P[z],A,!F&&Yn.includes(z));!W&&P.$dynamicAnchor&&$(P,H,F,!0)};if($(e,y),y===o.replace(/#$/,"")&&(g[0]==="/"||g==="")){const P=[],H=Qt(e,g,P);H!==void 0&&m.push([H,e,Mn(P)])}if(t.has(y)&&t.get(y)!==e){const P=Bn(t.get(y),t,`#${x}`,y);m.push(...P.map(([H,F,W])=>[H,F,_e(y,W)]))}return t.has(c)&&m.push([t.get(c),t.get(c),c]),m}function gi(e){const t=new Map;return nn(e,n=>{if(n!==e&&(n.$id||n.id))return Xn;const o=n.$dynamicAnchor;if(o&&typeof o=="string"){if(o.includes("#"))throw new Error("$dynamicAnchor can't include '#'");if(!/^[a-zA-Z0-9_-]+$/.test(o))throw new Error(`Unsupported $dynamicAnchor: ${o}`);Zn(t,o,n,"$dynamicAnchor")}}),t}const bi=(e,t)=>nn(e,n=>Object.keys(n).some(o=>t.includes(o))||void 0)||!1,Dn=(e,t,n=!1)=>{if(!Array.isArray(t))throw new Error("Expected an array of schemas");for(const o of t)nn(o,c=>{const m=c.$id||c.id,y=m&&typeof m=="string"?m.replace(/#$/,""):null;if(y&&y.includes("://")&&!y.includes("#"))Zn(e,y,c,"schema $id in 'schemas'");else if(c===o&&!n)throw new Error("Schema with missing or invalid $id in 'schemas'")});return e},er=(e,t)=>{if(t)return Dn(er(e),t,!0);if(e)switch(Object.getPrototypeOf(e)){case Object.prototype:return new Map(Object.entries(e));case Map.prototype:return new Map(e);case Array.prototype:return Dn(new Map,e)}throw new Error("Unexpected value for 'schemas' option")};var tr={get:Qt,joinPath:_e,resolveReference:Bn,getDynamicAnchors:gi,hasKeywords:bi,buildSchemas:er};const Xt={email:e=>{if(e.length>318)return!1;if(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,20}(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,21}){0,2}@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,60}[a-z0-9])?){0,3}$/i.test(e))return!0;if(!e.includes("@")||/(^\.|^"|\.@|\.\.)/.test(e))return!1;const[n,o,...c]=e.split("@");return!n||!o||c.length!==0||n.length>64||o.length>253||!/^[a-z0-9.-]+$/i.test(o)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(n)?!1:o.split(".").every(m=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(m))},hostname:e=>e.length>(e.endsWith(".")?254:253)?!1:/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*\.?$/i.test(e),date:e=>{if(e.length!==10)return!1;if(e[5]==="0"&&e[6]==="2"){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)$/.test(e))return!0;const t=e.match(/^(\d\d\d\d)-02-29$/);if(!t)return!1;const n=t[1]|0;return n%16===0||n%4===0&&n%25!==0}return e.endsWith("31")?/^\d\d\d\d-(?:0[13578]|1[02])-31$/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)$/.test(e)},time:e=>{if(e.length>27||!/^(?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)?$/i.test(e))return!1;if(!/:60/.test(e))return!0;const n=e.match(/([0-9.]+|[^0-9.])/g);let o=Number(n[0])*60+Number(n[2]);return n[5]==="+"?o+=24*60-Number(n[6]||0)*60-Number(n[8]||0):n[5]==="-"&&(o+=Number(n[6]||0)*60+Number(n[8]||0)),o%(24*60)===23*60+59},"date-time":e=>{if(e.length>38)return!1;const t=/^\d\d\d\d-(?:0[1-9]|1[0-2])-(?:[0-2]\d|3[01])[t\s](?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)$/i,n=e[5]==="0"&&e[6]==="2";if(n&&e[8]==="3"||!t.test(e))return!1;if(e[17]==="6"){const o=e.slice(11).match(/([0-9.]+|[^0-9.])/g);let c=Number(o[0])*60+Number(o[2]);if(o[5]==="+"?c+=24*60-Number(o[6]||0)*60-Number(o[8]||0):o[5]==="-"&&(c+=Number(o[6]||0)*60+Number(o[8]||0)),c%(24*60)!==23*60+59)return!1}if(n){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)/.test(e))return!0;const o=e.match(/^(\d\d\d\d)-02-29/);if(!o)return!1;const c=o[1]|0;return c%16===0||c%4===0&&c%25!==0}return e[8]==="3"&&e[9]==="1"?/^\d\d\d\d-(?:0[13578]|1[02])-31/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)/.test(e)},ipv4:e=>e.length<=15&&/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)$/.test(e),ipv6:e=>{if(e.length>45||e.length<2)return!1;let t=0,n=0,o=0,c=!1,m=!1,y=0,x=!0;for(let $=0;$<e.length;$++){const P=e.charCodeAt($);if($===1&&y===58&&P!==58)return!1;if(P>=48&&P<=57){if(++o>4)return!1}else if(P===46){if(t>6||n>=3||o===0||m)return!1;n++,o=0}else if(P===58){if(n>0||t>=7)return!1;if(y===58){if(c)return!1;c=!0}else $===0&&(x=!1);t++,o=0,m=!1}else if(P>=97&&P<=102||P>=65&&P<=70){if(n>0||++o>4)return!1;m=!0}else return!1;y=P}if(t<2||n>0&&(n!==3||o===0))return!1;if(c&&e.length===2)return!0;if(n>0&&!/(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}$/.test(e))return!1;const g=n>0?6:7;return c?(x||o>0)&&t<g:t===g&&x&&o>0},uri:/^[a-z][a-z0-9+\-.]*:(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)?(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2}|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,"json-pointer":/^(?:|\/(?:[^~]|~0|~1)*)$/,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:|#|\/(?:[^~]|~0|~1)*)$/,uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e))},wi={alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"hex-digits":/^[0-9a-f]+$/i,"hex-digits-prefixed":/^0x[0-9a-f]+$/i,"hex-bytes":/^([0-9a-f][0-9a-f])+$/i,"hex-bytes-prefixed":/^0x([0-9a-f][0-9a-f])+$/i,base64:e=>e.length%4===0&&/^[a-z0-9+/]*={0,3}$/i.test(e),"json-pointer-uri-fragment":/^#(|\/(\/|[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)$/i,"host-name":Xt.hostname,"ip-address":Xt.ipv4,color:/^(#[0-9A-Fa-f]{3,6}|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\(\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*\)|rgb\(\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*\))$/},vi={regex:e=>{if(e.length>1e5||/[^\\]\\Z/.test(e))return!1;try{return new RegExp(e,"u"),!0}catch{return!1}}};var ki={core:Xt,extra:wi,weak:vi};const pe=(e,t)=>[...new Set([...e,...t])].sort(),nr=(e,t)=>e.filter(n=>t.includes(n)),$i=e=>(...t)=>e(...t.map(Ot)),rr=e=>(...t)=>Ot(e(...t.map(Ot))),ue=(e,t)=>e&&!e.includes(t),Ot=({type:e=null,dyn:t={},...n})=>({type:e&&[...e].sort(),items:ue(e,"array")?1/0:n.items||0,properties:ue(e,"object")?[!0]:[...n.properties||[]].sort(),patterns:ue(e,"object")?[]:[...n.patterns||[]].sort(),required:ue(e,"object")?[]:[...n.required||[]].sort(),fullstring:ue(e,"string")||n.fullstring||!1,dyn:{item:ue(e,"array")?!1:t.item||!1,items:ue(e,"array")?0:Math.max(n.items||0,t.items||0),properties:ue(e,"object")?[]:pe(n.properties||[],t.properties||[]),patterns:ue(e,"object")?[]:pe(n.patterns||[],t.patterns||[])},unknown:n.unknown&&!(ue(e,"object")&&ue(e,"array"))||!1}),ji=()=>Ot({}),ir=rr((e,t)=>({type:e.type&&t.type?nr(e.type,t.type):e.type||t.type||null,items:Math.max(e.items,t.items),properties:pe(e.properties,t.properties),patterns:pe(e.patterns,t.patterns),required:pe(e.required,t.required),fullstring:e.fullstring||t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:pe(e.dyn.properties,t.dyn.properties),patterns:pe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Bt=(e,t)=>t!==!0&&new RegExp(e,"u").test(t),Ai=({properties:e,patterns:t},{properties:n,patterns:o})=>{const c=e.filter(g=>n.includes(g)||n.includes(!0)||o.some($=>Bt($,g))),m=n.filter(g=>e.includes(g)||e.includes(!0)||t.some($=>Bt($,g))),y=t.filter(g=>o.includes(g)||n.includes(!0)),x=o.filter(g=>t.includes(g)||e.includes(!0));return{properties:pe(c,m),patterns:pe(y,x)}},sr=({properties:e,patterns:t},{properties:n,patterns:o})=>n.every(c=>e.includes(c)||e.includes(!0)||t.some(m=>Bt(m,c)))&&o.every(c=>t.includes(c)||e.includes(!0)),Oi=rr((e,t)=>({type:e.type&&t.type?pe(e.type,t.type):null,items:Math.min(e.items,t.items),...Ai(e,t),required:ue(e.type,"object")&&t.required||ue(t.type,"object")&&e.required||nr(e.required,t.required),fullstring:e.fullstring&&t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:pe(e.dyn.properties,t.dyn.properties),patterns:pe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Ei=(e,t)=>Object.assign(e,ir(e,t)),Si=$i(({unknown:e,items:t,dyn:n,...o})=>({items:t!==1/0&&(e||n.items>t||n.item),properties:!o.properties.includes(!0)&&(e||!sr(o,n))}));var xi={initTracing:ji,andDelta:ir,orDelta:Oi,applyDelta:Ei,isDynamic:Si,inProperties:sr};const{format:k,safe:Rn,safeand:kt,safenot:Le,safenotor:$t}=xt,Pi=Kn,{resolveReference:et,joinPath:In,getDynamicAnchors:qi,hasKeywords:zn}=tr,jt=ki,{toPointer:Vt,...G}=tn,{scopeMethods:or}=_n,{buildName:Jt,types:ve,jsHelpers:Ti}=Jn,{knownKeywords:Mi,schemaVersions:Et,knownVocabularies:Di}=Hn,{initTracing:Ri,andDelta:Cn,orDelta:Me,applyDelta:Ii,isDynamic:ke,inProperties:zi}=xi,Kt=new Set(["^[\\s\\S]*$","^[\\S\\s]*$","^[^]*$","",".*","^","$"]),Ht=["null","boolean","number","integer","string"],en=new Map(Object.entries({boolean:e=>typeof e=="boolean",array:e=>Array.isArray(e)&&Object.getPrototypeOf(e)===Array.prototype,object:e=>e&&Object.getPrototypeOf(e)===Object.prototype,finite:e=>Number.isFinite(e),natural:e=>Number.isInteger(e)&&e>=0,string:e=>typeof e=="string",jsonval:e=>G.deepEqual(e,JSON.parse(JSON.stringify(e)))})),We=en.get("object"),Nn=e=>We(e)||typeof e=="boolean",Ci=e=>G.deepEqual(e,{type:[]}),De=(e,t)=>Et.indexOf(e)>Et.indexOf(`https://json-schema.org/${t}/schema`),Ni=(e,t)=>{const n=`${e}`.replace(/^http:\/\//,"https://").replace(/#$/,"");return Et.includes(n)?De(n,t):!0},Ui=(e,t,n=!1,o=!1)=>Object.freeze({parent:e,keyname:t,inKeys:n,number:o}),Li=(e,t,n=!1)=>Object.freeze({parent:e,keyval:t,checked:n}),Gt=Symbol("evaluatedStatic"),Re=Symbol("optDynamic"),tt=Symbol("optDynAnchors"),at=Symbol("optRecAnchors"),Fi=e=>{if(typeof e=="boolean")return e;if(We(e)&&Object.keys(e).length===0)return!0},Ie=new Set,dt=new Map,_i=(e,t,n,o)=>{if(t){const c=t.replace(/^http:\/\//,"https://").replace(/#$/,"");n(Et.includes(c),"Unexpected schema version:",c),dt.set(e,{exclusiveRefs:De(c,"draft/2019-09"),contentValidation:De(c,"draft/2019-09"),dependentUnsupported:De(c,"draft/2019-09"),newItemsSyntax:!De(c,"draft/2020-12"),containsEvaluates:!De(c,"draft/2020-12"),objectContains:!De(c,"draft/next"),bookending:De(c,"draft/next")})}else n(!o,"[requireSchema] $schema is required"),dt.set(e,{})},ar=(e,t,n,o,c="")=>{const{mode:m="default",useDefaults:y=!1,removeAdditional:x=!1,includeErrors:g=!1,allErrors:$=!1,contentValidation:P,dryRun:H,lint:F=!1,allowUnusedKeywords:W=n.mode==="lax"||n.mode==="spec",allowUnreachable:q=n.mode==="lax"||n.mode==="spec",requireSchema:A=n.mode==="strong",requireValidation:O=n.mode==="strong",requireStringValidation:z=n.mode==="strong",forbidNoopValues:V=n.mode==="strong",complexityChecks:Q=n.mode==="strong",unmodifiedPrototypes:ce=!1,isJSON:te=!1,$schemaDefault:ne=null,formatAssertion:le=n.mode!=="spec"||Ni(t.$schema,"draft/2019-09"),formats:ye={},weakFormats:Oe=n.mode!=="strong",extraFormats:h=!1,schemas:u,...w}=n,v={...jt.core,...Oe?jt.weak:{},...h?jt.extra:{},...ye};if(Object.keys(w).length!==0)throw new Error(`Unknown options: ${Object.keys(w).join(", ")}`);if(!["strong","lax","default","spec"].includes(m))throw new Error(`Invalid mode: ${m}`);if(!g&&$)throw new Error("allErrors requires includeErrors to be enabled");if(A&&ne)throw new Error("requireSchema forbids $schemaDefault");if(m==="strong"){const oe={...{requireValidation:O,requireStringValidation:z},formatAssertion:le,complexityChecks:Q,requireSchema:A},E={weakFormats:Oe,allowUnusedKeywords:W};for(const[l,ee]of Object.entries(oe))if(!ee)throw new Error(`Strong mode demands ${l}`);for(const[l,ee]of Object.entries(E))if(ee)throw new Error(`Strong mode forbids ${l}`)}const{gensym:D,getref:Y,genref:U,genformat:B}=or(o),re=se=>{const oe=[];let E=se;for(;E;)E.name||oe.unshift(E),E=E.parent||E.errorParent;if(oe.every(he=>he.keyval!==void 0))return k("%j",Vt(oe.map(he=>he.keyval)));const l=["#"],ee=()=>{const he=l.map(G.pointerPart).join("/");return l.length=0,he};let ge=null;for(const{keyname:he,keyval:mt,number:Ce}of oe)if(he){Ce||(o.pointerPart=G.pointerPart);const Je=Ce?he:k("pointerPart(%s)",he),C=`${ee()}/`;ge=ge?k("%s+%j+%s",ge,C,Je):k("%j+%s",C,Je)}else mt&&l.push(mt);return l.length>0?k("%s+%j",ge,`/${ee()}`):ge},me=U(e);let ft=null;const on=(...se)=>{const oe=ft(...se);return on.errors=ft.errors,oe};o[me]=on;const lr=zn(e,["$ref","$recursiveRef","$dynamicRef"]),Pt=n[tt]&&lr&&zn(e,["$dynamicAnchor"]),dr=()=>n[tt]?k(Pt?", dynAnchors = []":", dynAnchors"):k(""),fr=n[at]?k(", recursive"):k(""),f=Pi();f.write("function validate(data%s%s) {",fr,dr()),g&&f.write("validate.errors = null"),$&&f.write("let errorCount = 0"),n[Re]&&f.write("validate.evaluatedDynamic = null");let an=n[tt]?k(", dynAnchors"):k("");Pt&&(f.write("const dynLocal = [{}]"),an=k(", [...dynAnchors, dynLocal[0] || []]"));const ur=Ti(f,o,Ui,{unmodifiedPrototypes:ce,isJSON:te},Kt),{present:je,forObjectKeys:ut,forArray:qt,patternTest:pr,compare:Tt}=ur,ze=[],ie=()=>dt.get(t),Ve=c?[c]:[],Mt=(se,oe,E,l,ee,ge={},{constProp:he}={})=>{const mt=oe.length>0&&oe[oe.length-1].prop===E,Ce=()=>oe.filter(r=>r.prop===E),Je=!E.parent||E.checked||E.inKeys&&te||Ce().length>0,C=Jt(E),Ne=(...r)=>Li(E,...r),Ee=({path:r=[],prop:s=E,source:a,suberr:d})=>{const i=Vt([...ee,...r]),p=g?re(s):null;if(g===!0&&se&&a){o.errorMerge=G.errorMerge;const b=[a,i,p];$?(f.write("if (validate.errors === null) validate.errors = []"),f.write("validate.errors.push(...%s.map(e => errorMerge(e, %j, %s)))",...b)):f.write("validate.errors = [errorMerge(%s[0], %j, %s)]",...b)}else if(g===!0&&se){const b=k("{ keywordLocation: %j, instanceLocation: %s }",i,p);$?(f.write("if (%s === null) %s = []",se,se),f.write("%s.push(%s)",se,b)):f.write("%s = [%s]",se,b)}d&&vn(d),$?f.write("errorCount++"):f.write("return false")},de=(r,s)=>f.if(r,()=>Ee(s));F&&!o.lintErrors&&(o.lintErrors=[]);const Ae=(r,s)=>{const a=s!==void 0?` ${JSON.stringify(s)}`:"",d=In(c,Vt(ee)),i=`${r}${a} at ${d}`;if(F)return o.lintErrors.push({message:i,keywordLocation:d,schema:e});throw new Error(i)},Rt=(r,s)=>{try{return pr(r,s)}catch(a){return Ae(a.message),k("false")}},T=(r,...s)=>r||Ae(...s),nt=(r,...s)=>T(m==="lax"||m==="spec"||r,...s),Se=(r,s)=>nt(!(l[s]<l[r]),`Invalid ${r} / ${s} combination`),xe=(r,s="should be specified")=>T(!O,`[requireValidation] ${r} ${s}`),X=(...r)=>[...ee,...r],Ke=r=>T(!x&&!y,`[removeAdditional/useDefaults] uncertain: ${r}`),cn=(r,s)=>T(!Q,`[complexityChecks] ${r}`,s),ln=r=>_i(t,r||ne,T,A),M=Ri(),L=r=>Ii(M,r);if(typeof l=="boolean")return l===!0?(xe("schema = true","is not allowed"),{stat:M}):(de(Je||E.inKeys?!0:je(E),{}),L({type:[]}),{stat:M});T(We(l),"Schema is not an object");for(const r of Object.keys(l))T(Mi.includes(r)||W,"Keyword not supported:",r);if(Object.keys(l).length===0)return xe("empty rules node","is not allowed"),{stat:M};const Pe=new Set(Object.keys(l)),dn=new Set,qe=(r,...s)=>{T(dn.has(r)||Pe.has(r),"Unexpected double consumption:",r),T(G.hasOwn(l,r),"Is not an own property:",r),T(s.every(a=>en.has(a)),"Invalid type used in consume"),T(s.some(a=>en.get(a)(l[r])),"Unexpected type for",r),Pe.delete(r)},fn=(r,...s)=>(l[r]!==void 0&&qe(r,...s),l[r]),j=(r,s,a,d={})=>{if(l[r]===void 0)return!1;if(qe(r,...s),a!==null)try{const i=a(l[r]);i!==null&&de(i,{path:[r],...d})}catch(i){if(F&&!i.message.startsWith("[opt] "))Ae(i.message);else throw i}return!0};if(l===t?(ln(fn("$schema","string")),j("$vocabulary",["object"],r=>{for(const[s,a]of Object.entries(r))a!==!1&&T(a===!0&&Di.includes(s),"Unknown vocabulary:",s);return null})):ie()||ln(t.$schema),ie().objectContains)for(const r of["contains","minContains","maxContains"])dn.add(r);j("examples",["array"],null),j("example",["jsonval"],null);for(const r of["title","description","$comment"])j(r,["string"],null);for(const r of["deprecated","readOnly","writeOnly"])j(r,["boolean"],null);j("$defs",["object"],null)||j("definitions",["object"],null);const rt=(r,s,a)=>r===e?Rn("validate"):Y(r)||ar(r,s,n,o,a),Te=()=>Ve.length>0?Ve[Ve.length-1]:"",mr=Ve.length,un=r=>(Ve.push(In(Te(),r)),null);(!ie().exclusiveRefs||!l.$ref)&&(j("$id",["string"],un)||j("id",["string"],un),j("$anchor",["string"],null),j("$dynamicAnchor",["string"],null),(l.$recursiveAnchor||!V)&&j("$recursiveAnchor",["boolean"],r=>(r&&ze.push([l,t,Te()]),null)));const pn=Pt&&(l===e||l.id||l.$id);if(pn){const r=qi(l);l!==e&&f.write("dynLocal.unshift({})");for(const[s,a]of r){const d=et(t,u,`#${s}`,Te()),[i,p,b]=d[0]||[];T(i===a,`Unexpected $dynamicAnchor resolution: ${s}`);const S=rt(i,p,b);f.write("dynLocal[0][%j] = %s",`#${s}`,S)}}const It=r=>n[Re]&&(l[r]||l[r]===!1||l===e),fe=Object.freeze({item:It("unevaluatedItems")?D("evaluatedItem"):null,items:It("unevaluatedItems")?D("evaluatedItems"):null,props:It("unevaluatedProperties")?D("evaluatedProps"):null}),K=Object.freeze({item:fe.item||ge.item,items:fe.items||ge.items,props:fe.props||ge.props}),mn=()=>(!K.items||M.items===1/0)&&(!K.props||M.properties.includes(!0)),be=r=>{if(K.item&&r.item&&M.items!==1/0&&f.write("%s.push(%s)",K.item,r.item),K.items&&r.items>M.items&&f.write("%s.push(%d)",K.items,r.items),K.props&&(r.properties||[]).includes(!0)&&!M.properties.includes(!0))f.write("%s[0].push(true)",K.props);else if(K.props){const s=(i,p)=>zi(M,{properties:i,patterns:p}),a=(r.properties||[]).filter(i=>!s([i],[])),d=(r.patterns||[]).filter(i=>!s([],[i]));a.length>0&&f.write("%s[0].push(...%j)",K.props,a),d.length>0&&f.write("%s[1].push(...%j)",K.props,d);for(const i of r.propertiesVars||[])f.write("%s[0].push(%s)",K.props,i)}},hn=(r,s,a,d)=>{ke(M).items&&r.item&&s&&f.write("%s.push(...%s)",r.item,s),ke(M).items&&r.items&&a&&f.write("%s.push(...%s)",r.items,a),ke(M).properties&&r.props&&d&&(f.write("%s[0].push(...%s[0])",r.props,d),f.write("%s[1].push(...%s[1])",r.props,d))},hr=()=>n[at]?ze.length===0?k(", recursive"):k(", recursive || %s",rt(...ze[0])):k(""),ht=(r,s)=>{const a=o[r]&&o[r][Gt]||{unknown:!0};L(a);const d=k("%s(%s%s%s)",r,C,hr(),an);if(!g&&mn())return k("!%s",d);const i=D("res"),p=D("err"),b=D("suberr");return g&&f.write("const %s = validate.errors",p),f.write("const %s = %s",i,d),g&&f.write("const %s = %s.errors",b,r),g&&f.write("validate.errors = %s",p),de(Le(i),{...s,source:b}),f.if(i,()=>{const S=ke(a).items?k("%s.evaluatedDynamic[0]",r):null,I=ke(a).items?k("%s.evaluatedDynamic[1]",r):null,N=ke(a).properties?k("%s.evaluatedDynamic[2]",r):null;hn(K,S,I,N)}),null},yn=(r,s)=>r&&r.every(a=>s.includes(a)),gn=(r,s)=>s.some(a=>r===null||r.includes(a)),bn=(...r)=>Ce().some(s=>yn(s.stat.type,r)),yr=(...r)=>yn(M.type,r)||bn(...r),He=(...r)=>gn(M.type,r)&&Ce().every(s=>gn(s.stat.type,r)),zt=(r,s=l)=>{T(typeof r=="string","Invalid pattern:",r),(O||z)&&T(/^\^.*\$$/.test(r),"Should start with ^ and end with $:",r),/([{+*].*[{+*]|\)[{+*]|^[^^].*[{+*].)/.test(r)&&s.maxLength===void 0&&cn("maxLength should be specified for pattern:",r)},gr=l.pattern&&!Kt.has(l.pattern),br=l.uniqueItems||gr||l.patternProperties||l.format,yt=$&&br?D("prev"):null,gt=(r,s)=>f.if(r&&yt!==null?k("errorCount === %s",yt):!0,s),wn=()=>[...oe,{stat:M,prop:E}],ae=(...r)=>Mt(se,wn(),...r).stat,Ue=(r,...s)=>{if(s[0]===E){const i=Fi(s[1]);if(i===!0)return{sub:k("true"),delta:{}};if(i===!1)return{sub:k("false"),delta:{type:[]}}}const a=D("sub");f.write("const %s = (() => {",a),$&&f.write("let errorCount = 0");const{stat:d}=Mt(r,wn(),...s);return $?f.write("return errorCount === 0"):f.write("return true"),f.write("})()"),{sub:a,delta:d}},Ct=()=>{const r=g&&$?D("suberr"):null;return r&&f.write("let %s = null",r),r},vn=r=>{se===null||r===null||f.if(r,()=>f.write("%s.push(...%s)",se,r))},kn=()=>{if(!x)return!1;if(x===!0)return!0;if(x==="keyword")return l.removeAdditional?(qe("removeAdditional","boolean"),!0):!1;throw new Error(`Invalid removeAdditional: ${x}`)},bt=(r,s,a)=>{j(r,["object","boolean"],i=>i===!1&&kn()?(f.write("if (%s.length > %s) %s.length = %s",C,s,C,s),null):i===!1&&!a?k("%s.length > %s",C,s):(qt(E,s,(p,b)=>(a&&f.write("if (%s) continue",a(b)),ae(p,i,X(r)))),null))&&L({items:1/0})},Nt=(r,s)=>{j(r,["object","boolean"],d=>(ut(E,(i,p)=>{f.if(s(p),()=>{d===!1&&kn()?f.write("delete %s[%s]",C,p):ae(i,d,X(r))})}),null))&&L({properties:[!0]})},$n=(r,s,a)=>kt(...s.map(d=>k("%s !== %j",r,d)),...a.map(d=>Le(Rt(d,r)))),jn=(r,s)=>{const a=s.map(i=>new RegExp(i,"u")),d=i=>r.includes(i)||a.some(p=>p.test(i));for(const i of M.required)T(d(i),"Unknown required property:",i)},An=[],wr=()=>{const r=(a,d)=>k("!(%d %c %s)",a,d,C);Number.isFinite(l.exclusiveMinimum)?j("exclusiveMinimum",["finite"],a=>r(a,"<")):(j("minimum",["finite"],a=>r(a,l.exclusiveMinimum?"<":"<=")),j("exclusiveMinimum",["boolean"],null)),Number.isFinite(l.exclusiveMaximum)?(j("exclusiveMaximum",["finite"],a=>r(a,">")),Se("minimum","exclusiveMaximum"),Se("exclusiveMinimum","exclusiveMaximum")):l.maximum!==void 0&&(j("maximum",["finite"],a=>r(a,l.exclusiveMaximum?">":">=")),j("exclusiveMaximum",["boolean"],null),Se("minimum","maximum"),Se("exclusiveMinimum","maximum"));const s=l.multipleOf===void 0?"divisibleBy":"multipleOf";j(s,["finite"],a=>{T(a>0,`Invalid ${s}:`,a);const[d,i]=`${a}`.split("e-"),b=`${d}.`.split(".")[1].length+(i?Number(i):0);if(Number.isInteger(a*2**b))return k("%s %% %d !== 0",C,a);o.isMultipleOf=G.isMultipleOf;const S=[C,a,b,Math.round(a*Math.pow(10,b))];return k("!isMultipleOf(%s, %d, 1e%d, %d)",...S)})},vr=()=>{j("maxLength",["natural"],r=>(o.stringLength=G.stringLength,k("%s.length > %d && stringLength(%s) > %d",C,r,C,r))),j("minLength",["natural"],r=>(o.stringLength=G.stringLength,k("%s.length < %d || stringLength(%s) < %d",C,r,C,r))),Se("minLength","maxLength"),gt(!0,()=>{const r=(i,p,b=v)=>{const S=typeof i=="string"&&G.hasOwn(b,i);T(S,"Unrecognized format used:",i);const I=b[i],N=I instanceof RegExp||typeof I=="function";return T(N,"Invalid format used:",i),le?I instanceof RegExp?(G.hasOwn(ye,i)&&zt(I.source),k("!%s.test(%s)",B(I),p)):k("!%s(%s)",B(I),p):null};j("format",["string"],i=>(L({fullstring:!0}),r(i,C))),j("pattern",["string"],i=>(zt(i),L({fullstring:!0}),Kt.has(i)?null:Le(Rt(i,C)))),T(l.contentSchema!==!1,"contentSchema cannot be set to false");const s=P===void 0?ie().contentValidation:P,a=l.contentEncoding||l.contentMediaType||l.contentSchema;if(T(!a||s||W,'"content*" keywords are disabled by default per spec, enable with { contentValidation = true } option (see doc/Options.md for more info)'),a&&s){const i=D("dec");l.contentMediaType&&f.write("let %s = %s",i,C),l.contentEncoding==="base64"?(de(r("base64",C,jt.extra),{path:["contentEncoding"]}),l.contentMediaType&&(o.deBase64=G.deBase64,f.write("try {"),f.write("%s = deBase64(%s)",i,i)),qe("contentEncoding","string")):T(!l.contentEncoding,"Unknown contentEncoding:",l.contentEncoding);let p=!1;if(l.contentMediaType==="application/json"?(f.write("try {"),f.write("%s = JSON.parse(%s)",i,i),p=!0,qe("contentMediaType","string")):T(!l.contentMediaType,"Unknown contentMediaType:",l.contentMediaType),l.contentSchema){T(p,"contentSchema requires contentMediaType application/json");const b=Object.freeze({name:i,errorParent:E});ae(b,l.contentSchema,X("contentSchema")),qe("contentSchema","object","array"),L({fullstring:!0})}l.contentMediaType&&(f.write("} catch (e) {"),Ee({path:["contentMediaType"]}),f.write("}"),l.contentEncoding&&(f.write("} catch (e) {"),Ee({path:["contentEncoding"]}),f.write("}")))}})},kr=()=>{j("maxItems",["natural"],i=>{const p=ie().newItemsSyntax?"prefixItems":"items";return Array.isArray(l[p])&&l[p].length>i&&Ae(`Invalid maxItems: ${i} is less than ${p} array length`),k("%s.length > %d",C,i)}),j("minItems",["natural"],i=>k("%s.length < %d",C,i)),Se("minItems","maxItems");const r=i=>{for(let p=0;p<i.length;p++)ae(Ne(p),i[p],X(`${p}`));return L({items:i.length}),null};ie().newItemsSyntax?(j("prefixItems",["array"],r),bt("items",k("%d",(l.prefixItems||[]).length))):Array.isArray(l.items)?(j("items",["array"],r),bt("additionalItems",k("%d",l.items.length))):j("items",["object","boolean"],i=>(qt(E,k("0"),p=>ae(p,i,X("items"))),L({items:1/0}),null)),On(i=>{qt(E,k("0"),(p,b)=>{i(p,()=>{L({dyn:{item:!0}}),be({item:b})})})});const s=i=>{if(!We(i))return!1;if(i.enum||G.hasOwn(i,"const")||i.type&&(Array.isArray(i.type)?i.type:[i.type]).every(b=>Ht.includes(b)))return!0;if(i.$ref){const[p]=et(t,u,i.$ref,Te())[0]||[];if(s(p))return!0}return!1},a=i=>i===!1||s(i),d=()=>!!(l.maxItems!==void 0||a(l.items)||Array.isArray(l.items)&&a(l.additionalItems));gt(!0,()=>{j("uniqueItems",["boolean"],i=>i===!1?null:(d()||cn("maxItems should be specified for non-primitive uniqueItems"),Object.assign(o,{unique:G.unique,deepEqual:G.deepEqual}),k("!unique(%s)",C)))})},Ge=r=>!$&&(M.required.includes(r)||Ce().some(s=>s.stat.required.includes(r))),$r=()=>{const r=k("Object.keys(%s).length",C);j("maxProperties",["natural"],s=>k("%s > %d",r,s)),j("minProperties",["natural"],s=>k("%s < %d",r,s)),Se("minProperties","maxProperties"),j("propertyNames",["object","boolean"],s=>(ut(E,(a,d)=>{const i=typeof s=="object"&&!s.$ref?{type:"string",...s}:s,p=Object.freeze({name:d,errorParent:a,type:"string"});ae(p,i,X("propertyNames"))}),null)),j("required",["array"],s=>{for(const a of s){if(Ge(a))continue;const d=Ne(a);de(Le(je(d)),{path:["required"],prop:d})}return L({required:s}),null});for(const s of["dependencies","dependentRequired","dependentSchemas"])s!=="dependencies"&&ie().dependentUnsupported||j(s,["object"],a=>{for(const d of Object.keys(a)){const i=typeof a[d]=="string"?[a[d]]:a[d],p=Ne(d,Ge(d));if(Array.isArray(i)&&s!=="dependentSchemas"){const b=i.filter(N=>!Ge(N)).map(N=>je(Ne(N))),S=Le(kt(...b)),I={path:[s,d]};b.length===0||(p.checked?(de(S,I),L({required:i})):de(kt(je(p),S),I))}else Nn(i)&&s!=="dependentRequired"?(Ke(s),f.if(p.checked?!0:je(p),()=>{const b=ae(E,i,X(s,d),K);L(Me({},b)),be(b)})):Ae(`Unexpected ${s} entry`)}return null});j("propertyDependencies",["object"],s=>{for(const[a,d]of Object.entries(s)){T(We(d),"propertyDependencies must be an object"),Ke("propertyDependencies");const i=Ne(a,Ge(a));f.if(i.checked?!0:je(i),()=>{for(const[p,b]of Object.entries(d))T(Nn(b),"propertyDependencies must contain schemas"),f.if(Tt(Jt(i),p),()=>{const S=ae(E,b,X("propertyDependencies",a,p),K);L(Me({},S)),be(S)})})}return null}),j("properties",["object"],s=>{for(const a of Object.keys(s))he!==a&&ae(Ne(a,Ge(a)),s[a],X("properties",a));return L({properties:Object.keys(s)}),null}),gt(l.patternProperties,()=>{if(j("patternProperties",["object"],s=>(ut(E,(a,d)=>{for(const i of Object.keys(s))zt(i,l.propertyNames||{}),f.if(Rt(i,d),()=>{ae(a,s[i],X("patternProperties",i))})}),L({patterns:Object.keys(s)}),null)),l.additionalProperties||l.additionalProperties===!1){const s=Object.keys(l.properties||{}),a=Object.keys(l.patternProperties||{});l.additionalProperties===!1&&An.push(()=>jn(s,a)),Nt("additionalProperties",i=>$n(i,s,a))}}),ie().objectContains&&On(s=>{ut(E,(a,d)=>{s(a,()=>{L({dyn:{properties:[!0]}}),be({propertiesVars:[d]})})})})},jr=()=>{const r=j("const",["jsonval"],a=>Le(Tt(C,a)));if(r&&!W)return!0;const s=j("enum",["array"],a=>{const d=a.filter(p=>p&&typeof p=="object"),i=a.filter(p=>!(p&&typeof p=="object"));return $t(...[...i,...d].map(p=>Tt(C,p)))});return r||s},On=r=>{j("contains",["object","boolean"],()=>{Ke("contains"),ie().objectContains&&He("array")&&He("object")&&xe("possible type confusion in 'contains',","forbid 'object' or 'array'");const s=D("passes");f.write("let %s = 0",s);const a=Ct();return r((d,i)=>{const{sub:p}=Ue(a,d,l.contains,X("contains"));f.if(p,()=>{f.write("%s++",s),ie().containsEvaluates&&(T(!x,`Can't use removeAdditional with draft2020+ "contains"`),i())})}),j("minContains",["natural"],d=>k("%s < %d",s,d),{suberr:a})||de(k("%s < 1",s),{path:["contains"],suberr:a}),j("maxContains",["natural"],d=>k("%s > %d",s,d)),Se("minContains","maxContains"),null})},Ar=()=>{j("not",["object","boolean"],i=>Ue(null,E,i,X("not")).sub),l.not&&Ke("not"),(l.then||l.then===!1||l.else||l.else===!1||W)&&j("if",["object","boolean"],i=>{Ke("if/then/else");const{sub:p,delta:b}=Ue(null,E,i,X("if"),K);let S,I,N,_;return j("else",["object","boolean"],J=>(S=()=>{N=ae(E,J,X("else"),K),be(N)},null)),j("then",["object","boolean"],J=>(I=()=>{_=ae(E,J,X("then"),K),be(Cn(b,_))},null)),!I&&!Ci(b)&&(I=()=>be(b)),f.if(p,I,S),L(Me(N||{},Cn(b,_||{}))),null});const s=(i,p="allOf")=>{T(i.length>0,`${p} cannot be empty`);for(const[b,S]of Object.entries(i))L(ae(E,S,X(p,b),K));return null};j("allOf",["array"],i=>s(i));let a=null;j("discriminator",["object"],i=>{const p=new Set,b=(Z,Ye,Qe)=>T(Z,`[discriminator]: ${Ye}`,Qe),{propertyName:S,mapping:I,...N}=i,_=Ne(S);b(S&&!l.oneOf!=!l.anyOf,"need propertyName, oneOf OR anyOf"),b(Object.keys(N).length===0,'only "propertyName" and "mapping" are supported');const J=Z=>We(Z)?Object.keys(Z).length:null;return a=(Z,Ye)=>{const Qe=()=>{f.write("switch (%s) {",Jt(_));let Xe;for(const[Sr,Be]of Object.entries(Z)){const{const:Ut,enum:xn,...xr}=(Be.properties||{})[S]||{};let st=Ut!==void 0?[Ut]:xn;if(!st&&Be.$ref){const[we]=et(t,u,Be.$ref,Te())[0]||[];T(We(we),"failed to resolve $ref:",Be.$ref);const ot=(we.properties||{})[S]||{};st=ot.const!==void 0?[ot.const]:ot.enum}const Pr=Array.isArray(st)&&st.length>0;b(Pr,"branches should have unique string const or enum values for [propertyName]");const qr=Object.keys(xr).length===0&&(!Ut||!xn);b(qr,"only const OR enum rules are allowed on [propertyName] in branches");for(const we of st){const ot=!I||G.hasOwn(I,we)&&I[we]===Be.$ref;b(ot,"mismatching mapping for",we);const Tr=typeof we=="string"&&!p.has(we);b(Tr,"const/enum values for [propertyName] should be unique strings"),p.add(we),f.write("case %j:",we)}const Lt=ae(E,Be,X(Ye,Sr),K,{constProp:S});be(Lt),Xe=Xe?Me(Xe,Lt):Lt,f.write("break")}b(I===void 0||J(I)===p.size,"mismatching mapping size"),L(Xe),f.write("default:"),Ee({path:[Ye]}),f.write("}")},it=()=>{if(Ge(S))Qe();else{const Xe=["discriminator","propertyName"];f.if(je(_),Qe,()=>Ee({path:Xe,prop:_}))}};return $||!G.deepEqual(M.type,["object"])?f.if(ve.get("object")(C),it,()=>Ee({path:["discriminator"]})):it(),b(G.deepEqual(M.type,["object"]),"has to be checked for type:","object"),b(M.required.includes(S),"propertyName should be placed in required:",S),null},null});const d=(i,p)=>{const b=p.map(N=>N.type||(Array.isArray(N.const)?"array":typeof N.const)),S=b.filter(N=>!Ht.includes(N)&&N!=="array").length,I=b.filter(N=>!Ht.includes(N)&&N!=="object").length;(S>1||I>1)&&Ke(`${i}, use discriminator to make it certain`)};j("anyOf",["array"],i=>{if(T(i.length>0,"anyOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"anyOf");const p=Ct();if(!mn()){d("anyOf",i);const _=Object.entries(i).map(([J,Z])=>Ue(p,E,Z,X("anyOf",J),K));L(_.map(J=>J.delta).reduce((J,Z)=>Me(J,Z))),de($t(..._.map(({sub:J})=>J)),{path:["anyOf"],suberr:p});for(const{delta:J,sub:Z}of _)f.if(Z,()=>be(J));return null}const b=i.filter(_=>G.hasOwn(_,"const")),S=i.filter(_=>!G.hasOwn(_,"const"));d("anyOf",S);const I=[...b,...S];let N;if(ie().exclusiveRefs){let _=()=>Ee({path:["anyOf"],suberr:p});for(const[J,Z]of Object.entries(I).reverse()){const Ye=_;_=()=>{const{sub:Qe,delta:it}=Ue(p,E,Z,X("anyOf",J));f.if(Le(Qe),Ye),N=N?Me(N,it):it}}_()}else{const _=Object.entries(i).map(([J,Z])=>Ue(p,E,Z,X("anyOf",J),K));N=_.map(J=>J.delta).reduce((J,Z)=>Me(J,Z)),de($t(..._.map(({sub:J})=>J)),{path:["anyOf"],suberr:p})}return L(N),null}),j("oneOf",["array"],i=>{if(T(i.length>0,"oneOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"oneOf");d("oneOf",i);const p=D("passes");f.write("let %s = 0",p);const b=Ct();let S,I=0;const N=Object.entries(i).map(([_,J])=>{!g&&I++>1&&de(k("%s > 1",p),{path:["oneOf"]});const Z=Ue(b,E,J,X("oneOf",_),K);return f.if(Z.sub,()=>f.write("%s++",p)),S=S?Me(S,Z.delta):Z.delta,Z});L(S),de(k("%s !== 1",p),{path:["oneOf"]}),f.if(k("%s === 0",p),()=>vn(b));for(const _ of N)f.if(_.sub,()=>be(_.delta));return null})},Ze=(r,s,a)=>{const[d,i]=[f.size(),Pe.size];f.if(yr(...s)?!0:a,r),(d!==f.size()||i!==Pe.size)&&T(He(...s),"Unexpected rules in type",l.type)},Or=()=>{if(M.items===1/0)l.unevaluatedItems===!1&&qe("unevaluatedItems","boolean");else if(l.unevaluatedItems||l.unevaluatedItems===!1)if(ke(M).items){if(!n[Re])throw new Error("[opt] Dynamic unevaluated tracing not enabled");const r=k("Math.max(%d, ...%s)",M.items,K.items),s=a=>k("%s.includes(%s)",K.item,a);bt("unevaluatedItems",r,ie().containsEvaluates?s:null)}else bt("unevaluatedItems",k("%d",M.items))},Er=()=>{gt(M.patterns.length>0||M.dyn.patterns.length>0||M.unknown,()=>{if(M.properties.includes(!0))l.unevaluatedProperties===!1&&qe("unevaluatedProperties","boolean");else if(l.unevaluatedProperties||l.unevaluatedProperties===!1){const r=s=>$n(s,M.properties,M.patterns);if(ke(M).properties){if(!n[Re])throw new Error("[opt] Dynamic unevaluated tracing not enabled");o.propertyIn=G.propertyIn;const s=d=>k("!propertyIn(%s, %s)",d,K.props);Nt("unevaluatedProperties",d=>kt(r(d),s(d)))}else l.unevaluatedProperties===!1&&jn(M.properties,M.patterns),Nt("unevaluatedProperties",r)}})},En=()=>{if(yt!==null&&f.write("const %s = errorCount",yt),jr()){const r=[...ve.keys()];if(L({properties:[!0],items:1/0,type:r,fullstring:!0}),!W){T(Pe.size===0,"Unexpected keywords mixed with const or enum:",[...Pe]);return}}Ze(wr,["number","integer"],ve.get("number")(C)),Ze(vr,["string"],ve.get("string")(C)),Ze(kr,["array"],ve.get("array")(C)),Ze($r,["object"],ve.get("object")(C)),Ar(),Ze(Or,["array"],ve.get("array")(C)),Ze(Er,["object"],ve.get("object")(C));for(const r of An)r();hn(ge,fe.item,fe.items,fe.props)},Sn=()=>{if(fe.item&&f.write("const %s = []",fe.item),fe.items&&f.write("const %s = [0]",fe.items),fe.props&&f.write("const %s = [[], []]",fe.props),j("$ref",["string"],s=>{const a=et(t,u,s,Te()),[d,i,p]=a[0]||[];if(!d&&d!==!1&&(Ae("failed to resolve $ref:",s),F))return null;const b=rt(d,i,p),S=d===e?me:b;if(!o[S])throw new Error("Unexpected: coherence check failed");if(!o[S][Gt]&&d.type){const I=Array.isArray(d.type)?d.type:[d.type];L({type:I}),O&&(Ie.add(S),I.includes("array")&&L({items:1/0}),I.includes("object")&&L({properties:[!0]})),z&&I.includes("string")&&(Ie.add(S),L({fullstring:!0}))}return ht(b,{path:["$ref"]})}),ie().exclusiveRefs&&(T(!n[Re],"unevaluated* is supported only on draft2019-09 and above"),l.$ref))return;j("$recursiveRef",["string"],s=>{if(!n[at])throw new Error("[opt] Recursive anchors are not enabled");T(s==="#",'Behavior of $recursiveRef is defined only for "#"');const a=et(t,u,"#",Te()),[d,i,p]=a[0];nt(d.$recursiveAnchor,"$recursiveRef without $recursiveAnchor");const b=rt(d,i,p),S=d.$recursiveAnchor?k("(recursive || %s)",b):b;return ht(S,{path:["$recursiveRef"]})}),j("$dynamicRef",["string"],s=>{if(!n[tt])throw new Error("[opt] Dynamic anchors are not enabled");nt(/^[^#]*#[a-zA-Z0-9_-]+$/.test(s),"Unsupported $dynamicRef format");const a=s.replace(/^[^#]+/,""),d=et(t,u,s,Te());if(!d[0]&&!ie().bookending){nt(!1,"$dynamicRef bookending resolution failed (even though not required)"),o.dynamicResolve=G.dynamicResolve;const _=k("dynamicResolve(dynAnchors || [], %j)",a);return ht(_,{path:["$dynamicRef"]})}T(d[0],"$dynamicRef bookending resolution failed",s);const[i,p,b]=d[0],S=i.$dynamicAnchor&&`#${i.$dynamicAnchor}`===a;nt(S,"$dynamicRef without $dynamicAnchor in the same scope");const I=rt(i,p,b);o.dynamicResolve=G.dynamicResolve;const N=S?k("(dynamicResolve(dynAnchors || [], %j) || %s)",a,I):I;return ht(N,{path:["$dynamicRef"]})});let r=null;j("type",["string","array"],s=>{const a=Array.isArray(s)?s:[s];for(const i of a)T(typeof i=="string"&&ve.has(i),"Unknown type:",i);if(E.type)return T(G.deepEqual(a,[E.type]),"One type allowed:",E.type),L({type:[E.type]}),null;if(bn(...a))return null;const d=a.filter(i=>He(i));return d.length===0&&Ae("No valid types possible"),L({type:a}),r=$t(...d.map(i=>ve.get(i)(C))),null}),r&&$?f.if(r,()=>Ee({path:["type"]}),En):(r&&de(r,{path:["type"]}),En()),M.items<1/0&&l.maxItems<=M.items&&L({items:1/0})};if(l.default!==void 0&&y){Je&&Ae("Can not apply default value here (e.g. at root)");const r=fn("default","jsonval");f.if(je(E),Sn,()=>f.write("%s = %j",C,r))}else j("default",["jsonval"],null),f.if(Je?!0:je(E),Sn);if(Ve.length=mr,ze[0]&&ze[ze.length-1][0]===l&&ze.pop(),pn&&l!==e&&f.write("dynLocal.shift()"),q||T(!f.optimizedOut,"some checks are never reachable"),mt){const r=["not","if","then","else"].includes(ee[ee.length-1]),s=["oneOf","anyOf","allOf"].includes(ee[ee.length-2]),a=["dependencies","dependentSchemas"].includes(ee[ee.length-2]),d=["propertyDependencies"].includes(ee[ee.length-3]);T(r||s||a||d,"Unexpected logical path")}else if(!ee.includes("not")&&((!(e!==t&&l===e)||Ie.has(me))&&(Ie.delete(me),M.type||xe("type"),He("array")&&M.items!==1/0&&xe(l.items?"additionalItems or unevaluatedItems":"items rule"),He("object")&&!M.properties.includes(!0)&&xe("additionalProperties or unevaluatedProperties"),!M.fullstring&&z&&Ae("[requireStringValidation] pattern, format or contentSchema should be specified for strings, use pattern: ^[\\s\\S]*$ to opt-out")),typeof l.propertyNames!="object"))for(const s of["additionalProperties","unevaluatedProperties"])l[s]&&xe(`wild-card ${s}`,"requires propertyNames");return l.properties&&!l.required&&xe("if properties is used, required"),T(Pe.size===0||W,"Unprocessed keywords:",[...Pe]),{stat:M,local:fe}},{stat:Dt,local:pt}=Mt(k("validate.errors"),[],{name:Rn("data")},e,[]);if(Ie.has(me))throw new Error("Unexpected: unvalidated cyclic ref");if(n[Re]&&(ke(Dt).items||ke(Dt).properties)){if(!pt)throw new Error("Failed to trace dynamic properties");f.write("validate.evaluatedDynamic = [%s, %s, %s]",pt.item,pt.items,pt.props)}return $?f.write("return errorCount === 0"):f.write("return true"),f.write("}"),F||(ft=f.makeFunction(o),delete o[me],o[me]=ft),o[me][Gt]=Dt,me},At=(e,t)=>{if(!Array.isArray(e))throw new Error("Expected an array of schemas");try{const n=Object.create(null),{getref:o}=or(n);Ie.clear(),dt.clear();const c=e.map(m=>o(m)||ar(m,m,t,n));if(Ie.size!==0)throw new Error("Unexpected: not all refs are validated");return{scope:n,refs:c}}catch(n){if(!t[Re]&&n.message==="[opt] Dynamic unevaluated tracing not enabled")return At(e,{...t,[Re]:!0});if(!t[tt]&&n.message==="[opt] Dynamic anchors are not enabled")return At(e,{...t,[tt]:!0});if(!t[at]&&n.message==="[opt] Recursive anchors are not enabled")return At(e,{...t,[at]:!0});throw n}finally{Ie.clear(),dt.clear()}};var Wi={compile:At};const Vi=Kn,{buildSchemas:Ji}=tr,{compile:Ki}=Wi,{deepEqual:rn}=tn,Hi=e=>function t(n){if(!rn(n,JSON.parse(JSON.stringify(n))))return t.errors=[{instanceLocation:"#",error:"not JSON compatible"}],!1;const o=e(n);return t.errors=e.errors,o},Gi=e=>t=>rn(t,JSON.parse(JSON.stringify(t)))&&e(t),sn=(e,{parse:t=!1,multi:n=!1,jsonCheck:o=!1,isJSON:c=!1,schemas:m=[],...y}={})=>{if(o&&c)throw new Error("Can not specify both isJSON and jsonCheck options");if(t&&(o||c))throw new Error("jsonCheck and isJSON options are not applicable in parser mode");const x=t?"strong":"default",g=c||o||t,$=n?e:[e],P={mode:x,...y,schemas:Ji(m,$),isJSON:g},{scope:H,refs:F}=Ki($,P);if(y.dryRun)return;if(y.lint)return H.lintErrors;const W=Vi();if(t?H.parseWrap=y.includeErrors?Zi:Yi:o&&(H.deepEqual=rn,H.jsonCheckWrap=y.includeErrors?Hi:Gi),n){W.write("[");for(const A of F.slice(0,-1))W.write("%s,",A);F.length>0&&W.write("%s",F[F.length-1]),W.write("]"),t?W.write(".map(parseWrap)"):o&&W.write(".map(jsonCheckWrap)")}else t?W.write("parseWrap(%s)",F[0]):o?W.write("jsonCheckWrap(%s)",F[0]):W.write("%s",F[0]);const q=W.makeFunction(H);return q.toModule=({semi:A=!0}={})=>W.makeModule(H)+(A?";":""),q.toJSON=()=>e,q},Zi=e=>t=>{if(typeof t!="string")return{valid:!1,error:"Input is not a string"};try{const n=JSON.parse(t);if(!e(n)){const{keywordLocation:o,instanceLocation:c}=e.errors[0];return{valid:!1,error:`JSON validation failed for ${o.slice(o.lastIndexOf("/")+1)} at ${c}`,errors:e.errors}}return{valid:!0,value:n}}catch({message:n}){return{valid:!1,error:n}}},Yi=e=>t=>{if(typeof t!="string")return{valid:!1};try{const n=JSON.parse(t);return e(n)?{valid:!0,value:n}:{valid:!1}}catch{return{valid:!1}}},Qi=function(e,{parse:t=!0,...n}={}){if(!t)throw new Error("can not disable parse in parser");return sn(e,{parse:t,...n})},Xi=function(e,{lint:t=!0,...n}={}){if(!t)throw new Error("can not disable lint option in lint()");return sn(e,{lint:t,...n})};var Bi={validator:sn,parser:Qi,lint:Xi};const es="http://json-schema.org/draft-04/schema#",ts="object",ns={version:{type:"string"},isReadonly:{type:"boolean"},isDrawerOpen:{type:"boolean"},showLegend:{type:"boolean"},techniqueMappingMode:{type:"string"},selectedProfile:{type:"integer"},selectedStore:{type:"string"},containerSize:{type:"number"},matrixSize:{type:"integer"},associationMode:{type:"boolean"},matrixCommentMode:{type:"boolean"},localStorageWarning:{type:"boolean"},profiles:{type:"array",items:[{type:"object",properties:{id:{type:"integer"},description:{type:"string"},name:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","description","name","includedLayers"]}]},layers:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},color:{type:"string"},children:{type:"array",items:[{type:"string"}]},checked:{type:"boolean"}},additionalProperties:!1,required:["id","description","name","techniques","color","children","checked"]}}},attack:{type:"object",patternProperties:{".*":{type:"object",patternProperties:{".*":{type:"array",items:[{type:"object",properties:{id:{type:"string"},justification:{type:"string"},tactic:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","justification","tactic"]}]}}}}},rootTemplates:{type:"array",items:[{type:"string"}]},templates:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},checked:{type:"boolean"},color:{type:"string"},children:{type:"array",items:{}}},additionalProperties:!1,required:["id","description","name","techniques","checked","color","children"]}}},shownTactics:{type:"object",properties:{"d3f:Model":{type:"boolean"},"d3f:Harden":{type:"boolean"},"d3f:Detect":{type:"boolean"},"d3f:Isolate":{type:"boolean"},"d3f:Deceive":{type:"boolean"},"d3f:Evict":{type:"boolean"}},required:["d3f:Model","d3f:Harden","d3f:Detect","d3f:Isolate","d3f:Deceive","d3f:Evict"]}},rs=!1,is=["version","isReadonly","isDrawerOpen","showLegend","techniqueMappingMode","selectedProfile","selectedStore","containerSize","matrixSize","associationMode","matrixCommentMode","localStorageWarning","profiles","layers","attack","rootTemplates","templates","shownTactics"],ss={$schema:es,type:ts,properties:ns,additionalProperties:rs,required:is},$e={layers:"layers",templates:"templates"},ls={rootColor:"multiColor",heatMap:"heatMap",childrenMultiColor:"childrenMultiColor","ATT&CK":"ATT&CK"},ds={attack:"attack",controls:"controls",cwe:"cwe",act:"acf"},cr={version:"1",isReadonly:!1,isDrawerOpen:!0,showLegend:!0,techniqueMappingMode:"multiColor",selectedProfile:0,selectedStore:"layers",containerSize:.8,matrixSize:1,associationMode:!1,matrixCommentMode:!1,localStorageWarning:!1,profiles:[{name:"Example Profile",description:"Example D3FEND Profile",id:0,includedLayers:["endpoint-detection-response-b5e1b37fe803","network-detection-response-bd0a1550c68f","web-application-firewall-e2b69b0e42e7","network-intrusion-detection-system-53345eadd88f","idam-analytics-suite-05a3693fb7f6","network-vulnerability-scanner-5bdfd415a60c","security-orchestration-automation-and-response-861f9e04e823","operational-test-status-3e2e05ea8e07"]}],layers:{"zero-trust-kdjj2mvnvjkkd":{id:"zero-trust-kdjj2mvnvjkkd",description:"Testing the description",name:"Zero-Trust",techniques:[],color:"#ef0b0b",children:["role-based-access-hdjkfkkbvgn","continuous-verification-jkqwwer","geo-location-ie83909"],checked:!0},"role-based-access-hdjkfkkbvgn":{id:"role-based-access-hdjkfkkbvgn",description:"Testing the description",name:"Role-Based Access",techniques:[{id:"d3f:DataInventory",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""},{id:"d3f:AssetInventory",comment:""}],children:[],color:"#ef0b0b",checked:!0},"least-priviledge-27kdjkdfkj":{id:"least-priviledge-27kdjkdfkj",description:"Testing the description",name:"Least Priviledge",techniques:[{id:"d3f:DNSAllowlisting",comment:""},{id:"d3f:DNSDenylisting",comment:""},{id:"d3f:ForwardResolutionDomainDenylisting",comment:""},{id:"d3f:HierarchicalDomainDenylisting",comment:""},{id:"d3f:HomoglyphDenylisting",comment:""},{id:"d3f:ForwardResolutionIPDenylisting",comment:""},{id:"d3f:ReverseResolutionIPDenylisting",comment:""},{id:"d3f:InboundTrafficFiltering",comment:""},{id:"d3f:OutboundTrafficFiltering",comment:""},{id:"d3f:AccountLocking",comment:""},{id:"d3f:ProcessTermination",comment:""}],color:"#bbc171",checked:!0,children:[]},"continuous-verification-jkqwwer":{id:"continuous-verification-jkqwwer",description:"Testing the description",name:"Continuous Verification",techniques:[],color:"#ef0b0b",children:[],checked:!1},"geo-location-ie83909":{id:"geo-location-ie83909",description:"Testing the description",name:"Geo Location",techniques:[{id:"d3f:TransferAgentAuthentication",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""}],color:"#ef0b0b",children:[],checked:!0},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[],children:[],color:"#ef0b0b",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",description:"Testing the description",name:"Web Filtering",techniques:[],color:"#ef0b0b",children:["web-filtering-rule-1-e639d37443c9"],checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],color:"#ef0b0b",children:[],checked:!0},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",description:"Testing the description",name:"Threat Prevention",techniques:[],color:"#ef0b0b",children:[],checked:!0},"application-and-identiy-based-inspection-dkvn":{id:"application-and-identiy-based-inspection-dkvn",description:"Testing the description",name:"Application and Identiy-based Inspection",techniques:[{id:"d3f:HomoglyphDetection",comment:""},{id:"d3f:URLAnalysis",comment:""},{id:"d3f:CertificateAnalysis",comment:""},{id:"d3f:PassiveCertificateAnalysis",comment:""},{id:"d3f:IPCTrafficAnalysis",comment:""},{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:DomainAccountMonitoring",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:LocalAccountMonitoring",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""},{id:"d3f:SessionDurationAnalysis",comment:""},{id:"d3f:UserDataTransferAnalysis",comment:""},{id:"d3f:UserGeolocationLogonPatternAnalysis",comment:""},{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""},{id:"d3f:FirmwareBehaviorAnalysis",comment:""},{id:"d3f:FirmwareEmbeddedMonitoringCode",comment:""},{id:"d3f:PeripheralFirmwareVerification",comment:""},{id:"d3f:SystemFirmwareVerification",comment:""},{id:"d3f:FileIntegrityMonitoring",comment:""}],color:"#817fcc",checked:!0,children:[]},"scalability-kdnvmv":{id:"scalability-kdnvmv",description:"Testing the description",name:"Scalability",techniques:[],color:"#ef0b0b",children:[],checked:!0},"next-generation-firewall-kjlknlkn":{id:"next-generation-firewall-kjlknlkn",description:"Testing the description",name:"Next-Generation Firewall",techniques:[],color:"#ef0b0b",children:["web-filtering-3iejkdfmv","sandboxing-kdnvmvmmv","threat-prevention-kdkvsaka"],checked:!0},"claimed-dkjndlkdj":{id:"claimed-dkjndlkdj",description:"Testing the description",name:"Claimed",checked:!0,techniques:[],color:"#98d0A9",children:["scalability-kdnvmv","application-and-identiy-based-inspection-dkvn"]},"tested-dnkljlkldjs":{id:"tested-dnkljlkldjs",description:"Testing the description",name:"Tested",checked:!0,techniques:[{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],children:[],color:"#ec4327"},"integration-jksieufnvdkd":{id:"integration-jksieufnvdkd",description:"Testing the description",name:"Integration",techniques:[],children:["least-priviledge-27kdjkdfkj"],checked:!0,color:"#ffcc80"},"web-filtering-rule-1-e639d37443c9":{id:"web-filtering-rule-1-e639d37443c9",name:"Web Filtering Rule 1 ",description:"",techniques:[{id:"d3f:OutboundTrafficFiltering",comment:""}],children:[],checked:!0,color:"#ef0b0b"},"endpoint-detection-response-b5e1b37fe803":{id:"endpoint-detection-response-b5e1b37fe803",name:"Endpoint Detection & Response",description:"",techniques:[],children:["process-analysis-module-03228699d908","file-analysis-module-53b1557a8c3f","inventory-module-cd27dd8b9898"],checked:!0,color:"#12f576"},"network-detection-response-bd0a1550c68f":{id:"network-detection-response-bd0a1550c68f",name:"Network Detection & Response",description:"",techniques:[],children:["ueba-module-45cfb57fb917","anomaly-analytics-f62110fc7f8d"],checked:!0,color:"#9ff604"},"web-application-firewall-e2b69b0e42e7":{id:"web-application-firewall-e2b69b0e42e7",name:"Web Application Firewall",description:"",techniques:[{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""}],children:[],checked:!0,color:"#e6f62a"},"network-intrusion-detection-system-53345eadd88f":{id:"network-intrusion-detection-system-53345eadd88f",name:"Network Intrusion Detection System",description:"",techniques:[],children:["ids-vendor-signatures-99c3ce856ebe"],checked:!0,color:"#f6bf37"},"idam-analytics-suite-05a3693fb7f6":{id:"idam-analytics-suite-05a3693fb7f6",name:"IDAM Analytics Suite",description:"",techniques:[{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:UserGeolocationLogonPatternAnalysis",comment:""}],children:[],checked:!0,color:"#f67518"},"network-vulnerability-scanner-5bdfd415a60c":{id:"network-vulnerability-scanner-5bdfd415a60c",name:"Network Vulnerability Scanner",description:"",techniques:[{id:"d3f:AssetVulnerabilityEnumeration",comment:""},{id:"d3f:ContainerImageAnalysis",comment:""},{id:"d3f:NetworkNodeInventory",comment:""},{id:"d3f:PassiveLogicalLinkMapping",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""}],children:[],checked:!0,color:"#0075ff"},"process-analysis-module-03228699d908":{id:"process-analysis-module-03228699d908",name:"Process Analysis Module",description:"",techniques:[{id:"d3f:ProcessSelf-ModificationDetection",comment:""},{id:"d3f:ProcessSpawnAnalysis",comment:""},{id:"d3f:ProcessLineageAnalysis",comment:""},{id:"d3f:ScriptExecutionAnalysis",comment:""},{id:"d3f:SystemCallAnalysis",comment:""},{id:"d3f:FileCreationAnalysis",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""}],children:[],checked:!0,color:"#12f576"},"file-analysis-module-53b1557a8c3f":{id:"file-analysis-module-53b1557a8c3f",name:"File Analysis Module",description:"",techniques:[{id:"d3f:DynamicAnalysis",comment:""},{id:"d3f:FileHashing",comment:""},{id:"d3f:FileContentAnalysis",comment:""},{id:"d3f:FileContentRules",comment:""}],children:["custom-rules-9bcb48770338","vendor-supplied-rules-7efac2058dcb"],checked:!0,color:"#4cfe4b"},"inventory-module-cd27dd8b9898":{id:"inventory-module-cd27dd8b9898",name:"Inventory Module",description:"",techniques:[{id:"d3f:SoftwareInventory",comment:""},{id:"d3f:AssetVulnerabilityEnumeration",comment:""}],children:[],checked:!0,color:"#55fe38"},"custom-rules-9bcb48770338":{id:"custom-rules-9bcb48770338",name:"Custom Rules",description:"",techniques:[],children:["rule-1-fc6354ccbfc9","rule-2-11e6773a42cb"],checked:!0,color:"#37ff2a"},"rule-1-fc6354ccbfc9":{id:"rule-1-fc6354ccbfc9",name:"Rule 1",description:"",techniques:[{id:"d3f:FileContentRules",comment:""}],children:[],checked:!0,color:"#12f576"},"rule-2-11e6773a42cb":{id:"rule-2-11e6773a42cb",name:"Rule 2",description:"",techniques:[],children:[],checked:!0,color:"#36fe3b"},"vendor-supplied-rules-7efac2058dcb":{id:"vendor-supplied-rules-7efac2058dcb",name:"Vendor Supplied Rules",description:"",techniques:[{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""}],children:[],checked:!0,color:"#23fe36"},"ueba-module-45cfb57fb917":{id:"ueba-module-45cfb57fb917",name:"UEBA Module",description:"",techniques:[{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""},{id:"d3f:SessionDurationAnalysis",comment:""},{id:"d3f:UserDataTransferAnalysis",comment:""},{id:"d3f:UserGeolocationLogonPatternAnalysis",comment:""},{id:"d3f:WebSessionActivityAnalysis",comment:""},{id:"d3f:AuthenticationEventThresholding",comment:""}],children:[],checked:!0,color:"#9ff604"},"anomaly-analytics-f62110fc7f8d":{id:"anomaly-analytics-f62110fc7f8d",name:"Anomaly Analytics",description:"",techniques:[{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:InboundSessionVolumeAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],children:[],checked:!0,color:"#9ff604"},"ids-vendor-signatures-99c3ce856ebe":{id:"ids-vendor-signatures-99c3ce856ebe",name:"IDS Vendor Signatures",description:"",techniques:[{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""}],children:[],checked:!0,color:"#f6bf37"},"security-orchestration-automation-and-response-861f9e04e823":{id:"security-orchestration-automation-and-response-861f9e04e823",name:"Security Orchestration Automation and Response",description:"",techniques:[{id:"d3f:EmailRemoval",comment:""},{id:"d3f:AccountLocking",comment:""},{id:"d3f:AuthenticationCacheInvalidation",comment:""},{id:"d3f:CredentialRevoking",comment:""},{id:"d3f:ProcessTermination",comment:""},{id:"d3f:ProcessSuspension",comment:""},{id:"d3f:RestoreNetworkAccess",comment:""},{id:"d3f:RestoreUserAccountAccess",comment:""},{id:"d3f:UnlockAccount",comment:""},{id:"d3f:RestoreFile",comment:""}],children:[],checked:!0,color:"#7ecdf5"},"operational-test-status-3e2e05ea8e07":{id:"operational-test-status-3e2e05ea8e07",name:"Operational Test Status",description:"",techniques:[{id:"d3f:DynamicAnalysis",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:ProcessSpawnAnalysis",comment:""},{id:"d3f:ScriptExecutionAnalysis",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""},{id:"d3f:AuthenticationCacheInvalidation",comment:""}],children:[],checked:!0,color:"#ff260c"}},attack:{},rootTemplates:["firewall-kdjenyeurhg","threat-prevention-kdkvsaka"],templates:{"firewall-kdjenyeurhg":{id:"firewall-kdjenyeurhg",description:"Testing the description",name:"Firewall",techniques:[],checked:!0,color:"#7078A4",children:["bandwidth-control-and-monitoring-837fdrkdm"]},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[{id:"d3f:SoftwareUpdate",comment:""},{id:"d3f:ByteSequenceEmulation",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:NetworkTrafficFiltering",comment:""}],children:[],color:"#7078A4",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",name:"Web Filtering",description:"Testing the description",techniques:[],children:[],color:"#7078A4",checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],children:[],checked:!0,color:"#BB5883"},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",name:"Threat Prevention",description:"Testing the description",techniques:[],children:[],color:"#BB5883",checked:!0}},shownTactics:{"d3f:Model":!1,"d3f:Harden":!1,"d3f:Detect":!1,"d3f:Isolate":!1,"d3f:Deceive":!1,"d3f:Evict":!1}},Un={selected:"selected",editing:"editing",parent:"parent",root:"root",noop:"noop"};try{const e=Bi.parser(ss,{requireStringValidation:!1,mode:"lax",includeErrors:!0,allErrors:!0}),{valid:t,error:n,errors:o}=e(JSON.stringify(cr));if(!t)throw new AggregateError(o,`Error Parsing Initial Profile Layer: ${n}`)}catch(e){if(console.error(e.message),Array.isArray(e.errors))for(let t=0;t<e.errors.length;t++){const n=e.errors[t];console.error(n)}else console.error(e.errors);process.exit(1)}const os=e=>{const{subscribe:t,update:n,set:o}=Rr("d3fend-layers",e);return{subscribe:t,update:n,set:o,createProfile:h=>n(u=>{const w=u.profiles.length;return h.id=w,h.includedLayers=[],u.profiles.push(h),u.selectedProfile=w,u}),deleteProfile:()=>n(h=>(h.profiles=h.profiles.filter((u,w)=>w!==h.selectedProfile),h.selectedProfile=h.profiles.length?0:null,h)),addLayer:h=>n(u=>(u.layers[h.id]=h,u.profiles[u.selectedProfile].includedLayers.push(h.id),u)),bulkAddLayer:(h,u)=>n(w=>{for(const v of h)w.layers[v.id]=v;return w.profiles[w.selectedProfile].includedLayers.push(u),w}),addTemplate:h=>n(u=>(u.templates[h.id]=h,u.rootTemplates.push(h.id),u)),copyFromTemplate:(h,u=$e.layers)=>n(w=>(h.id=Ft(h.name),w[u][h.id]=h,w)),appendLayer:h=>n(u=>(u.layers[h]&&u.profiles[u.selectedProfile].includedLayers.push(h),u)),editName:(h,u,w=$e.layers)=>n(v=>(v[w][h].name=u,v)),editLayerComment:(h,u,w=$e.layers)=>n(v=>(v[w][h].comment=u,v)),addChild:(h,u,w=$e.layers)=>n(v=>{const D=Ft(u.name),Y=h.id;return u.id=D,u.checked=!0,u.children=[],u.techniques=[...h.techniques],u.color=h.color,v[w][D]=u,v[w][Y].children||(v[w][Y].children=[]),v[w][Y].children.push(D),v[w][Y].techniques=[],v}),addNonRootChild:(h,u,w=$e.layers)=>n(v=>{const D=Ft(u.name);return u.id=D,u.checked=!0,u.techniques=[],u.children=[],u.color=h.color,v[w][D]=u,v[w][h.id].children.push(D),v}),deleteLayer:h=>n(u=>{const{[h]:w,...v}=u.layers,D=u.profiles.reduce((Y,U,B)=>{if(u.selectedProfile===B){const re={...U,includedLayers:U.includedLayers.filter(me=>me!==h)};Y.push(re)}else Y.push(U);return Y},[]);return{...u,profiles:D,layers:v}}),deleteTemplate:h=>n(u=>{const{[h]:w,...v}=u.templates,D=u.rootTemplates.filter(Y=>h!==Y);return{...u,templates:v,rootTemplates:D}}),deleteSublayer:(h,u,w=$e.layers)=>n(v=>(v[w][u].children=v[w][u].children.filter(D=>D!==h.id),delete v[w][h.id],v)),saveTechniques:(h,u,w=$e.layers)=>n(v=>{const D=Object.values(h).reduce((U,B)=>(B.classes.isSelected&&U.push(B["@id"]),U),[]);return Object.entries(u).reduce((U,[B,re])=>(re===Un.selected&&U.push(B),U),[]).forEach(U=>{const B=[...new Set([...v[w][U].techniques.map(re=>re.id),...D])];v[w][U].techniques=B.map(re=>({id:re,comment:""})),v[w][U].checked=!0}),v}),removeTechniques:(h,u,w=$e.layers)=>n(v=>{const D=Object.values(h).reduce((U,B)=>(B.classes.isSelected&&U.push(B["@id"]),U),[]);return Object.entries(u).reduce((U,[B,re])=>(re===Un.selected&&U.push(B),U),[]).forEach(U=>{const B=v[w][U].techniques.filter(re=>!D.includes(re.id));v[w][U].techniques=B,v[w][U].checked=!0}),v}),saveLayerColor:(h,u,w=$e.layers)=>n(v=>(v[w][h.id].color=u,v)),saveLayerTechniqueComment:(h,u,w,v=$e.layers)=>n(D=>{const Y=D[v][h].techniques.find(U=>U.id===u);return Y.comment=w,D}),changeTechniqueMappingMode:(h,u)=>n(w=>(w.techniqueMappingMode=h,w.showLegend=u,w)),addUserAssociatedAttack:(h,u,w)=>n(v=>{if((v.attack[h]||(v.attack[h]={}))&&(v.attack[h][u]||(v.attack[h][u]=[]))){const D=`${w.id}${w.tactic}`;if(v.attack[h][u].findIndex(({id:U,tactic:B})=>`${U}${B}`===D)!==-1)return v;v.attack[h][u].push(w)}return v}),editUserAssociatedAttack:(h,u,w)=>n(v=>(v.attack[h][u].justification=w,v)),deleteUserAssociatedAttack:(h,u,w)=>n(v=>{const D=v.attack[h][u].reduce((Y,U)=>(U.id!==w&&Y.push(U),Y),[]);return v.attack[h][u]=D,v})}},fs=os(cr);export{ls as M,$e as P,Un as S,ds as T,ss as j,fs as l,Bi as s};
