import{w as Mr}from"./index.BQBQGMgF.js";import{c as _t}from"./utils.xEKteSAW.js";var Ft={local:{},session:{}};function Ir(e){return e==="local"?localStorage:sessionStorage}function Dr(e,t,n){var o,c,m,y,S,g,$,q;const H=(o=void 0)!=null?o:JSON,_=(c=void 0)!=null?c:"local",W=(m=void 0)!=null?m:!0,T=(S=(y=void 0)!=null?y:void 0)!=null?S:ne=>console.error(`Error when writing value from persisted store "${e}" to ${_}`,ne),O=(g=void 0)!=null?g:(ne,le)=>console.error(`Error when parsing ${ne?'"'+ne+'"':"value"} from persisted store "${e}"`,le),x=($=void 0)!=null?$:ne=>ne,R=(q=void 0)!=null?q:ne=>ne,J=typeof window<"u"&&typeof document<"u",Q=J?Ir(_):null;function ce(ne,le){const ge=R(le);try{Q==null||Q.setItem(ne,H.stringify(ge))}catch(xe){T(xe)}}function te(){function ne(h){try{return H.parse(h)}catch(u){O(h,u)}}const le=Q==null?void 0:Q.getItem(e);if(le==null)return t;const ge=ne(le);return ge==null?t:x(ge)}if(!Ft[_][e]){const ne=te(),le=Mr(ne,h=>{if(J&&_=="local"&&W){const u=b=>{if(b.key===e&&b.newValue){let v;try{v=H.parse(b.newValue)}catch(Y){O(b.newValue,Y);return}const I=x(v);h(I)}};return window.addEventListener("storage",u),()=>window.removeEventListener("storage",u)}}),{subscribe:ge,set:xe}=le;Ft[_][e]={set(h){xe(h),ce(e,h)},update(h){return le.update(u=>{const b=h(u);return ce(e,b),b})},reset(){this.set(t)},subscribe:ge}}return Ft[_][e]}class ct extends String{}const zr=new Set(["<",">","<=",">="]),Rr=e=>`\\u${e.toString(16).padStart(4,"0")}`,Cr=e=>{if([1/0,-1/0,NaN,void 0,null].includes(e))return`${e}`;if(!["string","boolean","number"].includes(typeof e)){if(typeof e!="object")throw new Error("Unexpected value type");const n=Object.getPrototypeOf(e);if(!(n===Array.prototype&&Array.isArray(e)||n===Object.prototype))throw new Error("Unexpected object given as value")}return JSON.stringify(e).replace(/([{,])"__proto__":/g,'$1["__proto__"]:').replace(/[^\\]"__proto__":/g,()=>{throw new Error("Unreachable")}).replace(/[\u2028\u2029]/g,n=>Rr(n.charCodeAt(0)))},At=(e,...t)=>{const n=e.replace(/%[%drscjw]/g,o=>{if(o==="%%")return"%";if(t.length===0)throw new Error("Unexpected arguments count");const c=t.shift();switch(o){case"%d":if(typeof c=="number")return c;throw new Error("Expected a number");case"%r":if(c instanceof RegExp)return At("new RegExp(%j, %j)",c.source,c.flags);throw new Error("Expected a RegExp instance");case"%s":if(c instanceof ct)return c;throw new Error("Expected a safe string");case"%c":if(zr.has(c))return c;throw new Error("Expected a compare op");case"%j":return Cr(c);case"%w":if(Number.isInteger(c)&&c>=0)return" ".repeat(c);throw new Error("Expected a non-negative integer for indentation")}throw new Error("Unreachable")});if(t.length!==0)throw new Error("Unexpected arguments count");return new ct(n)},Gt=e=>{if(!/^[a-z][a-z0-9_]*$/i.test(e))throw new Error("Does not look like a safe id");return new ct(e)},Ln=e=>(...t)=>{if(!t.every(n=>n instanceof ct))throw new Error("Unsafe arguments");return new ct(e(...t))},Nr=e=>/^[a-z][a-z0-9_().]*$/i.test(e)||/^\([^()]+\)$/i.test(e)?e:At("(%s)",e),Ur=Ln((...e)=>e.some(t=>`${t}`=="true")?"true":e.join(" || ")||"false"),Lr=Ln((...e)=>e.some(t=>`${t}`=="false")?"false":e.join(" && ")||"true"),_n=e=>`${e}`=="true"?Gt("false"):`${e}`=="false"?Gt("true"):At("!%s",Nr(e)),_r=(...e)=>_n(Ur(...e));var St={format:At,safe:Gt,safeand:Lr,safenot:_n,safenotor:_r};const{safe:qn}=St,Wt=new WeakMap,Fr=e=>{Wt.has(e)||Wt.set(e,{sym:new Map,ref:new Map,format:new Map,pattern:new Map});const t=Wt.get(e),n=g=>{t.sym.get(g)||t.sym.set(g,0);const $=t.sym.get(g);return t.sym.set(g,$+1),qn(`${g}${$}`)},o=g=>{if(t.pattern.has(g))return t.pattern.get(g);const $=n("pattern");return e[$]=new RegExp(g,"u"),t.pattern.set(g,$),$};return t.loop||(t.loop="ijklmnopqrstuvxyz".split("")),{gensym:n,genpattern:o,genloop:()=>{const g=t.loop.shift();return t.loop.push(`${g}${g[0]}`),qn(g)},getref:g=>t.ref.get(g),genref:g=>{const $=n("ref");return t.ref.set(g,$),$},genformat:g=>{let $=t.format.get(g);return $||($=n("format"),e[$]=g,t.format.set(g,$)),$}}};var Fn={scopeMethods:Fr};const Wr=e=>/[\uD800-\uDFFF]/.test(e)?[...e].length:e.length,Jr=(e,t,n,o)=>{if(e%t===0)return!0;let c=e*n;if((c===1/0||c===-1/0)&&(c=e),c%o===0)return!0;const m=Math.floor(c+.5);return m/n===e&&m%o===0},lt=(e,t)=>{if(e===t)return!0;if(!e||!t||typeof e!=typeof t||e!==t&&typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n!==Object.getPrototypeOf(t))return!1;if(n===Array.prototype)return!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length?!1:e.every((o,c)=>lt(o,t[c]));if(n===Object.prototype){const[o,c]=[Object.keys(e),Object.keys(t)];return o.length!==c.length?!1:new Set([...o,...c]).size===o.length&&o.every(y=>lt(e[y],t[y]))}return!1},Vr=e=>{if(e.length<2)return!0;if(e.length===2)return!lt(e[0],e[1]);const t=[],n=e.length>20?new Set:null;let o=0,c=0;for(const m of e){if(typeof m=="object")t.push(m);else if(n){if(n.add(m),n.size!==++o)return!1}else if(e.indexOf(m,c+1)!==-1)return!1;c++}for(let m=1;m<t.length;m++)for(let y=0;y<m;y++)if(lt(t[m],t[y]))return!1;return!0},Kr=e=>{if(typeof Buffer<"u")return Buffer.from(e,"base64").toString("utf-8");const t=atob(e);return new TextDecoder("utf-8").decode(new Uint8Array(t.length).map((n,o)=>t.charCodeAt(o)))},Wn=Function.prototype.call.bind(Object.prototype.hasOwnProperty);Wn[Symbol.for("toJayString")]="Function.prototype.call.bind(Object.prototype.hasOwnProperty)";const Jn=e=>/~\//.test(e)?`${e}`.replace(/~/g,"~0").replace(/\//g,"~1"):e,Hr=e=>e.length===0?"#":`#/${e.map(Jn).join("/")}`,Zr=({keywordLocation:e,instanceLocation:t},n,o)=>({keywordLocation:`${n}${e.slice(1)}`,instanceLocation:`${o}${t.slice(1)}`}),Gr=(e,[t,n])=>t.includes(!0)||t.some(o=>o===e)||n.some(o=>new RegExp(o,"u").test(e)),Yr=(e,t)=>(e.filter(n=>n[t])[0]||{})[t],Qr={toPointer:Hr,pointerPart:Jn,errorMerge:Zr,propertyIn:Gr,dynamicResolve:Yr};var tn={stringLength:Wr,isMultipleOf:Jr,deepEqual:lt,unique:Vr,deBase64:Kr,hasOwn:Wn,...Qr};const{format:D,safe:Xr}=St,{scopeMethods:Br}=Fn,bt=tn,Yt=new Map(Object.entries({null:e=>D("%s === null",e),boolean:e=>D('typeof %s === "boolean"',e),array:e=>D("Array.isArray(%s)",e),object:e=>D('typeof %s === "object" && %s && !Array.isArray(%s)',e,e,e),number:e=>D('typeof %s === "number"',e),integer:e=>D("Number.isInteger(%s)",e),string:e=>D('typeof %s === "string"',e)})),_e=({name:e,parent:t,keyval:n,keyname:o})=>{if(e){if(t||n||o)throw new Error("name can be used only stand-alone");return e}if(!t)throw new Error("Can not use property of undefined parent!");const c=_e(t);if(n!==void 0){if(o)throw new Error("Can not use key value and name together");if(!["string","number"].includes(typeof n))throw new Error("Invalid property path");return/^[a-z][a-z0-9_]*$/i.test(n)?D("%s.%s",c,Xr(n)):D("%s[%j]",c,n)}else if(o)return D("%s[%s]",c,o);throw new Error("Unreachable")},ei=new Set([].concat(...[Object,Array,String,Number,Boolean].map(e=>Object.getOwnPropertyNames(e.prototype)))),ti=(e,t,n,{unmodifiedPrototypes:o,isJSON:c},m)=>{const{gensym:y,genpattern:S,genloop:g}=Br(t,n);return{present:T=>{const O=_e(T),{parent:x,keyval:R,keyname:J,inKeys:Q,checked:ce}=T;if(ce||Q&&c)throw new Error("Unreachable: useless check for undefined");if(Q)return D("%s !== undefined",O);if(x&&J){t.hasOwn=bt.hasOwn;const te=_e(x);return c?D("%s !== undefined && hasOwn(%s, %s)",O,te,J):D("%s in %s && hasOwn(%s, %s)",J,te,te,J)}else if(x&&R!==void 0){if(o&&c&&!ei.has(`${R}`))return D("%s !== undefined",O);t.hasOwn=bt.hasOwn;const te=_e(x);return c?D("%s !== undefined && hasOwn(%s, %j)",O,te,R):D("%j in %s && hasOwn(%s, %j)",R,te,te,R)}throw new Error("Unreachable: present() check without parent")},forObjectKeys:(T,O)=>{const x=y("key");e.block(D("for (const %s of Object.keys(%s))",x,_e(T)),()=>{O(n(T,x,!0),x)})},forArray:(T,O,x)=>{const R=g(),J=_e(T);e.block(D("for (let %s = %s; %s < %s.length; %s++)",R,O,R,J,R),()=>{x(n(T,R,o,!0),R)})},patternTest:(T,O)=>{const x=T.replace(/[.^$|*+?(){}[\]\\]/gu,"");if(T===`^${x}$`)return D("(%s === %j)",O,T.slice(1,-1));if(m.has(T))return D("true");if([x,`${x}+`,`${x}.*`,`.*${x}.*`].includes(T))return D("%s.includes(%j)",O,x);if([`^${x}`,`^${x}+`,`^${x}.*`].includes(T))return D("%s.startsWith(%j)",O,x);if([`${x}$`,`.*${x}$`].includes(T))return D("%s.endsWith(%j)",O,x);const R=[...x].slice(0,-1).join("");return[`${x}*`,`${x}?`].includes(T)?R.length===0?D("true"):D("%s.includes(%j)",O,R):[`^${x}*`,`^${x}?`].includes(T)?R.length===0?D("true"):D("%s.startsWith(%j)",O,R):D("%s.test(%s)",S(T),O)},compare:(T,O)=>{if(!O||typeof O!="object")return D("%s === %j",T,O);let x;const R=J=>J.length<=3&&J.every(Q=>!Q||typeof Q!="object");if(Array.isArray(O)){if(x=Yt.get("array")(T),R(O)){let J=D("%s.length === %d",T,O.length);for(let Q=0;Q<O.length;Q++)J=D("%s && %s[%d] === %j",J,T,Q,O[Q]);return D("%s && %s",x,J)}}else{x=Yt.get("object")(T);const[J,Q]=[Object.keys(O),Object.values(O)];if(R(Q)){let ce=D("Object.keys(%s).length === %d",T,J.length);J.length>0&&(t.hasOwn=bt.hasOwn);for(const te of J)ce=D("%s && hasOwn(%s, %j)",ce,T,te);for(const te of J)ce=D("%s && %s[%j] === %j",ce,T,te,O[te]);return D("%s && %s",x,ce)}}return t.deepEqual=bt.deepEqual,D("%s && deepEqual(%s, %j)",x,T,O)},propvar:n}},ni=/^\([^)]*\) *=>/,ri=/^[^=]*=>/,Tn=Symbol.for("toJayString");function ii(e){if(typeof e=="function"){if(e[Tn])return e[Tn];if(Object.getPrototypeOf(e)!==Function.prototype)throw new Error("Can not stringify: a function with unexpected prototype");const t=`${e}`;if(e.prototype){if(!/^function[ (]/.test(t))throw new Error("Unexpected function");return t}if(ni.test(t)||ri.test(t))return t;throw new Error("Can not stringify: only either normal or arrow functions are supported")}else if(typeof e=="object"){const t=Object.getPrototypeOf(e);if(e instanceof RegExp&&t===RegExp.prototype)return D("%r",e);throw new Error("Can not stringify: an object with unexpected prototype")}throw new Error(`Can not stringify: unknown type ${typeof e}`)}var Vn={types:Yt,buildName:_e,jsHelpers:ti,jaystring:ii};const{format:vt,safe:si,safenot:oi}=St,{jaystring:ai}=Vn,ci=/[{[]/,li=/[}\]]/;var Kn=()=>{const e=[];let t=0;const n=m=>{li.test(m.trim()[0])&&t--,e.push({indent:t,code:m}),ci.test(m[m.length-1])&&t++},o=()=>{if(t!==0)throw new Error("Unexpected indent at build()");const m=e.map(y=>vt("%w%s",y.indent*2,y.code)).join(`
`);return/^[a-z][a-z0-9]*$/i.test(m)?`return ${m}`:`return (${m})`},c=m=>{const y=Object.entries(m);for(const[S,g]of y){if(!/^[a-z][a-z0-9]*$/i.test(S))throw new Error("Unexpected scope key!");if(!(typeof g=="function"||g instanceof RegExp))throw new Error("Unexpected scope value!")}return y};return{optimizedOut:!1,size:()=>e.length,write(m,...y){if(typeof m!="string")throw new Error("Format must be a string!");if(m.includes(`
`))throw new Error("Only single lines are supported");return n(vt(m,...y)),!0},block(m,y,S=!1){const g=t;this.write("%s {",m);const $=e.length;if(y(),$===e.length)return e.pop(),t=g,!1;if($===e.length-1&&!S){const{code:q}=e[e.length-1];if(!/^(if|for) /.test(q))return e.length-=2,t=g,this.write("%s %s",m,q)}return this.write("}")},if(m,y,S){`${m}`=="false"?(S&&S(),y&&(this.optimizedOut=!0)):`${m}`=="true"?(y&&y(),S&&(this.optimizedOut=!0)):y&&this.block(vt("if (%s)",m),y,!!S)?S&&this.block(vt("else"),S):S&&this.if(oi(m),S)},makeModule(m={}){return`(function() {
'use strict'
${c(m).map(([S,g])=>`const ${si(S)} = ${ai(g)};`).join(`
`)}
${o()}})()`},makeFunction(m={}){const y=c(m),S=y.map($=>$[0]),g=y.map($=>$[1]);return Function(...S,`'use strict'
${o()}`)(...g)}}};const di=["$schema","$vocabulary","id","$id","$anchor","$ref","definitions","$defs","$recursiveRef","$recursiveAnchor","$dynamicAnchor","$dynamicRef","type","required","default","enum","const","not","allOf","anyOf","oneOf","if","then","else","maximum","minimum","exclusiveMaximum","exclusiveMinimum","multipleOf","divisibleBy","items","maxItems","minItems","additionalItems","prefixItems","contains","minContains","maxContains","uniqueItems","maxLength","minLength","format","pattern","contentEncoding","contentMediaType","contentSchema","properties","maxProperties","minProperties","additionalProperties","patternProperties","propertyNames","dependencies","dependentRequired","dependentSchemas","propertyDependencies","unevaluatedProperties","unevaluatedItems","title","description","deprecated","readOnly","writeOnly","examples","$comment","example","discriminator","removeAdditional"],fi=["draft/next","draft/2020-12","draft/2019-09","draft-07","draft-06","draft-04","draft-03"],ui=fi.map(e=>`https://json-schema.org/${e}/schema`),pi=["core","applicator","validation","meta-data","format","content"],mi=["core","applicator","unevaluated","validation","meta-data","format-annotation","format-assertion","content"],hi=[...pi.map(e=>`https://json-schema.org/draft/2019-09/vocab/${e}`),...mi.map(e=>`https://json-schema.org/draft/2020-12/vocab/${e}`)];var Hn={knownKeywords:di,schemaVersions:ui,knownVocabularies:hi};const{knownKeywords:Zn}=Hn;function Gn(e,t,n,o="keys"){if(!e.has(t))return e.set(t,n);if(e.get(t)!==n)throw new Error(`Conflicting duplicate ${o}: ${t}`)}function yi(e){return e.includes("~")?e.replace(/~[01]/g,t=>{switch(t){case"~1":return"/";case"~0":return"~"}throw new Error("Unreachable")}):e}function Qt(e,t,n){if(typeof e!="object")throw new Error("Invalid input object");if(typeof t!="string")throw new Error("Invalid JSON pointer");const o=t.split("/");if(!["","#"].includes(o.shift()))throw new Error("Invalid JSON pointer");if(o.length===0)return e;let c=e;for(const m of o){if(typeof m!="string")throw new Error("Invalid JSON pointer");n&&n.push(c);const y=yi(m);if(typeof c!="object"||!Object.prototype.hasOwnProperty.call(c,y))return;c=c[y]}return c}const Pn=/^https?:\/\//;function Fe(e,t){if(typeof e!="string"||typeof t!="string")throw new Error("Unexpected path!");if(t.length===0)return e;const n=e.replace(/#.*/,"");return t.startsWith("#")?`${n}${t}`:!n.includes("/")||Pn.test(t)?t:Pn.test(n)?`${new URL(t,n)}`:t.startsWith("/")?t:[...n.split("/").slice(0,-1),t].join("/")}function Mn(e){return e.map(n=>n&&(n.$id||n.id)||"").filter(n=>n&&typeof n=="string").reduce(Fe,"")}const Yn=["properties","patternProperties","$defs","definitions"],Qn=["const","enum","examples","example","comment"],Xn=Symbol("skip");function nn(e,t){const n=(o,c=!1)=>{if(!o||typeof o!="object")return;const m=t(o);if(m!==void 0)return m===Xn?void 0:m;for(const y of Object.keys(o)){if(!c&&!Array.isArray(o)&&!Zn.includes(y)||!c&&Qn.includes(y))continue;const S=n(o[y],!c&&Yn.includes(y));if(S!==void 0)return S}};return n(e)}function Bn(e,t,n,o=""){const c=Fe(o,n),m=[],[y,S=""]=c.split("#"),g=decodeURI(S),$=(q,H,_=!1,W=!1)=>{if(!q||typeof q!="object")return;const T=q.$id||q.id;let O=H;if(T&&typeof T=="string"){if(O=Fe(O,T),O===c||O===y&&g==="")m.push([q,e,H]);else if(O===y&&g[0]==="/"){const R=[],J=Qt(q,g,R);J!==void 0&&m.push([J,e,Fe(H,Mn(R))])}}const x=W?q.$dynamicAnchor:q.$anchor;if(x&&typeof x=="string"){if(x.includes("#"))throw new Error("$anchor can't include '#'");if(x.startsWith("/"))throw new Error("$anchor can't start with '/'");O=Fe(O,`#${x}`),O===c&&m.push([q,e,H])}for(const R of Object.keys(q))!_&&!Array.isArray(q)&&!Zn.includes(R)||!_&&Qn.includes(R)||$(q[R],O,!_&&Yn.includes(R));!W&&q.$dynamicAnchor&&$(q,H,_,!0)};if($(e,y),y===o.replace(/#$/,"")&&(g[0]==="/"||g==="")){const q=[],H=Qt(e,g,q);H!==void 0&&m.push([H,e,Mn(q)])}if(t.has(y)&&t.get(y)!==e){const q=Bn(t.get(y),t,`#${S}`,y);m.push(...q.map(([H,_,W])=>[H,_,Fe(y,W)]))}return t.has(c)&&m.push([t.get(c),t.get(c),c]),m}function gi(e){const t=new Map;return nn(e,n=>{if(n!==e&&(n.$id||n.id))return Xn;const o=n.$dynamicAnchor;if(o&&typeof o=="string"){if(o.includes("#"))throw new Error("$dynamicAnchor can't include '#'");if(!/^[a-zA-Z0-9_-]+$/.test(o))throw new Error(`Unsupported $dynamicAnchor: ${o}`);Gn(t,o,n,"$dynamicAnchor")}}),t}const wi=(e,t)=>nn(e,n=>Object.keys(n).some(o=>t.includes(o))||void 0)||!1,In=(e,t,n=!1)=>{if(!Array.isArray(t))throw new Error("Expected an array of schemas");for(const o of t)nn(o,c=>{const m=c.$id||c.id,y=m&&typeof m=="string"?m.replace(/#$/,""):null;if(y&&y.includes("://")&&!y.includes("#"))Gn(e,y,c,"schema $id in 'schemas'");else if(c===o&&!n)throw new Error("Schema with missing or invalid $id in 'schemas'")});return e},er=(e,t)=>{if(t)return In(er(e),t,!0);if(e)switch(Object.getPrototypeOf(e)){case Object.prototype:return new Map(Object.entries(e));case Map.prototype:return new Map(e);case Array.prototype:return In(new Map,e)}throw new Error("Unexpected value for 'schemas' option")};var tr={get:Qt,joinPath:Fe,resolveReference:Bn,getDynamicAnchors:gi,hasKeywords:wi,buildSchemas:er};const Xt={email:e=>{if(e.length>318)return!1;if(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,20}(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,21}){0,2}@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,60}[a-z0-9])?){0,3}$/i.test(e))return!0;if(!e.includes("@")||/(^\.|^"|\.@|\.\.)/.test(e))return!1;const[n,o,...c]=e.split("@");return!n||!o||c.length!==0||n.length>64||o.length>253||!/^[a-z0-9.-]+$/i.test(o)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(n)?!1:o.split(".").every(m=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(m))},hostname:e=>e.length>(e.endsWith(".")?254:253)?!1:/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*\.?$/i.test(e),date:e=>{if(e.length!==10)return!1;if(e[5]==="0"&&e[6]==="2"){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)$/.test(e))return!0;const t=e.match(/^(\d\d\d\d)-02-29$/);if(!t)return!1;const n=t[1]|0;return n%16===0||n%4===0&&n%25!==0}return e.endsWith("31")?/^\d\d\d\d-(?:0[13578]|1[02])-31$/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)$/.test(e)},time:e=>{if(e.length>27||!/^(?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)?$/i.test(e))return!1;if(!/:60/.test(e))return!0;const n=e.match(/([0-9.]+|[^0-9.])/g);let o=Number(n[0])*60+Number(n[2]);return n[5]==="+"?o+=24*60-Number(n[6]||0)*60-Number(n[8]||0):n[5]==="-"&&(o+=Number(n[6]||0)*60+Number(n[8]||0)),o%(24*60)===23*60+59},"date-time":e=>{if(e.length>38)return!1;const t=/^\d\d\d\d-(?:0[1-9]|1[0-2])-(?:[0-2]\d|3[01])[t\s](?:2[0-3]|[0-1]\d):[0-5]\d:(?:[0-5]\d|60)(?:\.\d+)?(?:z|[+-](?:2[0-3]|[0-1]\d)(?::?[0-5]\d)?)$/i,n=e[5]==="0"&&e[6]==="2";if(n&&e[8]==="3"||!t.test(e))return!1;if(e[17]==="6"){const o=e.slice(11).match(/([0-9.]+|[^0-9.])/g);let c=Number(o[0])*60+Number(o[2]);if(o[5]==="+"?c+=24*60-Number(o[6]||0)*60-Number(o[8]||0):o[5]==="-"&&(c+=Number(o[6]||0)*60+Number(o[8]||0)),c%(24*60)!==23*60+59)return!1}if(n){if(/^\d\d\d\d-02-(?:[012][1-8]|[12]0|[01]9)/.test(e))return!0;const o=e.match(/^(\d\d\d\d)-02-29/);if(!o)return!1;const c=o[1]|0;return c%16===0||c%4===0&&c%25!==0}return e[8]==="3"&&e[9]==="1"?/^\d\d\d\d-(?:0[13578]|1[02])-31/.test(e):/^\d\d\d\d-(?:0[13-9]|1[012])-(?:[012][1-9]|[123]0)/.test(e)},ipv4:e=>e.length<=15&&/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)$/.test(e),ipv6:e=>{if(e.length>45||e.length<2)return!1;let t=0,n=0,o=0,c=!1,m=!1,y=0,S=!0;for(let $=0;$<e.length;$++){const q=e.charCodeAt($);if($===1&&y===58&&q!==58)return!1;if(q>=48&&q<=57){if(++o>4)return!1}else if(q===46){if(t>6||n>=3||o===0||m)return!1;n++,o=0}else if(q===58){if(n>0||t>=7)return!1;if(y===58){if(c)return!1;c=!0}else $===0&&(S=!1);t++,o=0,m=!1}else if(q>=97&&q<=102||q>=65&&q<=70){if(n>0||++o>4)return!1;m=!0}else return!1;y=q}if(t<2||n>0&&(n!==3||o===0))return!1;if(c&&e.length===2)return!0;if(n>0&&!/(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}$/.test(e))return!1;const g=n>0?6:7;return c?(S||o>0)&&t<g:t===g&&S&&o>0},uri:/^[a-z][a-z0-9+\-.]*:(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/?(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?)?(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2}|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,"json-pointer":/^(?:|\/(?:[^~]|~0|~1)*)$/,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:|#|\/(?:[^~]|~0|~1)*)$/,uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e))},bi={alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"hex-digits":/^[0-9a-f]+$/i,"hex-digits-prefixed":/^0x[0-9a-f]+$/i,"hex-bytes":/^([0-9a-f][0-9a-f])+$/i,"hex-bytes-prefixed":/^0x([0-9a-f][0-9a-f])+$/i,base64:e=>e.length%4===0&&/^[a-z0-9+/]*={0,3}$/i.test(e),"json-pointer-uri-fragment":/^#(|\/(\/|[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)$/i,"host-name":Xt.hostname,"ip-address":Xt.ipv4,color:/^(#[0-9A-Fa-f]{3,6}|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\(\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s*\)|rgb\(\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*\))$/},vi={regex:e=>{if(e.length>1e5||/[^\\]\\Z/.test(e))return!1;try{return new RegExp(e,"u"),!0}catch{return!1}}};var ki={core:Xt,extra:bi,weak:vi};const pe=(e,t)=>[...new Set([...e,...t])].sort(),nr=(e,t)=>e.filter(n=>t.includes(n)),$i=e=>(...t)=>e(...t.map(xt)),rr=e=>(...t)=>xt(e(...t.map(xt))),ue=(e,t)=>e&&!e.includes(t),xt=({type:e=null,dyn:t={},...n})=>({type:e&&[...e].sort(),items:ue(e,"array")?1/0:n.items||0,properties:ue(e,"object")?[!0]:[...n.properties||[]].sort(),patterns:ue(e,"object")?[]:[...n.patterns||[]].sort(),required:ue(e,"object")?[]:[...n.required||[]].sort(),fullstring:ue(e,"string")||n.fullstring||!1,dyn:{item:ue(e,"array")?!1:t.item||!1,items:ue(e,"array")?0:Math.max(n.items||0,t.items||0),properties:ue(e,"object")?[]:pe(n.properties||[],t.properties||[]),patterns:ue(e,"object")?[]:pe(n.patterns||[],t.patterns||[])},unknown:n.unknown&&!(ue(e,"object")&&ue(e,"array"))||!1}),ji=()=>xt({}),ir=rr((e,t)=>({type:e.type&&t.type?nr(e.type,t.type):e.type||t.type||null,items:Math.max(e.items,t.items),properties:pe(e.properties,t.properties),patterns:pe(e.patterns,t.patterns),required:pe(e.required,t.required),fullstring:e.fullstring||t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:pe(e.dyn.properties,t.dyn.properties),patterns:pe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Bt=(e,t)=>t!==!0&&new RegExp(e,"u").test(t),Oi=({properties:e,patterns:t},{properties:n,patterns:o})=>{const c=e.filter(g=>n.includes(g)||n.includes(!0)||o.some($=>Bt($,g))),m=n.filter(g=>e.includes(g)||e.includes(!0)||t.some($=>Bt($,g))),y=t.filter(g=>o.includes(g)||n.includes(!0)),S=o.filter(g=>t.includes(g)||e.includes(!0));return{properties:pe(c,m),patterns:pe(y,S)}},sr=({properties:e,patterns:t},{properties:n,patterns:o})=>n.every(c=>e.includes(c)||e.includes(!0)||t.some(m=>Bt(m,c)))&&o.every(c=>t.includes(c)||e.includes(!0)),xi=rr((e,t)=>({type:e.type&&t.type?pe(e.type,t.type):null,items:Math.min(e.items,t.items),...Oi(e,t),required:ue(e.type,"object")&&t.required||ue(t.type,"object")&&e.required||nr(e.required,t.required),fullstring:e.fullstring&&t.fullstring,dyn:{item:e.dyn.item||t.dyn.item,items:Math.max(e.dyn.items,t.dyn.items),properties:pe(e.dyn.properties,t.dyn.properties),patterns:pe(e.dyn.patterns,t.dyn.patterns)},unknown:e.unknown||t.unknown})),Ei=(e,t)=>Object.assign(e,ir(e,t)),Ai=$i(({unknown:e,items:t,dyn:n,...o})=>({items:t!==1/0&&(e||n.items>t||n.item),properties:!o.properties.includes(!0)&&(e||!sr(o,n))}));var Si={initTracing:ji,andDelta:ir,orDelta:xi,applyDelta:Ei,isDynamic:Ai,inProperties:sr};const{format:k,safe:Dn,safeand:kt,safenot:Le,safenotor:$t}=St,qi=Kn,{resolveReference:et,joinPath:zn,getDynamicAnchors:Ti,hasKeywords:Rn}=tr,jt=ki,{toPointer:Jt,...Z}=tn,{scopeMethods:or}=Fn,{buildName:Vt,types:ke,jsHelpers:Pi}=Vn,{knownKeywords:Mi,schemaVersions:Et,knownVocabularies:Ii}=Hn,{initTracing:Di,andDelta:Cn,orDelta:Me,applyDelta:zi,isDynamic:$e,inProperties:Ri}=Si,Kt=new Set(["^[\\s\\S]*$","^[\\S\\s]*$","^[^]*$","",".*","^","$"]),Ht=["null","boolean","number","integer","string"],en=new Map(Object.entries({boolean:e=>typeof e=="boolean",array:e=>Array.isArray(e)&&Object.getPrototypeOf(e)===Array.prototype,object:e=>e&&Object.getPrototypeOf(e)===Object.prototype,finite:e=>Number.isFinite(e),natural:e=>Number.isInteger(e)&&e>=0,string:e=>typeof e=="string",jsonval:e=>Z.deepEqual(e,JSON.parse(JSON.stringify(e)))})),We=en.get("object"),Nn=e=>We(e)||typeof e=="boolean",Ci=e=>Z.deepEqual(e,{type:[]}),Ie=(e,t)=>Et.indexOf(e)>Et.indexOf(`https://json-schema.org/${t}/schema`),Ni=(e,t)=>{const n=`${e}`.replace(/^http:\/\//,"https://").replace(/#$/,"");return Et.includes(n)?Ie(n,t):!0},Ui=(e,t,n=!1,o=!1)=>Object.freeze({parent:e,keyname:t,inKeys:n,number:o}),Li=(e,t,n=!1)=>Object.freeze({parent:e,keyval:t,checked:n}),Zt=Symbol("evaluatedStatic"),De=Symbol("optDynamic"),tt=Symbol("optDynAnchors"),at=Symbol("optRecAnchors"),_i=e=>{if(typeof e=="boolean")return e;if(We(e)&&Object.keys(e).length===0)return!0},ze=new Set,dt=new Map,Fi=(e,t,n,o)=>{if(t){const c=t.replace(/^http:\/\//,"https://").replace(/#$/,"");n(Et.includes(c),"Unexpected schema version:",c),dt.set(e,{exclusiveRefs:Ie(c,"draft/2019-09"),contentValidation:Ie(c,"draft/2019-09"),dependentUnsupported:Ie(c,"draft/2019-09"),newItemsSyntax:!Ie(c,"draft/2020-12"),containsEvaluates:!Ie(c,"draft/2020-12"),objectContains:!Ie(c,"draft/next"),bookending:Ie(c,"draft/next")})}else n(!o,"[requireSchema] $schema is required"),dt.set(e,{})},ar=(e,t,n,o,c="")=>{const{mode:m="default",useDefaults:y=!1,removeAdditional:S=!1,includeErrors:g=!1,allErrors:$=!1,contentValidation:q,dryRun:H,lint:_=!1,allowUnusedKeywords:W=n.mode==="lax"||n.mode==="spec",allowUnreachable:T=n.mode==="lax"||n.mode==="spec",requireSchema:O=n.mode==="strong",requireValidation:x=n.mode==="strong",requireStringValidation:R=n.mode==="strong",forbidNoopValues:J=n.mode==="strong",complexityChecks:Q=n.mode==="strong",unmodifiedPrototypes:ce=!1,isJSON:te=!1,$schemaDefault:ne=null,formatAssertion:le=n.mode!=="spec"||Ni(t.$schema,"draft/2019-09"),formats:ge={},weakFormats:xe=n.mode!=="strong",extraFormats:h=!1,schemas:u,...b}=n,v={...jt.core,...xe?jt.weak:{},...h?jt.extra:{},...ge};if(Object.keys(b).length!==0)throw new Error(`Unknown options: ${Object.keys(b).join(", ")}`);if(!["strong","lax","default","spec"].includes(m))throw new Error(`Invalid mode: ${m}`);if(!g&&$)throw new Error("allErrors requires includeErrors to be enabled");if(O&&ne)throw new Error("requireSchema forbids $schemaDefault");if(m==="strong"){const oe={...{requireValidation:x,requireStringValidation:R},formatAssertion:le,complexityChecks:Q,requireSchema:O},E={weakFormats:xe,allowUnusedKeywords:W};for(const[l,ee]of Object.entries(oe))if(!ee)throw new Error(`Strong mode demands ${l}`);for(const[l,ee]of Object.entries(E))if(ee)throw new Error(`Strong mode forbids ${l}`)}const{gensym:I,getref:Y,genref:U,genformat:B}=or(o),re=se=>{const oe=[];let E=se;for(;E;)E.name||oe.unshift(E),E=E.parent||E.errorParent;if(oe.every(he=>he.keyval!==void 0))return k("%j",Jt(oe.map(he=>he.keyval)));const l=["#"],ee=()=>{const he=l.map(Z.pointerPart).join("/");return l.length=0,he};let we=null;for(const{keyname:he,keyval:mt,number:Ce}of oe)if(he){Ce||(o.pointerPart=Z.pointerPart);const Ve=Ce?he:k("pointerPart(%s)",he),C=`${ee()}/`;we=we?k("%s+%j+%s",we,C,Ve):k("%j+%s",C,Ve)}else mt&&l.push(mt);return l.length>0?k("%s+%j",we,`/${ee()}`):we},me=U(e);let ft=null;const on=(...se)=>{const oe=ft(...se);return on.errors=ft.errors,oe};o[me]=on;const lr=Rn(e,["$ref","$recursiveRef","$dynamicRef"]),qt=n[tt]&&lr&&Rn(e,["$dynamicAnchor"]),dr=()=>n[tt]?k(qt?", dynAnchors = []":", dynAnchors"):k(""),fr=n[at]?k(", recursive"):k(""),f=qi();f.write("function validate(data%s%s) {",fr,dr()),g&&f.write("validate.errors = null"),$&&f.write("let errorCount = 0"),n[De]&&f.write("validate.evaluatedDynamic = null");let an=n[tt]?k(", dynAnchors"):k("");qt&&(f.write("const dynLocal = [{}]"),an=k(", [...dynAnchors, dynLocal[0] || []]"));const ur=Pi(f,o,Ui,{unmodifiedPrototypes:ce,isJSON:te},Kt),{present:je,forObjectKeys:ut,forArray:Tt,patternTest:pr,compare:Pt}=ur,Re=[],ie=()=>dt.get(t),Je=c?[c]:[],Mt=(se,oe,E,l,ee,we={},{constProp:he}={})=>{const mt=oe.length>0&&oe[oe.length-1].prop===E,Ce=()=>oe.filter(r=>r.prop===E),Ve=!E.parent||E.checked||E.inKeys&&te||Ce().length>0,C=Vt(E),Ne=(...r)=>Li(E,...r),Ee=({path:r=[],prop:s=E,source:a,suberr:d})=>{const i=Jt([...ee,...r]),p=g?re(s):null;if(g===!0&&se&&a){o.errorMerge=Z.errorMerge;const w=[a,i,p];$?(f.write("if (validate.errors === null) validate.errors = []"),f.write("validate.errors.push(...%s.map(e => errorMerge(e, %j, %s)))",...w)):f.write("validate.errors = [errorMerge(%s[0], %j, %s)]",...w)}else if(g===!0&&se){const w=k("{ keywordLocation: %j, instanceLocation: %s }",i,p);$?(f.write("if (%s === null) %s = []",se,se),f.write("%s.push(%s)",se,w)):f.write("%s = [%s]",se,w)}d&&vn(d),$?f.write("errorCount++"):f.write("return false")},de=(r,s)=>f.if(r,()=>Ee(s));_&&!o.lintErrors&&(o.lintErrors=[]);const Oe=(r,s)=>{const a=s!==void 0?` ${JSON.stringify(s)}`:"",d=zn(c,Jt(ee)),i=`${r}${a} at ${d}`;if(_)return o.lintErrors.push({message:i,keywordLocation:d,schema:e});throw new Error(i)},Dt=(r,s)=>{try{return pr(r,s)}catch(a){return Oe(a.message),k("false")}},P=(r,...s)=>r||Oe(...s),nt=(r,...s)=>P(m==="lax"||m==="spec"||r,...s),Ae=(r,s)=>nt(!(l[s]<l[r]),`Invalid ${r} / ${s} combination`),Se=(r,s="should be specified")=>P(!x,`[requireValidation] ${r} ${s}`),X=(...r)=>[...ee,...r],Ke=r=>P(!S&&!y,`[removeAdditional/useDefaults] uncertain: ${r}`),cn=(r,s)=>P(!Q,`[complexityChecks] ${r}`,s),ln=r=>Fi(t,r||ne,P,O),M=Di(),L=r=>zi(M,r);if(typeof l=="boolean")return l===!0?(Se("schema = true","is not allowed"),{stat:M}):(de(Ve||E.inKeys?!0:je(E),{}),L({type:[]}),{stat:M});P(We(l),"Schema is not an object");for(const r of Object.keys(l))P(Mi.includes(r)||W,"Keyword not supported:",r);if(Object.keys(l).length===0)return Se("empty rules node","is not allowed"),{stat:M};const qe=new Set(Object.keys(l)),dn=new Set,Te=(r,...s)=>{P(dn.has(r)||qe.has(r),"Unexpected double consumption:",r),P(Z.hasOwn(l,r),"Is not an own property:",r),P(s.every(a=>en.has(a)),"Invalid type used in consume"),P(s.some(a=>en.get(a)(l[r])),"Unexpected type for",r),qe.delete(r)},fn=(r,...s)=>(l[r]!==void 0&&Te(r,...s),l[r]),j=(r,s,a,d={})=>{if(l[r]===void 0)return!1;if(Te(r,...s),a!==null)try{const i=a(l[r]);i!==null&&de(i,{path:[r],...d})}catch(i){if(_&&!i.message.startsWith("[opt] "))Oe(i.message);else throw i}return!0};if(l===t?(ln(fn("$schema","string")),j("$vocabulary",["object"],r=>{for(const[s,a]of Object.entries(r))a!==!1&&P(a===!0&&Ii.includes(s),"Unknown vocabulary:",s);return null})):ie()||ln(t.$schema),ie().objectContains)for(const r of["contains","minContains","maxContains"])dn.add(r);j("examples",["array"],null),j("example",["jsonval"],null);for(const r of["title","description","$comment"])j(r,["string"],null);for(const r of["deprecated","readOnly","writeOnly"])j(r,["boolean"],null);j("$defs",["object"],null)||j("definitions",["object"],null);const rt=(r,s,a)=>r===e?Dn("validate"):Y(r)||ar(r,s,n,o,a),Pe=()=>Je.length>0?Je[Je.length-1]:"",mr=Je.length,un=r=>(Je.push(zn(Pe(),r)),null);(!ie().exclusiveRefs||!l.$ref)&&(j("$id",["string"],un)||j("id",["string"],un),j("$anchor",["string"],null),j("$dynamicAnchor",["string"],null),(l.$recursiveAnchor||!J)&&j("$recursiveAnchor",["boolean"],r=>(r&&Re.push([l,t,Pe()]),null)));const pn=qt&&(l===e||l.id||l.$id);if(pn){const r=Ti(l);l!==e&&f.write("dynLocal.unshift({})");for(const[s,a]of r){const d=et(t,u,`#${s}`,Pe()),[i,p,w]=d[0]||[];P(i===a,`Unexpected $dynamicAnchor resolution: ${s}`);const A=rt(i,p,w);f.write("dynLocal[0][%j] = %s",`#${s}`,A)}}const zt=r=>n[De]&&(l[r]||l[r]===!1||l===e),fe=Object.freeze({item:zt("unevaluatedItems")?I("evaluatedItem"):null,items:zt("unevaluatedItems")?I("evaluatedItems"):null,props:zt("unevaluatedProperties")?I("evaluatedProps"):null}),K=Object.freeze({item:fe.item||we.item,items:fe.items||we.items,props:fe.props||we.props}),mn=()=>(!K.items||M.items===1/0)&&(!K.props||M.properties.includes(!0)),be=r=>{if(K.item&&r.item&&M.items!==1/0&&f.write("%s.push(%s)",K.item,r.item),K.items&&r.items>M.items&&f.write("%s.push(%d)",K.items,r.items),K.props&&(r.properties||[]).includes(!0)&&!M.properties.includes(!0))f.write("%s[0].push(true)",K.props);else if(K.props){const s=(i,p)=>Ri(M,{properties:i,patterns:p}),a=(r.properties||[]).filter(i=>!s([i],[])),d=(r.patterns||[]).filter(i=>!s([],[i]));a.length>0&&f.write("%s[0].push(...%j)",K.props,a),d.length>0&&f.write("%s[1].push(...%j)",K.props,d);for(const i of r.propertiesVars||[])f.write("%s[0].push(%s)",K.props,i)}},hn=(r,s,a,d)=>{$e(M).items&&r.item&&s&&f.write("%s.push(...%s)",r.item,s),$e(M).items&&r.items&&a&&f.write("%s.push(...%s)",r.items,a),$e(M).properties&&r.props&&d&&(f.write("%s[0].push(...%s[0])",r.props,d),f.write("%s[1].push(...%s[1])",r.props,d))},hr=()=>n[at]?Re.length===0?k(", recursive"):k(", recursive || %s",rt(...Re[0])):k(""),ht=(r,s)=>{const a=o[r]&&o[r][Zt]||{unknown:!0};L(a);const d=k("%s(%s%s%s)",r,C,hr(),an);if(!g&&mn())return k("!%s",d);const i=I("res"),p=I("err"),w=I("suberr");return g&&f.write("const %s = validate.errors",p),f.write("const %s = %s",i,d),g&&f.write("const %s = %s.errors",w,r),g&&f.write("validate.errors = %s",p),de(Le(i),{...s,source:w}),f.if(i,()=>{const A=$e(a).items?k("%s.evaluatedDynamic[0]",r):null,z=$e(a).items?k("%s.evaluatedDynamic[1]",r):null,N=$e(a).properties?k("%s.evaluatedDynamic[2]",r):null;hn(K,A,z,N)}),null},yn=(r,s)=>r&&r.every(a=>s.includes(a)),gn=(r,s)=>s.some(a=>r===null||r.includes(a)),wn=(...r)=>Ce().some(s=>yn(s.stat.type,r)),yr=(...r)=>yn(M.type,r)||wn(...r),He=(...r)=>gn(M.type,r)&&Ce().every(s=>gn(s.stat.type,r)),Rt=(r,s=l)=>{P(typeof r=="string","Invalid pattern:",r),(x||R)&&P(/^\^.*\$$/.test(r),"Should start with ^ and end with $:",r),/([{+*].*[{+*]|\)[{+*]|^[^^].*[{+*].)/.test(r)&&s.maxLength===void 0&&cn("maxLength should be specified for pattern:",r)},gr=l.pattern&&!Kt.has(l.pattern),wr=l.uniqueItems||gr||l.patternProperties||l.format,yt=$&&wr?I("prev"):null,gt=(r,s)=>f.if(r&&yt!==null?k("errorCount === %s",yt):!0,s),bn=()=>[...oe,{stat:M,prop:E}],ae=(...r)=>Mt(se,bn(),...r).stat,Ue=(r,...s)=>{if(s[0]===E){const i=_i(s[1]);if(i===!0)return{sub:k("true"),delta:{}};if(i===!1)return{sub:k("false"),delta:{type:[]}}}const a=I("sub");f.write("const %s = (() => {",a),$&&f.write("let errorCount = 0");const{stat:d}=Mt(r,bn(),...s);return $?f.write("return errorCount === 0"):f.write("return true"),f.write("})()"),{sub:a,delta:d}},Ct=()=>{const r=g&&$?I("suberr"):null;return r&&f.write("let %s = null",r),r},vn=r=>{se===null||r===null||f.if(r,()=>f.write("%s.push(...%s)",se,r))},kn=()=>{if(!S)return!1;if(S===!0)return!0;if(S==="keyword")return l.removeAdditional?(Te("removeAdditional","boolean"),!0):!1;throw new Error(`Invalid removeAdditional: ${S}`)},wt=(r,s,a)=>{j(r,["object","boolean"],i=>i===!1&&kn()?(f.write("if (%s.length > %s) %s.length = %s",C,s,C,s),null):i===!1&&!a?k("%s.length > %s",C,s):(Tt(E,s,(p,w)=>(a&&f.write("if (%s) continue",a(w)),ae(p,i,X(r)))),null))&&L({items:1/0})},Nt=(r,s)=>{j(r,["object","boolean"],d=>(ut(E,(i,p)=>{f.if(s(p),()=>{d===!1&&kn()?f.write("delete %s[%s]",C,p):ae(i,d,X(r))})}),null))&&L({properties:[!0]})},$n=(r,s,a)=>kt(...s.map(d=>k("%s !== %j",r,d)),...a.map(d=>Le(Dt(d,r)))),jn=(r,s)=>{const a=s.map(i=>new RegExp(i,"u")),d=i=>r.includes(i)||a.some(p=>p.test(i));for(const i of M.required)P(d(i),"Unknown required property:",i)},On=[],br=()=>{const r=(a,d)=>k("!(%d %c %s)",a,d,C);Number.isFinite(l.exclusiveMinimum)?j("exclusiveMinimum",["finite"],a=>r(a,"<")):(j("minimum",["finite"],a=>r(a,l.exclusiveMinimum?"<":"<=")),j("exclusiveMinimum",["boolean"],null)),Number.isFinite(l.exclusiveMaximum)?(j("exclusiveMaximum",["finite"],a=>r(a,">")),Ae("minimum","exclusiveMaximum"),Ae("exclusiveMinimum","exclusiveMaximum")):l.maximum!==void 0&&(j("maximum",["finite"],a=>r(a,l.exclusiveMaximum?">":">=")),j("exclusiveMaximum",["boolean"],null),Ae("minimum","maximum"),Ae("exclusiveMinimum","maximum"));const s=l.multipleOf===void 0?"divisibleBy":"multipleOf";j(s,["finite"],a=>{P(a>0,`Invalid ${s}:`,a);const[d,i]=`${a}`.split("e-"),w=`${d}.`.split(".")[1].length+(i?Number(i):0);if(Number.isInteger(a*2**w))return k("%s %% %d !== 0",C,a);o.isMultipleOf=Z.isMultipleOf;const A=[C,a,w,Math.round(a*Math.pow(10,w))];return k("!isMultipleOf(%s, %d, 1e%d, %d)",...A)})},vr=()=>{j("maxLength",["natural"],r=>(o.stringLength=Z.stringLength,k("%s.length > %d && stringLength(%s) > %d",C,r,C,r))),j("minLength",["natural"],r=>(o.stringLength=Z.stringLength,k("%s.length < %d || stringLength(%s) < %d",C,r,C,r))),Ae("minLength","maxLength"),gt(!0,()=>{const r=(i,p,w=v)=>{const A=typeof i=="string"&&Z.hasOwn(w,i);P(A,"Unrecognized format used:",i);const z=w[i],N=z instanceof RegExp||typeof z=="function";return P(N,"Invalid format used:",i),le?z instanceof RegExp?(Z.hasOwn(ge,i)&&Rt(z.source),k("!%s.test(%s)",B(z),p)):k("!%s(%s)",B(z),p):null};j("format",["string"],i=>(L({fullstring:!0}),r(i,C))),j("pattern",["string"],i=>(Rt(i),L({fullstring:!0}),Kt.has(i)?null:Le(Dt(i,C)))),P(l.contentSchema!==!1,"contentSchema cannot be set to false");const s=q===void 0?ie().contentValidation:q,a=l.contentEncoding||l.contentMediaType||l.contentSchema;if(P(!a||s||W,'"content*" keywords are disabled by default per spec, enable with { contentValidation = true } option (see doc/Options.md for more info)'),a&&s){const i=I("dec");l.contentMediaType&&f.write("let %s = %s",i,C),l.contentEncoding==="base64"?(de(r("base64",C,jt.extra),{path:["contentEncoding"]}),l.contentMediaType&&(o.deBase64=Z.deBase64,f.write("try {"),f.write("%s = deBase64(%s)",i,i)),Te("contentEncoding","string")):P(!l.contentEncoding,"Unknown contentEncoding:",l.contentEncoding);let p=!1;if(l.contentMediaType==="application/json"?(f.write("try {"),f.write("%s = JSON.parse(%s)",i,i),p=!0,Te("contentMediaType","string")):P(!l.contentMediaType,"Unknown contentMediaType:",l.contentMediaType),l.contentSchema){P(p,"contentSchema requires contentMediaType application/json");const w=Object.freeze({name:i,errorParent:E});ae(w,l.contentSchema,X("contentSchema")),Te("contentSchema","object","array"),L({fullstring:!0})}l.contentMediaType&&(f.write("} catch (e) {"),Ee({path:["contentMediaType"]}),f.write("}"),l.contentEncoding&&(f.write("} catch (e) {"),Ee({path:["contentEncoding"]}),f.write("}")))}})},kr=()=>{j("maxItems",["natural"],i=>{const p=ie().newItemsSyntax?"prefixItems":"items";return Array.isArray(l[p])&&l[p].length>i&&Oe(`Invalid maxItems: ${i} is less than ${p} array length`),k("%s.length > %d",C,i)}),j("minItems",["natural"],i=>k("%s.length < %d",C,i)),Ae("minItems","maxItems");const r=i=>{for(let p=0;p<i.length;p++)ae(Ne(p),i[p],X(`${p}`));return L({items:i.length}),null};ie().newItemsSyntax?(j("prefixItems",["array"],r),wt("items",k("%d",(l.prefixItems||[]).length))):Array.isArray(l.items)?(j("items",["array"],r),wt("additionalItems",k("%d",l.items.length))):j("items",["object","boolean"],i=>(Tt(E,k("0"),p=>ae(p,i,X("items"))),L({items:1/0}),null)),xn(i=>{Tt(E,k("0"),(p,w)=>{i(p,()=>{L({dyn:{item:!0}}),be({item:w})})})});const s=i=>{if(!We(i))return!1;if(i.enum||Z.hasOwn(i,"const")||i.type&&(Array.isArray(i.type)?i.type:[i.type]).every(w=>Ht.includes(w)))return!0;if(i.$ref){const[p]=et(t,u,i.$ref,Pe())[0]||[];if(s(p))return!0}return!1},a=i=>i===!1||s(i),d=()=>!!(l.maxItems!==void 0||a(l.items)||Array.isArray(l.items)&&a(l.additionalItems));gt(!0,()=>{j("uniqueItems",["boolean"],i=>i===!1?null:(d()||cn("maxItems should be specified for non-primitive uniqueItems"),Object.assign(o,{unique:Z.unique,deepEqual:Z.deepEqual}),k("!unique(%s)",C)))})},Ze=r=>!$&&(M.required.includes(r)||Ce().some(s=>s.stat.required.includes(r))),$r=()=>{const r=k("Object.keys(%s).length",C);j("maxProperties",["natural"],s=>k("%s > %d",r,s)),j("minProperties",["natural"],s=>k("%s < %d",r,s)),Ae("minProperties","maxProperties"),j("propertyNames",["object","boolean"],s=>(ut(E,(a,d)=>{const i=typeof s=="object"&&!s.$ref?{type:"string",...s}:s,p=Object.freeze({name:d,errorParent:a,type:"string"});ae(p,i,X("propertyNames"))}),null)),j("required",["array"],s=>{for(const a of s){if(Ze(a))continue;const d=Ne(a);de(Le(je(d)),{path:["required"],prop:d})}return L({required:s}),null});for(const s of["dependencies","dependentRequired","dependentSchemas"])s!=="dependencies"&&ie().dependentUnsupported||j(s,["object"],a=>{for(const d of Object.keys(a)){const i=typeof a[d]=="string"?[a[d]]:a[d],p=Ne(d,Ze(d));if(Array.isArray(i)&&s!=="dependentSchemas"){const w=i.filter(N=>!Ze(N)).map(N=>je(Ne(N))),A=Le(kt(...w)),z={path:[s,d]};w.length===0||(p.checked?(de(A,z),L({required:i})):de(kt(je(p),A),z))}else Nn(i)&&s!=="dependentRequired"?(Ke(s),f.if(p.checked?!0:je(p),()=>{const w=ae(E,i,X(s,d),K);L(Me({},w)),be(w)})):Oe(`Unexpected ${s} entry`)}return null});j("propertyDependencies",["object"],s=>{for(const[a,d]of Object.entries(s)){P(We(d),"propertyDependencies must be an object"),Ke("propertyDependencies");const i=Ne(a,Ze(a));f.if(i.checked?!0:je(i),()=>{for(const[p,w]of Object.entries(d))P(Nn(w),"propertyDependencies must contain schemas"),f.if(Pt(Vt(i),p),()=>{const A=ae(E,w,X("propertyDependencies",a,p),K);L(Me({},A)),be(A)})})}return null}),j("properties",["object"],s=>{for(const a of Object.keys(s))he!==a&&ae(Ne(a,Ze(a)),s[a],X("properties",a));return L({properties:Object.keys(s)}),null}),gt(l.patternProperties,()=>{if(j("patternProperties",["object"],s=>(ut(E,(a,d)=>{for(const i of Object.keys(s))Rt(i,l.propertyNames||{}),f.if(Dt(i,d),()=>{ae(a,s[i],X("patternProperties",i))})}),L({patterns:Object.keys(s)}),null)),l.additionalProperties||l.additionalProperties===!1){const s=Object.keys(l.properties||{}),a=Object.keys(l.patternProperties||{});l.additionalProperties===!1&&On.push(()=>jn(s,a)),Nt("additionalProperties",i=>$n(i,s,a))}}),ie().objectContains&&xn(s=>{ut(E,(a,d)=>{s(a,()=>{L({dyn:{properties:[!0]}}),be({propertiesVars:[d]})})})})},jr=()=>{const r=j("const",["jsonval"],a=>Le(Pt(C,a)));if(r&&!W)return!0;const s=j("enum",["array"],a=>{const d=a.filter(p=>p&&typeof p=="object"),i=a.filter(p=>!(p&&typeof p=="object"));return $t(...[...i,...d].map(p=>Pt(C,p)))});return r||s},xn=r=>{j("contains",["object","boolean"],()=>{Ke("contains"),ie().objectContains&&He("array")&&He("object")&&Se("possible type confusion in 'contains',","forbid 'object' or 'array'");const s=I("passes");f.write("let %s = 0",s);const a=Ct();return r((d,i)=>{const{sub:p}=Ue(a,d,l.contains,X("contains"));f.if(p,()=>{f.write("%s++",s),ie().containsEvaluates&&(P(!S,`Can't use removeAdditional with draft2020+ "contains"`),i())})}),j("minContains",["natural"],d=>k("%s < %d",s,d),{suberr:a})||de(k("%s < 1",s),{path:["contains"],suberr:a}),j("maxContains",["natural"],d=>k("%s > %d",s,d)),Ae("minContains","maxContains"),null})},Or=()=>{j("not",["object","boolean"],i=>Ue(null,E,i,X("not")).sub),l.not&&Ke("not"),(l.then||l.then===!1||l.else||l.else===!1||W)&&j("if",["object","boolean"],i=>{Ke("if/then/else");const{sub:p,delta:w}=Ue(null,E,i,X("if"),K);let A,z,N,F;return j("else",["object","boolean"],V=>(A=()=>{N=ae(E,V,X("else"),K),be(N)},null)),j("then",["object","boolean"],V=>(z=()=>{F=ae(E,V,X("then"),K),be(Cn(w,F))},null)),!z&&!Ci(w)&&(z=()=>be(w)),f.if(p,z,A),L(Me(N||{},Cn(w,F||{}))),null});const s=(i,p="allOf")=>{P(i.length>0,`${p} cannot be empty`);for(const[w,A]of Object.entries(i))L(ae(E,A,X(p,w),K));return null};j("allOf",["array"],i=>s(i));let a=null;j("discriminator",["object"],i=>{const p=new Set,w=(G,Ye,Qe)=>P(G,`[discriminator]: ${Ye}`,Qe),{propertyName:A,mapping:z,...N}=i,F=Ne(A);w(A&&!l.oneOf!=!l.anyOf,"need propertyName, oneOf OR anyOf"),w(Object.keys(N).length===0,'only "propertyName" and "mapping" are supported');const V=G=>We(G)?Object.keys(G).length:null;return a=(G,Ye)=>{const Qe=()=>{f.write("switch (%s) {",Vt(F));let Xe;for(const[Ar,Be]of Object.entries(G)){const{const:Ut,enum:Sn,...Sr}=(Be.properties||{})[A]||{};let st=Ut!==void 0?[Ut]:Sn;if(!st&&Be.$ref){const[ve]=et(t,u,Be.$ref,Pe())[0]||[];P(We(ve),"failed to resolve $ref:",Be.$ref);const ot=(ve.properties||{})[A]||{};st=ot.const!==void 0?[ot.const]:ot.enum}const qr=Array.isArray(st)&&st.length>0;w(qr,"branches should have unique string const or enum values for [propertyName]");const Tr=Object.keys(Sr).length===0&&(!Ut||!Sn);w(Tr,"only const OR enum rules are allowed on [propertyName] in branches");for(const ve of st){const ot=!z||Z.hasOwn(z,ve)&&z[ve]===Be.$ref;w(ot,"mismatching mapping for",ve);const Pr=typeof ve=="string"&&!p.has(ve);w(Pr,"const/enum values for [propertyName] should be unique strings"),p.add(ve),f.write("case %j:",ve)}const Lt=ae(E,Be,X(Ye,Ar),K,{constProp:A});be(Lt),Xe=Xe?Me(Xe,Lt):Lt,f.write("break")}w(z===void 0||V(z)===p.size,"mismatching mapping size"),L(Xe),f.write("default:"),Ee({path:[Ye]}),f.write("}")},it=()=>{if(Ze(A))Qe();else{const Xe=["discriminator","propertyName"];f.if(je(F),Qe,()=>Ee({path:Xe,prop:F}))}};return $||!Z.deepEqual(M.type,["object"])?f.if(ke.get("object")(C),it,()=>Ee({path:["discriminator"]})):it(),w(Z.deepEqual(M.type,["object"]),"has to be checked for type:","object"),w(M.required.includes(A),"propertyName should be placed in required:",A),null},null});const d=(i,p)=>{const w=p.map(N=>N.type||(Array.isArray(N.const)?"array":typeof N.const)),A=w.filter(N=>!Ht.includes(N)&&N!=="array").length,z=w.filter(N=>!Ht.includes(N)&&N!=="object").length;(A>1||z>1)&&Ke(`${i}, use discriminator to make it certain`)};j("anyOf",["array"],i=>{if(P(i.length>0,"anyOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"anyOf");const p=Ct();if(!mn()){d("anyOf",i);const F=Object.entries(i).map(([V,G])=>Ue(p,E,G,X("anyOf",V),K));L(F.map(V=>V.delta).reduce((V,G)=>Me(V,G))),de($t(...F.map(({sub:V})=>V)),{path:["anyOf"],suberr:p});for(const{delta:V,sub:G}of F)f.if(G,()=>be(V));return null}const w=i.filter(F=>Z.hasOwn(F,"const")),A=i.filter(F=>!Z.hasOwn(F,"const"));d("anyOf",A);const z=[...w,...A];let N;if(ie().exclusiveRefs){let F=()=>Ee({path:["anyOf"],suberr:p});for(const[V,G]of Object.entries(z).reverse()){const Ye=F;F=()=>{const{sub:Qe,delta:it}=Ue(p,E,G,X("anyOf",V));f.if(Le(Qe),Ye),N=N?Me(N,it):it}}F()}else{const F=Object.entries(i).map(([V,G])=>Ue(p,E,G,X("anyOf",V),K));N=F.map(V=>V.delta).reduce((V,G)=>Me(V,G)),de($t(...F.map(({sub:V})=>V)),{path:["anyOf"],suberr:p})}return L(N),null}),j("oneOf",["array"],i=>{if(P(i.length>0,"oneOf cannot be empty"),i.length===1)return s(i);if(a)return a(i,"oneOf");d("oneOf",i);const p=I("passes");f.write("let %s = 0",p);const w=Ct();let A,z=0;const N=Object.entries(i).map(([F,V])=>{!g&&z++>1&&de(k("%s > 1",p),{path:["oneOf"]});const G=Ue(w,E,V,X("oneOf",F),K);return f.if(G.sub,()=>f.write("%s++",p)),A=A?Me(A,G.delta):G.delta,G});L(A),de(k("%s !== 1",p),{path:["oneOf"]}),f.if(k("%s === 0",p),()=>vn(w));for(const F of N)f.if(F.sub,()=>be(F.delta));return null})},Ge=(r,s,a)=>{const[d,i]=[f.size(),qe.size];f.if(yr(...s)?!0:a,r),(d!==f.size()||i!==qe.size)&&P(He(...s),"Unexpected rules in type",l.type)},xr=()=>{if(M.items===1/0)l.unevaluatedItems===!1&&Te("unevaluatedItems","boolean");else if(l.unevaluatedItems||l.unevaluatedItems===!1)if($e(M).items){if(!n[De])throw new Error("[opt] Dynamic unevaluated tracing not enabled");const r=k("Math.max(%d, ...%s)",M.items,K.items),s=a=>k("%s.includes(%s)",K.item,a);wt("unevaluatedItems",r,ie().containsEvaluates?s:null)}else wt("unevaluatedItems",k("%d",M.items))},Er=()=>{gt(M.patterns.length>0||M.dyn.patterns.length>0||M.unknown,()=>{if(M.properties.includes(!0))l.unevaluatedProperties===!1&&Te("unevaluatedProperties","boolean");else if(l.unevaluatedProperties||l.unevaluatedProperties===!1){const r=s=>$n(s,M.properties,M.patterns);if($e(M).properties){if(!n[De])throw new Error("[opt] Dynamic unevaluated tracing not enabled");o.propertyIn=Z.propertyIn;const s=d=>k("!propertyIn(%s, %s)",d,K.props);Nt("unevaluatedProperties",d=>kt(r(d),s(d)))}else l.unevaluatedProperties===!1&&jn(M.properties,M.patterns),Nt("unevaluatedProperties",r)}})},En=()=>{if(yt!==null&&f.write("const %s = errorCount",yt),jr()){const r=[...ke.keys()];if(L({properties:[!0],items:1/0,type:r,fullstring:!0}),!W){P(qe.size===0,"Unexpected keywords mixed with const or enum:",[...qe]);return}}Ge(br,["number","integer"],ke.get("number")(C)),Ge(vr,["string"],ke.get("string")(C)),Ge(kr,["array"],ke.get("array")(C)),Ge($r,["object"],ke.get("object")(C)),Or(),Ge(xr,["array"],ke.get("array")(C)),Ge(Er,["object"],ke.get("object")(C));for(const r of On)r();hn(we,fe.item,fe.items,fe.props)},An=()=>{if(fe.item&&f.write("const %s = []",fe.item),fe.items&&f.write("const %s = [0]",fe.items),fe.props&&f.write("const %s = [[], []]",fe.props),j("$ref",["string"],s=>{const a=et(t,u,s,Pe()),[d,i,p]=a[0]||[];if(!d&&d!==!1&&(Oe("failed to resolve $ref:",s),_))return null;const w=rt(d,i,p),A=d===e?me:w;if(!o[A])throw new Error("Unexpected: coherence check failed");if(!o[A][Zt]&&d.type){const z=Array.isArray(d.type)?d.type:[d.type];L({type:z}),x&&(ze.add(A),z.includes("array")&&L({items:1/0}),z.includes("object")&&L({properties:[!0]})),R&&z.includes("string")&&(ze.add(A),L({fullstring:!0}))}return ht(w,{path:["$ref"]})}),ie().exclusiveRefs&&(P(!n[De],"unevaluated* is supported only on draft2019-09 and above"),l.$ref))return;j("$recursiveRef",["string"],s=>{if(!n[at])throw new Error("[opt] Recursive anchors are not enabled");P(s==="#",'Behavior of $recursiveRef is defined only for "#"');const a=et(t,u,"#",Pe()),[d,i,p]=a[0];nt(d.$recursiveAnchor,"$recursiveRef without $recursiveAnchor");const w=rt(d,i,p),A=d.$recursiveAnchor?k("(recursive || %s)",w):w;return ht(A,{path:["$recursiveRef"]})}),j("$dynamicRef",["string"],s=>{if(!n[tt])throw new Error("[opt] Dynamic anchors are not enabled");nt(/^[^#]*#[a-zA-Z0-9_-]+$/.test(s),"Unsupported $dynamicRef format");const a=s.replace(/^[^#]+/,""),d=et(t,u,s,Pe());if(!d[0]&&!ie().bookending){nt(!1,"$dynamicRef bookending resolution failed (even though not required)"),o.dynamicResolve=Z.dynamicResolve;const F=k("dynamicResolve(dynAnchors || [], %j)",a);return ht(F,{path:["$dynamicRef"]})}P(d[0],"$dynamicRef bookending resolution failed",s);const[i,p,w]=d[0],A=i.$dynamicAnchor&&`#${i.$dynamicAnchor}`===a;nt(A,"$dynamicRef without $dynamicAnchor in the same scope");const z=rt(i,p,w);o.dynamicResolve=Z.dynamicResolve;const N=A?k("(dynamicResolve(dynAnchors || [], %j) || %s)",a,z):z;return ht(N,{path:["$dynamicRef"]})});let r=null;j("type",["string","array"],s=>{const a=Array.isArray(s)?s:[s];for(const i of a)P(typeof i=="string"&&ke.has(i),"Unknown type:",i);if(E.type)return P(Z.deepEqual(a,[E.type]),"One type allowed:",E.type),L({type:[E.type]}),null;if(wn(...a))return null;const d=a.filter(i=>He(i));return d.length===0&&Oe("No valid types possible"),L({type:a}),r=$t(...d.map(i=>ke.get(i)(C))),null}),r&&$?f.if(r,()=>Ee({path:["type"]}),En):(r&&de(r,{path:["type"]}),En()),M.items<1/0&&l.maxItems<=M.items&&L({items:1/0})};if(l.default!==void 0&&y){Ve&&Oe("Can not apply default value here (e.g. at root)");const r=fn("default","jsonval");f.if(je(E),An,()=>f.write("%s = %j",C,r))}else j("default",["jsonval"],null),f.if(Ve?!0:je(E),An);if(Je.length=mr,Re[0]&&Re[Re.length-1][0]===l&&Re.pop(),pn&&l!==e&&f.write("dynLocal.shift()"),T||P(!f.optimizedOut,"some checks are never reachable"),mt){const r=["not","if","then","else"].includes(ee[ee.length-1]),s=["oneOf","anyOf","allOf"].includes(ee[ee.length-2]),a=["dependencies","dependentSchemas"].includes(ee[ee.length-2]),d=["propertyDependencies"].includes(ee[ee.length-3]);P(r||s||a||d,"Unexpected logical path")}else if(!ee.includes("not")&&((!(e!==t&&l===e)||ze.has(me))&&(ze.delete(me),M.type||Se("type"),He("array")&&M.items!==1/0&&Se(l.items?"additionalItems or unevaluatedItems":"items rule"),He("object")&&!M.properties.includes(!0)&&Se("additionalProperties or unevaluatedProperties"),!M.fullstring&&R&&Oe("[requireStringValidation] pattern, format or contentSchema should be specified for strings, use pattern: ^[\\s\\S]*$ to opt-out")),typeof l.propertyNames!="object"))for(const s of["additionalProperties","unevaluatedProperties"])l[s]&&Se(`wild-card ${s}`,"requires propertyNames");return l.properties&&!l.required&&Se("if properties is used, required"),P(qe.size===0||W,"Unprocessed keywords:",[...qe]),{stat:M,local:fe}},{stat:It,local:pt}=Mt(k("validate.errors"),[],{name:Dn("data")},e,[]);if(ze.has(me))throw new Error("Unexpected: unvalidated cyclic ref");if(n[De]&&($e(It).items||$e(It).properties)){if(!pt)throw new Error("Failed to trace dynamic properties");f.write("validate.evaluatedDynamic = [%s, %s, %s]",pt.item,pt.items,pt.props)}return $?f.write("return errorCount === 0"):f.write("return true"),f.write("}"),_||(ft=f.makeFunction(o),delete o[me],o[me]=ft),o[me][Zt]=It,me},Ot=(e,t)=>{if(!Array.isArray(e))throw new Error("Expected an array of schemas");try{const n=Object.create(null),{getref:o}=or(n);ze.clear(),dt.clear();const c=e.map(m=>o(m)||ar(m,m,t,n));if(ze.size!==0)throw new Error("Unexpected: not all refs are validated");return{scope:n,refs:c}}catch(n){if(!t[De]&&n.message==="[opt] Dynamic unevaluated tracing not enabled")return Ot(e,{...t,[De]:!0});if(!t[tt]&&n.message==="[opt] Dynamic anchors are not enabled")return Ot(e,{...t,[tt]:!0});if(!t[at]&&n.message==="[opt] Recursive anchors are not enabled")return Ot(e,{...t,[at]:!0});throw n}finally{ze.clear(),dt.clear()}};var Wi={compile:Ot};const Ji=Kn,{buildSchemas:Vi}=tr,{compile:Ki}=Wi,{deepEqual:rn}=tn,Hi=e=>function t(n){if(!rn(n,JSON.parse(JSON.stringify(n))))return t.errors=[{instanceLocation:"#",error:"not JSON compatible"}],!1;const o=e(n);return t.errors=e.errors,o},Zi=e=>t=>rn(t,JSON.parse(JSON.stringify(t)))&&e(t),sn=(e,{parse:t=!1,multi:n=!1,jsonCheck:o=!1,isJSON:c=!1,schemas:m=[],...y}={})=>{if(o&&c)throw new Error("Can not specify both isJSON and jsonCheck options");if(t&&(o||c))throw new Error("jsonCheck and isJSON options are not applicable in parser mode");const S=t?"strong":"default",g=c||o||t,$=n?e:[e],q={mode:S,...y,schemas:Vi(m,$),isJSON:g},{scope:H,refs:_}=Ki($,q);if(y.dryRun)return;if(y.lint)return H.lintErrors;const W=Ji();if(t?H.parseWrap=y.includeErrors?Gi:Yi:o&&(H.deepEqual=rn,H.jsonCheckWrap=y.includeErrors?Hi:Zi),n){W.write("[");for(const O of _.slice(0,-1))W.write("%s,",O);_.length>0&&W.write("%s",_[_.length-1]),W.write("]"),t?W.write(".map(parseWrap)"):o&&W.write(".map(jsonCheckWrap)")}else t?W.write("parseWrap(%s)",_[0]):o?W.write("jsonCheckWrap(%s)",_[0]):W.write("%s",_[0]);const T=W.makeFunction(H);return T.toModule=({semi:O=!0}={})=>W.makeModule(H)+(O?";":""),T.toJSON=()=>e,T},Gi=e=>t=>{if(typeof t!="string")return{valid:!1,error:"Input is not a string"};try{const n=JSON.parse(t);if(!e(n)){const{keywordLocation:o,instanceLocation:c}=e.errors[0];return{valid:!1,error:`JSON validation failed for ${o.slice(o.lastIndexOf("/")+1)} at ${c}`,errors:e.errors}}return{valid:!0,value:n}}catch({message:n}){return{valid:!1,error:n}}},Yi=e=>t=>{if(typeof t!="string")return{valid:!1};try{const n=JSON.parse(t);return e(n)?{valid:!0,value:n}:{valid:!1}}catch{return{valid:!1}}},Qi=function(e,{parse:t=!0,...n}={}){if(!t)throw new Error("can not disable parse in parser");return sn(e,{parse:t,...n})},Xi=function(e,{lint:t=!0,...n}={}){if(!t)throw new Error("can not disable lint option in lint()");return sn(e,{lint:t,...n})};var Bi={validator:sn,parser:Qi,lint:Xi};const es="http://json-schema.org/draft-04/schema#",ts="object",ns={version:{type:"string"},isReadonly:{type:"boolean"},isDrawerOpen:{type:"boolean"},showLegend:{type:"boolean"},techniqueMappingMode:{type:"string"},selectedProfile:{type:"integer"},selectedStore:{type:"string"},containerSize:{type:"number"},matrixSize:{type:"integer"},associationMode:{type:"boolean"},matrixCommentMode:{type:"boolean"},localStorageWarning:{type:"boolean"},profiles:{type:"array",items:[{type:"object",properties:{id:{type:"integer"},description:{type:"string"},name:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","description","name","includedLayers"]}]},layers:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},color:{type:"string"},children:{type:"array",items:[{type:"string"}]},checked:{type:"boolean"}},additionalProperties:!1,required:["id","description","name","techniques","color","children","checked"]}}},attack:{type:"object",patternProperties:{".*":{type:"object",patternProperties:{".*":{type:"array",items:[{type:"object",properties:{id:{type:"string"},justification:{type:"string"},tactic:{type:"string"},includedLayers:{type:"array",items:[{type:"string"}]}},additionalProperties:!1,required:["id","justification","tactic"]}]}}}}},rootTemplates:{type:"array",items:[{type:"string"}]},templates:{type:"object",patternProperties:{".*":{type:"object",properties:{id:{type:"string"},description:{type:"string"},name:{type:"string"},techniques:{type:"array",items:[{type:"object",properties:{id:{type:"string"},comment:{type:"string"}},required:["id","comment"]}]},checked:{type:"boolean"},color:{type:"string"},children:{type:"array",items:{}}},additionalProperties:!1,required:["id","description","name","techniques","checked","color","children"]}}},shownTactics:{type:"object",properties:{"d3f:Model":{type:"boolean"},"d3f:Harden":{type:"boolean"},"d3f:Detect":{type:"boolean"},"d3f:Isolate":{type:"boolean"},"d3f:Deceive":{type:"boolean"},"d3f:Evict":{type:"boolean"}},required:["d3f:Model","d3f:Harden","d3f:Detect","d3f:Isolate","d3f:Deceive","d3f:Evict"]}},rs=!1,is=["version","isReadonly","isDrawerOpen","showLegend","techniqueMappingMode","selectedProfile","selectedStore","containerSize","matrixSize","associationMode","matrixCommentMode","localStorageWarning","profiles","layers","attack","rootTemplates","templates","shownTactics"],ss={$schema:es,type:ts,properties:ns,additionalProperties:rs,required:is},ye={layers:"layers",templates:"templates"},os={rootColor:"multiColor",heatMap:"heatMap",childrenMultiColor:"childrenMultiColor","ATT&CK":"ATT&CK"},ds={attack:"attack",controls:"controls",cwe:"cwe",act:"acf"},cr={version:"1",isReadonly:!1,isDrawerOpen:!0,showLegend:!0,techniqueMappingMode:os.childrenMultiColor,selectedProfile:0,selectedStore:ye.layers,containerSize:.8,matrixSize:1,associationMode:!1,matrixCommentMode:!1,localStorageWarning:!0,profiles:[{id:0,description:"Testing the description",name:"Profile 1",includedLayers:["claimed-dkjndlkdj","tested-dnkljlkldjs","integration-jksieufnvdkd"]},{id:1,description:"Testing the description",name:"Profile 2",includedLayers:["zero-trust-kdjj2mvnvjkkd"]},{id:2,description:"Testing the description",name:"Profile 3",includedLayers:["next-generation-firewall-kjlknlkn","zero-trust-kdjj2mvnvjkkd"]}],layers:{"zero-trust-kdjj2mvnvjkkd":{id:"zero-trust-kdjj2mvnvjkkd",description:"Testing the description",name:"Zero-Trust",techniques:[],color:"#ef0b0b",children:["role-based-access-hdjkfkkbvgn","continuous-verification-jkqwwer","geo-location-ie83909"],checked:!0},"role-based-access-hdjkfkkbvgn":{id:"role-based-access-hdjkfkkbvgn",description:"Testing the description",name:"Role-Based Access",techniques:[{id:"d3f:DataInventory",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""},{id:"d3f:AssetInventory",comment:""}],children:[],color:"#ef0b0b",checked:!0},"least-priviledge-27kdjkdfkj":{id:"least-priviledge-27kdjkdfkj",description:"Testing the description",name:"Least Priviledge",techniques:[{id:"d3f:DNSAllowlisting",comment:""},{id:"d3f:DNSDenylisting",comment:""},{id:"d3f:ForwardResolutionDomainDenylisting",comment:""},{id:"d3f:HierarchicalDomainDenylisting",comment:""},{id:"d3f:HomoglyphDenylisting",comment:""},{id:"d3f:ForwardResolutionIPDenylisting",comment:""},{id:"d3f:ReverseResolutionIPDenylisting",comment:""},{id:"d3f:InboundTrafficFiltering",comment:""},{id:"d3f:OutboundTrafficFiltering",comment:""},{id:"d3f:AccountLocking",comment:""},{id:"d3f:ProcessTermination",comment:""}],color:"#bbc171",checked:!0,children:[]},"continuous-verification-jkqwwer":{id:"continuous-verification-jkqwwer",description:"Testing the description",name:"Continuous Verification",techniques:[],color:"#ef0b0b",children:[],checked:!1},"geo-location-ie83909":{id:"geo-location-ie83909",description:"Testing the description",name:"Geo Location",techniques:[{id:"d3f:TransferAgentAuthentication",comment:""},{id:"d3f:ServiceDependencyMapping",comment:""},{id:"d3f:AccessModeling",comment:""}],color:"#ef0b0b",children:[],checked:!0},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[],children:[],color:"#ef0b0b",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",description:"Testing the description",name:"Web Filtering",techniques:[],color:"#ef0b0b",children:[],checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],color:"#ef0b0b",children:[],checked:!1},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",description:"Testing the description",name:"Threat Prevention",techniques:[],color:"#ef0b0b",children:[],checked:!0},"application-and-identiy-based-inspection-dkvn":{id:"application-and-identiy-based-inspection-dkvn",description:"Testing the description",name:"Application and Identiy-based Inspection",techniques:[{id:"d3f:HomoglyphDetection",comment:""},{id:"d3f:URLAnalysis",comment:""},{id:"d3f:CertificateAnalysis",comment:""},{id:"d3f:PassiveCertificateAnalysis",comment:""},{id:"d3f:IPCTrafficAnalysis",comment:""},{id:"d3f:AuthenticationEventThresholding",comment:""},{id:"d3f:AuthorizationEventThresholding",comment:""},{id:"d3f:DomainAccountMonitoring",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:LocalAccountMonitoring",comment:""},{id:"d3f:ResourceAccessPatternAnalysis",comment:""},{id:"d3f:SessionDurationAnalysis",comment:""},{id:"d3f:UserDataTransferAnalysis",comment:""},{id:"d3f:UserGeolocationLogonPatternAnalysis",comment:""},{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],color:"#817fcc",checked:!0,children:[]},"scalability-kdnvmv":{id:"scalability-kdnvmv",description:"Testing the description",name:"Scalability",techniques:[],color:"#ef0b0b",children:[],checked:!0},"next-generation-firewall-kjlknlkn":{id:"next-generation-firewall-kjlknlkn",description:"Testing the description",name:"Next-Generation Firewall",techniques:[],color:"#ef0b0b",children:["web-filtering-3iejkdfmv","sandboxing-kdnvmvmmv","threat-prevention-kdkvsaka"],checked:!1},"claimed-dkjndlkdj":{id:"claimed-dkjndlkdj",description:"Testing the description",name:"Claimed",checked:!0,techniques:[],color:"#98d0A9",children:["scalability-kdnvmv","application-and-identiy-based-inspection-dkvn"]},"tested-dnkljlkldjs":{id:"tested-dnkljlkldjs",description:"Testing the description",name:"Tested",checked:!0,techniques:[{id:"d3f:AdministrativeNetworkActivityAnalysis",comment:""},{id:"d3f:Client-serverPayloadProfiling",comment:""},{id:"d3f:ConnectionAttemptAnalysis",comment:""},{id:"d3f:DNSTrafficAnalysis",comment:""},{id:"d3f:NetworkTrafficCommunityDeviation",comment:""},{id:"d3f:PerHostDownload-UploadRatioAnalysis",comment:""},{id:"d3f:ProtocolMetadataAnomalyDetection",comment:""},{id:"d3f:RelayPatternAnalysis",comment:""},{id:"d3f:RemoteTerminalSessionDetection",comment:""},{id:"d3f:RPCTrafficAnalysis",comment:""}],children:[],color:"#7eec9f"},"integration-jksieufnvdkd":{id:"integration-jksieufnvdkd",description:"Testing the description",name:"Integration",techniques:[],children:["least-priviledge-27kdjkdfkj"],checked:!0,color:"#ffcc80"}},attack:{},rootTemplates:["firewall-kdjenyeurhg","threat-prevention-kdkvsaka"],templates:{"firewall-kdjenyeurhg":{id:"firewall-kdjenyeurhg",description:"Testing the description",name:"Firewall",techniques:[],checked:!0,color:"#7078A4",children:["bandwidth-control-and-monitoring-837fdrkdm"]},"bandwidth-control-and-monitoring-837fdrkdm":{id:"bandwidth-control-and-monitoring-837fdrkdm",description:"Testing the description",name:"Bandwidth Control and Monitoring",techniques:[{id:"d3f:SoftwareUpdate",comment:""},{id:"d3f:ByteSequenceEmulation",comment:""},{id:"d3f:JobFunctionAccessPatternAnalysis",comment:""},{id:"d3f:NetworkTrafficFiltering",comment:""}],children:[],color:"#7078A4",checked:!0},"web-filtering-3iejkdfmv":{id:"web-filtering-3iejkdfmv",name:"Web Filtering",description:"Testing the description",techniques:[],children:[],color:"#7078A4",checked:!0},"sandboxing-kdnvmvmmv":{id:"sandboxing-kdnvmvmmv",description:"Testing the description",name:"Sandboxing",techniques:[],children:[],checked:!0,color:"#BB5883"},"threat-prevention-kdkvsaka":{id:"threat-prevention-kdkvsaka",name:"Threat Prevention",description:"Testing the description",techniques:[],children:[],color:"#BB5883",checked:!0}},shownTactics:{"d3f:Model":!1,"d3f:Harden":!1,"d3f:Detect":!1,"d3f:Isolate":!1,"d3f:Deceive":!1,"d3f:Evict":!1}},Un={selected:"selected",editing:"editing",parent:"parent",root:"root",noop:"noop"};try{const e=Bi.parser(ss,{requireStringValidation:!1,mode:"lax",includeErrors:!0,allErrors:!0}),{valid:t,error:n,errors:o}=e(JSON.stringify(cr));if(!t)throw new AggregateError(o,`Error Parsing Initial Profile Layer: ${n}`)}catch(e){if(console.error(e.message),Array.isArray(e.errors))for(let t=0;t<e.errors.length;t++){const n=e.errors[t];console.error(n)}else console.error(e.errors);process.exit(1)}const as=e=>{const{subscribe:t,update:n,set:o}=Dr("d3fend-layers",e);return{subscribe:t,update:n,set:o,createProfile:h=>n(u=>{const b=u.profiles.length;return h.id=b,h.includedLayers=[],u.profiles.push(h),u.selectedProfile=b,u}),deleteProfile:()=>n(h=>(h.profiles=h.profiles.filter((u,b)=>b!==h.selectedProfile),h.selectedProfile=h.profiles.length?0:null,h)),addLayer:h=>n(u=>(u.layers[h.id]=h,u.profiles[u.selectedProfile].includedLayers.push(h.id),u)),bulkAddLayer:(h,u)=>n(b=>{for(const v of h)b.layers[v.id]=v;return b.profiles[b.selectedProfile].includedLayers.push(u),b}),addTemplate:h=>n(u=>(u.templates[h.id]=h,u.rootTemplates.push(h.id),u)),copyFromTemplate:(h,u=ye.layers)=>n(b=>(h.id=_t(h.name),b[u][h.id]=h,b)),appendLayer:h=>n(u=>(u.layers[h]&&u.profiles[u.selectedProfile].includedLayers.push(h),u)),editName:(h,u,b=ye.layers)=>n(v=>(v[b][h].name=u,v)),editLayerComment:(h,u,b=ye.layers)=>n(v=>(v[b][h].comment=u,v)),addChild:(h,u,b=ye.layers)=>n(v=>{const I=_t(u.name),Y=h.id;return u.id=I,u.checked=!0,u.children=[],u.techniques=[...h.techniques],u.color=h.color,v[b][I]=u,v[b][Y].children||(v[b][Y].children=[]),v[b][Y].children.push(I),v[b][Y].techniques=[],v}),addNonRootChild:(h,u,b=ye.layers)=>n(v=>{const I=_t(u.name);return u.id=I,u.checked=!0,u.techniques=[],u.children=[],u.color=h.color,v[b][I]=u,v[b][h.id].children.push(I),v}),deleteLayer:h=>n(u=>{const{[h]:b,...v}=u.layers,I=u.profiles.reduce((Y,U,B)=>{if(u.selectedProfile===B){const re={...U,includedLayers:U.includedLayers.filter(me=>me!==h)};Y.push(re)}else Y.push(U);return Y},[]);return{...u,profiles:I,layers:v}}),deleteTemplate:h=>n(u=>{const{[h]:b,...v}=u.templates,I=u.rootTemplates.filter(Y=>h!==Y);return{...u,templates:v,rootTemplates:I}}),deleteSublayer:(h,u,b=ye.layers)=>n(v=>(v[b][u].children=v[b][u].children.filter(I=>I!==h.id),delete v[b][h.id],v)),saveTechniques:(h,u,b=ye.layers)=>n(v=>{const I=Object.values(h).reduce((U,B)=>(B.classes.isSelected&&U.push(B["@id"]),U),[]);return Object.entries(u).reduce((U,[B,re])=>(re===Un.selected&&U.push(B),U),[]).forEach(U=>{const B=[...new Set([...v[b][U].techniques.map(re=>re.id),...I])];v[b][U].techniques=B.map(re=>({id:re,comment:""})),v[b][U].checked=!0}),v}),removeTechniques:(h,u,b=ye.layers)=>n(v=>{const I=Object.values(h).reduce((U,B)=>(B.classes.isSelected&&U.push(B["@id"]),U),[]);return Object.entries(u).reduce((U,[B,re])=>(re===Un.selected&&U.push(B),U),[]).forEach(U=>{const B=v[b][U].techniques.filter(re=>!I.includes(re.id));v[b][U].techniques=B,v[b][U].checked=!0}),v}),saveLayerColor:(h,u,b=ye.layers)=>n(v=>(v[b][h.id].color=u,v)),saveLayerTechniqueComment:(h,u,b,v=ye.layers)=>n(I=>{const Y=I[v][h].techniques.find(U=>U.id===u);return Y.comment=b,I}),changeTechniqueMappingMode:(h,u)=>n(b=>(b.techniqueMappingMode=h,b.showLegend=u,b)),addUserAssociatedAttack:(h,u,b)=>n(v=>{if((v.attack[h]||(v.attack[h]={}))&&(v.attack[h][u]||(v.attack[h][u]=[]))){const I=`${b.id}${b.tactic}`;if(v.attack[h][u].findIndex(({id:U,tactic:B})=>`${U}${B}`===I)!==-1)return v;v.attack[h][u].push(b)}return v}),editUserAssociatedAttack:(h,u,b)=>n(v=>(v.attack[h][u].justification=b,v)),deleteUserAssociatedAttack:(h,u,b)=>n(v=>{const I=v.attack[h][u].reduce((Y,U)=>(U.id!==b&&Y.push(U),Y),[]);return v.attack[h][u]=I,v})}},fs=as(cr);export{os as M,ye as P,Un as S,ds as T,ss as j,fs as l,Bi as s};
