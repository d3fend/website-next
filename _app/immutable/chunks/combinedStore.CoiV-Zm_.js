import{s as _e,A as Ee,k as I,i as _,o as se,al as hn,c as Fe,e as k,b as L,d as y,f as M,j as A,w as g,P as pe,C as Te,l as v,u as Ue,g as Ge,a as Ke,a1 as Pe,I as Xe,am as pn,t as fe,h as ue,H as Mt,p as te,m as Ne,y as Ie,S as Nt,ak as mn,$ as yt,Q as Pt,R as Dt,a2 as Lt,a3 as At,Z as Ql,a0 as _n,an as xe,v as we,N as qe,n as Y,X as Xl,r as X,z as gn,x as We,M as Ve,ao as pt,ap as Yl,q as bn,a4 as nt,V as vn,O as xl,aq as en,ar as $n}from"./scheduler.Cph8Trd5.js";import{S as ge,i as be,t as b,g as ae,a as $,e as ce,p as je,c as R,b as F,m as B,d as Z,h as it,j as wt,f as tn}from"./index.CThJCPP4.js";import{w as et,d as Cn}from"./index.BaLOT0NF.js";import{s as tt,a as He,f as ut}from"./index.C4XKit2g.js";import{e as Me}from"./each.DkdHin5j.js";import{h as qt,u as Ot}from"./await_block.CJX8xr84.js";import{S as ln}from"./SimpleAutocomplete.H2Dnecp-.js";import{R as kn}from"./Technique.Ry0AwKli.js";import{a as St}from"./lib.C6z0nzwW.js";import{l as he,M as ve,f as Vt,T as at,S as ne,P as Je,c as Tt,m as yn}from"./layers.Bv9rf-Lc.js";/* empty css                     */import{t as ot,T as Tn}from"./updateDefendTree.BepZFoY9.js";import{s as wn}from"./dialog.BdKcBNGP.js";import{g as En}from"./entry.C0gnFZlW.js";import{g as In}from"./spread.CgU5AtxT.js";const zt=(n,e=[])=>{let l=()=>{};for(let{query:t,transition:i,...r}of e)if(window.matchMedia(t).matches)return i(n,r);return l},Mn=n=>({}),jt=n=>({id:"drawer-content"}),Nn=n=>({}),Ht=n=>({}),Pn=n=>({}),Rt=n=>({id:"matrix-slot"});function Bt(n){let e,l,t,i,r;const s=n[3].matrix,o=Fe(s,n,n[2],Rt),f=n[3].legend,a=Fe(f,n,n[2],Ht);let c=n[0].isDrawerOpen&&Zt(n);return{c(){e=k("main"),l=k("section"),o&&o.c(),t=L(),a&&a.c(),i=L(),c&&c.c(),this.h()},l(u){e=y(u,"MAIN",{style:!0,class:!0});var d=M(e);l=y(d,"SECTION",{id:!0,class:!0});var h=M(l);o&&o.l(h),t=A(h),a&&a.l(h),h.forEach(_),i=A(d),c&&c.l(d),d.forEach(_),this.h()},h(){g(l,"id","container-matrix"),g(l,"class","svelte-mlvs39"),pe(l,"expand-matrix",n[0].isDrawerOpen),Te(e,"--drawer-width",Ln),Te(e,"--ANIMATION_TIMING",ft),g(e,"class","svelte-mlvs39")},m(u,d){I(u,e,d),v(e,l),o&&o.m(l,null),v(l,t),a&&a.m(l,null),v(e,i),c&&c.m(e,null),r=!0},p(u,d){o&&o.p&&(!r||d&4)&&Ue(o,s,u,u[2],r?Ke(s,u[2],d,Pn):Ge(u[2]),Rt),a&&a.p&&(!r||d&4)&&Ue(a,f,u,u[2],r?Ke(f,u[2],d,Nn):Ge(u[2]),Ht),(!r||d&1)&&pe(l,"expand-matrix",u[0].isDrawerOpen),u[0].isDrawerOpen?c?(c.p(u,d),d&1&&b(c,1)):(c=Zt(u),c.c(),b(c,1),c.m(e,null)):c&&(ae(),$(c,1,1,()=>{c=null}),ce())},i(u){r||(b(o,u),b(a,u),b(c),r=!0)},o(u){$(o,u),$(a,u),$(c),r=!1},d(u){u&&_(e),o&&o.d(u),a&&a.d(u),c&&c.d()}}}function Zt(n){let e,l,t;const i=n[3].drawer,r=Fe(i,n,n[2],jt);return{c(){e=k("aside"),r&&r.c(),this.h()},l(s){e=y(s,"ASIDE",{id:!0,class:!0});var o=M(e);r&&r.l(o),o.forEach(_),this.h()},h(){g(e,"id","container-drawer"),g(e,"class","svelte-mlvs39"),pe(e,"drawer-closed",!n[0].isDrawerOpen)},m(s,o){I(s,e,o),r&&r.m(e,null),t=!0},p(s,o){n=s,r&&r.p&&(!t||o&4)&&Ue(r,i,n,n[2],t?Ke(i,n[2],o,Mn):Ge(n[2]),jt),(!t||o&1)&&pe(e,"drawer-closed",!n[0].isDrawerOpen)},i(s){t||(b(r,s),s&&Pe(()=>{t&&(l||(l=je(e,zt,[{query:"(min-width: 501px)",transition:tt,duration:ft,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:tt,duration:ft,axis:"y"}],!0)),l.run(1))}),t=!0)},o(s){$(r,s),s&&(l||(l=je(e,zt,[{query:"(min-width: 501px)",transition:tt,duration:ft,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:tt,duration:ft,axis:"y"}],!1)),l.run(0)),t=!1},d(s){s&&_(e),r&&r.d(s),s&&l&&l.end()}}}function Dn(n){let e,l,t=n[0]&&Bt(n);return{c(){t&&t.c(),e=Ee()},l(i){t&&t.l(i),e=Ee()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[0]?t?(t.p(i,r),r&1&&b(t,1)):(t=Bt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ae(),$(t,1,1,()=>{t=null}),ce())},i(i){l||(b(t),l=!0)},o(i){$(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}const Ae=28,mt=33,_t={[ve.rootColor]:({root:n})=>n.color,[ve.childrenMultiColor]:({element:n})=>n.color,[ve.heatMap]:({root:n})=>n.color,[ve["ATT&CK"]]:({element:n})=>n.color},ft=1e3;let Ln="25vw";function An(n,e,l){let t;se(n,he,o=>l(0,t=o));let{$$slots:i={},$$scope:r}=e,{profileConfig:s}=e;return hn("profile-config",s),n.$$set=o=>{"profileConfig"in o&&l(1,s=o.profileConfig),"$$scope"in o&&l(2,r=o.$$scope)},[t,s,r,i]}class Oo extends ge{constructor(e){super(),be(this,e,An,Dn,_e,{profileConfig:1})}}const lt=(n,e,...l)=>{n.code==="Enter"&&e(n,...l)};function Ft(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Ut(n,e,l){const t=n.slice();return t[10]=e[l],t}const qn=n=>({}),Gt=n=>({});function Kt(n){let e,l;const t=n[6].header,i=Fe(t,n,n[5],Gt);return{c(){e=k("div"),i&&i.c(),this.h()},l(r){e=y(r,"DIV",{id:!0,class:!0});var s=M(e);i&&i.l(s),s.forEach(_),this.h()},h(){g(e,"id","header"),g(e,"class","svelte-zl7ap5")},m(r,s){I(r,e,s),i&&i.m(e,null),l=!0},p(r,s){i&&i.p&&(!l||s&32)&&Ue(i,t,r,r[5],l?Ke(t,r[5],s,qn):Ge(r[5]),Gt)},i(r){l||(b(i,r),l=!0)},o(r){$(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function Jt(n){let e,l,t=n[10].label+"",i,r,s,o,f;function a(...u){return n[7](n[10],...u)}function c(...u){return n[8](n[10],...u)}return{c(){e=k("li"),l=k("span"),i=fe(t),r=L(),this.h()},l(u){e=y(u,"LI",{class:!0});var d=M(e);l=y(d,"SPAN",{role:!0,tabindex:!0,class:!0});var h=M(l);i=ue(h,t),h.forEach(_),r=A(d),d.forEach(_),this.h()},h(){g(l,"role","menuitem"),g(l,"tabindex","0"),g(l,"class","svelte-zl7ap5"),g(e,"class",s=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")},m(u,d){I(u,e,d),v(e,l),v(l,i),v(e,r),o||(f=[te(l,"click",a),te(l,"keydown",c)],o=!0)},p(u,d){n=u,d&1&&t!==(t=n[10].label+"")&&Ne(i,t),d&3&&s!==(s=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")&&g(e,"class",s)},d(u){u&&_(e),o=!1,Ie(f)}}}function Wt(n){let e,l,t,i,r,s,o;var f=n[10].component;function a(c,u){return{props:{component:c[0][c[12]],containerHeight:c[3]}}}return f&&(l=Nt(f,a(n))),{c(){e=k("div"),l&&R(l.$$.fragment),t=L(),this.h()},l(c){e=y(c,"DIV",{class:!0});var u=M(e);l&&F(l.$$.fragment,u),t=A(u),u.forEach(_),this.h()},h(){g(e,"class","tab svelte-zl7ap5"),Pe(()=>n[9].call(e))},m(c,u){I(c,e,u),l&&B(l,e,null),v(e,t),i=mn(e,n[9].bind(e)),o=!0},p(c,u){if(u&1&&f!==(f=c[10].component)){if(l){ae();const d=l;$(d.$$.fragment,1,0,()=>{Z(d,1)}),ce()}f?(l=Nt(f,a(c)),R(l.$$.fragment),b(l.$$.fragment,1),B(l,e,t)):l=null}else if(f){const d={};u&1&&(d.component=c[0][c[12]]),u&8&&(d.containerHeight=c[3]),l.$set(d)}},i(c){o||(l&&b(l.$$.fragment,c),c&&Pe(()=>{o&&(s&&s.end(1),r=it(e,He,{duration:400,delay:400}),r.start())}),o=!0)},o(c){l&&$(l.$$.fragment,c),r&&r.invalidate(),c&&(s=wt(e,He,{duration:400})),o=!1},d(c){c&&_(e),l&&Z(l),i(),c&&s&&s.end()}}}function Qt(n){let e,l,t=n[1]===n[10].value&&Wt(n);return{c(){t&&t.c(),e=Ee()},l(i){t&&t.l(i),e=Ee()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,r){i[1]===i[10].value?t?(t.p(i,r),r&3&&b(t,1)):(t=Wt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ae(),$(t,1,1,()=>{t=null}),ce())},i(i){l||(b(t),l=!0)},o(i){$(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function On(n){let e,l,t,i,r,s=n[4].header&&Kt(n),o=Me(n[0]),f=[];for(let d=0;d<o.length;d+=1)f[d]=Jt(Ut(n,o,d));let a=Me(n[0]),c=[];for(let d=0;d<a.length;d+=1)c[d]=Qt(Ft(n,a,d));const u=d=>$(c[d],1,1,()=>{c[d]=null});return{c(){e=k("section"),s&&s.c(),l=L(),t=k("ul");for(let d=0;d<f.length;d+=1)f[d].c();i=L();for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){e=y(d,"SECTION",{id:!0,class:!0});var h=M(e);s&&s.l(h),l=A(h),t=y(h,"UL",{class:!0});var m=M(t);for(let p=0;p<f.length;p+=1)f[p].l(m);m.forEach(_),i=A(h);for(let p=0;p<c.length;p+=1)c[p].l(h);h.forEach(_),this.h()},h(){g(t,"class","svelte-zl7ap5"),g(e,"id","tabs--container"),g(e,"class","svelte-zl7ap5")},m(d,h){I(d,e,h),s&&s.m(e,null),v(e,l),v(e,t);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(t,null);v(e,i);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(e,null);r=!0},p(d,[h]){if(d[4].header?s?(s.p(d,h),h&16&&b(s,1)):(s=Kt(d),s.c(),b(s,1),s.m(e,l)):s&&(ae(),$(s,1,1,()=>{s=null}),ce()),h&7){o=Me(d[0]);let m;for(m=0;m<o.length;m+=1){const p=Ut(d,o,m);f[m]?f[m].p(p,h):(f[m]=Jt(p),f[m].c(),f[m].m(t,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=o.length}if(h&11){a=Me(d[0]);let m;for(m=0;m<a.length;m+=1){const p=Ft(d,a,m);c[m]?(c[m].p(p,h),b(c[m],1)):(c[m]=Qt(p),c[m].c(),b(c[m],1),c[m].m(e,null))}for(ae(),m=a.length;m<c.length;m+=1)u(m);ce()}},i(d){if(!r){b(s);for(let h=0;h<a.length;h+=1)b(c[h]);r=!0}},o(d){$(s),c=c.filter(Boolean);for(let h=0;h<c.length;h+=1)$(c[h]);r=!1},d(d){d&&_(e),s&&s.d(),Xe(f,d),Xe(c,d)}}}function Sn(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=pn(t);let{tabs:s=[]}=e,{activeTabValue:o}=e,{clickTab:f}=e,a;const c=(h,m)=>f(h.value,h.value),u=(h,m)=>lt(m,f,h.value);function d(){a=this.clientHeight,l(3,a)}return n.$$set=h=>{"tabs"in h&&l(0,s=h.tabs),"activeTabValue"in h&&l(1,o=h.activeTabValue),"clickTab"in h&&l(2,f=h.clickTab),"$$scope"in h&&l(5,i=h.$$scope)},[s,o,f,a,r,i,t,c,u,d]}class nn extends ge{constructor(e){super(),be(this,e,Sn,On,_e,{tabs:0,activeTabValue:1,clickTab:2})}}const Xt={setting:"M19.5 12c0 .34-.03.66-.07.98l2.11 1.65c.19.15.24.42.12.64l-2 3.46c-.12.22-.38.31-.61.22l-2.49-1c-.52.39-1.08.73-1.69.98l-.38 2.65c-.03.24-.24.42-.49.42h-4c-.25 0-.46-.18-.49-.42l-.38-2.65c-.61-.25-1.17-.58-1.69-.98l-2.49 1c-.22.08-.49 0-.61-.22l-2-3.46a.505.505 0 0 1 .12-.64l2.11-1.65A7.93 7.93 0 0 1 4.5 12c0-.33.03-.66.07-.98L2.46 9.37a.493.493 0 0 1-.12-.64l2-3.46c.12-.22.38-.31.61-.22l2.49 1c.52-.39 1.08-.73 1.69-.98l.38-2.65c.03-.24.24-.42.49-.42h4c.25 0 .46.18.49.42l.38 2.65c.61.25 1.17.58 1.69.98l2.49-1c.22-.08.49 0 .61.22l2 3.46c.12.22.07.49-.12.64l-2.11 1.65c.04.32.07.64.07.98Zm-11 0c0 1.93 1.57 3.5 3.5 3.5s3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5-3.5 1.57-3.5 3.5Z","color picker":"M12 3a9 9 0 0 0 0 18c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8Zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12ZM8 6.5C8 7.33 8.67 8 9.5 8S11 7.33 11 6.5 10.33 5 9.5 5 8 5.67 8 6.5ZM14.5 8c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8Zm1.5 2.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5S18.33 9 17.5 9s-1.5.67-1.5 1.5Z",create:"M20.71 5.63c.39.39.39 1.02 0 1.41l-1.83 1.83-3.75-3.75 1.83-1.83a.996.996 0 0 1 1.41 0l2.34 2.34ZM3 20.5v-3.04c0-.14.05-.26.15-.36L14.06 6.19l3.75 3.75L6.89 20.85a.47.47 0 0 1-.35.15H3.5c-.28 0-.5-.22-.5-.5Z",delete:"M16 2v4h6v2h-2v14H4V8H2V6h6V2zm-2 2h-4v2h4zm0 4H6v12h12V8zm-5 2h2v8H9zm6 0h-2v8h2z","create profile":"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v1c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-1h5c1.1 0 2-.9 2-2V5a2 2 0 0 0-2-2Zm0 13c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h16c.55 0 1 .45 1 1v10Zm-6-4c.55 0 1-.45 1-1s-.45-1-1-1h-2V8c0-.55-.45-1-1-1s-1 .45-1 1v2H9c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2Z",heatMap:"M10.5 2A3.5 3.5 0 0 1 14 5.5v6.758a5.5 5.5 0 1 1-7 0V5.499A3.5 3.5 0 0 1 10.5 2Zm0 2a1.5 1.5 0 0 0-1.493 1.355L9 5.5v7.699l-.726.6a3.5 3.5 0 1 0 4.609.137l-.156-.136-.726-.6L12 5.5a1.5 1.5 0 0 0-1.355-1.493L10.5 4Zm.5 1.5a.5.5 0 0 0-1 0v8.55a2.5 2.5 0 1 0 1 0V5.5Zm9 5.5a1 1 0 1 1 0 2h-3a1 1 0 1 1 0-2h3Zm-1-2a1 1 0 0 0-1-1h-1a1 1 0 1 0 0 2h1a1 1 0 0 0 1-1Zm1-4a1 1 0 1 1 0 2h-3a1 1 0 1 1 0-2h3Zm-1-2a1 1 0 0 0-1-1h-1a1 1 0 1 0 0 2h1a1 1 0 0 0 1-1Z",multiColor:"M6.34 19.24c-3.12-3.12-3.12-8.19 0-11.31l4.96-4.95a.996.996 0 0 1 1.41 0l4.95 4.95c3.12 3.12 3.12 8.19 0 11.31A7.98 7.98 0 0 1 12 21.58c-2.05 0-4.1-.78-5.66-2.34Zm1.42-1.41A5.928 5.928 0 0 0 12 19.59V5.1L7.76 9.35A5.928 5.928 0 0 0 6 13.59c0 1.6.62 3.1 1.76 4.24Z",info:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1Zm-1-8h2V7h-2v2Z",plus:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1Z",arrowLeft:"M14.71 6.71a.996.996 0 0 0-1.41 0L8.71 11.3a.996.996 0 0 0 0 1.41l4.59 4.59a.996.996 0 1 0 1.41-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41Z",arrowRight:"M9.29 6.71a.996.996 0 0 0 0 1.41L13.17 12l-3.88 3.88a.996.996 0 1 0 1.41 1.41l4.59-4.59a.996.996 0 0 0 0-1.41L10.7 6.7c-.38-.38-1.02-.38-1.41.01Z",chart:"M5 3h14c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2Zm1 16c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H6Zm6-2c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v8c0 .55-.45 1-1 1Zm-4 0c-.55 0-1-.45-1-1v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 .55-.45 1-1 1Zm7-1c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1v2Z",plus_circle:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2m0 18a8 8 0 1 1 8-8a8 8 0 0 1-8 8m4-9h-3V8a1 1 0 0 0-2 0v3H8a1 1 0 0 0 0 2h3v3a1 1 0 0 0 2 0v-3h3a1 1 0 0 0 0-2",export:"M11.78 7.159a.75.75 0 0 0-1.06 0l-1.97 1.97V1.75a.75.75 0 0 0-1.5 0v7.379l-1.97-1.97a.75.75 0 0 0-1.06 1.06l3.25 3.25L8 12l.53-.53l3.25-3.25a.75.75 0 0 0 0-1.061ZM2.5 9.75a.75.75 0 1 0-1.5 0V13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9.75a.75.75 0 0 0-1.5 0V13a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V9.75Z",import:"M11.78 5.841a.75.75 0 0 1-1.06 0l-1.97-1.97v7.379a.75.75 0 0 1-1.5 0V3.871l-1.97 1.97a.75.75 0 0 1-1.06-1.06l3.25-3.25L8 1l.53.53l3.25 3.25a.75.75 0 0 1 0 1.061ZM2.5 9.75a.75.75 0 0 0-1.5 0V13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9.75a.75.75 0 0 0-1.5 0V13a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V9.75Z",edit:"m19.71 8.04l-2.34 2.33l-3.75-3.75l2.34-2.33c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25L13.06 7.18l3.75 3.75L6.75 21H3zM16.62 5.04l-1.54 1.54l2.34 2.34l1.54-1.54zM15.36 11L13 8.64l-9 9.02V20h2.34z",check:"M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41L9 16.17z",close:"M6.793 6.793a1 1 0 0 1 1.414 0L12 10.586l3.793-3.793a1 1 0 1 1 1.414 1.414L13.414 12l3.793 3.793a1 1 0 0 1-1.414 1.414L12 13.414l-3.793 3.793a1 1 0 0 1-1.414-1.414L10.586 12L6.793 8.207a1 1 0 0 1 0-1.414Z",copy:"M21 8.94a1.31 1.31 0 0 0-.06-.27v-.09a1.07 1.07 0 0 0-.19-.28l-6-6a1.07 1.07 0 0 0-.28-.19a.32.32 0 0 0-.09 0a.88.88 0 0 0-.33-.11H10a3 3 0 0 0-3 3v1H6a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3v-1h1a3 3 0 0 0 3-3V8.94Zm-6-3.53L17.59 8H16a1 1 0 0 1-1-1ZM15 19a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h1v7a3 3 0 0 0 3 3h5Zm4-4a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h3v3a3 3 0 0 0 3 3h3Z",childrenMultiColor:"M8 30H2v-6h6zm-4-2h2v-2H4zm15 2h-6v-6h6zm-4-2h2v-2h-2zm15 2h-6v-6h6zm-4-2h2v-2h-2zM16 10a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4m0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2m10 12h-5a4.005 4.005 0 0 1-4-4h-2a4.005 4.005 0 0 1-4 4H6a2.002 2.002 0 0 0-2 2v4h2v-4h5a5.97 5.97 0 0 0 4-1.54V22h2v-5.54A5.97 5.97 0 0 0 21 18h5v4h2v-4a2.002 2.002 0 0 0-2-2",infoOutline:"M13 9h-2V7h2zm0 8h-2v-6h2zM5 3h14a2 2 0 0 1 2 2v14c0 .53-.21 1.04-.59 1.41c-.37.38-.88.59-1.41.59H5c-.53 0-1.04-.21-1.41-.59C3.21 20.04 3 19.53 3 19V5c0-1.11.89-2 2-2m14 16V5H5v14z",folder:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6z","ATT&CK":"M4.4 16.5c0-.9.3-1.8.8-2.6s1.5-1.7 3-2.7c-.9-1.1-1.4-1.9-1.7-2.5c-.4-.7-.5-1.3-.5-2c0-1.5.4-2.6 1.3-3.5c.9-.9 2.1-1.2 3.6-1.2c1.3 0 2.4.4 3.3 1.2c.9.8 1.3 1.8 1.3 2.9c0 .8-.2 1.5-.6 2.2c-.4.7-1.1 1.4-2.1 2.1l-1.4 1.1l4.3 5.2c.6-1.2.9-2.4.9-3.9h2.2c0 2.3-.5 4.2-1.6 5.7l2.8 3.3h-3l-1.3-1.5c-.7.6-1.4 1-2.3 1.3c-.9.3-1.8.5-2.7.5c-1.9 0-3.4-.5-4.6-1.5c-1.1-1.1-1.7-2.4-1.7-4.1m6.3 3.5c1.3 0 2.5-.5 3.6-1.5l-4.7-5.7l-.4.3C7.7 14.2 7 15.3 7 16.5c0 1.1.3 1.9 1 2.5c.7.6 1.5 1 2.7 1M8.5 6.7c0 .9.5 1.9 1.6 3.2l1.6-1.1c.6-.4 1-.8 1.2-1.2c.2-.4.3-.9.3-1.4c0-.6-.2-1.1-.7-1.5c-.4-.4-1-.6-1.7-.6s-1.3.2-1.7.7c-.4.5-.6 1.1-.6 1.9"};function Vn(n){let e,l,t,i,r,s,o,f,a,c;const u=n[9].default,d=Fe(u,n,n[8],null);let h=[{style:o="--size:"+n[0]},{"data-icon":n[2]},{class:"fab"},{"aria-label":n[3]},{disabled:n[4]},n[7]],m={};for(let p=0;p<h.length;p+=1)m=yt(m,h[p]);return{c(){e=k("button"),l=Pt("svg"),t=Pt("path"),s=L(),d&&d.c(),this.h()},l(p){e=y(p,"BUTTON",{style:!0,"data-icon":!0,class:!0,"aria-label":!0});var T=M(e);l=Dt(T,"svg",{xmlns:!0,viewBox:!0,class:!0});var C=M(l);t=Dt(C,"path",{"fill-rule":!0,d:!0,fill:!0}),M(t).forEach(_),C.forEach(_),s=A(T),d&&d.l(T),T.forEach(_),this.h()},h(){g(t,"fill-rule","evenodd"),g(t,"d",i=Xt[n[2]]),g(t,"fill",n[5]),g(l,"xmlns","http://www.w3.org/2000/svg"),g(l,"viewBox",r="0 0 "+n[1]+" "+n[1]),g(l,"class","svelte-fbph36"),pe(l,"icon-disabled",n[4]),Lt(e,m),pe(e,"svelte-fbph36",!0)},m(p,T){I(p,e,T),v(e,l),v(l,t),v(e,s),d&&d.m(e,null),e.autofocus&&e.focus(),f=!0,a||(c=te(e,"click",n[6],!0),a=!0)},p(p,[T]){(!f||T&4&&i!==(i=Xt[p[2]]))&&g(t,"d",i),(!f||T&32)&&g(t,"fill",p[5]),(!f||T&2&&r!==(r="0 0 "+p[1]+" "+p[1]))&&g(l,"viewBox",r),(!f||T&16)&&pe(l,"icon-disabled",p[4]),d&&d.p&&(!f||T&256)&&Ue(d,u,p,p[8],f?Ke(u,p[8],T,null):Ge(p[8]),null),Lt(e,m=In(h,[(!f||T&1&&o!==(o="--size:"+p[0]))&&{style:o},(!f||T&4)&&{"data-icon":p[2]},{class:"fab"},(!f||T&8)&&{"aria-label":p[3]},(!f||T&16)&&{disabled:p[4]},T&128&&p[7]])),pe(e,"svelte-fbph36",!0)},i(p){f||(b(d,p),f=!0)},o(p){$(d,p),f=!1},d(p){p&&_(e),d&&d.d(p),a=!1,c()}}}function zn(n,e,l){const t=["size","viewBox","iconName","description","disabled","pathColor"];let i=At(e,t),{$$slots:r={},$$scope:s}=e,{size:o}=e,{viewBox:f=24}=e,{iconName:a}=e,{description:c}=e,{disabled:u=!1}=e,{pathColor:d="black"}=e;const h=new Ql,m=p=>{h("iconClick",{event:p})};return n.$$set=p=>{e=yt(yt({},e),_n(p)),l(7,i=At(e,t)),"size"in p&&l(0,o=p.size),"viewBox"in p&&l(1,f=p.viewBox),"iconName"in p&&l(2,a=p.iconName),"description"in p&&l(3,c=p.description),"disabled"in p&&l(4,u=p.disabled),"pathColor"in p&&l(5,d=p.pathColor),"$$scope"in p&&l(8,s=p.$$scope)},[o,f,a,c,u,d,m,i,s,r]}class de extends ge{constructor(e){super(),be(this,e,zn,Vn,_e,{size:0,viewBox:1,iconName:2,description:3,disabled:4,pathColor:5})}}function Yt(n,e,l){const t=n.slice();return t[34]=e[l],t}function jn(n){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function Hn(n){let e,l,t,i,r,s;function o(d){n[21](d)}let f={items:Object.values(n[37]),labelFunction:n[19],keywordsFunction:n[20],placeholder:"ATT&CK Lookup"};n[4]!==void 0&&(f.selectedItem=n[4]),l=new ln({props:f}),qe.push(()=>tn(l,"selectedItem",o));function a(d,h){return d[4]?Rn:Bn}let c=a(n),u=c(n);return{c(){e=k("span"),R(l.$$.fragment),i=L(),u.c(),r=Ee(),this.h()},l(d){e=y(d,"SPAN",{id:!0});var h=M(e);F(l.$$.fragment,h),h.forEach(_),i=A(d),u.l(d),r=Ee(),this.h()},h(){g(e,"id","offensive")},m(d,h){I(d,e,h),B(l,e,null),I(d,i,h),u.m(d,h),I(d,r,h),s=!0},p(d,h){const m={};!t&&h[0]&16&&(t=!0,m.selectedItem=d[4],Xl(()=>t=!1)),l.$set(m),c===(c=a(d))&&u?u.p(d,h):(u.d(1),u=c(d),u&&(u.c(),u.m(r.parentNode,r)))},i(d){s||(b(l.$$.fragment,d),s=!0)},o(d){$(l.$$.fragment,d),s=!1},d(d){d&&(_(e),_(i),_(r)),Z(l),u.d(d)}}}function Rn(n){let e,l,t="Justification:",i,r,s,o,f="save",a,c;return{c(){e=k("div"),l=k("label"),l.textContent=t,i=L(),r=k("input"),s=L(),o=k("button"),o.textContent=f,this.h()},l(u){e=y(u,"DIV",{});var d=M(e);l=y(d,"LABEL",{for:!0,"data-svelte-h":!0}),we(l)!=="svelte-u8h1xa"&&(l.textContent=t),i=A(d),r=y(d,"INPUT",{id:!0,type:!0}),s=A(d),o=y(d,"BUTTON",{"data-svelte-h":!0}),we(o)!=="svelte-4u68nx"&&(o.textContent=f),d.forEach(_),this.h()},h(){g(l,"for","attack--justification"),g(r,"id","attack--justification"),g(r,"type","text")},m(u,d){I(u,e,d),v(e,l),v(e,i),v(e,r),n[22](r),v(e,s),v(e,o),a||(c=te(o,"click",n[14]),a=!0)},p:Y,d(u){u&&_(e),n[22](null),a=!1,c()}}}function Bn(n){let e,l="<i>Select ATT&amp;CK Technique to associate to Layer</i>";return{c(){e=k("span"),e.innerHTML=l},l(t){e=y(t,"SPAN",{"data-svelte-h":!0}),we(e)!=="svelte-1d39b1v"&&(e.innerHTML=l)},m(t,i){I(t,e,i)},p:Y,d(t){t&&_(e)}}}function Zn(n){let e;return{c(){e=fe("...loading")},l(l){e=ue(l,"...loading")},m(l,t){I(l,e,t)},p:Y,i:Y,o:Y,d(l){l&&_(e)}}}function xt(n){let e,l,t,i='<th class="svelte-pjnk5u">ID</th> <th class="svelte-pjnk5u">Tactic</th> <th class="svelte-pjnk5u">Technique</th> <th class="svelte-pjnk5u">SubTechnique</th> <th class="svelte-pjnk5u">Justification</th> <th class="svelte-pjnk5u"></th>',r,s,o,f=Me(n[2]),a=[];for(let u=0;u<f.length;u+=1)a[u]=el(Yt(n,f,u));const c=u=>$(a[u],1,1,()=>{a[u]=null});return{c(){e=k("section"),l=k("table"),t=k("thead"),t.innerHTML=i,r=L(),s=k("tbody");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){e=y(u,"SECTION",{});var d=M(e);l=y(d,"TABLE",{class:!0});var h=M(l);t=y(h,"THEAD",{"data-svelte-h":!0}),we(t)!=="svelte-1rtdzpr"&&(t.innerHTML=i),r=A(h),s=y(h,"TBODY",{});var m=M(s);for(let p=0;p<a.length;p+=1)a[p].l(m);m.forEach(_),h.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u")},m(u,d){I(u,e,d),v(e,l),v(l,t),v(l,r),v(l,s);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(s,null);o=!0},p(u,d){if(d[0]&32772){f=Me(u[2]);let h;for(h=0;h<f.length;h+=1){const m=Yt(u,f,h);a[h]?(a[h].p(m,d),b(a[h],1)):(a[h]=el(m),a[h].c(),b(a[h],1),a[h].m(s,null))}for(ae(),h=f.length;h<a.length;h+=1)c(h);ce()}},i(u){if(!o){for(let d=0;d<f.length;d+=1)b(a[d]);o=!0}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)$(a[d]);o=!1},d(u){u&&_(e),Xe(a,u)}}}function el(n){let e,l,t=n[34].id.replace("d3f:","")+"",i,r,s,o=n[34].tactic+"",f,a,c,u=n[34].technique+"",d,h,m,p=(n[34].subTechnique||"")+"",T,C,V,w=(n[34].justification||"")+"",z,K,G,D,E,j,H,ee;return D=new de({props:{size:33,iconName:"edit",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),D.$on("iconClick",n[23]),j=new de({props:{size:33,iconName:"delete",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),j.$on("iconClick",n[24]),{c(){e=k("tr"),l=k("td"),i=fe(t),r=L(),s=k("td"),f=fe(o),a=L(),c=k("td"),d=fe(u),h=L(),m=k("td"),T=fe(p),C=L(),V=k("td"),z=fe(w),K=L(),G=k("td"),R(D.$$.fragment),E=L(),R(j.$$.fragment),H=L(),this.h()},l(W){e=y(W,"TR",{});var J=M(e);l=y(J,"TD",{class:!0});var U=M(l);i=ue(U,t),U.forEach(_),r=A(J),s=y(J,"TD",{class:!0});var Q=M(s);f=ue(Q,o),Q.forEach(_),a=A(J),c=y(J,"TD",{class:!0});var oe=M(c);d=ue(oe,u),oe.forEach(_),h=A(J),m=y(J,"TD",{class:!0});var S=M(m);T=ue(S,p),S.forEach(_),C=A(J),V=y(J,"TD",{class:!0});var P=M(V);z=ue(P,w),P.forEach(_),K=A(J),G=y(J,"TD",{class:!0});var O=M(G);F(D.$$.fragment,O),E=A(O),F(j.$$.fragment,O),O.forEach(_),H=A(J),J.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u"),g(s,"class","svelte-pjnk5u"),g(c,"class","svelte-pjnk5u"),g(m,"class","svelte-pjnk5u"),g(V,"class","svelte-pjnk5u"),g(G,"class","table--no--border svelte-pjnk5u")},m(W,J){I(W,e,J),v(e,l),v(l,i),v(e,r),v(e,s),v(s,f),v(e,a),v(e,c),v(c,d),v(e,h),v(e,m),v(m,T),v(e,C),v(e,V),v(V,z),v(e,K),v(e,G),B(D,G,null),v(G,E),B(j,G,null),v(e,H),ee=!0},p(W,J){(!ee||J[0]&4)&&t!==(t=W[34].id.replace("d3f:","")+"")&&Ne(i,t),(!ee||J[0]&4)&&o!==(o=W[34].tactic+"")&&Ne(f,o),(!ee||J[0]&4)&&u!==(u=W[34].technique+"")&&Ne(d,u),(!ee||J[0]&4)&&p!==(p=(W[34].subTechnique||"")+"")&&Ne(T,p),(!ee||J[0]&4)&&w!==(w=(W[34].justification||"")+"")&&Ne(z,w)},i(W){ee||(b(D.$$.fragment,W),b(j.$$.fragment,W),ee=!0)},o(W){$(D.$$.fragment,W),$(j.$$.fragment,W),ee=!1},d(W){W&&_(e),Z(D),Z(j)}}}function Fn(n){let e,l="Something Went Wrong";return{c(){e=k("div"),e.textContent=l},l(t){e=y(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-14i7fbl"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}function Un(n){let e,l,t,i,r;const s=[Kn,Gn],o=[];function f(a,c){return c[0]&64&&(e=null),e==null&&(e=Object.values(a[6]).length>0),e?0:1}return l=f(n,[-1,-1]),t=o[l]=s[l](n),{c(){t.c(),i=Ee()},l(a){t.l(a),i=Ee()},m(a,c){o[l].m(a,c),I(a,i,c),r=!0},p(a,c){let u=l;l=f(a,c),l===u?o[l].p(a,c):(ae(),$(o[u],1,1,()=>{o[u]=null}),ce(),t=o[l],t?t.p(a,c):(t=o[l]=s[l](a),t.c()),b(t,1),t.m(i.parentNode,i))},i(a){r||(b(t),r=!0)},o(a){$(t),r=!1},d(a){a&&_(i),o[l].d(a)}}}function Gn(n){let e,l="No Associated ATT&CK Techniques...";return{c(){e=k("div"),e.textContent=l},l(t){e=y(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-1l1k2ul"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}function Kn(n){let e,l;return e=new kn({props:{related_matrix:n[6],d_digital_artifacts:n[1].digital_artifacts,d_technique:n[3],d3fend_layer_color:n[8],additional_techniques:n[7]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&64&&(r.related_matrix=t[6]),i[0]&2&&(r.d_digital_artifacts=t[1].digital_artifacts),i[0]&8&&(r.d_technique=t[3]),i[0]&256&&(r.d3fend_layer_color=t[8]),i[0]&128&&(r.additional_techniques=t[7]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Jn(n){let e,l="loading...";return{c(){e=k("p"),e.textContent=l},l(t){e=y(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-qeejp2"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}function Wn(n){let e,l,t,i,r,s={ctx:n,current:null,token:null,hasCatch:!1,pending:Zn,then:Hn,catch:jn,value:37,blocks:[,,,]};qt(n[13],s);let o=n[2].length>0&&xt(n),f={ctx:n,current:null,token:null,hasCatch:!0,pending:Jn,then:Un,catch:Fn,value:32,error:33,blocks:[,,,]};return qt(n[12],f),{c(){e=k("main"),l=k("section"),s.block.c(),t=L(),o&&o.c(),i=L(),f.block.c(),this.h()},l(a){e=y(a,"MAIN",{style:!0,class:!0});var c=M(e);l=y(c,"SECTION",{id:!0,class:!0});var u=M(l);s.block.l(u),u.forEach(_),t=A(c),o&&o.l(c),i=A(c),f.block.l(c),c.forEach(_),this.h()},h(){g(l,"id","attack--input"),g(l,"class","svelte-pjnk5u"),Te(e,"--container-height",n[0]+"px"),g(e,"class","svelte-pjnk5u")},m(a,c){I(a,e,c),v(e,l),s.block.m(l,s.anchor=null),s.mount=()=>l,s.anchor=null,v(e,t),o&&o.m(e,null),v(e,i),f.block.m(e,f.anchor=null),f.mount=()=>e,f.anchor=null,r=!0},p(a,c){n=a,Ot(s,n,c),n[2].length>0?o?(o.p(n,c),c[0]&4&&b(o,1)):(o=xt(n),o.c(),b(o,1),o.m(e,i)):o&&(ae(),$(o,1,1,()=>{o=null}),ce()),Ot(f,n,c),(!r||c[0]&1)&&Te(e,"--container-height",n[0]+"px")},i(a){r||(b(s.block),b(o),b(f.block),r=!0)},o(a){for(let c=0;c<3;c+=1){const u=s.blocks[c];$(u)}$(o);for(let c=0;c<3;c+=1){const u=f.blocks[c];$(u)}r=!1},d(a){a&&_(e),s.block.d(),s.token=null,s=null,o&&o.d(),f.block.d(),f.token=null,f=null}}}function Qn(n,e,l){let t,i,r,s,o,f,a;se(n,he,S=>l(18,a=S));let{containerHeight:c}=e;const{selectedD3fendId:u,selectedLayerId:d,selectedLayerColor:h}=xe("profile-config");se(n,u,S=>l(3,s=S)),se(n,d,S=>l(17,o=S)),se(n,h,S=>l(8,f=S));let m,p,T,C,V=Vt(`/api/technique/${s}.json`).then(S=>l(1,m=S)),w=Vt("/api/offensive-technique/heirarchy.json").then(S=>(l(16,p=S["@graph"].reduce((P,O)=>(O!=null&&O["d3f:attack-id"]&&(P[O["@id"]]=O),P),{})),p));const z=(S,P)=>S&&P?S.map(({id:O,justification:le,tactic:re})=>({...E(P[O]),tactic:re,justification:le,id:O})):[],K=S=>S.reduce((P,{tactic:O,technique:le,subTechnique:re,id:N})=>(re&&(P[re]={tactic:O,name:re,color:f,id:N}),P[le]={name:le,color:f,id:N},P),{}),G=(S,P)=>S?P.length===0?S:P.reduce((le,{tactic:re,technique:N,subTechnique:q,id:me})=>{const De={off_tech_label:{type:"literal",value:N},off_tech_id:{type:"literal",value:me}},Le=q?[De,{off_tech_label:{type:"literal",value:q},off_tech_id:{type:"literal",value:me}}]:[De];if(le[re]){const Oe=le[re].findIndex(Re=>Re[0]===N);Oe!==-1?(le[re][Oe][1].push(De),q&&le[re][Oe][1].push(Le[1])):le[re].push([N,Le])}else le[re]=[[N,Le]];return le},{...S}):[],D=S=>S.replace("d3f:","").split(/(?=[A-Z])/).slice(0,-1).join(" "),E=(S,P={})=>{const O=S==null?void 0:S["rdfs:subClassOf"];return Object.values(P).length===0&&(P.id=S["@id"],P.subTechnique=S["rdfs:label"]),S.hasOwnProperty("d3f:attack-id")||(Array.isArray(S)?P.tactic=S.map(le=>D(le["@id"])):P.tactic=[D(S["@id"])]),typeof O=="object"||Array.isArray(O)?(P.technique=S["rdfs:label"],{...P,...E(O,P)}):P},j=S=>{const P=C.value,O=o,le=s,re=E(p[T["@id"]]);re.technique===re.subTechnique&&(re.subTechnique=null),re.tactic.reduce((q,me)=>(q.push({...re,tactic:me,justification:P}),q),[]).forEach(q=>{const me={id:q.id,justification:q.justification,tactic:q.tactic};he.addUserAssociatedAttack(O,le,me)})},H=S=>{},ee=S=>{if(S!=null)return S["d3f:attack-id"]+" - "+St(S)},W=S=>S["d3f:attack-id"]+" - "+St(S);function J(S){T=S,l(4,T)}function U(S){qe[S?"unshift":"push"](()=>{C=S,l(5,C)})}const Q=S=>H(),oe=S=>H();return n.$$set=S=>{"containerHeight"in S&&l(0,c=S.containerHeight)},n.$$.update=()=>{var S,P;n.$$.dirty[0]&458760&&l(2,t=z((P=(S=a.attack)==null?void 0:S[o])==null?void 0:P[s],p)),n.$$.dirty[0]&4&&l(7,i=K(t)),n.$$.dirty[0]&6&&l(6,r=G(m==null?void 0:m.related_offensive_matrix,t))},[c,m,t,s,T,C,r,i,f,u,d,h,V,w,j,H,p,o,a,ee,W,J,U,Q,oe]}class Xn extends ge{constructor(e){super(),be(this,e,Qn,Wn,_e,{containerHeight:0},null,[-1,-1])}}function Yn(n){let e,l="800-53 Controls";return{c(){e=k("p"),e.textContent=l},l(t){e=y(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-14yy83n"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}class xn extends ge{constructor(e){super(),be(this,e,null,Yn,_e,{})}}function ei(n){let e,l="CWE";return{c(){e=k("p"),e.textContent=l},l(t){e=y(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-19dyrix"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}class ti extends ge{constructor(e){super(),be(this,e,null,ei,_e,{})}}function li(n){let e,l="AFF Mapper";return{c(){e=k("p"),e.textContent=l},l(t){e=y(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-1q7pk5k"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:Y,i:Y,o:Y,d(t){t&&_(e)}}}class ni extends ge{constructor(e){super(),be(this,e,null,li,_e,{})}}function ii(n){let e,l="D3FEND Layer Mapper";return{c(){e=k("h2"),e.textContent=l,this.h()},l(t){e=y(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-nvnyht"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:Y,d(t){t&&_(e)}}}function ri(n){let e,l,t,i,r;return l=new nn({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[ii]},$$scope:{ctx:n}}}),{c(){e=k("section"),R(l.$$.fragment),this.h()},l(s){e=y(s,"SECTION",{class:!0});var o=M(e);F(l.$$.fragment,o),o.forEach(_),this.h()},h(){g(e,"class","svelte-1ymr2vu")},m(s,o){I(s,e,o),B(l,e,null),r=!0},p(s,[o]){const f={};o&1&&(f.tabs=s[0]),o&2&&(f.activeTabValue=s[1]),o&16&&(f.$$scope={dirty:o,ctx:s}),l.$set(f)},i(s){r||(b(l.$$.fragment,s),s&&Pe(()=>{r&&(i&&i.end(1),t=it(e,He,{delay:400}),t.start())}),r=!0)},o(s){$(l.$$.fragment,s),t&&t.invalidate(),s&&(i=wt(e,He,{duration:100})),r=!1},d(s){s&&_(e),Z(l),s&&i&&i.end()}}}function oi(n,e,l){let t,i;const r=et(at.attack);se(n,r,o=>l(1,i=o));const s=o=>{X(r,i=o,i)};return l(0,t=[{label:"ATT&CK",value:at.attack,component:Xn},{label:"800-53",value:at.controls,component:xn},{label:"CWE",value:at.cwe,component:ti},{label:"ACF",value:at.acf,component:ni}]),[t,i,r,s]}class rn extends ge{constructor(e){super(),be(this,e,oi,ri,_e,{})}}function si(n){let e,l,t,i;const r=n[1].default,s=Fe(r,n,n[0],null);return{c(){e=k("h2"),s&&s.c(),l=L(),t=k("hr"),this.h()},l(o){e=y(o,"H2",{class:!0});var f=M(e);s&&s.l(f),f.forEach(_),l=A(o),t=y(o,"HR",{class:!0}),this.h()},h(){g(e,"class","text-center svelte-1j2cwkl"),g(t,"class","svelte-1j2cwkl")},m(o,f){I(o,e,f),s&&s.m(e,null),I(o,l,f),I(o,t,f),i=!0},p(o,[f]){s&&s.p&&(!i||f&1)&&Ue(s,r,o,o[0],i?Ke(r,o[0],f,null):Ge(o[0]),null)},i(o){i||(b(s,o),i=!0)},o(o){$(s,o),i=!1},d(o){o&&(_(e),_(l),_(t)),s&&s.d(o)}}}function ai(n,e,l){let{$$slots:t={},$$scope:i}=e;return n.$$set=r=>{"$$scope"in r&&l(0,i=r.$$scope)},[i,t]}class ci extends ge{constructor(e){super(),be(this,e,ai,si,_e,{})}}const fi=n=>({}),tl=n=>({}),ui=n=>({}),ll=n=>({});function di(n){let e,l,t,i,r,s,o,f,a;const c=n[5].submit,u=Fe(c,n,n[4],ll),d=n[5].cancel,h=Fe(d,n,n[4],tl);return{c(){e=k("hr"),l=L(),t=k("section"),i=k("button"),u&&u.c(),r=L(),s=k("button"),h&&h.c(),this.h()},l(m){e=y(m,"HR",{class:!0}),l=A(m),t=y(m,"SECTION",{id:!0,class:!0});var p=M(t);i=y(p,"BUTTON",{});var T=M(i);u&&u.l(T),T.forEach(_),r=A(p),s=y(p,"BUTTON",{});var C=M(s);h&&h.l(C),C.forEach(_),p.forEach(_),this.h()},h(){g(e,"class","svelte-7f2jjs"),g(t,"id","btns"),g(t,"class","svelte-7f2jjs")},m(m,p){I(m,e,p),I(m,l,p),I(m,t,p),v(t,i),u&&u.m(i,null),v(t,r),v(t,s),h&&h.m(s,null),o=!0,f||(a=[te(i,"click",n[6]),te(s,"click",function(){gn(n[2])&&n[2].apply(this,arguments)})],f=!0)},p(m,[p]){n=m,u&&u.p&&(!o||p&16)&&Ue(u,c,n,n[4],o?Ke(c,n[4],p,ui):Ge(n[4]),ll),h&&h.p&&(!o||p&16)&&Ue(h,d,n,n[4],o?Ke(d,n[4],p,fi):Ge(n[4]),tl)},i(m){o||(b(u,m),b(h,m),o=!0)},o(m){$(u,m),$(h,m),o=!1},d(m){m&&(_(e),_(l),_(t)),u&&u.d(m),h&&h.d(m),f=!1,Ie(a)}}}function hi(n,e,l){let t,i=Y,r=()=>(i(),i=We(f,d=>l(3,t=d)),f);n.$$.on_destroy.push(()=>i());let{$$slots:s={},$$scope:o}=e,{item:f}=e;r();let{handleOnSubmit:a}=e,{handleCloseModal:c}=e;const u=()=>a(t);return n.$$set=d=>{"item"in d&&r(l(0,f=d.item)),"handleOnSubmit"in d&&l(1,a=d.handleOnSubmit),"handleCloseModal"in d&&l(2,c=d.handleCloseModal),"$$scope"in d&&l(4,o=d.$$scope)},[f,a,c,t,o,s,u]}class pi extends ge{constructor(e){super(),be(this,e,hi,di,_e,{item:0,handleOnSubmit:1,handleCloseModal:2})}}function nl(n,e,l){const t=n.slice();return t[3]=e[l],t}function il(n){let e,l=n[3].name+"",t,i;return{c(){e=k("option"),t=fe(l),this.h()},l(r){e=y(r,"OPTION",{});var s=M(e);t=ue(s,l),s.forEach(_),this.h()},h(){e.__value=i=n[3],Ve(e,e.__value)},m(r,s){I(r,e,s),v(e,t)},p(r,s){s&2&&l!==(l=r[3].name+"")&&Ne(t,l),s&2&&i!==(i=r[3])&&(e.__value=i,Ve(e,e.__value))},d(r){r&&_(e)}}}function mi(n){let e,l,t="NAME",i,r,s,o,f=`Select Capability from Templates...
      `,a,c,u,d=n[0].name+"",h,m,p,T,C=Me(n[1]),V=[];for(let w=0;w<C.length;w+=1)V[w]=il(nl(n,C,w));return{c(){e=k("div"),l=k("label"),l.textContent=t,i=L(),r=k("div"),s=k("select"),o=k("option"),o.textContent=f;for(let w=0;w<V.length;w+=1)V[w].c();a=L(),c=k("p"),u=fe("The Template Capability ("),h=fe(d),m=fe(`) will incorporate all
    child Capabilities and associated Techniques.`),this.h()},l(w){e=y(w,"DIV",{id:!0,class:!0});var z=M(e);l=y(z,"LABEL",{"aria-label":!0,for:!0,"data-svelte-h":!0}),we(l)!=="svelte-l4gr53"&&(l.textContent=t),i=A(z),r=y(z,"DIV",{id:!0});var K=M(r);s=y(K,"SELECT",{id:!0,class:!0});var G=M(s);o=y(G,"OPTION",{"data-svelte-h":!0}),we(o)!=="svelte-1t4hjue"&&(o.textContent=f);for(let E=0;E<V.length;E+=1)V[E].l(G);G.forEach(_),K.forEach(_),a=A(z),c=y(z,"P",{class:!0});var D=M(c);u=ue(D,"The Template Capability ("),h=ue(D,d),m=ue(D,`) will incorporate all
    child Capabilities and associated Techniques.`),D.forEach(_),z.forEach(_),this.h()},h(){g(l,"aria-label","Capability Name"),g(l,"for","capability-name"),o.selected=!0,o.disabled=!0,o.__value="",Ve(o,o.__value),g(s,"id","capability--select"),s.required=!0,g(s,"class","svelte-3hjn8y"),n[0]===void 0&&Pe(()=>n[2].call(s)),g(r,"id","autocomplete"),g(c,"class","form-info"),pe(c,"non--existing",n[0]),g(e,"id","layer-input-form"),g(e,"class","svelte-3hjn8y")},m(w,z){I(w,e,z),v(e,l),v(e,i),v(e,r),v(r,s),v(s,o);for(let K=0;K<V.length;K+=1)V[K]&&V[K].m(s,null);pt(s,n[0],!0),v(e,a),v(e,c),v(c,u),v(c,h),v(c,m),p||(T=te(s,"change",n[2]),p=!0)},p(w,[z]){if(z&2){C=Me(w[1]);let K;for(K=0;K<C.length;K+=1){const G=nl(w,C,K);V[K]?V[K].p(G,z):(V[K]=il(G),V[K].c(),V[K].m(s,null))}for(;K<V.length;K+=1)V[K].d(1);V.length=C.length}z&3&&pt(s,w[0]),z&1&&d!==(d=w[0].name+"")&&Ne(h,d),z&1&&pe(c,"non--existing",w[0])},i:Y,o:Y,d(w){w&&_(e),Xe(V,w),p=!1,T()}}}function _i(n,e,l){let{selectedCapability:t=null}=e,{capabilities:i}=e;function r(){t=Yl(this),l(0,t),l(1,i)}return n.$$set=s=>{"selectedCapability"in s&&l(0,t=s.selectedCapability),"capabilities"in s&&l(1,i=s.capabilities)},[t,i,r]}class gi extends ge{constructor(e){super(),be(this,e,_i,mi,_e,{selectedCapability:0,capabilities:1})}}function bi(n){let e,l,t,i,r,s,o,f,a,c,u,d,h,m,p;return{c(){e=k("div"),l=k("form"),t=k("label"),i=k("p"),r=fe(n[1]),s=L(),o=k("input"),f=L(),a=k("label"),c=k("p"),u=fe(n[2]),d=L(),h=k("textarea"),this.h()},l(T){e=y(T,"DIV",{id:!0,class:!0});var C=M(e);l=y(C,"FORM",{class:!0,autocomplete:!0});var V=M(l);t=y(V,"LABEL",{"aria-label":!0,for:!0});var w=M(t);i=y(w,"P",{});var z=M(i);r=ue(z,n[1]),z.forEach(_),w.forEach(_),s=A(V),o=y(V,"INPUT",{id:!0,type:!0,name:!0,class:!0,"aria-describedby":!0,oninvalid:!0}),f=A(V),a=y(V,"LABEL",{"aria-label":!0,for:!0});var K=M(a);c=y(K,"P",{});var G=M(c);u=ue(G,n[2]),G.forEach(_),K.forEach(_),d=A(V),h=y(V,"TEXTAREA",{id:!0,name:!0,class:!0}),M(h).forEach(_),V.forEach(_),C.forEach(_),this.h()},h(){g(t,"aria-label","layer name"),g(t,"for","layer-name"),g(o,"id","layer-name"),g(o,"type","text"),g(o,"name","Layer"),g(o,"class","layer-input svelte-s0zavs"),o.required=!0,g(o,"aria-describedby","layername-error"),g(o,"oninvalid",n[5]("This field is required.")),g(a,"aria-label","layer description"),g(a,"for","layer-description"),g(h,"id","layer-description"),g(h,"name","Description"),g(h,"class","layer-input svelte-s0zavs"),h.required=!0,g(l,"class","layer-input-form svelte-s0zavs"),g(l,"autocomplete","off"),g(e,"id","container-layer-form"),g(e,"class","svelte-s0zavs")},m(T,C){I(T,e,C),v(e,l),v(l,t),v(t,i),v(i,r),v(l,s),v(l,o),Ve(o,n[4].name),v(l,f),v(l,a),v(a,c),v(c,u),v(l,d),v(l,h),Ve(h,n[4].description),n[9](l),m||(p=[te(o,"input",n[7]),te(h,"input",n[8])],m=!0)},p(T,[C]){C&2&&Ne(r,T[1]),C&16&&o.value!==T[4].name&&Ve(o,T[4].name),C&4&&Ne(u,T[2]),C&16&&Ve(h,T[4].description)},i:Y,o:Y,d(T){T&&_(e),n[9](null),m=!1,Ie(p)}}}function vi(n,e,l){let t,i=Y,r=()=>(i(),i=We(s,p=>l(4,t=p)),s);n.$$.on_destroy.push(()=>i());let{item:s}=e;r();let{textInput:o}=e,{textArea:f}=e,{submit:a}=e,c;bn(()=>{X(s,t.name="",t),X(s,t.description="",t)});const u=p=>p;function d(){t.name=this.value,s.set(t)}function h(){t.description=this.value,s.set(t)}function m(p){qe[p?"unshift":"push"](()=>{c=p,l(3,c)})}return n.$$set=p=>{"item"in p&&r(l(0,s=p.item)),"textInput"in p&&l(1,o=p.textInput),"textArea"in p&&l(2,f=p.textArea),"submit"in p&&l(6,a=p.submit)},[s,o,f,c,t,u,a,d,h,m]}class $i extends ge{constructor(e){super(),be(this,e,vi,bi,_e,{item:0,textInput:1,textArea:2,submit:6})}}const Ci=n=>({}),rl=n=>({M:n[1],item:n[0]});function ki(n){let e,l;const t=n[3].default,i=Fe(t,n,n[2],rl);return{c(){e=k("section"),i&&i.c(),this.h()},l(r){e=y(r,"SECTION",{id:!0,class:!0});var s=M(e);i&&i.l(s),s.forEach(_),this.h()},h(){g(e,"id","dialog--container"),g(e,"class","svelte-1jrgukv")},m(r,s){I(r,e,s),i&&i.m(e,null),l=!0},p(r,[s]){i&&i.p&&(!l||s&4)&&Ue(i,t,r,r[2],l?Ke(t,r[2],s,Ci):Ge(r[2]),rl)},i(r){l||(b(i,r),l=!0)},o(r){$(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function yi(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=et({}),s={Title:ci,Buttons:pi,Select:gi,Create:$i};return n.$$set=o=>{"$$scope"in o&&l(2,i=o.$$scope)},[r,s,i,t]}class dt extends ge{constructor(e){super(),be(this,e,yi,ki,_e,{})}}function ol(n){let e,l,t,i,r,s,o,f;e=new de({props:{size:33,iconName:"create profile",description:"Create Profile",title:"Create Profile"}}),e.$on("iconClick",n[9]),t=new de({props:{size:33,iconName:"delete",description:"Delete Profile",title:"Delete Profile"}}),t.$on("iconClick",n[10]);let a=n[3]&&sl(n);return{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),r=k("dialog"),a&&a.c(),this.h()},l(c){F(e.$$.fragment,c),l=A(c),F(t.$$.fragment,c),i=A(c),r=y(c,"DIALOG",{});var u=M(r);a&&a.l(u),u.forEach(_),this.h()},h(){r.open=n[3]},m(c,u){B(e,c,u),I(c,l,u),B(t,c,u),I(c,i,u),I(c,r,u),a&&a.m(r,null),n[12](r),s=!0,o||(f=te(r,"close",n[13]),o=!0)},p(c,u){c[3]?a?(a.p(c,u),u&8&&b(a,1)):(a=sl(c),a.c(),b(a,1),a.m(r,null)):a&&(ae(),$(a,1,1,()=>{a=null}),ce()),(!s||u&8)&&(r.open=c[3])},i(c){s||(b(e.$$.fragment,c),b(t.$$.fragment,c),b(a),s=!0)},o(c){$(e.$$.fragment,c),$(t.$$.fragment,c),$(a),s=!1},d(c){c&&(_(l),_(i),_(r)),Z(e,c),Z(t,c),a&&a.d(),n[12](null),o=!1,f()}}}function sl(n){let e,l;return e=new dt({props:{$$slots:{default:[Ii,({M:t,item:i})=>({15:t,16:i}),({M:t,item:i})=>(t?32768:0)|(i?65536:0)]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i&196612&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Ti(n){let e;return{c(){e=fe("Create New Profile")},l(l){e=ue(l,"Create New Profile")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function wi(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ei(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ii(n){let e,l,t,i,r,s;return e=new n[15].Title({props:{$$slots:{default:[Ti]},$$scope:{ctx:n}}}),t=new n[15].Create({props:{item:n[16],textInput:"Name",textArea:"Description"}}),r=new n[15].Buttons({props:{item:n[16],handleCloseModal:n[8],handleOnSubmit:n[11],$$slots:{cancel:[Ei],submit:[wi]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment)},l(o){F(e.$$.fragment,o),l=A(o),F(t.$$.fragment,o),i=A(o),F(r.$$.fragment,o)},m(o,f){B(e,o,f),I(o,l,f),B(t,o,f),I(o,i,f),B(r,o,f),s=!0},p(o,f){const a={};f&131072&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const c={};f&65536&&(c.item=o[16]),t.$set(c);const u={};f&65536&&(u.item=o[16]),f&4&&(u.handleOnSubmit=o[11]),f&131072&&(u.$$scope={dirty:f,ctx:o}),r.$set(u)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(r.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&(_(l),_(i)),Z(e,o),Z(t,o),Z(r,o)}}}function Mi(n){let e,l,t=!n[4].isReadonly&&ol(n);return{c(){t&&t.c(),e=Ee()},l(i){t&&t.l(i),e=Ee()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[4].isReadonly?t&&(ae(),$(t,1,1,()=>{t=null}),ce()):t?(t.p(i,r),r&16&&b(t,1)):(t=ol(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){$(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Ni(n,e,l){let t,i=Y,r=()=>(i(),i=We(a,G=>l(4,t=G)),a),s,o=Y,f=()=>(o(),o=We(c,G=>l(14,s=G)),c);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>o());let{store:a}=e;r();let{selectedProfile:c}=e;f();let u,d=!1;const h=()=>{l(3,d=!0),u.showModal()},m=G=>{confirm("Deleting Profile will delete all associated Capabilities.")&&(a.deleteProfile(),X(c,s=t.profiles[t.selectedProfile]||{name:""},s))},p=({name:G,description:D},E)=>{a.createProfile({name:G,description:D}),X(c,s=t.profiles[t.selectedProfile]||null,s),E.close()},T=()=>{l(3,d=!1),u.close()},C=G=>h(),V=G=>m(),w=G=>p(G,u);function z(G){qe[G?"unshift":"push"](()=>{u=G,l(2,u)})}const K=()=>l(3,d=!1);return n.$$set=G=>{"store"in G&&r(l(0,a=G.store)),"selectedProfile"in G&&f(l(1,c=G.selectedProfile))},[a,c,u,d,t,h,m,p,T,C,V,w,z,K]}class Pi extends ge{constructor(e){super(),be(this,e,Ni,Mi,_e,{store:0,selectedProfile:1})}}function Di(n){var s;let e,l,t;function i(o){n[6](o)}let r={inputClassName:"autocomplete-cursor-select",items:(s=n[2])==null?void 0:s.profiles,readonly:!1,labelFieldName:"name",onChange:n[5]};return n[3]!==void 0&&(r.selectedItem=n[3]),e=new ln({props:r}),qe.push(()=>tn(e,"selectedItem",i)),{c(){R(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,f){B(e,o,f),t=!0},p(o,[f]){var c;const a={};f&4&&(a.items=(c=o[2])==null?void 0:c.profiles),!l&&f&8&&(l=!0,a.selectedItem=o[3],Xl(()=>l=!1)),e.$set(a)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){$(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function Li(n,e,l){let t,i=Y,r=()=>(i(),i=We(a,m=>l(2,t=m)),a),s,o=Y,f=()=>(o(),o=We(c,m=>l(3,s=m)),c);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>o());let{store:a}=e;r();let{selectedProfile:c}=e;f();const u=m=>{var p;if(m){const T=t==null?void 0:t.profiles.findIndex(({id:C})=>C===m.id);X(a,t.selectedProfile=T,t),X(c,s=((p=t==null?void 0:t.profiles)==null?void 0:p[T])||null,s),ot.reset()}else X(a,t.selectedProfile=null,t)},d=m=>u(m);function h(m){s=m,c.set(s)}return n.$$set=m=>{"store"in m&&r(l(0,a=m.store)),"selectedProfile"in m&&f(l(1,c=m.selectedProfile))},[a,c,t,s,u,d,h]}class Ai extends ge{constructor(e){super(),be(this,e,Li,Di,_e,{store:0,selectedProfile:1})}}const qi=n=>({}),al=n=>({}),Oi=n=>({}),cl=n=>({});function fl(n){let e,l,t,i,r,s,o,f,a;const c=n[6].popover,u=Fe(c,n,n[5],al);return{c(){e=k("div"),l=k("div"),i=L(),r=k("div"),u&&u.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,role:!0,tabindex:!0,"aria-labelledby":!0,"aria-describedby":!0,style:!0});var h=M(e);l=y(h,"DIV",{class:!0,tabindex:!0,role:!0}),M(l).forEach(_),i=A(h),r=y(h,"DIV",{class:!0});var m=M(r);u&&u.l(m),m.forEach(_),h.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-zv51ll"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-zv51ll"),g(e,"class","popover svelte-zv51ll"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-labelledby","Chart"),g(e,"aria-describedby","Description"),Te(e,"--popover-top",`${n[2]}px`),Te(e,"--popover-left",`${n[3]}px`)},m(d,h){I(d,e,h),v(e,l),v(e,i),v(e,r),u&&u.m(r,null),o=!0,f||(a=[te(l,"click",nt(n[11])),te(e,"click",nt(n[7]))],f=!0)},p(d,h){u&&u.p&&(!o||h&32)&&Ue(u,c,d,d[5],o?Ke(c,d[5],h,qi):Ge(d[5]),al),(!o||h&4)&&Te(e,"--popover-top",`${d[2]}px`),(!o||h&8)&&Te(e,"--popover-left",`${d[3]}px`)},i(d){o||(d&&Pe(()=>{o&&(t||(t=je(l,He,{delay:25,duration:150},!0)),t.run(1))}),b(u,d),d&&Pe(()=>{o&&(s||(s=je(e,He,{},!0)),s.run(1))}),o=!0)},o(d){d&&(t||(t=je(l,He,{delay:25,duration:150},!1)),t.run(0)),$(u,d),d&&(s||(s=je(e,He,{},!1)),s.run(0)),o=!1},d(d){d&&_(e),d&&t&&t.end(),u&&u.d(d),d&&s&&s.end(),f=!1,Ie(a)}}}function Si(n){let e,l,t,i,r,s;const o=n[6].popoverClick,f=Fe(o,n,n[5],cl);let a=n[1]&&fl(n);return{c(){e=k("div"),f&&f.c(),l=L(),a&&a.c(),t=Ee(),this.h()},l(c){e=y(c,"DIV",{role:!0,tabindex:!0});var u=M(e);f&&f.l(u),u.forEach(_),l=A(c),a&&a.l(c),t=Ee(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(c,u){I(c,e,u),f&&f.m(e,null),n[10](e),I(c,l,u),a&&a.m(c,u),I(c,t,u),i=!0,r||(s=[te(window,"resize",n[8]),te(e,"click",n[9])],r=!0)},p(c,[u]){f&&f.p&&(!i||u&32)&&Ue(f,o,c,c[5],i?Ke(o,c[5],u,Oi):Ge(c[5]),cl),c[1]?a?(a.p(c,u),u&2&&b(a,1)):(a=fl(c),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(ae(),$(a,1,1,()=>{a=null}),ce())},i(c){i||(b(f,c),b(a),i=!0)},o(c){$(f,c),$(a),i=!1},d(c){c&&(_(e),_(l),_(t)),f&&f.d(c),n[10](null),a&&a.d(c),r=!1,Ie(s)}}}function Vi(n,e,l){let{$$slots:t={},$$scope:i}=e,r=!1,s,o,f;const a=p=>setTimeout(()=>{l(2,{bottom:o,left:f}=(p==null?void 0:p.getBoundingClientRect())??{bottom:0,left:0},o,l(3,f))},1e3);function c(p){vn.call(this,n,p)}const u=p=>a(s),d=()=>l(1,r=!0);function h(p){qe[p?"unshift":"push"](()=>{s=p,l(0,s)})}const m=()=>l(1,r=!1);return n.$$set=p=>{"$$scope"in p&&l(5,i=p.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&a(s)},[s,r,o,f,a,i,t,c,u,d,h,m]}class zi extends ge{constructor(e){super(),be(this,e,Vi,Si,_e,{})}}function ji(n){let e,l;return e=new de({props:{size:30,iconName:"chart",description:"Change Layout",title:"Change Layout",slot:"popoverClick"}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p:Y,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function ul(n){let e,l,t,i,r="ATT&CK Associations",s,o,f;return l=new de({props:{size:30,iconName:ve["ATT&CK"],description:"Associated ATT&CK Techniques",title:"Associated ATT&CK Techniques"}}),{c(){e=k("button"),R(l.$$.fragment),t=L(),i=k("span"),i.textContent=r,this.h()},l(a){e=y(a,"BUTTON",{class:!0});var c=M(e);F(l.$$.fragment,c),t=A(c),i=y(c,"SPAN",{class:!0,"data-svelte-h":!0}),we(i)!=="svelte-rreezx"&&(i.textContent=r),c.forEach(_),this.h()},h(){g(i,"class","pop-text"),g(e,"class","btn svelte-1jv35sd"),pe(e,"selected-mode",n[1].techniqueMappingMode===ve["ATT&CK"])},m(a,c){I(a,e,c),B(l,e,null),v(e,t),v(e,i),s=!0,o||(f=te(e,"click",n[8]),o=!0)},p(a,c){(!s||c&2)&&pe(e,"selected-mode",a[1].techniqueMappingMode===ve["ATT&CK"])},i(a){s||(b(l.$$.fragment,a),s=!0)},o(a){$(l.$$.fragment,a),s=!1},d(a){a&&_(e),Z(l),o=!1,f()}}}function Hi(n){let e,l,t,i,r,s="Root Colored",o,f,a,c,u,d="Multi-Colored",h,m,p,T,C,V="Heatmap",w,z,K,G;t=new de({props:{size:30,iconName:ve.rootColor,description:"Root Colored",title:"Root Colored"}}),a=new de({props:{size:30,viewBox:32,iconName:ve.childrenMultiColor,description:"Children Multi-Color",title:"Children Multi-Color"}}),p=new de({props:{size:30,iconName:ve.heatMap,description:"Heatmap",title:"Heatmap"}});let D=n[2]&&ul(n);return{c(){e=k("div"),l=k("button"),R(t.$$.fragment),i=L(),r=k("span"),r.textContent=s,o=L(),f=k("button"),R(a.$$.fragment),c=L(),u=k("span"),u.textContent=d,h=L(),m=k("button"),R(p.$$.fragment),T=L(),C=k("span"),C.textContent=V,w=L(),D&&D.c(),this.h()},l(E){e=y(E,"DIV",{id:!0,slot:!0,class:!0});var j=M(e);l=y(j,"BUTTON",{class:!0});var H=M(l);F(t.$$.fragment,H),i=A(H),r=y(H,"SPAN",{class:!0,"data-svelte-h":!0}),we(r)!=="svelte-1mm9720"&&(r.textContent=s),H.forEach(_),o=A(j),f=y(j,"BUTTON",{class:!0});var ee=M(f);F(a.$$.fragment,ee),c=A(ee),u=y(ee,"SPAN",{class:!0,"data-svelte-h":!0}),we(u)!=="svelte-17kog5w"&&(u.textContent=d),ee.forEach(_),h=A(j),m=y(j,"BUTTON",{class:!0});var W=M(m);F(p.$$.fragment,W),T=A(W),C=y(W,"SPAN",{class:!0,"data-svelte-h":!0}),we(C)!=="svelte-1cpq3q6"&&(C.textContent=V),W.forEach(_),w=A(j),D&&D.l(j),j.forEach(_),this.h()},h(){g(r,"class","pop-text"),g(l,"class","btn svelte-1jv35sd"),pe(l,"selected-mode",n[1].techniqueMappingMode===ve.rootColor),g(u,"class","pop-text"),g(f,"class","btn svelte-1jv35sd"),pe(f,"selected-mode",n[1].techniqueMappingMode===ve.childrenMultiColor),g(C,"class","pop-text"),g(m,"class","btn svelte-1jv35sd"),pe(m,"selected-mode",n[1].techniqueMappingMode===ve.heatMap),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-1jv35sd")},m(E,j){I(E,e,j),v(e,l),B(t,l,null),v(l,i),v(l,r),v(e,o),v(e,f),B(a,f,null),v(f,c),v(f,u),v(e,h),v(e,m),B(p,m,null),v(m,T),v(m,C),v(e,w),D&&D.m(e,null),z=!0,K||(G=[te(l,"click",n[5]),te(f,"click",n[6]),te(m,"click",n[7])],K=!0)},p(E,j){(!z||j&2)&&pe(l,"selected-mode",E[1].techniqueMappingMode===ve.rootColor),(!z||j&2)&&pe(f,"selected-mode",E[1].techniqueMappingMode===ve.childrenMultiColor),(!z||j&2)&&pe(m,"selected-mode",E[1].techniqueMappingMode===ve.heatMap),E[2]?D?(D.p(E,j),j&4&&b(D,1)):(D=ul(E),D.c(),b(D,1),D.m(e,null)):D&&(ae(),$(D,1,1,()=>{D=null}),ce())},i(E){z||(b(t.$$.fragment,E),b(a.$$.fragment,E),b(p.$$.fragment,E),b(D),z=!0)},o(E){$(t.$$.fragment,E),$(a.$$.fragment,E),$(p.$$.fragment,E),$(D),z=!1},d(E){E&&_(e),Z(t),Z(a),Z(p),D&&D.d(),K=!1,Ie(G)}}}function Ri(n){let e,l,t;return l=new zi({props:{$$slots:{popover:[Hi],popoverClick:[ji]},$$scope:{ctx:n}}}),{c(){e=k("div"),R(l.$$.fragment),this.h()},l(i){e=y(i,"DIV",{id:!0,class:!0});var r=M(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"id","layer-btns"),g(e,"class","svelte-1jv35sd")},m(i,r){I(i,e,r),B(l,e,null),t=!0},p(i,[r]){const s={};r&518&&(s.$$scope={dirty:r,ctx:i}),l.$set(s)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&_(e),Z(l)}}}function Bi(n,e,l){let t,i=Y,r=()=>(i(),i=We(o,m=>l(1,t=m)),o),s;n.$$.on_destroy.push(()=>i());let{store:o}=e;r();const{mappings:f}=xe("profile-config");se(n,f,m=>l(2,s=m));const a=m=>{X(o,t.techniqueMappingMode=m,t)},c=()=>a(ve.rootColor),u=()=>a(ve.childrenMultiColor),d=()=>a(ve.heatMap),h=()=>a(ve["ATT&CK"]);return n.$$set=m=>{"store"in m&&r(l(0,o=m.store))},[o,t,s,f,a,c,u,d,h]}class Zi extends ge{constructor(e){super(),be(this,e,Bi,Ri,_e,{store:0})}}function dl(n){let e,l,t,i;return e=new de({props:{size:33,iconName:"import",description:"Import Profile",title:"Import Profile",$$slots:{default:[Fi]},$$scope:{ctx:n}}}),e.$on("iconClick",n[4]),t=new de({props:{size:33,iconName:"export",description:"Export Profile",title:"Export Profile"}}),t.$on("iconClick",n[6]),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=A(r),F(t.$$.fragment,r)},m(r,s){B(e,r,s),I(r,l,s),B(t,r,s),i=!0},p(r,s){const o={};s&1030&&(o.$$scope={dirty:s,ctx:r}),e.$set(o)},i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){$(e.$$.fragment,r),$(t.$$.fragment,r),i=!1},d(r){r&&_(l),Z(e,r),Z(t,r)}}}function Fi(n){let e,l,t;return{c(){e=k("input"),this.h()},l(i){e=y(i,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){g(e,"type","file"),g(e,"id","file"),g(e,"name","file"),e.hidden=!0,g(e,"accept",".json")},m(i,r){I(i,e,r),n[8](e),l||(t=[te(e,"change",n[9]),te(e,"change",n[5])],l=!0)},p:Y,d(i){i&&_(e),n[8](null),l=!1,Ie(t)}}}function Ui(n){let e,l,t=!n[3].isReadonly&&dl(n);return{c(){t&&t.c(),e=Ee()},l(i){t&&t.l(i),e=Ee()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[3].isReadonly?t&&(ae(),$(t,1,1,()=>{t=null}),ce()):t?(t.p(i,r),r&8&&b(t,1)):(t=dl(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){$(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Gi(n,e,l){let t,i=Y,r=()=>(i(),i=We(s,p=>l(3,t=p)),s);n.$$.on_destroy.push(()=>i());let{store:s}=e;r();let{storeProp:o}=e,f,a;const c=()=>{f.click()},u=async()=>{const p=await f.files[0];if(p){let T;try{T=JSON.parse(await p.text())}catch(C){return alert("Unable to parse file"),console.error(C)}s.set(T),alert("Profile imported Successfully")}},d=()=>{const p=JSON.stringify(t),T=new Blob([p],{type:"application/json;charset=utf-8"});wn(T,"d3fend-profile.json")};function h(p){qe[p?"unshift":"push"](()=>{f=p,l(1,f)})}function m(){a=this.files,l(2,a)}return n.$$set=p=>{"store"in p&&r(l(0,s=p.store)),"storeProp"in p&&l(7,o=p.storeProp)},[s,f,a,t,c,u,d,o,h,m]}class Ki extends ge{constructor(e){super(),be(this,e,Gi,Ui,_e,{store:0,storeProp:7})}}const Ji=n=>({store:n&1}),hl=n=>({H:n[1],store:n[0]});function Wi(n){let e,l;const t=n[3].default,i=Fe(t,n,n[2],hl);return{c(){e=k("section"),i&&i.c(),this.h()},l(r){e=y(r,"SECTION",{id:!0,class:!0});var s=M(e);i&&i.l(s),s.forEach(_),this.h()},h(){g(e,"id","header--container"),g(e,"class","svelte-12ygfxa")},m(r,s){I(r,e,s),i&&i.m(e,null),l=!0},p(r,[s]){i&&i.p&&(!l||s&5)&&Ue(i,t,r,r[2],l?Ke(t,r[2],s,Ji):Ge(r[2]),hl)},i(r){l||(b(i,r),l=!0)},o(r){$(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function Qi(n,e,l){let{$$slots:t={},$$scope:i}=e,{store:r}=e;const s={ProfileButtons:Pi,ProfileSelect:Ai,MappingMode:Zi,ExportImport:Ki};return n.$$set=o=>{"store"in o&&l(0,r=o.store),"$$scope"in o&&l(2,i=o.$$scope)},[r,s,i,t]}class on extends ge{constructor(e){super(),be(this,e,Qi,Wi,_e,{store:0})}}function pl(n,e,l){const t=n.slice();return t[12]=e[l],t}function ml(n){let e,l=n[12].name+"",t;return{c(){e=k("option"),t=fe(l),this.h()},l(i){e=y(i,"OPTION",{});var r=M(e);t=ue(r,l),r.forEach(_),this.h()},h(){e.__value=n[12],Ve(e,e.__value)},m(i,r){I(i,e,r),v(e,t)},p:Y,d(i){i&&_(e)}}}function Xi(n){let e,l,t,i,r,s,o,f,a,c="NAME",u,d,h,m,p=`Select Capability from Templates...
          `,T,C,V,w=n[0].name+"",z,K,G,D,E,j,H,ee="Save",W,J,U="Cancel",Q,oe,S=Me(n[3]),P=[];for(let O=0;O<S.length;O+=1)P[O]=ml(pl(n,S,O));return{c(){e=k("section"),l=k("h2"),t=fe(n[1]),i=L(),r=k("hr"),s=L(),o=k("article"),f=k("div"),a=k("label"),a.textContent=c,u=L(),d=k("div"),h=k("select"),m=k("option"),m.textContent=p;for(let O=0;O<P.length;O+=1)P[O].c();T=L(),C=k("p"),V=fe("The Template Capability ("),z=fe(w),K=fe(`) will incorporate all
        associated Techniques.`),G=L(),D=k("hr"),E=L(),j=k("section"),H=k("button"),H.textContent=ee,W=L(),J=k("button"),J.textContent=U,this.h()},l(O){e=y(O,"SECTION",{id:!0,class:!0});var le=M(e);l=y(le,"H2",{class:!0});var re=M(l);t=ue(re,n[1]),re.forEach(_),i=A(le),r=y(le,"HR",{}),s=A(le),o=y(le,"ARTICLE",{id:!0});var N=M(o);f=y(N,"DIV",{id:!0,class:!0});var q=M(f);a=y(q,"LABEL",{"aria-label":!0,for:!0,class:!0,"data-svelte-h":!0}),we(a)!=="svelte-l4gr53"&&(a.textContent=c),u=A(q),d=y(q,"DIV",{id:!0,class:!0});var me=M(d);h=y(me,"SELECT",{id:!0,class:!0});var De=M(h);m=y(De,"OPTION",{"data-svelte-h":!0}),we(m)!=="svelte-1lnlsc6"&&(m.textContent=p);for(let Re=0;Re<P.length;Re+=1)P[Re].l(De);De.forEach(_),me.forEach(_),T=A(q),C=y(q,"P",{class:!0});var Le=M(C);V=ue(Le,"The Template Capability ("),z=ue(Le,w),K=ue(Le,`) will incorporate all
        associated Techniques.`),Le.forEach(_),q.forEach(_),G=A(N),D=y(N,"HR",{}),E=A(N),j=y(N,"SECTION",{id:!0,class:!0});var Oe=M(j);H=y(Oe,"BUTTON",{"data-svelte-h":!0}),we(H)!=="svelte-syg9fy"&&(H.textContent=ee),W=A(Oe),J=y(Oe,"BUTTON",{"data-svelte-h":!0}),we(J)!=="svelte-1alkrs9"&&(J.textContent=U),Oe.forEach(_),N.forEach(_),le.forEach(_),this.h()},h(){var O;g(l,"class","text-center"),g(a,"aria-label","Capability Name"),g(a,"for","capability-name"),g(a,"class","svelte-3ehrko"),m.selected=!0,m.disabled=!0,m.__value="",Ve(m,m.__value),g(h,"id","capability--select"),h.required=!0,g(h,"class","svelte-3ehrko"),n[0]===void 0&&Pe(()=>n[9].call(h)),g(d,"id","autocomplete"),g(d,"class","svelte-3ehrko"),g(C,"class","form-info svelte-3ehrko"),pe(C,"non--existing",!n[2].templates[(O=n[0])==null?void 0:O.id]),g(f,"id","layer-input-form"),g(f,"class","svelte-3ehrko"),g(j,"id","layer-btns"),g(j,"class","svelte-3ehrko"),g(o,"id","container-capability-form"),g(e,"id","dialog--container"),g(e,"class","svelte-3ehrko")},m(O,le){I(O,e,le),v(e,l),v(l,t),v(e,i),v(e,r),v(e,s),v(e,o),v(o,f),v(f,a),v(f,u),v(f,d),v(d,h),v(h,m);for(let re=0;re<P.length;re+=1)P[re]&&P[re].m(h,null);pt(h,n[0],!0),v(f,T),v(f,C),v(C,V),v(C,z),v(C,K),v(o,G),v(o,D),v(o,E),v(o,j),v(j,H),v(j,W),v(j,J),Q||(oe=[te(h,"change",n[9]),te(H,"click",n[4]),te(J,"click",n[5])],Q=!0)},p(O,[le]){var re;if(le&2&&Ne(t,O[1]),le&8){S=Me(O[3]);let N;for(N=0;N<S.length;N+=1){const q=pl(O,S,N);P[N]?P[N].p(q,le):(P[N]=ml(q),P[N].c(),P[N].m(h,null))}for(;N<P.length;N+=1)P[N].d(1);P.length=S.length}le&9&&pt(h,O[0]),le&1&&w!==(w=O[0].name+"")&&Ne(z,w),le&5&&pe(C,"non--existing",!O[2].templates[(re=O[0])==null?void 0:re.id])},i:Y,o:Y,d(O){O&&_(e),Xe(P,O),Q=!1,Ie(oe)}}}function Yi(n,e,l){let t;se(n,he,p=>l(2,t=p));let{dialog:i}=e,{title:r}=e,{selectedCapability:s=""}=e,{store:o}=e,{copyHandler:f}=e;const a=Ql(),c=Object.values(t.rootTemplates.map(p=>t.templates[p])),u=(p,T,C=[])=>{C.push(p);for(const V of(p==null?void 0:p.children)||[])u(T[V],T,C);return C},d=p=>{const T=u(s,o);f(T),a("closeModal",{dialog:i,dialogName:"copy"})},h=p=>{a("closeModal",{dialog:i,dialogName:"copy"})};function m(){s=Yl(this),l(0,s),l(3,c)}return n.$$set=p=>{"dialog"in p&&l(6,i=p.dialog),"title"in p&&l(1,r=p.title),"selectedCapability"in p&&l(0,s=p.selectedCapability),"store"in p&&l(7,o=p.store),"copyHandler"in p&&l(8,f=p.copyHandler)},[s,r,t,c,d,h,i,o,f,m]}class xi extends ge{constructor(e){super(),be(this,e,Yi,Xi,_e,{dialog:6,title:1,selectedCapability:0,store:7,copyHandler:8})}}function _l(n){let e,l,t,i,r,s,o;return{c(){e=k("button"),l=fe("Save Techniques"),t=L(),i=k("button"),r=fe("Remove"),this.h()},l(f){e=y(f,"BUTTON",{class:!0,title:!0});var a=M(e);l=ue(a,"Save Techniques"),a.forEach(_),t=A(f),i=y(f,"BUTTON",{class:!0,title:!0});var c=M(i);r=ue(c,"Remove"),c.forEach(_),this.h()},h(){g(e,"class","control-btn svelte-1sz3pl3"),e.disabled=n[1],g(e,"title","Save Techniques to currently highlighted Capabilities"),g(i,"class","control-btn svelte-1sz3pl3"),i.disabled=n[1],g(i,"title","Remove Techniques from currently highlighted Capabilities")},m(f,a){I(f,e,a),v(e,l),I(f,t,a),I(f,i,a),v(i,r),s||(o=[te(e,"click",n[8]),te(i,"click",n[9])],s=!0)},p(f,a){a&2&&(e.disabled=f[1]),a&2&&(i.disabled=f[1])},d(f){f&&(_(e),_(t),_(i)),s=!1,Ie(o)}}}function er(n){let e,l=!n[2].isReadonly&&_l(n);return{c(){e=k("div"),l&&l.c(),this.h()},l(t){e=y(t,"DIV",{id:!0,class:!0});var i=M(e);l&&l.l(i),i.forEach(_),this.h()},h(){g(e,"id","row-persist-btns"),g(e,"class","svelte-1sz3pl3")},m(t,i){I(t,e,i),l&&l.m(e,null)},p(t,[i]){t[2].isReadonly?l&&(l.d(1),l=null):l?l.p(t,i):(l=_l(t),l.c(),l.m(e,null))},i:Y,o:Y,d(t){t&&_(e),l&&l.d()}}}function tr(n,e,l){let t,i,r,s;se(n,he,h=>l(2,r=h)),se(n,ot,h=>l(3,s=h));let{selectedStore:o}=e;const{selected:f}=xe("profile-config");se(n,f,h=>l(0,i=h));const a=(h,m)=>{he.saveTechniques(h,m,o),ot.reset()},c=(h,m)=>{he.removeTechniques(h,m,o),ot.reset()},u=()=>a(s.treeMap,i),d=()=>c(s.treeMap,i);return n.$$set=h=>{"selectedStore"in h&&l(7,o=h.selectedStore)},n.$$.update=()=>{n.$$.dirty&1&&l(1,t=!Object.values(i).some(h=>h===ne.selected))},[i,t,r,s,f,a,c,o,u,d]}class sn extends ge{constructor(e){super(),be(this,e,tr,er,_e,{selectedStore:7})}}const lr=n=>({}),gl=n=>({});function bl(n){let e,l,t,i,r,s,o,f,a,c,u;const d=[ir,nr],h=[];function m(p,T){return p[2]?0:1}return s=m(n),o=h[s]=d[s](n),{c(){e=k("div"),l=k("div"),i=L(),r=k("div"),o.c(),this.h()},l(p){e=y(p,"DIV",{class:!0,role:!0,tabindex:!0,"aria-labelledby":!0,"aria-describedby":!0,style:!0});var T=M(e);l=y(T,"DIV",{class:!0,tabindex:!0,role:!0}),M(l).forEach(_),i=A(T),r=y(T,"DIV",{class:!0,role:!0,tabindex:!0});var C=M(r);o.l(C),C.forEach(_),T.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-1xtgwr8"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-1xtgwr8"),g(r,"role","button"),g(r,"tabindex","0"),g(e,"class","popover svelte-1xtgwr8"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-labelledby","Chart"),g(e,"aria-describedby","Description"),Te(e,"--popover-y",n[5].top+"px"),Te(e,"--popover-right",n[5].right+10+"px"),Te(e,"--color-icon",n[1])},m(p,T){I(p,e,T),v(e,l),v(e,i),v(e,r),h[s].m(r,null),a=!0,c||(u=[te(l,"click",xl(n[8])),te(r,"mouseleave",n[7])],c=!0)},p(p,T){let C=s;s=m(p),s===C?h[s].p(p,T):(ae(),$(h[C],1,1,()=>{h[C]=null}),ce(),o=h[s],o?o.p(p,T):(o=h[s]=d[s](p),o.c()),b(o,1),o.m(r,null)),(!a||T&32)&&Te(e,"--popover-y",p[5].top+"px"),(!a||T&32)&&Te(e,"--popover-right",p[5].right+10+"px"),(!a||T&2)&&Te(e,"--color-icon",p[1])},i(p){a||(p&&Pe(()=>{a&&(t||(t=je(l,He,{delay:25,duration:150},!0)),t.run(1))}),b(o),p&&Pe(()=>{a&&(f||(f=je(e,He,{duration:150},!0)),f.run(1))}),a=!0)},o(p){p&&(t||(t=je(l,He,{delay:25,duration:150},!1)),t.run(0)),$(o),p&&(f||(f=je(e,He,{duration:150},!1)),f.run(0)),a=!1},d(p){p&&_(e),p&&t&&t.end(),h[s].d(),p&&f&&f.end(),c=!1,Ie(u)}}}function nr(n){let e,l,t,i,r,s,o,f,a,c,u;return f=new de({props:{size:33,iconName:"edit",description:"Edit Description",title:"Edit Description",pathColor:"black"}}),{c(){e=k("div"),l=k("pre"),t=fe(n[3]),r=L(),s=k("div"),o=k("span"),R(f.$$.fragment),this.h()},l(d){e=y(d,"DIV",{class:!0,id:!0});var h=M(e);l=y(h,"PRE",{class:!0});var m=M(l);t=ue(m,n[3]),m.forEach(_),h.forEach(_),r=A(d),s=y(d,"DIV",{class:!0,role:!0,tabindex:!0});var p=M(s);o=y(p,"SPAN",{});var T=M(o);F(f.$$.fragment,T),T.forEach(_),p.forEach(_),this.h()},h(){g(l,"class","popover-text svelte-1xtgwr8"),g(e,"class","popover-description svelte-1xtgwr8"),g(e,"id",i=n[0].id),g(s,"class","edit-btn svelte-1xtgwr8"),g(s,"role","button"),g(s,"tabindex","0")},m(d,h){I(d,e,h),v(e,l),v(l,t),I(d,r,h),I(d,s,h),v(s,o),B(f,o,null),a=!0,c||(u=[te(s,"click",n[9]),te(s,"keyup",null)],c=!0)},p(d,h){(!a||h&8)&&Ne(t,d[3]),(!a||h&1&&i!==(i=d[0].id))&&g(e,"id",i)},i(d){a||(b(f.$$.fragment,d),a=!0)},o(d){$(f.$$.fragment,d),a=!1},d(d){d&&(_(e),_(r),_(s)),Z(f),c=!1,Ie(u)}}}function ir(n){let e,l,t,i,r,s,o,f,a,c,u;return s=new de({props:{size:33,iconName:"check",description:"Save Description",title:"Save Description"}}),s.$on("iconClick",n[10]),f=new de({props:{size:33,iconName:"close",description:"close",title:"close"}}),f.$on("iconClick",n[11]),{c(){e=k("div"),l=k("textarea"),i=L(),r=k("div"),R(s.$$.fragment),o=L(),R(f.$$.fragment),this.h()},l(d){e=y(d,"DIV",{class:!0,id:!0});var h=M(e);l=y(h,"TEXTAREA",{id:!0,name:!0,class:!0}),M(l).forEach(_),h.forEach(_),i=A(d),r=y(d,"DIV",{class:!0});var m=M(r);F(s.$$.fragment,m),o=A(m),F(f.$$.fragment,m),m.forEach(_),this.h()},h(){g(l,"id","layer-description"),g(l,"name","Description"),g(l,"class","layer-description svelte-1xtgwr8"),l.required=!0,g(e,"class","popover-description svelte-1xtgwr8"),g(e,"id",t=n[0].id),g(r,"class","popover-btns svelte-1xtgwr8")},m(d,h){I(d,e,h),v(e,l),Ve(l,n[3]),I(d,i,h),I(d,r,h),B(s,r,null),v(r,o),B(f,r,null),a=!0,c||(u=te(l,"input",n[14]),c=!0)},p(d,h){h&8&&Ve(l,d[3]),(!a||h&1&&t!==(t=d[0].id))&&g(e,"id",t)},i(d){a||(b(s.$$.fragment,d),b(f.$$.fragment,d),a=!0)},o(d){$(s.$$.fragment,d),$(f.$$.fragment,d),a=!1},d(d){d&&(_(e),_(i),_(r)),Z(s),Z(f),c=!1,u()}}}function rr(n){let e,l,t,i,r,s;const o=n[13].popoverHover,f=Fe(o,n,n[12],gl);let a=(n[4]||n[2])&&bl(n);return{c(){e=k("div"),f&&f.c(),l=L(),a&&a.c(),t=Ee(),this.h()},l(c){e=y(c,"DIV",{role:!0});var u=M(e);f&&f.l(u),u.forEach(_),l=A(c),a&&a.l(c),t=Ee(),this.h()},h(){g(e,"role","button")},m(c,u){I(c,e,u),f&&f.m(e,null),I(c,l,u),a&&a.m(c,u),I(c,t,u),i=!0,r||(s=te(e,"click",n[6]),r=!0)},p(c,[u]){f&&f.p&&(!i||u&4096)&&Ue(f,o,c,c[12],i?Ke(o,c[12],u,lr):Ge(c[12]),gl),c[4]||c[2]?a?(a.p(c,u),u&20&&b(a,1)):(a=bl(c),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(ae(),$(a,1,1,()=>{a=null}),ce())},i(c){i||(b(f,c),b(a),i=!0)},o(c){$(f,c),$(a),i=!1},d(c){c&&(_(e),_(l),_(t)),f&&f.d(c),a&&a.d(c),r=!1,s()}}}const vt=et(null),$t=et(!1),ct=et(!1),vl=et({}),Ct=et({});let ht;const or=n=>(n==null?void 0:n.getBoundingClientRect())??{bottom:0,left:0};function sr(n,e,l){let t,i,r,s,o;se(n,ct,w=>l(2,t=w)),se(n,Ct,w=>l(3,i=w)),se(n,$t,w=>l(4,r=w)),se(n,vt,w=>l(15,s=w)),se(n,vl,w=>l(5,o=w));let{$$slots:f={},$$scope:a}=e,{item:c}=e,{color:u}=e;const d=w=>{clearTimeout(ht),ht=setTimeout(()=>{X(vt,s=c.id,s),X(vl,o=or(w.target),o),X($t,r=!0,r),X(Ct,i=c.description,i)},500)},h=w=>{clearTimeout(ht),ht=setTimeout(()=>{m()},1e3)},m=()=>{X(vt,s=null,s),X($t,r=!1,r),X(ct,t=!1,t)},p=()=>{X(ct,t=!0,t)},T=w=>{he.editDescription(c.id,i),X(ct,t=!1,t)},C=()=>{X(ct,t=!1,t),m()};function V(){i=this.value,Ct.set(i)}return n.$$set=w=>{"item"in w&&l(0,c=w.item),"color"in w&&l(1,u=w.color),"$$scope"in w&&l(12,a=w.$$scope)},[c,u,t,i,r,o,d,h,m,p,T,C,a,f,V]}class an extends ge{constructor(e){super(),be(this,e,sr,rr,_e,{item:0,color:1})}}const cn=n=>{n.focus()};function ar(n){let e;return{c(){e=k("div"),this.h()},l(l){e=y(l,"DIV",{class:!0}),M(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-yvn279")},m(l,t){I(l,e,t)},p:Y,i:Y,o:Y,d(l){l&&_(e)}}}function cr(n){let e,l,t;return l=new de({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[19]),{c(){e=k("div"),R(l.$$.fragment),this.h()},l(i){e=y(i,"DIV",{class:!0});var r=M(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-yvn279"),pe(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),B(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&pe(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&_(e),Z(l)}}}function fr(n){let e,l=n[0].name+"",t,i,r;return{c(){e=k("span"),t=fe(l),this.h()},l(s){e=y(s,"SPAN",{class:!0,tabindex:!0,role:!0});var o=M(e);t=ue(o,l),o.forEach(_),this.h()},h(){var s;g(e,"class","layer-text svelte-yvn279"),g(e,"tabindex","0"),g(e,"role","button"),pe(e,"root-layer",((s=n[0].children)==null?void 0:s.length)>0)},m(s,o){I(s,e,o),v(e,t),i||(r=[te(e,"click",n[23]),te(e,"keydown",n[24])],i=!0)},p(s,o){var f;o[0]&1&&l!==(l=s[0].name+"")&&Ne(t,l),o[0]&1&&pe(e,"root-layer",((f=s[0].children)==null?void 0:f.length)>0)},d(s){s&&_(e),i=!1,Ie(r)}}}function ur(n){let e,l,t;return{c(){e=k("input"),this.h()},l(i){e=y(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-yvn279")},m(i,r){I(i,e,r),Ve(e,n[6]),l||(t=[en(cn.call(null,e)),te(e,"input",n[21]),te(e,"keydown",nt(n[22]))],l=!0)},p(i,r){r[0]&64&&e.value!==i[6]&&Ve(e,i[6])},d(i){i&&_(e),l=!1,Ie(t)}}}function dr(n){let e,l,t,i,r,s;return l=new de({props:{size:mt,iconName:"check",description:"Edit Capability",title:"Edit Capability"}}),l.$on("iconClick",n[31]),i=new de({props:{size:mt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[32]),{c(){e=k("div"),R(l.$$.fragment),t=L(),R(i.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var f=M(e);F(l.$$.fragment,f),t=A(f),F(i.$$.fragment,f),f.forEach(_),this.h()},h(){g(e,"class","element-form-btns svelte-yvn279")},m(o,f){I(o,e,f),B(l,e,null),v(e,t),B(i,e,null),s=!0},p:Y,i(o){s||(b(l.$$.fragment,o),b(i.$$.fragment,o),o&&(r||Pe(()=>{r=it(e,ut,{duration:700,delay:100,axis:"x",x:10}),r.start()})),s=!0)},o(o){$(l.$$.fragment,o),$(i.$$.fragment,o),s=!1},d(o){o&&_(e),Z(l),Z(i)}}}function hr(n){let e,l,t,i,r,s,o,f,a,c,u;l=new de({props:{size:Ae,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[25]),i=new de({props:{size:Ae,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[26]),s=new de({props:{size:Ae,iconName:"delete",description:"Delete Capability and Children",title:"Delete Capability and Children"}}),s.$on("iconClick",n[27]),f=new an({props:{item:n[0],color:n[0].color,$$slots:{popoverHover:[pr]},$$scope:{ctx:n}}});let d=n[8].techniqueMappingMode!==ve.heatMap&&$l(n);return{c(){e=k("div"),R(l.$$.fragment),t=L(),R(i.$$.fragment),r=L(),R(s.$$.fragment),o=L(),R(f.$$.fragment),a=L(),d&&d.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var m=M(e);F(l.$$.fragment,m),t=A(m),F(i.$$.fragment,m),r=A(m),F(s.$$.fragment,m),o=A(m),F(f.$$.fragment,m),a=A(m),d&&d.l(m),m.forEach(_),this.h()},h(){g(e,"class","element-btns svelte-yvn279")},m(h,m){I(h,e,m),B(l,e,null),v(e,t),B(i,e,null),v(e,r),B(s,e,null),v(e,o),B(f,e,null),v(e,a),d&&d.m(e,null),u=!0},p(h,m){const p={};m[0]&1&&(p.item=h[0]),m[0]&1&&(p.color=h[0].color),m[1]&4&&(p.$$scope={dirty:m,ctx:h}),f.$set(p),h[8].techniqueMappingMode!==ve.heatMap?d?(d.p(h,m),m[0]&256&&b(d,1)):(d=$l(h),d.c(),b(d,1),d.m(e,null)):d&&(ae(),$(d,1,1,()=>{d=null}),ce())},i(h){u||(b(l.$$.fragment,h),b(i.$$.fragment,h),b(s.$$.fragment,h),b(f.$$.fragment,h),b(d),h&&(c||Pe(()=>{c=it(e,ut,{axis:"x",duration:100,x:-10}),c.start()})),u=!0)},o(h){$(l.$$.fragment,h),$(i.$$.fragment,h),$(s.$$.fragment,h),$(f.$$.fragment,h),$(d),u=!1},d(h){h&&_(e),Z(l),Z(i),Z(s),Z(f),d&&d.d()}}}function pr(n){let e,l;return e=new de({props:{size:Ae,iconName:"infoOutline",slot:"popoverHover"}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p:Y,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function $l(n){let e,l,t,i,r,s,o;return e=new de({props:{size:Ae,iconName:"color picker",description:"Pick Capability Family Color",title:"Pick Capability Family Color"}}),e.$on("iconClick",n[28]),{c(){R(e.$$.fragment),l=L(),t=k("input"),this.h()},l(f){F(e.$$.fragment,f),l=A(f),t=y(f,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,Te(t,"display","none")},m(f,a){B(e,f,a),I(f,l,a),I(f,t,a),n[29](t),r=!0,s||(o=te(t,"change",$n(xl(n[30]))),s=!0)},p(f,a){(!r||a[0]&1&&i!==(i=f[0].color))&&(t.value=i)},i(f){r||(b(e.$$.fragment,f),r=!0)},o(f){$(e.$$.fragment,f),r=!1},d(f){f&&(_(l),_(t)),Z(e,f),n[29](null),s=!1,o()}}}function mr(n){let e,l,t,i,r,s,o,f,a,c,u,d,h,m;const p=[cr,ar],T=[];function C(E,j){return E[4]?0:1}l=C(n),t=T[l]=p[l](n);function V(E,j){return E[7][E[0].id]===ne.editing?ur:fr}let w=V(n),z=w(n);const K=[hr,dr],G=[];function D(E,j){return E[7][E[0].id]===ne.selected||E[7][E[0].id]===ne.root?0:E[7][E[0].id]===ne.editing?1:-1}return~(c=D(n))&&(u=G[c]=K[c](n)),{c(){e=k("div"),t.c(),i=L(),r=k("form"),s=k("input"),f=L(),z.c(),a=L(),u&&u.c(),this.h()},l(E){e=y(E,"DIV",{class:!0,style:!0});var j=M(e);t.l(j),i=A(j),r=y(j,"FORM",{});var H=M(r);s=y(H,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0,style:!0}),H.forEach(_),f=A(j),z.l(j),a=A(j),u&&u.l(j),j.forEach(_),this.h()},h(){var E,j,H;g(s,"class","check-box svelte-yvn279"),g(s,"type","checkbox"),g(s,"name","include"),s.checked=o=(E=n[0])==null?void 0:E.checked,g(s,"tabindex","0"),Te(s,"accent-color",_t[n[8].techniqueMappingMode]({root:n[0],element:n[0]})),g(e,"class","layer-parent svelte-yvn279"),Te(e,"--expanded-width",Ae+"px"),pe(e,"selected-layer",n[7][n[0].id]===ne.selected),pe(e,"layer-hover",!((H=(j=n[0])==null?void 0:j.children)!=null&&H.length))},m(E,j){I(E,e,j),T[l].m(e,null),v(e,i),v(e,r),v(r,s),v(e,f),z.m(e,null),v(e,a),~c&&G[c].m(e,null),d=!0,h||(m=te(s,"click",nt(n[20])),h=!0)},p(E,j){var W,J,U;let H=l;l=C(E),l===H?T[l].p(E,j):(ae(),$(T[H],1,1,()=>{T[H]=null}),ce(),t=T[l],t?t.p(E,j):(t=T[l]=p[l](E),t.c()),b(t,1),t.m(e,i)),(!d||j[0]&1&&o!==(o=(W=E[0])==null?void 0:W.checked))&&(s.checked=o),(!d||j[0]&257)&&Te(s,"accent-color",_t[E[8].techniqueMappingMode]({root:E[0],element:E[0]})),w===(w=V(E))&&z?z.p(E,j):(z.d(1),z=w(E),z&&(z.c(),z.m(e,a)));let ee=c;c=D(E),c===ee?~c&&G[c].p(E,j):(u&&(ae(),$(G[ee],1,1,()=>{G[ee]=null}),ce()),~c?(u=G[c],u?u.p(E,j):(u=G[c]=K[c](E),u.c()),b(u,1),u.m(e,null)):u=null),(!d||j[0]&129)&&pe(e,"selected-layer",E[7][E[0].id]===ne.selected),(!d||j[0]&1)&&pe(e,"layer-hover",!((U=(J=E[0])==null?void 0:J.children)!=null&&U.length))},i(E){d||(b(t),b(u),d=!0)},o(E){$(t),$(u),d=!1},d(E){E&&_(e),T[l].d(),z.d(),~c&&G[c].d(),h=!1,m()}}}function _r(n,e,l){let t,i,r,s,o=Y,f=()=>(o(),o=We(u,N=>l(8,s=N)),u),a;n.$$.on_destroy.push(()=>o());let{element:c}=e,{store:u}=e;f();let{storeProp:d}=e,{handlers:h}=e,{expandable:m}=e;const{expanded:p,selected:T,editingName:C,colorPicker:V}=xe("profile-config");se(n,p,N=>l(9,a=N)),se(n,T,N=>l(7,r=N)),se(n,C,N=>l(6,i=N)),se(n,V,N=>l(5,t=N));const w=(N,q)=>{X(p,a[q.id]=!a[q.id],a)},z=(N,q)=>{var De;const me=q===void 0?s[d][N.id].checked:q;if(X(u,s[d][N.id].checked=!me,s),!!((De=N==null?void 0:N.children)!=null&&De.length))for(const Le of N.children)z(s[d][Le],me)},K=(N,q,me)=>{N.detail.event.stopPropagation(),X(T,r[q.id]=ne.editing,r),X(T,r[me.id]=ne.noop,r),X(C,i=q.name,i)},G=(N,q)=>{t[q.id].click()},D=(N,q,me)=>{u.saveLayerColor(q,N.srcElement.value,me)},E=N=>w(N,c),j=N=>z(c);function H(){i=this.value,C.set(i)}const ee=N=>lt(N,h.saveCapabilityName,c.id,i,d),W=N=>h.selectLayer(N,c,c.children.length!==0),J=N=>lt(N,h.selectLayer,c,c.children.length!==0),U=N=>h.showCreateLayerDialog(N,c,null),Q=N=>K(N,c,parent),oe=N=>h.deleteCapability(c),S=N=>G(N,c);function P(N){qe[N?"unshift":"push"](()=>{t[c.id]=N,V.set(t)})}const O=N=>D(N,c,d),le=N=>h.saveCapabilityName(c.id,null,i,d),re=N=>h.cancelEdit(N,c);return n.$$set=N=>{"element"in N&&l(0,c=N.element),"store"in N&&f(l(1,u=N.store)),"storeProp"in N&&l(2,d=N.storeProp),"handlers"in N&&l(3,h=N.handlers),"expandable"in N&&l(4,m=N.expandable)},[c,u,d,h,m,t,i,r,s,a,p,T,C,V,w,z,K,G,D,E,j,H,ee,W,J,U,Q,oe,S,P,O,le,re]}class gr extends ge{constructor(e){super(),be(this,e,_r,mr,_e,{element:0,store:1,storeProp:2,handlers:3,expandable:4},null,[-1,-1])}}function br(n){let e;return{c(){e=k("div"),this.h()},l(l){e=y(l,"DIV",{class:!0}),M(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-18ybwtj")},m(l,t){I(l,e,t)},p:Y,i:Y,o:Y,d(l){l&&_(e)}}}function vr(n){let e,l,t;return l=new de({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[19]),{c(){e=k("div"),R(l.$$.fragment),this.h()},l(i){e=y(i,"DIV",{class:!0});var r=M(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-18ybwtj"),pe(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),B(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&pe(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&_(e),Z(l)}}}function $r(n){let e,l=n[0].name+"",t,i,r;return{c(){e=k("span"),t=fe(l),this.h()},l(s){e=y(s,"SPAN",{class:!0,tabindex:!0,role:!0});var o=M(e);t=ue(o,l),o.forEach(_),this.h()},h(){g(e,"class","layer-text svelte-18ybwtj"),g(e,"tabindex","0"),g(e,"role","button")},m(s,o){I(s,e,o),v(e,t),i||(r=[te(e,"click",n[24]),te(e,"keydown",nt(n[25]))],i=!0)},p(s,o){o[0]&1&&l!==(l=s[0].name+"")&&Ne(t,l)},d(s){s&&_(e),i=!1,Ie(r)}}}function Cr(n){let e,l,t;return{c(){e=k("input"),this.h()},l(i){e=y(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-18ybwtj")},m(i,r){I(i,e,r),Ve(e,n[11]),l||(t=[en(cn.call(null,e)),te(e,"input",n[22]),te(e,"keydown",nt(n[23]))],l=!0)},p(i,r){r[0]&2048&&e.value!==i[11]&&Ve(e,i[11])},d(i){i&&_(e),l=!1,Ie(t)}}}function kr(n){let e,l,t,i,r,s;return l=new de({props:{size:mt,iconName:"check",description:"Save Capability",title:"Save Capability"}}),l.$on("iconClick",n[32]),i=new de({props:{size:mt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[33]),{c(){e=k("div"),R(l.$$.fragment),t=L(),R(i.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var f=M(e);F(l.$$.fragment,f),t=A(f),F(i.$$.fragment,f),f.forEach(_),this.h()},h(){g(e,"class","element-form-btns svelte-18ybwtj")},m(o,f){I(o,e,f),B(l,e,null),v(e,t),B(i,e,null),s=!0},p:Y,i(o){s||(b(l.$$.fragment,o),b(i.$$.fragment,o),o&&(r||Pe(()=>{r=it(e,ut,{duration:700,delay:100,axis:"x",x:10}),r.start()})),s=!0)},o(o){$(l.$$.fragment,o),$(i.$$.fragment,o),s=!1},d(o){o&&_(e),Z(l),Z(i)}}}function yr(n){let e,l,t,i,r,s,o,f,a,c,u;l=new de({props:{size:Ae,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[26]),i=new de({props:{size:Ae,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[27]),s=new de({props:{size:28,iconName:"delete",description:"Delete Capability",title:"Delete Capability"}}),s.$on("iconClick",n[28]),f=new an({props:{item:n[0],color:n[0].color,$$slots:{popoverHover:[Tr]},$$scope:{ctx:n}}});let d=n[8].techniqueMappingMode!==ve.heatMap&&Cl(n);return{c(){e=k("div"),R(l.$$.fragment),t=L(),R(i.$$.fragment),r=L(),R(s.$$.fragment),o=L(),R(f.$$.fragment),a=L(),d&&d.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var m=M(e);F(l.$$.fragment,m),t=A(m),F(i.$$.fragment,m),r=A(m),F(s.$$.fragment,m),o=A(m),F(f.$$.fragment,m),a=A(m),d&&d.l(m),m.forEach(_),this.h()},h(){g(e,"class","element-btns svelte-18ybwtj")},m(h,m){I(h,e,m),B(l,e,null),v(e,t),B(i,e,null),v(e,r),B(s,e,null),v(e,o),B(f,e,null),v(e,a),d&&d.m(e,null),u=!0},p(h,m){const p={};m[0]&1&&(p.item=h[0]),m[0]&1&&(p.color=h[0].color),m[1]&8&&(p.$$scope={dirty:m,ctx:h}),f.$set(p),h[8].techniqueMappingMode!==ve.heatMap?d?(d.p(h,m),m[0]&256&&b(d,1)):(d=Cl(h),d.c(),b(d,1),d.m(e,null)):d&&(ae(),$(d,1,1,()=>{d=null}),ce())},i(h){u||(b(l.$$.fragment,h),b(i.$$.fragment,h),b(s.$$.fragment,h),b(f.$$.fragment,h),b(d),h&&(c||Pe(()=>{c=it(e,ut,{axis:"x",duration:200,x:-5}),c.start()})),u=!0)},o(h){$(l.$$.fragment,h),$(i.$$.fragment,h),$(s.$$.fragment,h),$(f.$$.fragment,h),$(d),u=!1},d(h){h&&_(e),Z(l),Z(i),Z(s),Z(f),d&&d.d()}}}function Tr(n){let e,l;return e=new de({props:{size:Ae,iconName:"infoOutline",slot:"popoverHover"}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p:Y,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Cl(n){let e,l,t,i,r,s,o;return e=new de({props:{size:Ae,iconName:"color picker",description:"Pick Capability Color",title:"Pick Capability Color"}}),e.$on("iconClick",n[29]),{c(){R(e.$$.fragment),l=L(),t=k("input"),this.h()},l(f){F(e.$$.fragment,f),l=A(f),t=y(f,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,Te(t,"display","none")},m(f,a){B(e,f,a),I(f,l,a),I(f,t,a),n[30](t),r=!0,s||(o=te(t,"change",n[31]),s=!0)},p(f,a){(!r||a[0]&1&&i!==(i=f[0].color))&&(t.value=i)},i(f){r||(b(e.$$.fragment,f),r=!0)},o(f){$(e.$$.fragment,f),r=!1},d(f){f&&(_(l),_(t)),Z(e,f),n[30](null),s=!1,o()}}}function wr(n){let e,l,t,i,r,s,o,f,a,c,u,d,h;const m=[vr,br],p=[];function T(D,E){return D[6]?0:1}l=T(n),t=p[l]=m[l](n);function C(D,E){return D[10][D[0].id]===ne.editing?Cr:$r}let V=C(n),w=V(n);const z=[yr,kr],K=[];function G(D,E){return D[10][D[0].id]===ne.selected?0:D[10][D[0].id]===ne.editing?1:-1}return~(a=G(n))&&(c=K[a]=z[a](n)),{c(){e=k("div"),t.c(),i=L(),r=k("input"),o=L(),w.c(),f=L(),c&&c.c(),this.h()},l(D){e=y(D,"DIV",{class:!0,style:!0});var E=M(e);t.l(E),i=A(E),r=y(E,"INPUT",{class:!0,type:!0,name:!0,style:!0}),o=A(E),w.l(E),f=A(E),c&&c.l(E),E.forEach(_),this.h()},h(){var D;g(r,"class","check-box svelte-18ybwtj"),g(r,"type","checkbox"),g(r,"name","include"),r.checked=s=(D=n[0])==null?void 0:D.checked,Te(r,"accent-color",_t[n[8].techniqueMappingMode]({root:n[2],element:n[0]})),g(e,"class","layer-child layer-hover svelte-18ybwtj"),Te(e,"--expanded-icon-width",Ae+"px"),pe(e,"selected-layer",n[10][n[0].id]===ne.selected)},m(D,E){I(D,e,E),p[l].m(e,null),v(e,i),v(e,r),v(e,o),w.m(e,null),v(e,f),~a&&K[a].m(e,null),u=!0,d||(h=[te(r,"click",nt(n[20])),te(r,"keydown",n[21])],d=!0)},p(D,E){var ee;let j=l;l=T(D),l===j?p[l].p(D,E):(ae(),$(p[j],1,1,()=>{p[j]=null}),ce(),t=p[l],t?t.p(D,E):(t=p[l]=m[l](D),t.c()),b(t,1),t.m(e,i)),(!u||E[0]&1&&s!==(s=(ee=D[0])==null?void 0:ee.checked))&&(r.checked=s),(!u||E[0]&261)&&Te(r,"accent-color",_t[D[8].techniqueMappingMode]({root:D[2],element:D[0]})),V===(V=C(D))&&w?w.p(D,E):(w.d(1),w=V(D),w&&(w.c(),w.m(e,f)));let H=a;a=G(D),a===H?~a&&K[a].p(D,E):(c&&(ae(),$(K[H],1,1,()=>{K[H]=null}),ce()),~a?(c=K[a],c?c.p(D,E):(c=K[a]=z[a](D),c.c()),b(c,1),c.m(e,null)):c=null),(!u||E[0]&1025)&&pe(e,"selected-layer",D[10][D[0].id]===ne.selected)},i(D){u||(b(t),b(c),u=!0)},o(D){$(t),$(c),u=!1},d(D){D&&_(e),p[l].d(),w.d(),~a&&K[a].d(),d=!1,Ie(h)}}}function Er(n,e,l){let t,i,r=Y,s=()=>(r(),r=We(h,q=>l(8,i=q)),h),o,f,a;n.$$.on_destroy.push(()=>r());let{element:c}=e,{parent:u}=e,{root:d}=e,{store:h}=e;s();let{storeProp:m}=e,{handlers:p}=e,{expandable:T}=e;const{expanded:C,selected:V,editingName:w,colorPicker:z}=xe("profile-config");se(n,C,q=>l(9,o=q)),se(n,V,q=>l(10,f=q)),se(n,w,q=>l(11,a=q)),se(n,z,q=>l(7,t=q));const K=(q,me)=>{X(C,o[me.id]=!o[me.id],o)},G=q=>{const me=i[m][q.id].checked;X(h,i[m][q.id].checked=!me,i)},D=(q,me)=>{t[me.id].click()},E=q=>K(q,c),j=q=>G(c),H=q=>lt(q,G,c);function ee(){a=this.value,w.set(a)}const W=q=>lt(q,p.saveCapabilityName,c.id,d,a,m),J=q=>p.selectLayer(q,c,!1,d),U=q=>lt(q,p.selectLayer,c,!1,d),Q=q=>p.showCreateLayerDialog(q,c,d),oe=q=>p.editCapability(q,c,u),S=q=>p.deleteChildCapability(c,u,m),P=q=>D(q,c);function O(q){qe[q?"unshift":"push"](()=>{t[c.id]=q,z.set(t)})}const le=q=>p.updateCapabilityColor(q,c,m),re=q=>p.saveCapabilityName(c.id,d,a,m),N=q=>p.cancelEdit(q,c);return n.$$set=q=>{"element"in q&&l(0,c=q.element),"parent"in q&&l(1,u=q.parent),"root"in q&&l(2,d=q.root),"store"in q&&s(l(3,h=q.store)),"storeProp"in q&&l(4,m=q.storeProp),"handlers"in q&&l(5,p=q.handlers),"expandable"in q&&l(6,T=q.expandable)},[c,u,d,h,m,p,T,t,i,o,f,a,C,V,w,z,K,G,D,E,j,H,ee,W,J,U,Q,oe,S,P,O,le,re,N]}class Ir extends ge{constructor(e){super(),be(this,e,Er,wr,_e,{element:0,parent:1,root:2,store:3,storeProp:4,handlers:5,expandable:6},null,[-1,-1])}}function kl(n){let e,l,t,i,r,s;return l=new de({props:{size:Ae,iconName:"info",description:"Technique Info",title:"Technique Info"}}),l.$on("iconClick",n[10]),i=new de({props:{size:Ae,iconName:"ATT&CK",description:"Edit ATT&CK Associations",title:"Edit ATT&CK Associations"}}),i.$on("iconClick",n[11]),{c(){e=k("div"),R(l.$$.fragment),t=L(),R(i.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var f=M(e);F(l.$$.fragment,f),t=A(f),F(i.$$.fragment,f),f.forEach(_),this.h()},h(){g(e,"class","element-btns svelte-18ybwtj")},m(o,f){I(o,e,f),B(l,e,null),v(e,t),B(i,e,null),s=!0},p:Y,i(o){s||(b(l.$$.fragment,o),b(i.$$.fragment,o),o&&(r||Pe(()=>{r=it(e,ut,{axis:"x",duration:200,x:-5}),r.start()})),s=!0)},o(o){$(l.$$.fragment,o),$(i.$$.fragment,o),s=!1},d(o){o&&_(e),Z(l),Z(i)}}}function Mr(n){var c;let e,l,t=((c=n[5].treeMap)==null?void 0:c[n[0]]["rdfs:label"])+"",i,r,s,o,f,a=n[4]===n[0]&&kl(n);return{c(){e=k("li"),l=k("span"),i=fe(t),r=L(),a&&a.c(),this.h()},l(u){e=y(u,"LI",{class:!0});var d=M(e);l=y(d,"SPAN",{class:!0,tabindex:!0,role:!0});var h=M(l);i=ue(h,t),h.forEach(_),r=A(d),a&&a.l(d),d.forEach(_),this.h()},h(){g(l,"class","layer-text d3fend-technique svelte-18ybwtj"),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-child layer-technique svelte-18ybwtj"),pe(e,"selected-layer",n[4]===n[0])},m(u,d){I(u,e,d),v(e,l),v(l,i),v(e,r),a&&a.m(e,null),s=!0,o||(f=[te(l,"click",n[8]),te(l,"keydown",nt(n[9]))],o=!0)},p(u,[d]){var h;(!s||d&33)&&t!==(t=((h=u[5].treeMap)==null?void 0:h[u[0]]["rdfs:label"])+"")&&Ne(i,t),u[4]===u[0]?a?(a.p(u,d),d&17&&b(a,1)):(a=kl(u),a.c(),b(a,1),a.m(e,null)):a&&(ae(),$(a,1,1,()=>{a=null}),ce()),(!s||d&17)&&pe(e,"selected-layer",u[4]===u[0])},i(u){s||(b(a),s=!0)},o(u){$(a),s=!1},d(u){u&&_(e),a&&a.d(),o=!1,Ie(f)}}}function Nr(n,e,l){let t,i=Y,r=()=>(i(),i=We(a,C=>l(4,t=C)),a),s;se(n,ot,C=>l(5,s=C)),n.$$.on_destroy.push(()=>i());let{techniqueId:o}=e,{element:f}=e,{selectedTechnique:a}=e;r();let{handlers:c}=e;const u=(C,V)=>{t===V?X(a,t=null,t):X(a,t=V,t)},d=C=>{En(`/profile/?technique_id=${C}`)},h=C=>u(C,o),m=C=>lt(C,u,o),p=C=>d(o),T=C=>c.openAttackDialog(C,o,f.id,f.color);return n.$$set=C=>{"techniqueId"in C&&l(0,o=C.techniqueId),"element"in C&&l(1,f=C.element),"selectedTechnique"in C&&r(l(2,a=C.selectedTechnique)),"handlers"in C&&l(3,c=C.handlers)},[o,f,a,c,t,s,u,d,h,m,p,T]}class Pr extends ge{constructor(e){super(),be(this,e,Nr,Mr,_e,{techniqueId:0,element:1,selectedTechnique:2,handlers:3})}}function yl(n,e,l){const t=n.slice();return t[10]=e[l],t}function Tl(n){let e,l,t,i=Me(n[2]),r=[];for(let o=0;o<i.length;o+=1)r[o]=wl(yl(n,i,o));const s=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=k("ul");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=y(o,"UL",{class:!0});var f=M(e);for(let a=0;a<r.length;a+=1)r[a].l(f);f.forEach(_),this.h()},h(){g(e,"class","svelte-10tthkv")},m(o,f){I(o,e,f);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,f){if(f&79){i=Me(o[2]);let a;for(a=0;a<i.length;a+=1){const c=yl(o,i,a);r[a]?(r[a].p(c,f),b(r[a],1)):(r[a]=wl(c),r[a].c(),b(r[a],1),r[a].m(e,null))}for(ae(),a=i.length;a<r.length;a+=1)s(a);ce()}},i(o){if(!t){for(let f=0;f<i.length;f+=1)b(r[f]);o&&Pe(()=>{t&&(l||(l=je(e,tt,{duration:200},!0)),l.run(1))}),t=!0}},o(o){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)$(r[f]);o&&(l||(l=je(e,tt,{duration:200},!1)),l.run(0)),t=!1},d(o){o&&_(e),Xe(r,o),o&&l&&l.end()}}}function wl(n){let e,l;return e=new Pr({props:{techniqueId:n[10],root:n[1],element:n[0],selectedTechnique:n[6],handlers:n[3]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i&4&&(r.techniqueId=t[10]),i&2&&(r.root=t[1]),i&1&&(r.element=t[0]),i&8&&(r.handlers=t[3]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Dr(n){let e,l,t,i,r,s,o,f=`Techniques (${n[2].length||0})`,a,c,u,d,h,m;t=new de({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),r=new de({props:{size:Ae,iconName:"folder",description:"Techniques"}});let p=n[4][n[0].id]&&Tl(n);return{c(){e=k("div"),l=k("div"),R(t.$$.fragment),i=L(),R(r.$$.fragment),s=L(),o=k("div"),a=fe(f),c=L(),p&&p.c(),u=Ee(),this.h()},l(T){e=y(T,"DIV",{class:!0,role:!0,tabindex:!0});var C=M(e);l=y(C,"DIV",{class:!0});var V=M(l);F(t.$$.fragment,V),V.forEach(_),i=A(C),F(r.$$.fragment,C),s=A(C),o=y(C,"DIV",{});var w=M(o);a=ue(w,f),w.forEach(_),C.forEach(_),c=A(T),p&&p.l(T),u=Ee(),this.h()},h(){g(l,"class","expanded-btn svelte-10tthkv"),pe(l,"expanded",n[4][n[0].id]),g(e,"class","layer-parent svelte-10tthkv"),g(e,"role","button"),g(e,"tabindex","0")},m(T,C){I(T,e,C),v(e,l),B(t,l,null),v(e,i),B(r,e,null),v(e,s),v(e,o),v(o,a),I(T,c,C),p&&p.m(T,C),I(T,u,C),d=!0,h||(m=[te(e,"click",n[8]),te(e,"keydown",n[9])],h=!0)},p(T,[C]){(!d||C&17)&&pe(l,"expanded",T[4][T[0].id]),(!d||C&4)&&f!==(f=`Techniques (${T[2].length||0})`)&&Ne(a,f),T[4][T[0].id]?p?(p.p(T,C),C&17&&b(p,1)):(p=Tl(T),p.c(),b(p,1),p.m(u.parentNode,u)):p&&(ae(),$(p,1,1,()=>{p=null}),ce())},i(T){d||(b(t.$$.fragment,T),b(r.$$.fragment,T),b(p),d=!0)},o(T){$(t.$$.fragment,T),$(r.$$.fragment,T),$(p),d=!1},d(T){T&&(_(e),_(c),_(u)),Z(t),Z(r),p&&p.d(T),h=!1,Ie(m)}}}function Lr(n,e,l){let t,{element:i}=e,{root:r}=e,{techniques:s}=e,{handlers:o}=e;const{expandedTechniques:f,selectedTechnique:a}=xe("profile-config");se(n,f,h=>l(4,t=h));const c=(h,m)=>{X(f,t[m]=!t[m],t)},u=h=>c(h,i.id),d=h=>lt(h,c,i.id);return n.$$set=h=>{"element"in h&&l(0,i=h.element),"root"in h&&l(1,r=h.root),"techniques"in h&&l(2,s=h.techniques),"handlers"in h&&l(3,o=h.handlers)},[i,r,s,o,t,f,a,c,u,d]}class Ar extends ge{constructor(e){super(),be(this,e,Lr,Dr,_e,{element:0,root:1,techniques:2,handlers:3})}}function El(n,e,l){const t=n.slice();return t[15]=e[l],t}function kt(n){const e=n.slice(),l=e[2]?e[2]:e[7];return e[14]=l,e}function qr(n){let e,l;return e=new Ir({props:{element:n[7],parent:n[3],root:n[2],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.element=t[7]),i&8&&(r.parent=t[3]),i&4&&(r.root=t[2]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Or(n){let e,l;return e=new gr({props:{element:n[7],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.element=t[7]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Il(n){let e,l,t,i,r=Me(n[7].children||[]),s=[];for(let a=0;a<r.length;a+=1)s[a]=Ml(El(n,r,a));const o=a=>$(s[a],1,1,()=>{s[a]=null});let f=n[7].techniques.length>0&&n[8]&&Nl(n);return{c(){e=k("ul");for(let a=0;a<s.length;a+=1)s[a].c();l=L(),f&&f.c(),this.h()},l(a){e=y(a,"UL",{class:!0});var c=M(e);for(let u=0;u<s.length;u+=1)s[u].l(c);l=A(c),f&&f.l(c),c.forEach(_),this.h()},h(){g(e,"class","svelte-yvn279")},m(a,c){I(a,e,c);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);v(e,l),f&&f.m(e,null),i=!0},p(a,c){if(n=a,c&244){r=Me(n[7].children||[]);let u;for(u=0;u<r.length;u+=1){const d=El(n,r,u);s[u]?(s[u].p(d,c),b(s[u],1)):(s[u]=Ml(d),s[u].c(),b(s[u],1),s[u].m(e,l))}for(ae(),u=r.length;u<s.length;u+=1)o(u);ce()}n[7].techniques.length>0&&n[8]?f?(f.p(n,c),c&384&&b(f,1)):(f=Nl(n),f.c(),b(f,1),f.m(e,null)):f&&(ae(),$(f,1,1,()=>{f=null}),ce())},i(a){if(!i){for(let c=0;c<r.length;c+=1)b(s[c]);b(f),a&&Pe(()=>{i&&(t||(t=je(e,tt,{duration:Pl},!0)),t.run(1))}),i=!0}},o(a){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)$(s[c]);$(f),a&&(t||(t=je(e,tt,{duration:Pl},!1)),t.run(0)),i=!1},d(a){a&&_(e),Xe(s,a),f&&f.d(),a&&t&&t.end()}}}function Ml(n){let e,l,t;return l=new Et({props:{elementId:n[15],root:n[14],parent:n[7],store:n[4],storeProp:n[5],handlers:n[6]}}),{c(){e=k("li"),R(l.$$.fragment),this.h()},l(i){e=y(i,"LI",{class:!0});var r=M(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","svelte-yvn279")},m(i,r){I(i,e,r),B(l,e,null),t=!0},p(i,r){const s={};r&128&&(s.elementId=i[15]),r&132&&(s.root=i[14]),r&128&&(s.parent=i[7]),r&16&&(s.store=i[4]),r&32&&(s.storeProp=i[5]),r&64&&(s.handlers=i[6]),l.$set(s)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&_(e),Z(l)}}}function Nl(n){let e,l;return e=new Ar({props:{techniques:n[7].techniques,handlers:n[6],root:n[2],element:n[7]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.techniques=t[7].techniques),i&64&&(r.handlers=t[6]),i&4&&(r.root=t[2]),i&128&&(r.element=t[7]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Sr(n){let e,l,t,i,r;const s=[Or,qr],o=[];function f(c,u){return c[2]?c[1]?1:-1:0}~(e=f(n))&&(l=o[e]=s[e](n));let a=n[10][n[0]]&&n[1]&&n[12]&&Il(kt(n));return{c(){l&&l.c(),t=L(),a&&a.c(),i=Ee()},l(c){l&&l.l(c),t=A(c),a&&a.l(c),i=Ee()},m(c,u){~e&&o[e].m(c,u),I(c,t,u),a&&a.m(c,u),I(c,i,u),r=!0},p(c,[u]){let d=e;e=f(c),e===d?~e&&o[e].p(c,u):(l&&(ae(),$(o[d],1,1,()=>{o[d]=null}),ce()),~e?(l=o[e],l?l.p(c,u):(l=o[e]=s[e](c),l.c()),b(l,1),l.m(t.parentNode,t)):l=null),c[10][c[0]]&&c[1]&&c[12]?a?(a.p(kt(c),u),u&1027&&b(a,1)):(a=Il(kt(c)),a.c(),b(a,1),a.m(i.parentNode,i)):a&&(ae(),$(a,1,1,()=>{a=null}),ce())},i(c){r||(b(l),b(a),r=!0)},o(c){$(l),$(a),r=!1},d(c){c&&(_(t),_(i)),~e&&o[e].d(c),a&&a.d(c)}}}const Pl=200;function Vr(n,e,l){let t,i,r,s,o=Y,f=()=>(o(),o=We(m,w=>l(13,s=w)),m),a;n.$$.on_destroy.push(()=>o());let{elementId:c}=e,{isLayer:u=!0}=e,{root:d=null}=e,{parent:h=null}=e,{store:m}=e;f();let{storeProp:p}=e,{handlers:T}=e;const{expanded:C,mappings:V}=xe("profile-config");return se(n,C,w=>l(10,a=w)),se(n,V,w=>l(8,r=w)),n.$$set=w=>{"elementId"in w&&l(0,c=w.elementId),"isLayer"in w&&l(1,u=w.isLayer),"root"in w&&l(2,d=w.root),"parent"in w&&l(3,h=w.parent),"store"in w&&f(l(4,m=w.store)),"storeProp"in w&&l(5,p=w.storeProp),"handlers"in w&&l(6,T=w.handlers)},n.$$.update=()=>{var w,z;n.$$.dirty&8225&&l(7,t=s[p][c]),n.$$.dirty&386&&l(9,i=u?((w=t.children)==null?void 0:w.length)>0||((z=t.techniques)==null?void 0:z.length)>0&&r:!1)},[c,u,d,h,m,p,T,t,r,i,a,C,V,s]}class Et extends ge{constructor(e){super(),be(this,e,Vr,Sr,_e,{elementId:0,isLayer:1,root:2,parent:3,store:4,storeProp:5,handlers:6})}}function Dl(n,e,l){const t=n.slice();return t[56]=e[l],t}function zr(n){let e,l,t,i,r,s,o,f;return e=new n[59].ProfileButtons({props:{store:he,selectedProfile:n[16]}}),t=new n[59].ProfileSelect({props:{store:he,selectedProfile:n[16]}}),r=new n[59].MappingMode({props:{store:he}}),o=new n[59].ExportImport({props:{store:he,storeProp:Je.layers}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment),s=L(),R(o.$$.fragment)},l(a){F(e.$$.fragment,a),l=A(a),F(t.$$.fragment,a),i=A(a),F(r.$$.fragment,a),s=A(a),F(o.$$.fragment,a)},m(a,c){B(e,a,c),I(a,l,c),B(t,a,c),I(a,i,c),B(r,a,c),I(a,s,c),B(o,a,c),f=!0},p:Y,i(a){f||(b(e.$$.fragment,a),b(t.$$.fragment,a),b(r.$$.fragment,a),b(o.$$.fragment,a),f=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),$(r.$$.fragment,a),$(o.$$.fragment,a),f=!1},d(a){a&&(_(l),_(i),_(s)),Z(e,a),Z(t,a),Z(r,a),Z(o,a)}}}function Ll(n){let e,l;return e=new Et({props:{elementId:n[56],store:he,storeProp:Je.layers,handlers:n[23]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&1024&&(r.elementId=t[56]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Al(n){let e,l,t,i;return e=new de({props:{size:33,iconName:"plus_circle",description:"Create Capability",title:"Create Capability",disabled:!n[0].profiles.length>0}}),e.$on("iconClick",n[24]),t=new de({props:{size:35,iconName:"copy",description:"Copy From Templates",title:"Copy From Templates",disabled:!n[0].profiles.length>0}}),t.$on("iconClick",n[25]),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=A(r),F(t.$$.fragment,r)},m(r,s){B(e,r,s),I(r,l,s),B(t,r,s),i=!0},p(r,s){const o={};s[0]&1&&(o.disabled=!r[0].profiles.length>0),e.$set(o);const f={};s[0]&1&&(f.disabled=!r[0].profiles.length>0),t.$set(f)},i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){$(e.$$.fragment,r),$(t.$$.fragment,r),i=!1},d(r){r&&_(l),Z(e,r),Z(t,r)}}}function ql(n){let e,l;return e=new dt({props:{$$slots:{default:[Br,({M:t,item:i})=>({54:t,55:i}),({M:t,item:i})=>[0,(t?8388608:0)|(i?16777216:0)]]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&12|i[1]&553648128&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function jr(n){let e;return{c(){e=fe("Create Capability")},l(l){e=ue(l,"Create Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Hr(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Rr(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Br(n){let e,l,t,i,r,s;return e=new n[54].Title({props:{$$slots:{default:[jr]},$$scope:{ctx:n}}}),t=new n[54].Create({props:{item:n[55],textInput:"Name",textArea:"Description"}}),r=new n[54].Buttons({props:{item:n[55],handleCloseModal:n[26],handleOnSubmit:n[27],$$slots:{cancel:[Rr],submit:[Hr]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment)},l(o){F(e.$$.fragment,o),l=A(o),F(t.$$.fragment,o),i=A(o),F(r.$$.fragment,o)},m(o,f){B(e,o,f),I(o,l,f),B(t,o,f),I(o,i,f),B(r,o,f),s=!0},p(o,f){const a={};f[1]&536870912&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const c={};f[1]&16777216&&(c.item=o[55]),t.$set(c);const u={};f[1]&16777216&&(u.item=o[55]),f[0]&12&&(u.handleCloseModal=o[26]),f[0]&4&&(u.handleOnSubmit=o[27]),f[1]&536870912&&(u.$$scope={dirty:f,ctx:o}),r.$set(u)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(r.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&(_(l),_(i)),Z(e,o),Z(t,o),Z(r,o)}}}function Ol(n){let e,l;return e=new dt({props:{$$slots:{default:[Gr,({M:t,item:i})=>({54:t,55:i}),({M:t,item:i})=>[0,(t?8388608:0)|(i?16777216:0)]]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&50|i[1]&553648128&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Zr(n){let e;return{c(){e=fe("Create Child Capability")},l(l){e=ue(l,"Create Child Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Fr(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ur(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Gr(n){let e,l,t,i,r,s;return e=new n[54].Title({props:{$$slots:{default:[Zr]},$$scope:{ctx:n}}}),t=new n[54].Create({props:{item:n[55],textInput:"Name",textArea:"Description"}}),r=new n[54].Buttons({props:{item:n[55],handleCloseModal:n[30],handleOnSubmit:n[31],$$slots:{cancel:[Ur],submit:[Fr]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment)},l(o){F(e.$$.fragment,o),l=A(o),F(t.$$.fragment,o),i=A(o),F(r.$$.fragment,o)},m(o,f){B(e,o,f),I(o,l,f),B(t,o,f),I(o,i,f),B(r,o,f),s=!0},p(o,f){const a={};f[1]&536870912&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const c={};f[1]&16777216&&(c.item=o[55]),t.$set(c);const u={};f[1]&16777216&&(u.item=o[55]),f[0]&48&&(u.handleCloseModal=o[30]),f[0]&18&&(u.handleOnSubmit=o[31]),f[1]&536870912&&(u.$$scope={dirty:f,ctx:o}),r.$set(u)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(r.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&(_(l),_(i)),Z(e,o),Z(t,o),Z(r,o)}}}function Sl(n){let e,l;return e=new xi({props:{dialog:n[8],title:"Copy Capability From Templates",store:n[0].templates,copyHandler:n[20]}}),e.$on("closeModal",n[34]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&256&&(r.dialog=t[8]),i[0]&1&&(r.store=t[0].templates),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Vl(n){let e,l;return e=new rn({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Kr(n){var S;let e,l,t,i,r,s,o="LAYERS",f,a,c,u,d,h,m,p,T,C,V,w,z,K,G,D,E;t=new on({props:{$$slots:{default:[zr,({H:P})=>({59:P}),({H:P})=>[0,P?268435456:0]]},$$scope:{ctx:n}}});let j=Me(((S=n[10])==null?void 0:S.includedLayers)||[]),H=[];for(let P=0;P<j.length;P+=1)H[P]=Ll(Dl(n,j,P));const ee=P=>$(H[P],1,1,()=>{H[P]=null});let W=!n[0].isReadonly&&Al(n);h=new sn({});let J=n[3]&&ql(n),U=n[5]&&Ol(n),Q=n[9]&&Sl(n),oe=n[7]&&Vl();return{c(){e=k("main"),l=k("section"),R(t.$$.fragment),i=L(),r=k("section"),s=k("div"),s.textContent=o,f=L();for(let P=0;P<H.length;P+=1)H[P].c();a=L(),c=k("div"),W&&W.c(),u=L(),d=k("section"),R(h.$$.fragment),m=L(),p=k("dialog"),J&&J.c(),T=L(),C=k("dialog"),U&&U.c(),V=L(),w=k("dialog"),Q&&Q.c(),z=L(),K=k("dialog"),oe&&oe.c(),this.h()},l(P){e=y(P,"MAIN",{class:!0});var O=M(e);l=y(O,"SECTION",{id:!0});var le=M(l);F(t.$$.fragment,le),le.forEach(_),i=A(O),r=y(O,"SECTION",{id:!0});var re=M(r);s=y(re,"DIV",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-1dwu0al"&&(s.textContent=o),f=A(re);for(let Re=0;Re<H.length;Re+=1)H[Re].l(re);a=A(re),c=y(re,"DIV",{id:!0});var N=M(c);W&&W.l(N),N.forEach(_),re.forEach(_),u=A(O),d=y(O,"SECTION",{id:!0});var q=M(d);F(h.$$.fragment,q),q.forEach(_),m=A(O),p=y(O,"DIALOG",{id:!0});var me=M(p);J&&J.l(me),me.forEach(_),T=A(O),C=y(O,"DIALOG",{id:!0});var De=M(C);U&&U.l(De),De.forEach(_),V=A(O),w=y(O,"DIALOG",{id:!0});var Le=M(w);Q&&Q.l(Le),Le.forEach(_),z=A(O),K=y(O,"DIALOG",{id:!0,class:!0});var Oe=M(K);oe&&oe.l(Oe),Oe.forEach(_),O.forEach(_),this.h()},h(){g(l,"id","container-header"),g(s,"class","text-center fancy-font"),g(c,"id","capability--btns"),g(r,"id","container-layer"),g(d,"id","container-btns"),p.open=n[3],g(p,"id","capability--dialog"),C.open=n[5],g(C,"id","create--capability--dialog"),w.open=n[9],g(w,"id","capability--dialog"),K.open=n[7],g(K,"id","attack--dialog"),g(K,"class","svelte-1jgw4yd"),g(e,"class","svelte-1jgw4yd")},m(P,O){I(P,e,O),v(e,l),B(t,l,null),v(e,i),v(e,r),v(r,s),v(r,f);for(let le=0;le<H.length;le+=1)H[le]&&H[le].m(r,null);v(r,a),v(r,c),W&&W.m(c,null),v(e,u),v(e,d),B(h,d,null),v(e,m),v(e,p),J&&J.m(p,null),n[28](p),v(e,T),v(e,C),U&&U.m(C,null),n[32](C),v(e,V),v(e,w),Q&&Q.m(w,null),n[35](w),v(e,z),v(e,K),oe&&oe.m(K,null),n[37](K),G=!0,D||(E=[te(p,"close",n[29]),te(C,"close",n[33]),te(w,"close",n[36]),te(K,"close",n[38])],D=!0)},p(P,O){var re;const le={};if(O[1]&536870912&&(le.$$scope={dirty:O,ctx:P}),t.$set(le),O[0]&8389632){j=Me(((re=P[10])==null?void 0:re.includedLayers)||[]);let N;for(N=0;N<j.length;N+=1){const q=Dl(P,j,N);H[N]?(H[N].p(q,O),b(H[N],1)):(H[N]=Ll(q),H[N].c(),b(H[N],1),H[N].m(r,a))}for(ae(),N=j.length;N<H.length;N+=1)ee(N);ce()}P[0].isReadonly?W&&(ae(),$(W,1,1,()=>{W=null}),ce()):W?(W.p(P,O),O[0]&1&&b(W,1)):(W=Al(P),W.c(),b(W,1),W.m(c,null)),P[3]?J?(J.p(P,O),O[0]&8&&b(J,1)):(J=ql(P),J.c(),b(J,1),J.m(p,null)):J&&(ae(),$(J,1,1,()=>{J=null}),ce()),(!G||O[0]&8)&&(p.open=P[3]),P[5]?U?(U.p(P,O),O[0]&32&&b(U,1)):(U=Ol(P),U.c(),b(U,1),U.m(C,null)):U&&(ae(),$(U,1,1,()=>{U=null}),ce()),(!G||O[0]&32)&&(C.open=P[5]),P[9]?Q?(Q.p(P,O),O[0]&512&&b(Q,1)):(Q=Sl(P),Q.c(),b(Q,1),Q.m(w,null)):Q&&(ae(),$(Q,1,1,()=>{Q=null}),ce()),(!G||O[0]&512)&&(w.open=P[9]),P[7]?oe?O[0]&128&&b(oe,1):(oe=Vl(),oe.c(),b(oe,1),oe.m(K,null)):oe&&(ae(),$(oe,1,1,()=>{oe=null}),ce()),(!G||O[0]&128)&&(K.open=P[7])},i(P){if(!G){b(t.$$.fragment,P);for(let O=0;O<j.length;O+=1)b(H[O]);b(W),b(h.$$.fragment,P),b(J),b(U),b(Q),b(oe),G=!0}},o(P){$(t.$$.fragment,P),H=H.filter(Boolean);for(let O=0;O<H.length;O+=1)$(H[O]);$(W),$(h.$$.fragment,P),$(J),$(U),$(Q),$(oe),G=!1},d(P){P&&_(e),Z(t),Xe(H,P),W&&W.d(),Z(h),J&&J.d(),n[28](null),U&&U.d(),n[32](null),Q&&Q.d(),n[35](null),oe&&oe.d(),n[37](null),D=!1,Ie(E)}}}function Jr(n,e,l){let t,i,r,s,o,f,a;se(n,he,x=>l(0,f=x));const{selected:c,editingName:u,selectedD3fendId:d,selectedLayerId:h,selectedLayerColor:m}=xe("profile-config");se(n,c,x=>l(40,t=x)),se(n,u,x=>l(44,o=x)),se(n,d,x=>l(43,s=x)),se(n,h,x=>l(42,r=x)),se(n,m,x=>l(41,i=x));const p=et(f.profiles[f==null?void 0:f.selectedProfile]);se(n,p,x=>l(10,a=x));let T,C=null,V,w=!1,z,K=!1,G,D=!1,E,j=!1;const H=x=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&he.deleteLayer(x.id)},ee=(x,ke,ye=null)=>{x.detail.event.stopPropagation(),l(1,T=ke),C=ye,l(5,K=!0),z.showModal()},W=(x,ke,ye,ze=null)=>{if(f.isReadonly)return;const Se=ke.id;if(t[Se]||X(c,t[Se]=ne.noop,t),ye){t[Se]===ne.noop?X(c,t[Se]=ne.root,t):X(c,t[Se]=ne.noop,t);return}x.shiftKey?t[Se]===ne.noop?X(c,t[Se]=ne.selected,t):X(c,t[Se]=ne.noop,t):(Object.entries(t).forEach(([Qe,rt])=>{Qe===Se?((!rt||rt===ne.noop)&&X(c,t[Qe]=ne.selected,t),rt===ne.selected&&X(c,t[Qe]=ne.noop,t)):X(c,t[Qe]=ne.noop,t)}),X(c,t[ze.id]=ne.root,t))},J=(x,ke,ye,ze)=>{he.editName(x,ye,ze),X(c,t[x]=ne.selected,t),ke&&X(c,t[ke.id]=ne.parent,t)},U=(x,ke,ye)=>{x.detail.event.stopPropagation(),X(c,t[ke.id]=ne.editing,t),X(c,t[ye==null?void 0:ye.id]=ne.noop,t),X(u,o=ke.name,o)},Q=(x,ke,ye)=>{x.detail.event.stopPropagation(),X(c,t[ke.id]=ne.selected,t),ye&&X(c,t[ye.id]=ne.parent,t),X(u,o="",o)},oe=(x,ke,ye)=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&he.deleteSublayer(x,ke.id,ye)},S=(x,ke,ye)=>{he.saveLayerColor(ke,x.srcElement.value,ye)},P=(x,ke,ye,ze)=>{x.detail.event.stopPropagation(),X(d,s=ke,s),X(h,r=ye,r),X(m,i=ze,i),l(7,D=!0),G.showModal()},O=x=>{l(3,w=!0),V.showModal()},le=x=>{l(9,j=!0),E.showModal()},re=({name:x,description:ke},ye)=>{const ze={id:Tt(x),name:x,description:ke,techniques:[],children:[],checked:!1,color:"#0075FF"};he.addLayer(ze),ye.close()},N=x=>{const{newArray:ke,mappedIds:ye}=x.reduce((Se,Qe)=>{const rt=Tt(Qe.name);return Se.newArray.push({...Qe,id:rt}),Se.mappedIds[Qe.id]=rt,Se},{newArray:[],mappedIds:{}}),ze=yn(ke,ye);he.bulkAddLayer(ze,ze[0].id)},q=(x,ke)=>{ke.close()},me=({name:x,description:ke},ye,ze,Se)=>{const Qe={id:null,name:x,description:ke,techniques:[],children:[],checked:!1,color:"#0075FF"};C?he.addNonRootChild(ye,Qe,ze):(X(c,t[ye.id]=ne.root,t),he.addChild(ye,Qe,ze)),Se.close()},De={deleteCapability:H,showCreateLayerDialog:ee,selectLayer:W,saveCapabilityName:J,editCapability:U,cancelEdit:Q,deleteChildCapability:oe,updateCapabilityColor:S,openAttackDialog:P},Le=x=>O(),Oe=x=>le(),Re=()=>q(w,V),bt=x=>re(x,V);function It(x){qe[x?"unshift":"push"](()=>{V=x,l(2,V)})}const ie=()=>l(3,w=!1),$e=()=>q(K,z),Ce=x=>me(x,T,Je.layers,z);function Be(x){qe[x?"unshift":"push"](()=>{z=x,l(4,z)})}const Ze=()=>l(5,K=!1),Ye=()=>q(j,E);function st(x){qe[x?"unshift":"push"](()=>{E=x,l(8,E)})}const fn=()=>l(9,j=!1);function un(x){qe[x?"unshift":"push"](()=>{G=x,l(6,G)})}const dn=()=>l(7,D=!1);return n.$$.update=()=>{n.$$.dirty[0]&1&&X(p,a=(f==null?void 0:f.profiles[f==null?void 0:f.selectedProfile])||{name:""},a)},[f,T,V,w,z,K,G,D,E,j,a,c,u,d,h,m,p,O,le,re,N,q,me,De,Le,Oe,Re,bt,It,ie,$e,Ce,Be,Ze,Ye,st,fn,un,dn]}class Wr extends ge{constructor(e){super(),be(this,e,Jr,Kr,_e,{},null,[-1,-1])}}function zl(n,e,l){const t=n.slice();return t[46]=e[l],t}function Qr(n){let e,l;return e=new n[49].MappingMode({props:{store:he}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p:Y,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function jl(n){let e,l;return e=new Et({props:{elementId:n[46],store:he,storeProp:Je.templates,handlers:n[17]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&128&&(r.elementId=t[46]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Hl(n){let e,l;return e=new de({props:{size:33,iconName:"plus_circle",description:"Create Capability",title:"Create Capability"}}),e.$on("iconClick",n[18]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p:Y,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Rl(n){let e,l;return e=new dt({props:{$$slots:{default:[eo,({M:t,item:i})=>({44:t,45:i}),({M:t,item:i})=>[0,(t?8192:0)|(i?16384:0)]]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&6|i[1]&540672&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Xr(n){let e;return{c(){e=fe("Create Template Capability")},l(l){e=ue(l,"Create Template Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Yr(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function xr(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function eo(n){let e,l,t,i,r,s;return e=new n[44].Title({props:{$$slots:{default:[Xr]},$$scope:{ctx:n}}}),t=new n[44].Create({props:{item:n[45],textInput:"Name",textArea:"Description"}}),r=new n[44].Buttons({props:{item:n[45],handleCloseModal:n[19],handleOnSubmit:n[20],$$slots:{cancel:[xr],submit:[Yr]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment)},l(o){F(e.$$.fragment,o),l=A(o),F(t.$$.fragment,o),i=A(o),F(r.$$.fragment,o)},m(o,f){B(e,o,f),I(o,l,f),B(t,o,f),I(o,i,f),B(r,o,f),s=!0},p(o,f){const a={};f[1]&524288&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const c={};f[1]&16384&&(c.item=o[45]),t.$set(c);const u={};f[1]&16384&&(u.item=o[45]),f[0]&6&&(u.handleCloseModal=o[19]),f[0]&2&&(u.handleOnSubmit=o[20]),f[1]&524288&&(u.$$scope={dirty:f,ctx:o}),r.$set(u)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(r.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&(_(l),_(i)),Z(e,o),Z(t,o),Z(r,o)}}}function Bl(n){let e,l;return e=new dt({props:{$$slots:{default:[io,({M:t,item:i})=>({44:t,45:i}),({M:t,item:i})=>[0,(t?8192:0)|(i?16384:0)]]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},p(t,i){const r={};i[0]&25|i[1]&540672&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function to(n){let e;return{c(){e=fe("Create Child Capability")},l(l){e=ue(l,"Create Child Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function lo(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function no(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function io(n){let e,l,t,i,r,s;return e=new n[44].Title({props:{$$slots:{default:[to]},$$scope:{ctx:n}}}),t=new n[44].Create({props:{item:n[45],textInput:"Name",textArea:"Description"}}),r=new n[44].Buttons({props:{item:n[45],handleCloseModal:n[23],handleOnSubmit:n[24],$$slots:{cancel:[no],submit:[lo]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=L(),R(t.$$.fragment),i=L(),R(r.$$.fragment)},l(o){F(e.$$.fragment,o),l=A(o),F(t.$$.fragment,o),i=A(o),F(r.$$.fragment,o)},m(o,f){B(e,o,f),I(o,l,f),B(t,o,f),I(o,i,f),B(r,o,f),s=!0},p(o,f){const a={};f[1]&524288&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const c={};f[1]&16384&&(c.item=o[45]),t.$set(c);const u={};f[1]&16384&&(u.item=o[45]),f[0]&24&&(u.handleCloseModal=o[23]),f[0]&9&&(u.handleOnSubmit=o[24]),f[1]&524288&&(u.$$scope={dirty:f,ctx:o}),r.$set(u)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(r.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&(_(l),_(i)),Z(e,o),Z(t,o),Z(r,o)}}}function Zl(n){let e,l;return e=new rn({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){B(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function ro(n){let e,l,t,i,r,s,o="LAYERS",f,a,c,u,d,h,m,p,T,C,V,w,z,K,G;t=new on({props:{$$slots:{default:[Qr,({H:U})=>({49:U}),({H:U})=>[0,U?262144:0]]},$$scope:{ctx:n}}});let D=Me(n[7].rootTemplates||[]),E=[];for(let U=0;U<D.length;U+=1)E[U]=jl(zl(n,D,U));const j=U=>$(E[U],1,1,()=>{E[U]=null});let H=!n[7].isReadonly&&Hl(n);h=new sn({props:{selectedStore:Je.templates}});let ee=n[2]&&Rl(n),W=n[4]&&Bl(n),J=n[6]&&Zl();return{c(){e=k("main"),l=k("section"),R(t.$$.fragment),i=L(),r=k("section"),s=k("div"),s.textContent=o,f=L();for(let U=0;U<E.length;U+=1)E[U].c();a=L(),c=k("div"),H&&H.c(),u=L(),d=k("section"),R(h.$$.fragment),m=L(),p=k("dialog"),ee&&ee.c(),T=L(),C=k("dialog"),W&&W.c(),V=L(),w=k("dialog"),J&&J.c(),this.h()},l(U){e=y(U,"MAIN",{class:!0});var Q=M(e);l=y(Q,"SECTION",{id:!0});var oe=M(l);F(t.$$.fragment,oe),oe.forEach(_),i=A(Q),r=y(Q,"SECTION",{id:!0});var S=M(r);s=y(S,"DIV",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-1dwu0al"&&(s.textContent=o),f=A(S);for(let q=0;q<E.length;q+=1)E[q].l(S);a=A(S),c=y(S,"DIV",{id:!0});var P=M(c);H&&H.l(P),P.forEach(_),S.forEach(_),u=A(Q),d=y(Q,"SECTION",{id:!0});var O=M(d);F(h.$$.fragment,O),O.forEach(_),m=A(Q),p=y(Q,"DIALOG",{id:!0});var le=M(p);ee&&ee.l(le),le.forEach(_),T=A(Q),C=y(Q,"DIALOG",{id:!0});var re=M(C);W&&W.l(re),re.forEach(_),V=A(Q),w=y(Q,"DIALOG",{id:!0,class:!0});var N=M(w);J&&J.l(N),N.forEach(_),Q.forEach(_),this.h()},h(){g(l,"id","container-header"),g(s,"class","text-center fancy-font"),g(c,"id","capability--btns"),g(r,"id","container-layer"),g(d,"id","container-btns"),p.open=n[2],g(p,"id","capability--dialog"),C.open=n[4],g(C,"id","create--capability--dialog"),w.open=n[6],g(w,"id","attack--dialog"),g(w,"class","svelte-1jgw4yd"),g(e,"class","svelte-1jgw4yd")},m(U,Q){I(U,e,Q),v(e,l),B(t,l,null),v(e,i),v(e,r),v(r,s),v(r,f);for(let oe=0;oe<E.length;oe+=1)E[oe]&&E[oe].m(r,null);v(r,a),v(r,c),H&&H.m(c,null),v(e,u),v(e,d),B(h,d,null),v(e,m),v(e,p),ee&&ee.m(p,null),n[21](p),v(e,T),v(e,C),W&&W.m(C,null),n[25](C),v(e,V),v(e,w),J&&J.m(w,null),n[27](w),z=!0,K||(G=[te(p,"close",n[22]),te(C,"close",n[26]),te(w,"close",n[28])],K=!0)},p(U,Q){const oe={};if(Q[1]&524288&&(oe.$$scope={dirty:Q,ctx:U}),t.$set(oe),Q[0]&131200){D=Me(U[7].rootTemplates||[]);let S;for(S=0;S<D.length;S+=1){const P=zl(U,D,S);E[S]?(E[S].p(P,Q),b(E[S],1)):(E[S]=jl(P),E[S].c(),b(E[S],1),E[S].m(r,a))}for(ae(),S=D.length;S<E.length;S+=1)j(S);ce()}U[7].isReadonly?H&&(ae(),$(H,1,1,()=>{H=null}),ce()):H?(H.p(U,Q),Q[0]&128&&b(H,1)):(H=Hl(U),H.c(),b(H,1),H.m(c,null)),U[2]?ee?(ee.p(U,Q),Q[0]&4&&b(ee,1)):(ee=Rl(U),ee.c(),b(ee,1),ee.m(p,null)):ee&&(ae(),$(ee,1,1,()=>{ee=null}),ce()),(!z||Q[0]&4)&&(p.open=U[2]),U[4]?W?(W.p(U,Q),Q[0]&16&&b(W,1)):(W=Bl(U),W.c(),b(W,1),W.m(C,null)):W&&(ae(),$(W,1,1,()=>{W=null}),ce()),(!z||Q[0]&16)&&(C.open=U[4]),U[6]?J?Q[0]&64&&b(J,1):(J=Zl(),J.c(),b(J,1),J.m(w,null)):J&&(ae(),$(J,1,1,()=>{J=null}),ce()),(!z||Q[0]&64)&&(w.open=U[6])},i(U){if(!z){b(t.$$.fragment,U);for(let Q=0;Q<D.length;Q+=1)b(E[Q]);b(H),b(h.$$.fragment,U),b(ee),b(W),b(J),z=!0}},o(U){$(t.$$.fragment,U),E=E.filter(Boolean);for(let Q=0;Q<E.length;Q+=1)$(E[Q]);$(H),$(h.$$.fragment,U),$(ee),$(W),$(J),z=!1},d(U){U&&_(e),Z(t),Xe(E,U),H&&H.d(),Z(h),ee&&ee.d(),n[21](null),W&&W.d(),n[25](null),J&&J.d(),n[27](null),K=!1,Ie(G)}}}function oo(n,e,l){let t,i,r,s,o,f;se(n,he,ie=>l(7,f=ie));const{selected:a,editingName:c,selectedD3fendId:u,selectedLayerId:d,selectedLayerColor:h}=xe("profile-config");se(n,a,ie=>l(30,t=ie)),se(n,c,ie=>l(34,o=ie)),se(n,u,ie=>l(33,s=ie)),se(n,d,ie=>l(32,r=ie)),se(n,h,ie=>l(31,i=ie));let m,p=null,T,C=!1,V,w=!1,z,K=!1;const G=ie=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&he.deleteTemplate(ie.id)},D=(ie,$e,Ce=null)=>{ie.detail.event.stopPropagation(),l(0,m=$e),p=Ce,l(4,w=!0),V.showModal()},E=(ie,$e,Ce,Be=null)=>{if(f.isReadonly)return;const Ze=$e.id;if(t[Ze]||X(a,t[Ze]=ne.noop,t),Ce){t[Ze]===ne.noop?X(a,t[Ze]=ne.root,t):X(a,t[Ze]=ne.noop,t);return}ie.shiftKey?t[Ze]===ne.noop?X(a,t[Ze]=ne.selected,t):X(a,t[Ze]=ne.noop,t):(Object.entries(t).forEach(([Ye,st])=>{Ye===Ze?((!st||st===ne.noop)&&X(a,t[Ye]=ne.selected,t),st===ne.selected&&X(a,t[Ye]=ne.noop,t)):X(a,t[Ye]=ne.noop,t)}),X(a,t[Be.id]=ne.root,t))},j=(ie,$e,Ce,Be)=>{he.editName(ie,Ce,Be),X(a,t[ie]=ne.selected,t),$e&&X(a,t[$e.id]=ne.parent,t)},H=(ie,$e,Ce)=>{ie.detail.event.stopPropagation(),X(a,t[$e.id]=ne.editing,t),X(a,t[Ce==null?void 0:Ce.id]=ne.noop,t),X(c,o=$e.name,o)},ee=(ie,$e,Ce)=>{ie.detail.event.stopPropagation(),X(a,t[$e.id]=ne.selected,t),Ce&&X(a,t[Ce.id]=ne.parent,t),X(c,o="",o)},W=(ie,$e,Ce)=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&he.deleteSublayer(ie,$e.id,Ce)},J=(ie,$e,Ce)=>{he.saveLayerColor($e,ie.srcElement.value,Ce)},U=(ie,$e,Ce,Be)=>{ie.detail.event.stopPropagation(),X(u,s=$e,s),X(d,r=Ce,r),X(h,i=Be,i),l(6,K=!0),z.showModal()},Q=ie=>{l(2,C=!0),T.showModal()},oe=({name:ie,description:$e},Ce)=>{const Be={id:Tt(ie),name:ie,description:$e,techniques:[],children:[],checked:!1,color:"#0075FF"};he.addTemplate(Be),Ce.close()},S=(ie,$e)=>{$e.close()},P=({name:ie,description:$e},Ce,Be,Ze)=>{const Ye={id:null,name:ie,description:$e,techniques:[],children:[],checked:!1,color:"#0075FF"};p?he.addNonRootChild(Ce,Ye,Be):(X(a,t[Ce.id]=ne.root,t),he.addChild(Ce,Ye,Be)),Ze.close()},O={deleteCapability:G,showCreateLayerDialog:D,selectLayer:E,saveCapabilityName:j,editCapability:H,cancelEdit:ee,deleteChildCapability:W,updateCapabilityColor:J,openAttackDialog:U},le=ie=>Q(),re=()=>S(C,T),N=ie=>oe(ie,T);function q(ie){qe[ie?"unshift":"push"](()=>{T=ie,l(1,T)})}const me=()=>l(2,C=!1),De=()=>S(w,V),Le=ie=>P(ie,m,Je.templates,V);function Oe(ie){qe[ie?"unshift":"push"](()=>{V=ie,l(3,V)})}const Re=()=>l(4,w=!1);function bt(ie){qe[ie?"unshift":"push"](()=>{z=ie,l(5,z)})}return[m,T,C,V,w,z,K,f,a,c,u,d,h,Q,oe,S,P,O,le,re,N,q,me,De,Le,Oe,Re,bt,()=>l(6,K=!1)]}class so extends ge{constructor(e){super(),be(this,e,oo,ro,_e,{},null,[-1,-1])}}function ao(n){let e,l="D3FEND PROFILE";return{c(){e=k("h2"),e.textContent=l,this.h()},l(t){e=y(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-u9fo7w"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:Y,d(t){t&&_(e)}}}function co(n){let e,l,t,i,r;return l=new nn({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[ao]},$$scope:{ctx:n}}}),{c(){e=k("section"),R(l.$$.fragment),this.h()},l(s){e=y(s,"SECTION",{class:!0});var o=M(e);F(l.$$.fragment,o),o.forEach(_),this.h()},h(){g(e,"class","svelte-qzr7y6")},m(s,o){I(s,e,o),B(l,e,null),r=!0},p(s,[o]){const f={};o&1&&(f.tabs=s[0]),o&2&&(f.activeTabValue=s[1]),o&32&&(f.$$scope={dirty:o,ctx:s}),l.$set(f)},i(s){r||(b(l.$$.fragment,s),s&&Pe(()=>{r&&(i&&i.end(1),t=it(e,He,{delay:400}),t.start())}),r=!0)},o(s){$(l.$$.fragment,s),t&&t.invalidate(),s&&(i=wt(e,He,{duration:100})),r=!1},d(s){s&&_(e),Z(l),s&&i&&i.end()}}}function fo(n,e,l){let t,i,r;se(n,he,f=>l(4,i=f));const s=et(i.selectedStore);se(n,s,f=>l(1,r=f));const o=(f,a)=>{X(s,r=f,r),X(he,i.selectedStore=a,i)};return l(0,t=[{label:"Profiles",value:Je.layers,component:Wr},{label:"Templates",value:Je.templates,component:so}]),[t,r,s,o]}class So extends ge{constructor(e){super(),be(this,e,fo,co,_e,{})}}function Fl(n,e,l){const t=n.slice();return t[4]=e[l],t}function Ul(n){var o;let e,l,t,i,r,s;return t=new de({props:{size:33,iconName:(o=n[0])!=null&&o.isDrawerOpen?"arrowLeft":"arrowRight",description:"Profile Controls",title:"Profile Controls",pathColor:"white"}}),{c(){e=k("div"),l=k("span"),R(t.$$.fragment),this.h()},l(f){e=y(f,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var a=M(e);l=y(a,"SPAN",{});var c=M(l);F(t.$$.fragment,c),c.forEach(_),a.forEach(_),this.h()},h(){g(e,"id","drawer-btn"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"class","svelte-mz34j1")},m(f,a){I(f,e,a),v(e,l),B(t,l,null),i=!0,r||(s=[te(e,"click",n[2]),te(e,"keyup",null)],r=!0)},p(f,a){var u;const c={};a&1&&(c.iconName=(u=f[0])!=null&&u.isDrawerOpen?"arrowLeft":"arrowRight"),t.$set(c)},i(f){i||(b(t.$$.fragment,f),i=!0)},o(f){$(t.$$.fragment,f),i=!1},d(f){f&&_(e),Z(t),r=!1,Ie(s)}}}function Gl(n){let e,l=Me(n[1].list.map(n[3]).reverse()),t=[];for(let i=0;i<l.length;i+=1)t[i]=Jl(Fl(n,l,i));return{c(){e=k("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=y(i,"DIV",{id:!0,class:!0});var r=M(e);for(let s=0;s<t.length;s+=1)t[s].l(r);r.forEach(_),this.h()},h(){g(e,"id","legend"),g(e,"class","svelte-mz34j1")},m(i,r){I(i,e,r);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(i,r){if(r&3){l=Me(i[1].list.map(i[3]).reverse());let s;for(s=0;s<l.length;s+=1){const o=Fl(i,l,s);t[s]?t[s].p(o,r):(t[s]=Jl(o),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(i){i&&_(e),Xe(t,i)}}}function Kl(n){let e,l=n[4].name+"",t,i;return{c(){e=k("div"),t=fe(l),i=L(),this.h()},l(r){e=y(r,"DIV",{class:!0,style:!0});var s=M(e);t=ue(s,l),i=A(s),s.forEach(_),this.h()},h(){g(e,"class","legend-item svelte-mz34j1"),Te(e,"background",n[4].color)},m(r,s){I(r,e,s),v(e,t),v(e,i)},p(r,s){s&3&&l!==(l=r[4].name+"")&&Ne(t,l),s&3&&Te(e,"background",r[4].color)},d(r){r&&_(e)}}}function Jl(n){let e,l=n[4].checked&&Kl(n);return{c(){l&&l.c(),e=Ee()},l(t){l&&l.l(t),e=Ee()},m(t,i){l&&l.m(t,i),I(t,e,i)},p(t,i){t[4].checked?l?l.p(t,i):(l=Kl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&_(e),l&&l.d(t)}}}function uo(n){var s,o,f,a;let e,l,t,i=!((s=n[0])!=null&&s.isReadonly)&&Ul(n),r=((o=n[0])==null?void 0:o.showLegend)&&((f=n[0])==null?void 0:f.techniqueMappingMode)!=="heatMap"&&((a=n[1].list)==null?void 0:a.length)>0&&Gl(n);return{c(){i&&i.c(),e=L(),l=k("div"),r&&r.c(),this.h()},l(c){i&&i.l(c),e=A(c),l=y(c,"DIV",{id:!0,class:!0});var u=M(l);r&&r.l(u),u.forEach(_),this.h()},h(){g(l,"id","container-legend"),g(l,"class","svelte-mz34j1")},m(c,u){i&&i.m(c,u),I(c,e,u),I(c,l,u),r&&r.m(l,null),t=!0},p(c,[u]){var d,h,m,p;(d=c[0])!=null&&d.isReadonly?i&&(ae(),$(i,1,1,()=>{i=null}),ce()):i?(i.p(c,u),u&1&&b(i,1)):(i=Ul(c),i.c(),b(i,1),i.m(e.parentNode,e)),(h=c[0])!=null&&h.showLegend&&((m=c[0])==null?void 0:m.techniqueMappingMode)!=="heatMap"&&((p=c[1].list)==null?void 0:p.length)>0?r?r.p(c,u):(r=Gl(c),r.c(),r.m(l,null)):r&&(r.d(1),r=null)},i(c){t||(b(i),t=!0)},o(c){$(i),t=!1},d(c){c&&(_(e),_(l)),i&&i.d(c),r&&r.d()}}}function ho(n,e,l){let t,i;se(n,he,o=>l(0,i=o));const r=()=>{X(he,i.isDrawerOpen=!i.isDrawerOpen,i)},s=o=>i[t.store][o];return n.$$.update=()=>{var o;n.$$.dirty&1&&l(1,t=i.selectedStore===Je.layers?{list:(o=i==null?void 0:i.profiles[i.selectedProfile])==null?void 0:o.includedLayers,store:Je.layers}:{list:i==null?void 0:i.rootTemplates,store:Je.templates})},[i,t,r,s]}class Vo extends ge{constructor(e){super(),be(this,e,ho,uo,_e,{})}}const po=(n,e)=>{const l={max:0,count:{},highlighted:{}};return Cn([n,e],([t,i],r)=>{if(!(i!=null&&i.tree.length)||!n){r(Tn);return}l.count={},l.highlighted=Object.entries(l.highlighted).reduce((a,[c,u])=>(a[c]=!1,a),{});const{highlightedTechniques:s,techniqueColors:o}=bo(t),f=Object.entries(o).reduce((a,[c,u])=>(a[c]=[...new Set(u)],a),{});s.forEach(a=>{l.highlighted[a]=!0,l.count[a]?l.count[a]+=1:l.count[a]=1}),l.max=Object.values(l.count).reduce((a,c)=>a>c?a:c,-1/0),Object.entries(l.highlighted).forEach(([a,c])=>{if(c){const u=go[t.techniqueMappingMode]({colors:f[a],count:l.count,max:l.max,technique:a,attack:t.attack});i.treeMap[a].classes.isHighlighted=!0,i.treeMap[a].classes.color=u}else i.treeMap[a].classes.isHighlighted=!1,i.treeMap[a].classes.color=null}),r(i)})},Wl=n=>{const{colors:e}=n,l=e.length,t=l-1,i=(1/l*100).toFixed(1);if(l===1)return e[0];let r="linear-gradient( to right,";for(let s=0;s<l;s++){const o=e[s];if(s===0){r+=` ${o} ${i}%`;continue}if(s===t){r+=`, ${o} ${i*t}%`;continue}r+=`, ${o} ${i*s}% ${i*(s+1)}%`}return r+=")",r},mo=n=>{const{count:e,max:l,technique:t}=n,i=e[t]/l*100;return`color-mix(in srgb, green ${i<20?20:i}%, white)`},_o=n=>{const{colors:e,attack:l,technique:t}=n;for(const i of Object.values(l))if(i[t]){const r=e.length,s=r-1,o=(1/r*100).toFixed(1);if(r===1)return e[0];let f="linear-gradient( to right,";for(let a=0;a<r;a++){const c=e[a];if(a===0){f+=` ${c} ${o}%`;continue}if(a===s){f+=`, ${c} ${o*s}%`;continue}f+=`, ${c} ${o*a}% ${o*(a+1)}%`}return f+=")",f}},go={[ve.rootColor]:n=>Wl(n),[ve.heatMap]:n=>mo(n),[ve.childrenMultiColor]:n=>Wl(n),[ve["ATT&CK"]]:n=>_o(n)},bo=n=>{var t;let e=(t=n.profiles[n==null?void 0:n.selectedProfile])==null?void 0:t.includedLayers,l=n==null?void 0:n.layers;return n.selectedStore===Je.templates&&(e=n.rootTemplates,l=n.templates),n.techniqueMappingMode===ve.rootColor?gt(e,l,!0,0):n.techniqueMappingMode===ve["ATT&CK"]?vo(e,l,n.attack,!1,0):gt(e,l,!1,0)},vo=(n=[],e,l,t=!1,i=0,r=null,s=[],o={})=>{const f=i===0||!t;for(let a=0;a<n.length;a++){const c=e[n[a]],u=f?c.color:r,d=i+1;if(c.checked){const h=l[n[a]];h&&Object.keys(h).map(m=>{s.push(m),(o[m]||(o[technique]=[]))&&o[m].push(u)})}c.children&&gt(c.children,e,t,d,u,s,o)}return{highlightedTechniques:s,techniqueColors:o}},gt=(n=[],e,l,t,i=null,r=[],s={})=>{const o=t===0||!l;for(let f=0;f<n.length;f++){const a=e[n[f]],c=o?a.color:i,u=t+1;a.checked&&(r.push(...a.techniques),a.techniques.forEach(d=>{(s[d]||(s[d]=[]))&&s[d].push(c)})),a.children&&gt(a.children,e,l,u,c,r,s)}return{highlightedTechniques:r,techniqueColors:s}},zo=po(he,ot);export{So as C,Oo as L,Vo as P,zo as c};
