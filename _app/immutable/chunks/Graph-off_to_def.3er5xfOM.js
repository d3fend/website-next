import{s as ne,L as Te,e as g,b as y,v as H,d as x,j as ee,f as we,i as t,x as Le,k as _,V as Ae,y as De,n as _e,t as p,h as o,P as Me,m as q}from"./scheduler.DDVliNtX.js";import{S as Re,i as Be,f as Ge,c as de,b as ke,m as he,g as $e,a as Q,e as Ne,t as U,d as qe}from"./index.iWffroUJ.js";import{e as ie}from"./each.BFyodu2L.js";import{G as Se}from"./_Graph.CGXTKsEb.js";import{a as Ee,T as Ce,b as M,d as ae}from"./lib.DSnscA8f.js";import{T as He,t as ue}from"./ToggleBar.Dt3UQwWP.js";function ce(i,v,s){const l=i.slice();return l[6]=v[s],l}function Oe(i){let v,s=`There are no digital artifacts defined on this offensive technique (yet).
    Please consider <a href="/contribute">contributing</a> an addition to D3FEND.`;return{c(){v=g("small"),v.innerHTML=s},l(l){v=x(l,"SMALL",{"data-svelte-h":!0}),De(v)!=="svelte-1ymw1cs"&&(v.innerHTML=s)},m(l,e){_(l,v,e)},p:_e,i:_e,o:_e,d(l){l&&t(v)}}}function Pe(i){let v=i[1],s,l,e=me(i);return{c(){e.c(),s=H()},l(f){e.l(f),s=H()},m(f,b){e.m(f,b),_(f,s,b),l=!0},p(f,b){b&2&&ne(v,v=f[1])?($e(),Q(e,1,1,_e),Ne(),e=me(f),e.c(),U(e,1),e.m(s.parentNode,s)):e.p(f,b)},i(f){l||(U(e),l=!0)},o(f){Q(e),l=!1},d(f){f&&t(s),e.d(f)}}}function ve(i){let v=i[2].edge_is_unique(i[6].def_tech_label.value,i[6].def_artifact_rel_label.value,i[6].off_artifact_label.value),s,l=v&&se(i);return{c(){l&&l.c(),s=H()},l(e){l&&l.l(e),s=H()},m(e,f){l&&l.m(e,f),_(e,s,f)},p(e,f){f&1&&(v=e[2].edge_is_unique(e[6].def_tech_label.value,e[6].def_artifact_rel_label.value,e[6].off_artifact_label.value)),v?l?l.p(e,f):(l=se(e),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null)},d(e){e&&t(s),l&&l.d(e)}}}function se(i){let v=!i[1].includes(i[6].def_tactic_label.value),s,l=v&&be(i);return{c(){l&&l.c(),s=H()},l(e){l&&l.l(e),s=H()},m(e,f){l&&l.m(e,f),_(e,s,f)},p(e,f){f&3&&(v=!e[1].includes(e[6].def_tactic_label.value)),v?l?l.p(e,f):(l=be(e),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null)},d(e){e&&t(s),l&&l.d(e)}}}function be(i){let v=M(i[6].def_tech.value)+"",s,l,e=i[6].def_tech_label.value+"",f,b,r="-->",T,h,w=i[6].def_artifact_rel_label.value.replace(/ /g,"")+"",k,N,L=M(i[6].off_artifact.value)+"",D,S,B=i[6].off_artifact_label.value+"",G,A,m=i[2].edge_is_unique(i[6].def_tech.value,i[6].def_tactic_label.value,i[6].off_tech_id.value),c,$=i[6].def_tech_label.value.replace(/ |\./g,"")+"",E,C,j=i[6].off_artifact_label.value.replace(/ /g,"")+"",O,F,I=M(i[6].def_tech.value)+"",P,z,J=M(i[6].def_tech.value)+"",V,K,R=m&&pe(i);return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),T=p(r),h=p(`
          | `),k=p(w),N=p(" | "),D=p(L),S=p('["'),G=p(B),A=p(`"];

          `),R&&R.c(),c=p(`
          class `),E=p($),C=p(` DefensiveTechniqueNode;
          class `),O=p(j),F=p(` ArtifactNode;
          click `),P=p(I),z=p(' href "/technique/d3f:'),V=p(J),K=p('";')},l(u){s=o(u,v),l=o(u,'["'),f=o(u,e),b=o(u,'"] '),T=o(u,r),h=o(u,`
          | `),k=o(u,w),N=o(u," | "),D=o(u,L),S=o(u,'["'),G=o(u,B),A=o(u,`"];

          `),R&&R.l(u),c=o(u,`
          class `),E=o(u,$),C=o(u,` DefensiveTechniqueNode;
          class `),O=o(u,j),F=o(u,` ArtifactNode;
          click `),P=o(u,I),z=o(u,' href "/technique/d3f:'),V=o(u,J),K=o(u,'";')},m(u,d){_(u,s,d),_(u,l,d),_(u,f,d),_(u,b,d),_(u,T,d),_(u,h,d),_(u,k,d),_(u,N,d),_(u,D,d),_(u,S,d),_(u,G,d),_(u,A,d),R&&R.m(u,d),_(u,c,d),_(u,E,d),_(u,C,d),_(u,O,d),_(u,F,d),_(u,P,d),_(u,z,d),_(u,V,d),_(u,K,d)},p(u,d){d&1&&v!==(v=M(u[6].def_tech.value)+"")&&q(s,v),d&1&&e!==(e=u[6].def_tech_label.value+"")&&q(f,e),d&1&&w!==(w=u[6].def_artifact_rel_label.value.replace(/ /g,"")+"")&&q(k,w),d&1&&L!==(L=M(u[6].off_artifact.value)+"")&&q(D,L),d&1&&B!==(B=u[6].off_artifact_label.value+"")&&q(G,B),d&1&&(m=u[2].edge_is_unique(u[6].def_tech.value,u[6].def_tactic_label.value,u[6].off_tech_id.value)),m?R?R.p(u,d):(R=pe(u),R.c(),R.m(c.parentNode,c)):R&&(R.d(1),R=null),d&1&&$!==($=u[6].def_tech_label.value.replace(/ |\./g,"")+"")&&q(E,$),d&1&&j!==(j=u[6].off_artifact_label.value.replace(/ /g,"")+"")&&q(O,j),d&1&&I!==(I=M(u[6].def_tech.value)+"")&&q(P,I),d&1&&J!==(J=M(u[6].def_tech.value)+"")&&q(V,J)},d(u){u&&(t(s),t(l),t(f),t(b),t(T),t(h),t(k),t(N),t(D),t(S),t(G),t(A),t(c),t(E),t(C),t(O),t(F),t(P),t(z),t(V),t(K)),R&&R.d(u)}}}function pe(i){let v=M(i[6].def_tech.value)+"",s,l,e=i[6].def_tech_label.value+"",f,b,r="-.->",T,h,w="May "+i[6].def_tactic_label.value,k,N,L=i[6].off_tech_id.value.replace(/ |\./g,"")+"",D,S,B=i[6].off_tech_label.value+"",G,A;return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),T=p(r),h=p(`
            | `),k=p(w),N=p(" | "),D=p(L),S=p('["'),G=p(B),A=p('"] ;')},l(m){s=o(m,v),l=o(m,'["'),f=o(m,e),b=o(m,'"] '),T=o(m,r),h=o(m,`
            | `),k=o(m,w),N=o(m," | "),D=o(m,L),S=o(m,'["'),G=o(m,B),A=o(m,'"] ;')},m(m,c){_(m,s,c),_(m,l,c),_(m,f,c),_(m,b,c),_(m,T,c),_(m,h,c),_(m,k,c),_(m,N,c),_(m,D,c),_(m,S,c),_(m,G,c),_(m,A,c)},p(m,c){c&1&&v!==(v=M(m[6].def_tech.value)+"")&&q(s,v),c&1&&e!==(e=m[6].def_tech_label.value+"")&&q(f,e),c&1&&w!==(w="May "+m[6].def_tactic_label.value)&&q(k,w),c&1&&L!==(L=m[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(D,L),c&1&&B!==(B=m[6].off_tech_label.value+"")&&q(G,B)},d(m){m&&(t(s),t(l),t(f),t(b),t(T),t(h),t(k),t(N),t(D),t(S),t(G),t(A))}}}function oe(i){let v=i[6].off_tech_id.value.replace(/ |\./g,"")+"",s,l,e=i[6].off_tech_label.value+"",f,b,r="-->",T,h,w=i[6].off_artifact_rel_label.value.replace(/ /g,"")+"",k,N,L=M(i[6].off_artifact.value)+"",D,S,B=i[6].off_artifact_label.value+"",G,A,m=i[6].off_tech_id.value.replace(/ |\./g,"")+"",c,$,E=M(i[6].off_artifact.value)+"",C,j,O=M(i[6].off_artifact.value)+"",F,I,P=M(i[6].off_artifact.value)+"",z,J,V=i[6].off_tech_id.value.replace(/ |\./g,"")+"",K,R,u=ae(i[6].off_tech_id.value)+"",d,le,W=M(i[6].off_artifact.value)+"",X,fe,Y=M(i[6].off_artifact.value)+"",Z,te;return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),T=p(r),h=p(" |"),k=p(w),N=p("| "),D=p(L),S=p('["'),G=p(B),A=p('"]; class '),c=p(m),$=p(` OffensiveTechniqueNode;
        class `),C=p(E),j=p(" ArtifactNode; click "),F=p(O),I=p(' href "/dao/artifact/d3f:'),z=p(P),J=p(`";
        click `),K=p(V),R=p(' href "'),d=p(u),le=p('"; click '),X=p(W),fe=p(' href "/dao/artifact/d3f:'),Z=p(Y),te=p('";')},l(a){s=o(a,v),l=o(a,'["'),f=o(a,e),b=o(a,'"] '),T=o(a,r),h=o(a," |"),k=o(a,w),N=o(a,"| "),D=o(a,L),S=o(a,'["'),G=o(a,B),A=o(a,'"]; class '),c=o(a,m),$=o(a,` OffensiveTechniqueNode;
        class `),C=o(a,E),j=o(a," ArtifactNode; click "),F=o(a,O),I=o(a,' href "/dao/artifact/d3f:'),z=o(a,P),J=o(a,`";
        click `),K=o(a,V),R=o(a,' href "'),d=o(a,u),le=o(a,'"; click '),X=o(a,W),fe=o(a,' href "/dao/artifact/d3f:'),Z=o(a,Y),te=o(a,'";')},m(a,n){_(a,s,n),_(a,l,n),_(a,f,n),_(a,b,n),_(a,T,n),_(a,h,n),_(a,k,n),_(a,N,n),_(a,D,n),_(a,S,n),_(a,G,n),_(a,A,n),_(a,c,n),_(a,$,n),_(a,C,n),_(a,j,n),_(a,F,n),_(a,I,n),_(a,z,n),_(a,J,n),_(a,K,n),_(a,R,n),_(a,d,n),_(a,le,n),_(a,X,n),_(a,fe,n),_(a,Z,n),_(a,te,n)},p(a,n){n&1&&v!==(v=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(s,v),n&1&&e!==(e=a[6].off_tech_label.value+"")&&q(f,e),n&1&&w!==(w=a[6].off_artifact_rel_label.value.replace(/ /g,"")+"")&&q(k,w),n&1&&L!==(L=M(a[6].off_artifact.value)+"")&&q(D,L),n&1&&B!==(B=a[6].off_artifact_label.value+"")&&q(G,B),n&1&&m!==(m=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(c,m),n&1&&E!==(E=M(a[6].off_artifact.value)+"")&&q(C,E),n&1&&O!==(O=M(a[6].off_artifact.value)+"")&&q(F,O),n&1&&P!==(P=M(a[6].off_artifact.value)+"")&&q(z,P),n&1&&V!==(V=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(K,V),n&1&&u!==(u=ae(a[6].off_tech_id.value)+"")&&q(d,u),n&1&&W!==(W=M(a[6].off_artifact.value)+"")&&q(X,W),n&1&&Y!==(Y=M(a[6].off_artifact.value)+"")&&q(Z,Y)},d(a){a&&(t(s),t(l),t(f),t(b),t(T),t(h),t(k),t(N),t(D),t(S),t(G),t(A),t(c),t($),t(C),t(j),t(F),t(I),t(z),t(J),t(K),t(R),t(d),t(le),t(X),t(fe),t(Z),t(te))}}}function re(i){let v,s=i[2].edge_is_unique(i[6].off_tech_label.value,i[6].off_artifact_rel_label.value,i[6].off_artifact_label.value),l,e="def_tech"in i[6]&&ve(i),f=s&&oe(i);return{c(){e&&e.c(),v=y(),f&&f.c(),l=H()},l(b){e&&e.l(b),v=ee(b),f&&f.l(b),l=H()},m(b,r){e&&e.m(b,r),_(b,v,r),f&&f.m(b,r),_(b,l,r)},p(b,r){"def_tech"in b[6]?e?e.p(b,r):(e=ve(b),e.c(),e.m(v.parentNode,v)):e&&(e.d(1),e=null),r&1&&(s=b[2].edge_is_unique(b[6].off_tech_label.value,b[6].off_artifact_rel_label.value,b[6].off_artifact_label.value)),s?f?f.p(b,r):(f=oe(b),f.c(),f.m(l.parentNode,l)):f&&(f.d(1),f=null)},d(b){b&&(t(v),t(l)),e&&e.d(b),f&&f.d(b)}}}function Ve(i){let v,s,l=ie(i[0].results.bindings),e=[];for(let f=0;f<l.length;f+=1)e[f]=re(ce(i,l,f));return{c(){v=p(`graph LR;

    `);for(let f=0;f<e.length;f+=1)e[f].c();s=H()},l(f){v=o(f,`graph LR;

    `);for(let b=0;b<e.length;b+=1)e[b].l(f);s=H()},m(f,b){_(f,v,b);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(f,b);_(f,s,b)},p(f,b){if(b&7){l=ie(f[0].results.bindings);let r;for(r=0;r<l.length;r+=1){const T=ce(f,l,r);e[r]?e[r].p(T,b):(e[r]=re(T),e[r].c(),e[r].m(s.parentNode,s))}for(;r<e.length;r+=1)e[r].d(1);e.length=l.length}},d(f){f&&(t(v),t(s)),Me(e,f)}}}function me(i){let v,s;return v=new Se({props:{$$slots:{default:[Ve]},$$scope:{ctx:i}}}),{c(){de(v.$$.fragment)},l(l){ke(v.$$.fragment,l)},m(l,e){he(v,l,e),s=!0},p(l,e){const f={};e&515&&(f.$$scope={dirty:e,ctx:l}),v.$set(f)},i(l){s||(U(v.$$.fragment,l),s=!0)},o(l){Q(v.$$.fragment,l),s=!1},d(l){qe(v,l)}}}function je(i){let v,s,l,e,f,b,r,T,h,w,k,N,L,D;function S(c){i[4](c)}let B={toggles:i[3]};i[1]!==void 0&&(B.selected=i[1]),e=new He({props:B}),Te.push(()=>Ge(e,"selected",S));const G=[Pe,Oe],A=[];function m(c,$){return c[0].results.bindings.length>0?0:1}return k=m(i),N=A[k]=G[k](i),{c(){v=g("br"),s=y(),l=g("div"),de(e.$$.fragment),b=y(),r=g("br"),T=y(),h=g("br"),w=y(),N.c(),L=H(),this.h()},l(c){v=x(c,"BR",{}),s=ee(c),l=x(c,"DIV",{class:!0});var $=we(l);ke(e.$$.fragment,$),$.forEach(t),b=ee(c),r=x(c,"BR",{}),T=ee(c),h=x(c,"BR",{}),w=ee(c),N.l(c),L=H(),this.h()},h(){Le(l,"class","center shrink")},m(c,$){_(c,v,$),_(c,s,$),_(c,l,$),he(e,l,null),_(c,b,$),_(c,r,$),_(c,T,$),_(c,h,$),_(c,w,$),A[k].m(c,$),_(c,L,$),D=!0},p(c,[$]){const E={};!f&&$&2&&(f=!0,E.selected=c[1],Ae(()=>f=!1)),e.$set(E);let C=k;k=m(c),k===C?A[k].p(c,$):($e(),Q(A[C],1,1,()=>{A[C]=null}),Ne(),N=A[k],N?N.p(c,$):(N=A[k]=G[k](c),N.c()),U(N,1),N.m(L.parentNode,L))},i(c){D||(U(e.$$.fragment,c),U(N),D=!0)},o(c){Q(e.$$.fragment,c),Q(N),D=!1},d(c){c&&(t(v),t(s),t(l),t(b),t(r),t(T),t(h),t(w),t(L)),qe(e),A[k].d(c)}}}function Fe(i,v,s){let{off_to_def:l}=v,e=new Ce,f=new Set;l.results.bindings.forEach(h=>{"def_tactic_label"in h&&f.add(h.def_tactic_label.value)});let b=Array.from(f).sort(function(h,w){return ue[h]-ue[w]}),r=["Model"];Ee(b,r)&&(r=[]);function T(h){r=h,s(1,r)}return i.$$set=h=>{"off_to_def"in h&&s(0,l=h.off_to_def)},i.$$.update=()=>{i.$$.dirty&2&&e.reset(r)},[l,r,e,b,T]}class We extends Re{constructor(v){super(),Be(this,v,Fe,je,ne,{off_to_def:0})}}export{We as G};
