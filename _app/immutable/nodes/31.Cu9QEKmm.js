import{e as st}from"../chunks/index.g5YcAAdQ.js";import{s as at,b as N,e as _,j as S,d as p,p as H,f as E,i as r,q as A,k as g,l as m,O as W,I as lt,n as J,t as K,h as R,B as q,G as X}from"../chunks/scheduler.XFNaxh87.js";import{S as it,i as rt,c as ot,b as ct,m as dt,t as ft,a as ut,d as ht}from"../chunks/index.CZJgJfrq.js";import{e as U}from"../chunks/each.BM1lhngx.js";import{T as _t}from"../chunks/Title.CR5zmqnh.js";import{G as pt,h as nt}from"../chunks/lib.Bf3INatD.js";async function mt({fetch:i}){const t=await i("/api/mappings/attack-mitigations.json"),s=await t.json();return t.status!==200&&st(500,s.message||"Internal Server Error"),{mitigations:s}}const It=Object.freeze(Object.defineProperty({__proto__:null,load:mt},Symbol.toStringTag,{value:"Module"}));function Y(i,t,s){const l=i.slice();return l[6]=t[s],l}function Z(i,t,s){const l=i.slice();return l[9]=t[s],l}function vt(i){let t,s="select",l,a;return{c(){t=_("button"),t.textContent=s,this.h()},l(n){t=p(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1h9ul0y"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[5]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function gt(i){let t,s="deselect",l,a;return{c(){t=_("button"),t.textContent=s,this.h()},l(n){t=p(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-iey0zo"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[2]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function Tt(i){let t,s,l=i[6]["@id"]+"",a,n,e,c="not found",T,f,h="<div>not found</div>";return{c(){t=_("td"),s=_("a"),a=K(l),n=N(),e=_("td"),e.textContent=c,T=N(),f=_("td"),f.innerHTML=h,this.h()},l(u){t=p(u,"TD",{});var d=E(t);s=p(d,"A",{style:!0,href:!0});var w=E(s);a=R(w,l),w.forEach(r),d.forEach(r),n=S(u),e=p(u,"TD",{style:!0,"data-svelte-h":!0}),H(e)!=="svelte-zllfjb"&&(e.textContent=c),T=S(u),f=p(u,"TD",{style:!0,"data-svelte-h":!0}),H(f)!=="svelte-uu95jw"&&(f.innerHTML=h),this.h()},h(){q(s,"color","red"),A(s,"href",nt(i[6]["@id"])),q(e,"color","red"),q(f,"color","red")},m(u,d){g(u,t,d),m(t,s),m(s,a),g(u,n,d),g(u,e,d),g(u,T,d),g(u,f,d)},p:J,d(u){u&&(r(t),r(n),r(e),r(T),r(f))}}}function bt(i){let t,s=i[6]["@id"].split(":")[1]+"",l,a,n,e,c=i[6]["rdfs:label"]+"",T,f,h,u,d,w,L=(i[6]["d3f:d3fend-comment"]||"")+"",y,C=i[6]["d3f:related"]&&Et(i);return{c(){t=_("td"),l=K(s),a=N(),n=_("td"),e=_("a"),T=K(c),f=N(),h=_("td"),C&&C.c(),u=N(),d=_("td"),w=_("small"),y=K(L),this.h()},l(v){t=p(v,"TD",{class:!0});var D=E(t);l=R(D,s),D.forEach(r),a=S(v),n=p(v,"TD",{class:!0});var O=E(n);e=p(O,"A",{href:!0});var x=E(e);T=R(x,c),x.forEach(r),O.forEach(r),f=S(v),h=p(v,"TD",{});var V=E(h);C&&C.l(V),V.forEach(r),u=S(v),d=p(v,"TD",{style:!0});var F=E(d);w=p(F,"SMALL",{});var j=E(w);y=R(j,L),j.forEach(r),F.forEach(r),this.h()},h(){A(t,"class","text-center"),A(e,"href",nt(i[6]["@id"].split(":")[1])),A(n,"class",""),q(d,"width","15rem")},m(v,D){g(v,t,D),m(t,l),g(v,a,D),g(v,n,D),m(n,e),m(e,T),g(v,f,D),g(v,h,D),C&&C.m(h,null),g(v,u,D),g(v,d,D),m(d,w),m(w,y)},p(v,D){v[6]["d3f:related"]&&C.p(v,D)},d(v){v&&(r(t),r(a),r(n),r(f),r(h),r(u),r(d)),C&&C.d()}}}function Et(i){let t,s=U(i[6]["d3f:related"]),l=[];for(let a=0;a<s.length;a+=1)l[a]=tt(Z(i,s,a));return{c(){for(let a=0;a<l.length;a+=1)l[a].c();t=X()},l(a){for(let n=0;n<l.length;n+=1)l[n].l(a);t=X()},m(a,n){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(a,n);g(a,t,n)},p(a,n){if(n&2){s=U(a[6]["d3f:related"]);let e;for(e=0;e<s.length;e+=1){const c=Z(a,s,e);l[e]?l[e].p(c,n):(l[e]=tt(c),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=s.length}},d(a){a&&r(t),lt(l,a)}}}function tt(i){let t,s,l=i[1].get_and_cache("@id",i[9]["@id"])["d3f:d3fend-id"]+"",a,n,e,c,T=i[1].current_node["rdfs:label"]+"",f,h;return{c(){t=_("div"),s=_("span"),a=K(l),n=N(),e=_("span"),c=_("a"),f=K(T),h=N(),this.h()},l(u){t=p(u,"DIV",{class:!0});var d=E(t);s=p(d,"SPAN",{style:!0});var w=E(s);a=R(w,l),w.forEach(r),n=S(d),e=p(d,"SPAN",{});var L=E(e);c=p(L,"A",{href:!0,title:!0});var y=E(c);f=R(y,T),y.forEach(r),L.forEach(r),h=S(d),d.forEach(r),this.h()},h(){q(s,"width","5rem"),q(s,"display","inline-block"),A(c,"href","/technique/"+i[9]["@id"]),A(c,"title",i[1].get("@id",i[9]["@id"])["d3f:definition"]),A(t,"class","center")},m(u,d){g(u,t,d),m(t,s),m(s,a),m(t,n),m(t,e),m(e,c),m(c,f),m(t,h)},p:J,d(u){u&&r(t)}}}function et(i){let t,s;function l(e,c){return e[6]?bt:Tt}let n=l(i)(i);return{c(){t=_("tr"),n.c(),s=N()},l(e){t=p(e,"TR",{});var c=E(t);n.l(c),s=S(c),c.forEach(r)},m(e,c){g(e,t,c),n.m(t,null),m(t,s)},p(e,c){n.p(e,c)},d(e){e&&r(t),n.d()}}}function yt(i){let t,s,l,a=`<h1>ATT&amp;CK Mitigations to D3FEND Technique Mappings</h1> <p>The D3FEND team created this mapping in order to help users navigate between
    the two knowledgebases.</p>`,n,e,c,T,f,h,u,d,w="copy",L,y,C,v="<th>ATT&amp;CK ID</th> <th>ATT&amp;CK Enterprise Mitigation</th> <th>Related D3FEND Techniques</th> <th>Comment</th>",D,O,x,V;t=new _t({props:{title:"ATT&CK Mitigations to D3FEND Mappings"}});function F(o,M){return o[0]?gt:vt}let j=F(i),I=j(i),B=U(i[1].get_by_type("d3f:ATTACKEnterpriseMitigation")),k=[];for(let o=0;o<B.length;o+=1)k[o]=et(Y(i,B,o));return{c(){ot(t.$$.fragment),s=N(),l=_("section"),l.innerHTML=a,n=N(),e=_("section"),c=_("div"),T=_("div"),f=_("div"),h=_("div"),I.c(),u=N(),d=_("button"),d.textContent=w,L=N(),y=_("table"),C=_("thead"),C.innerHTML=v,D=N();for(let o=0;o<k.length;o+=1)k[o].c();this.h()},l(o){ct(t.$$.fragment,o),s=S(o),l=p(o,"SECTION",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-vpl4c8"&&(l.innerHTML=a),n=S(o),e=p(o,"SECTION",{});var M=E(e);c=p(M,"DIV",{class:!0});var b=E(c);T=p(b,"DIV",{class:!0});var P=E(T);f=p(P,"DIV",{class:!0});var $=E(f);h=p($,"DIV",{class:!0});var z=E(h);I.l(z),u=S(z),d=p(z,"BUTTON",{"data-svelte-h":!0}),H(d)!=="svelte-1gemhfw"&&(d.textContent=w),z.forEach(r),L=S($),y=p($,"TABLE",{id:!0,class:!0});var G=E(y);C=p(G,"THEAD",{"data-svelte-h":!0}),H(C)!=="svelte-1saihs2"&&(C.innerHTML=v),D=S(G);for(let Q=0;Q<k.length;Q+=1)k[Q].l(G);G.forEach(r),$.forEach(r),P.forEach(r),b.forEach(r),M.forEach(r),this.h()},h(){A(l,"class","content"),A(h,"class","text-right"),A(y,"id","mappings"),A(y,"class","table-auto"),A(f,"class","results-wrap"),A(T,"class","card stretch shrink center"),A(c,"class","")},m(o,M){dt(t,o,M),g(o,s,M),g(o,l,M),g(o,n,M),g(o,e,M),m(e,c),m(c,T),m(T,f),m(f,h),I.m(h,null),m(h,u),m(h,d),m(f,L),m(f,y),m(y,C),m(y,D);for(let b=0;b<k.length;b+=1)k[b]&&k[b].m(y,null);O=!0,x||(V=W(d,"click",kt),x=!0)},p(o,[M]){if(j===(j=F(o))&&I?I.p(o,M):(I.d(1),I=j(o),I&&(I.c(),I.m(h,u))),M&2){B=U(o[1].get_by_type("d3f:ATTACKEnterpriseMitigation"));let b;for(b=0;b<B.length;b+=1){const P=Y(o,B,b);k[b]?k[b].p(P,M):(k[b]=et(P),k[b].c(),k[b].m(y,null))}for(;b<k.length;b+=1)k[b].d(1);k.length=B.length}},i(o){O||(ft(t.$$.fragment,o),O=!0)},o(o){ut(t.$$.fragment,o),O=!1},d(o){o&&(r(s),r(l),r(n),r(e)),ht(t,o),I.d(),lt(k,o),x=!1,V()}}}function kt(){document.execCommand("copy")}function Ct(i,t,s){let{data:l}=t,a=new pt(l.mitigations),n=!1;function e(){window.getSelection().removeAllRanges(),s(0,n=!1)}function c(f){const h=window.getSelection();h.removeAllRanges();const u=document.getElementById(f),d=document.createRange();d.selectNodeContents(u),h.addRange(d),s(0,n=!0)}const T=()=>c("mappings");return i.$$set=f=>{"data"in f&&s(4,l=f.data)},[n,a,e,c,l,T]}class Lt extends it{constructor(t){super(),rt(this,t,Ct,yt,at,{data:4})}}export{Lt as component,It as universal};
