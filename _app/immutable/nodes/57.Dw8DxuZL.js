import{e as Me}from"../chunks/index.g5YcAAdQ.js";import{s as Ve,b as L,e as p,j as M,d as v,f as A,p as G,i,q as $,k as I,l as f,N as me,P as se,v as Se,o as Be,C as Re,t as P,h as x,B as pe,m as U,n as Q,H as oe,J as ve,D as be}from"../chunks/scheduler.CpyzObLs.js";import{h as de,u as He}from"../chunks/await_block.v2v79I6O.js";import{e as ie}from"../chunks/each.9QANBvbJ.js";import{S as Pe,i as xe,c as ce,b as fe,m as ue,t as W,a as Z,d as he,g as qe,e as je}from"../chunks/index.CTZRj-VU.js";import{a as Oe,S as Le}from"../chunks/extract.C_YZ3hQR.js";import{G as ge,d as _e,k as ke,i as ne}from"../chunks/lib.DCwHEN4o.js";import{T as Ke}from"../chunks/Title.CJW-ouAc.js";import{H as Fe}from"../chunks/Header.jCTqvRC3.js";import{A as ze}from"../chunks/Alert.Cic_FqY9.js";import{p as Ue}from"../chunks/stores.BSH_B139.js";async function Ge({fetch:n}){const e=await n("/api/offensive-technique/all.json"),t=await e.json();return e.status!==200&&Me(500,data.message),{techniques:t}}const Et=Object.freeze(Object.defineProperty({__proto__:null,load:Ge},Symbol.toStringTag,{value:"Module"}));function Ee(n,e,t){const l=n.slice();return l[21]=e[t],l}function Te(n,e,t){const l=n.slice();return l[25]=e[t],l}function De(n,e,t){const l=n.slice();return l[29]=e[t],l}function Je(n){let e,t,l=n[28].message+"",a;return{c(){e=p("p"),t=P("error with promise: "),a=P(l),this.h()},l(s){e=v(s,"P",{style:!0});var r=A(e);t=x(r,"error with promise: "),a=x(r,l),r.forEach(i),this.h()},h(){pe(e,"color","red")},m(s,r){I(s,e,r),f(e,t),f(e,a)},p(s,r){r[0]&32&&l!==(l=s[28].message+"")&&U(a,l)},i:Q,o:Q,d(s){s&&i(e)}}}function Xe(n){let e,t,l,a;const s=[Qe,Ye],r=[];function u(h,m){return h[20].length>0?0:!h[3]&&h[20].length<1?1:-1}return~(e=u(n))&&(t=r[e]=s[e](n)),{c(){t&&t.c(),l=oe()},l(h){t&&t.l(h),l=oe()},m(h,m){~e&&r[e].m(h,m),I(h,l,m),a=!0},p(h,m){let y=e;e=u(h),e===y?~e&&r[e].p(h,m):(t&&(qe(),Z(r[y],1,1,()=>{r[y]=null}),je()),~e?(t=r[e],t?t.p(h,m):(t=r[e]=s[e](h),t.c()),W(t,1),t.m(l.parentNode,l)):t=null)},i(h){a||(W(t),a=!0)},o(h){Z(t),a=!1},d(h){h&&i(l),~e&&r[e].d(h)}}}function Ye(n){let e,t="No ATT&CK techniques found in text.";return{c(){e=p("div"),e.textContent=t,this.h()},l(l){e=v(l,"DIV",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-1f3fsck"&&(e.textContent=t),this.h()},h(){$(e,"class","card")},m(l,a){I(l,e,a)},p:Q,i:Q,o:Q,d(l){l&&i(e)}}}function Qe(n){let e,t,l,a,s,r,u,h,m,y,k,T="<b><i>Mapping Results:</i></b>",D,S,j,g,c,E="copy",_,d,C,w='<th class="stretch">ATT&amp;CK ID</th> <th>ATT&amp;CK Name</th> <th>Related D3FEND Techniques</th>',V,H,R,J,q=n[0]&&Ce(n);a=new ze({props:{$$slots:{default:[We]},$$scope:{ctx:n}}}),m=new Le({props:{url:n[6].url}});function X(o,N){return o[2]?et:Ze}let Y=X(n),O=Y(n),B=ie(n[20]),b=[];for(let o=0;o<B.length;o+=1)b[o]=Ie(Ee(n,B,o));return{c(){e=p("div"),q&&q.c(),t=L(),l=p("div"),ce(a.$$.fragment),s=L(),r=p("div"),u=p("div"),h=p("div"),ce(m.$$.fragment),y=L(),k=p("div"),k.innerHTML=T,D=L(),S=p("div"),j=p("div"),O.c(),g=L(),c=p("button"),c.textContent=E,_=L(),d=p("table"),C=p("thead"),C.innerHTML=w,V=L();for(let o=0;o<b.length;o+=1)b[o].c();this.h()},l(o){e=v(o,"DIV",{class:!0});var N=A(e);q&&q.l(N),N.forEach(i),t=M(o),l=v(o,"DIV",{class:!0});var F=A(l);fe(a.$$.fragment,F),F.forEach(i),s=M(o),r=v(o,"DIV",{class:!0});var z=A(r);u=v(z,"DIV",{class:!0});var K=A(u);h=v(K,"DIV",{class:!0});var ee=A(h);fe(m.$$.fragment,ee),ee.forEach(i),K.forEach(i),y=M(z),k=v(z,"DIV",{"data-svelte-h":!0}),G(k)!=="svelte-1hnfu3y"&&(k.innerHTML=T),D=M(z),S=v(z,"DIV",{class:!0});var te=A(S);j=v(te,"DIV",{class:!0});var le=A(j);O.l(le),g=M(le),c=v(le,"BUTTON",{"data-svelte-h":!0}),G(c)!=="svelte-1gemhfw"&&(c.textContent=E),le.forEach(i),_=M(te),d=v(te,"TABLE",{id:!0,class:!0});var ae=A(d);C=v(ae,"THEAD",{"data-svelte-h":!0}),G(C)!=="svelte-17r3wjn"&&(C.innerHTML=w),V=M(ae);for(let re=0;re<b.length;re+=1)b[re].l(ae);ae.forEach(i),te.forEach(i),z.forEach(i),this.h()},h(){$(e,"class","card"),$(l,"class","card"),$(h,"class","text-right"),$(u,"class","stretch"),$(j,"class","text-right"),$(d,"id","mappings"),$(d,"class","table-auto"),$(S,"class","results-wrap center svelte-xumjr3"),$(r,"class","card")},m(o,N){I(o,e,N),q&&q.m(e,null),I(o,t,N),I(o,l,N),ue(a,l,null),I(o,s,N),I(o,r,N),f(r,u),f(u,h),ue(m,h,null),f(r,y),f(r,k),f(r,D),f(r,S),f(S,j),O.m(j,null),f(j,g),f(j,c),f(S,_),f(S,d),f(d,C),f(d,V);for(let F=0;F<b.length;F+=1)b[F]&&b[F].m(d,null);H=!0,R||(J=se(c,"click",it),R=!0)},p(o,N){o[0]?q?(q.p(o,N),N[0]&1&&W(q,1)):(q=Ce(o),q.c(),W(q,1),q.m(e,null)):q&&(qe(),Z(q,1,1,()=>{q=null}),je());const F={};N[1]&2&&(F.$$scope={dirty:N,ctx:o}),a.$set(F);const z={};if(N[0]&64&&(z.url=o[6].url),m.$set(z),Y===(Y=X(o))&&O?O.p(o,N):(O.d(1),O=Y(o),O&&(O.c(),O.m(j,g))),N[0]&48){B=ie(o[20]);let K;for(K=0;K<B.length;K+=1){const ee=Ee(o,B,K);b[K]?b[K].p(ee,N):(b[K]=Ie(ee),b[K].c(),b[K].m(d,null))}for(;K<b.length;K+=1)b[K].d(1);b.length=B.length}},i(o){H||(W(q),W(a.$$.fragment,o),W(m.$$.fragment,o),H=!0)},o(o){Z(q),Z(a.$$.fragment,o),Z(m.$$.fragment,o),H=!1},d(o){o&&(i(e),i(t),i(l),i(s),i(r)),q&&q.d(),he(a),he(m),O.d(),ve(b,o),R=!1,J()}}}function Ce(n){let e,t,l,a,s,r,u,h,m=n[0].length+"",y,k,T,D,S;l=new Le({props:{url:n[6].url}});let j=ie(n[0]),g=[];for(let c=0;c<j.length;c+=1)g[c]=we(De(n,j,c));return{c(){e=p("div"),t=p("div"),ce(l.$$.fragment),a=L(),s=p("div"),r=p("b"),u=p("i"),h=P("Extracted "),y=P(m),k=P(" unique IDs:"),T=L(),D=p("dl");for(let c=0;c<g.length;c+=1)g[c].c();this.h()},l(c){e=v(c,"DIV",{class:!0});var E=A(e);t=v(E,"DIV",{class:!0});var _=A(t);fe(l.$$.fragment,_),_.forEach(i),E.forEach(i),a=M(c),s=v(c,"DIV",{class:!0});var d=A(s);r=v(d,"B",{});var C=A(r);u=v(C,"I",{});var w=A(u);h=x(w,"Extracted "),y=x(w,m),k=x(w," unique IDs:"),w.forEach(i),C.forEach(i),T=M(d),D=v(d,"DL",{class:!0});var V=A(D);for(let H=0;H<g.length;H+=1)g[H].l(V);V.forEach(i),d.forEach(i),this.h()},h(){$(t,"class","text-right"),$(e,"class","stretch"),$(D,"class","flex flex-wrap svelte-xumjr3"),$(s,"class","")},m(c,E){I(c,e,E),f(e,t),ue(l,t,null),I(c,a,E),I(c,s,E),f(s,r),f(r,u),f(u,h),f(u,y),f(u,k),f(s,T),f(s,D);for(let _=0;_<g.length;_+=1)g[_]&&g[_].m(D,null);S=!0},p(c,E){const _={};if(E[0]&64&&(_.url=c[6].url),l.$set(_),(!S||E[0]&1)&&m!==(m=c[0].length+"")&&U(y,m),E[0]&1){j=ie(c[0]);let d;for(d=0;d<j.length;d+=1){const C=De(c,j,d);g[d]?g[d].p(C,E):(g[d]=we(C),g[d].c(),g[d].m(D,null))}for(;d<g.length;d+=1)g[d].d(1);g.length=j.length}},i(c){S||(W(l.$$.fragment,c),S=!0)},o(c){Z(l.$$.fragment,c),S=!1},d(c){c&&(i(e),i(a),i(s)),he(l),ve(g,c)}}}function we(n){let e,t,l=n[29]+"",a,s;return{c(){e=p("dd"),t=p("a"),a=P(l),this.h()},l(r){e=v(r,"DD",{});var u=A(e);t=v(u,"A",{href:!0});var h=A(t);a=x(h,l),h.forEach(i),u.forEach(i),this.h()},h(){$(t,"href",s=_e(n[29]))},m(r,u){I(r,e,u),f(e,t),f(t,a)},p(r,u){u[0]&1&&l!==(l=r[29]+"")&&U(a,l),u[0]&1&&s!==(s=_e(r[29]))&&$(t,"href",s)},d(r){r&&i(e)}}}function We(n){let e,t="Note: ",l;return{c(){e=p("b"),e.textContent=t,l=P(`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},l(a){e=v(a,"B",{"data-svelte-h":!0}),G(e)!=="svelte-gwu32y"&&(e.textContent=t),l=x(a,`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},m(a,s){I(a,e,s),I(a,l,s)},p:Q,d(a){a&&(i(e),i(l))}}}function Ze(n){let e,t="select",l,a;return{c(){e=p("button"),e.textContent=t,this.h()},l(s){e=v(s,"BUTTON",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-3feg34"&&(e.textContent=t),this.h()},h(){$(e,"class","selector svelte-xumjr3")},m(s,r){I(s,e,r),l||(a=se(e,"click",n[9]),l=!0)},p:Q,d(s){s&&i(e),l=!1,a()}}}function et(n){let e,t="deselect",l,a;return{c(){e=p("button"),e.textContent=t,this.h()},l(s){e=v(s,"BUTTON",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-iey0zo"&&(e.textContent=t),this.h()},h(){$(e,"class","selector svelte-xumjr3")},m(s,r){I(s,e,r),l||(a=se(e,"click",n[8]),l=!0)},p:Q,d(s){s&&i(e),l=!1,a()}}}function tt(n){let e,t,l=n[28].message+"",a,s,r=console.log(n[28])+"",u;return{c(){e=p("p"),t=P("error with row: "),a=P(l),s=L(),u=P(r),this.h()},l(h){e=v(h,"P",{style:!0});var m=A(e);t=x(m,"error with row: "),a=x(m,l),m.forEach(i),s=M(h),u=x(h,r),this.h()},h(){pe(e,"color","red")},m(h,m){I(h,e,m),f(e,t),f(e,a),I(h,s,m),I(h,u,m)},p(h,m){m[0]&32&&l!==(l=h[28].message+"")&&U(a,l),m[0]&32&&r!==(r=console.log(h[28])+"")&&U(u,r)},d(h){h&&(i(e),i(s),i(u))}}}function lt(n){let e;function t(s,r){return s[24].description.graph[0]?rt:at}let l=t(n),a=l(n);return{c(){a.c(),e=oe()},l(s){a.l(s),e=oe()},m(s,r){a.m(s,r),I(s,e,r)},p(s,r){l===(l=t(s))&&a?a.p(s,r):(a.d(1),a=l(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&i(e),a.d(s)}}}function at(n){let e,t,l=n[24].id+"",a,s,r,u,h="not found in D3FEND graph",m,y;return{c(){e=p("td"),t=p("a"),a=P(l),r=L(),u=p("td"),u.textContent=h,m=L(),y=p("td"),this.h()},l(k){e=v(k,"TD",{class:!0});var T=A(e);t=v(T,"A",{style:!0,href:!0});var D=A(t);a=x(D,l),D.forEach(i),T.forEach(i),r=M(k),u=v(k,"TD",{"data-svelte-h":!0}),G(u)!=="svelte-mgiypo"&&(u.textContent=h),m=M(k),y=v(k,"TD",{}),A(y).forEach(i),this.h()},h(){pe(t,"color","red"),$(t,"href",s=ke(n[24].id)),$(e,"class","text-center")},m(k,T){I(k,e,T),f(e,t),f(t,a),I(k,r,T),I(k,u,T),I(k,m,T),I(k,y,T)},p(k,T){T[0]&32&&l!==(l=k[24].id+"")&&U(a,l),T[0]&32&&s!==(s=ke(k[24].id))&&$(t,"href",s)},d(k){k&&(i(e),i(r),i(u),i(m),i(y))}}}function rt(n){let e,t,l=n[24].description.graph[0]["d3f:attack-id"]+"",a,s,r,u,h=n[24].description.graph[0]["rdfs:label"]+"",m,y,k,T,D,S='<th scope="col">off rel</th> <th scope="col">off artifact</th> <th scope="col">D3FEND Tactic</th> <th scope="col">D3FEND Technique</th> <th scope="col">def rel</th> <th scope="col">def artifact</th>',j,g=ie(Ne(n[24].off_to_def.results.bindings)),c=[];for(let _=0;_<g.length;_+=1)c[_]=$e(Te(n,g,_));let E=null;return g.length||(E=Ae()),{c(){e=p("th"),t=p("a"),a=P(l),r=L(),u=p("td"),m=P(h),y=L(),k=p("td"),T=p("table"),D=p("thead"),D.innerHTML=S,j=L();for(let _=0;_<c.length;_+=1)c[_].c();E&&E.c(),this.h()},l(_){e=v(_,"TH",{class:!0,scope:!0});var d=A(e);t=v(d,"A",{href:!0});var C=A(t);a=x(C,l),C.forEach(i),d.forEach(i),r=M(_),u=v(_,"TD",{});var w=A(u);m=x(w,h),w.forEach(i),y=M(_),k=v(_,"TD",{});var V=A(k);T=v(V,"TABLE",{class:!0});var H=A(T);D=v(H,"THEAD",{class:!0,"data-svelte-h":!0}),G(D)!=="svelte-hv82y0"&&(D.innerHTML=S),j=M(H);for(let R=0;R<c.length;R+=1)c[R].l(H);E&&E.l(H),H.forEach(i),V.forEach(i),this.h()},h(){$(t,"href",s=_e(n[24].id)),$(e,"class","text-center"),$(e,"scope","row"),$(D,"class","svelte-xumjr3"),be(D,"hide",n[4]),$(T,"class","table-auto w100 svelte-xumjr3")},m(_,d){I(_,e,d),f(e,t),f(t,a),I(_,r,d),I(_,u,d),f(u,m),I(_,y,d),I(_,k,d),f(k,T),f(T,D),f(T,j);for(let C=0;C<c.length;C+=1)c[C]&&c[C].m(T,null);E&&E.m(T,null)},p(_,d){if(d[0]&32&&l!==(l=_[24].description.graph[0]["d3f:attack-id"]+"")&&U(a,l),d[0]&32&&s!==(s=_e(_[24].id))&&$(t,"href",s),d[0]&32&&h!==(h=_[24].description.graph[0]["rdfs:label"]+"")&&U(m,h),d[0]&16&&be(D,"hide",_[4]),d[0]&32){g=ie(Ne(_[24].off_to_def.results.bindings));let C;for(C=0;C<g.length;C+=1){const w=Te(_,g,C);c[C]?c[C].p(w,d):(c[C]=$e(w),c[C].c(),c[C].m(T,null))}for(;C<c.length;C+=1)c[C].d(1);c.length=g.length,!g.length&&E?E.p(_,d):g.length?E&&(E.d(1),E=null):(E=Ae(),E.c(),E.m(T,null))}},d(_){_&&(i(e),i(r),i(u),i(y),i(k)),ve(c,_),E&&E.d()}}}function Ae(n){let e,t='no defensive relations <a href="/contribute">yet</a> ';return{c(){e=p("td"),e.innerHTML=t,this.h()},l(l){e=v(l,"TD",{colspan:!0,"data-svelte-h":!0}),G(e)!=="svelte-3z0dm2"&&(e.innerHTML=t),this.h()},h(){$(e,"colspan","5")},m(l,a){I(l,e,a)},p:Q,d(l){l&&i(e)}}}function ye(n){let e,t,l=n[25].off_artifact_rel_label.value+"",a,s,r,u,h=n[25].off_artifact_label.value+"",m,y,k,T,D=n[25].def_tactic_label.value+"",S,j,g,c,E=n[25].def_tech_label.value+"",_,d,C,w,V=n[25].def_artifact_rel_label.value+"",H,R,J,q,X=n[25].def_artifact_label.value+"",Y,O,B;return{c(){e=p("tr"),t=p("td"),a=P(l),s=L(),r=p("td"),u=p("a"),m=P(h),k=L(),T=p("td"),S=P(D),j=L(),g=p("td"),c=p("a"),_=P(E),C=L(),w=p("td"),H=P(V),R=L(),J=p("td"),q=p("a"),Y=P(X),B=L(),this.h()},l(b){e=v(b,"TR",{});var o=A(e);t=v(o,"TD",{});var N=A(t);a=x(N,l),N.forEach(i),s=M(o),r=v(o,"TD",{});var F=A(r);u=v(F,"A",{href:!0});var z=A(u);m=x(z,h),z.forEach(i),F.forEach(i),k=M(o),T=v(o,"TD",{});var K=A(T);S=x(K,D),K.forEach(i),j=M(o),g=v(o,"TD",{});var ee=A(g);c=v(ee,"A",{href:!0});var te=A(c);_=x(te,E),te.forEach(i),ee.forEach(i),C=M(o),w=v(o,"TD",{});var le=A(w);H=x(le,V),le.forEach(i),R=M(o),J=v(o,"TD",{});var ae=A(J);q=v(ae,"A",{href:!0});var re=A(q);Y=x(re,X),re.forEach(i),ae.forEach(i),B=M(o),o.forEach(i),this.h()},h(){$(u,"href",y="/dao/artifact/"+ne(n[25].off_artifact.value)),$(c,"href",d="/technique/"+ne(n[25].def_tech.value)),$(q,"href",O="/dao/artifact/"+ne(n[25].def_artifact.value))},m(b,o){I(b,e,o),f(e,t),f(t,a),f(e,s),f(e,r),f(r,u),f(u,m),f(e,k),f(e,T),f(T,S),f(e,j),f(e,g),f(g,c),f(c,_),f(e,C),f(e,w),f(w,H),f(e,R),f(e,J),f(J,q),f(q,Y),f(e,B)},p(b,o){o[0]&32&&l!==(l=b[25].off_artifact_rel_label.value+"")&&U(a,l),o[0]&32&&h!==(h=b[25].off_artifact_label.value+"")&&U(m,h),o[0]&32&&y!==(y="/dao/artifact/"+ne(b[25].off_artifact.value))&&$(u,"href",y),o[0]&32&&D!==(D=b[25].def_tactic_label.value+"")&&U(S,D),o[0]&32&&E!==(E=b[25].def_tech_label.value+"")&&U(_,E),o[0]&32&&d!==(d="/technique/"+ne(b[25].def_tech.value))&&$(c,"href",d),o[0]&32&&V!==(V=b[25].def_artifact_rel_label.value+"")&&U(H,V),o[0]&32&&X!==(X=b[25].def_artifact_label.value+"")&&U(Y,X),o[0]&32&&O!==(O="/dao/artifact/"+ne(b[25].def_artifact.value))&&$(q,"href",O)},d(b){b&&i(e)}}}function $e(n){let e,t=n[25].def_tech&&ye(n);return{c(){t&&t.c(),e=oe()},l(l){t&&t.l(l),e=oe()},m(l,a){t&&t.m(l,a),I(l,e,a)},p(l,a){l[25].def_tech?t?t.p(l,a):(t=ye(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&i(e),t&&t.d(l)}}}function nt(n){let e;return{c(){e=P("loading...")},l(t){e=x(t,"loading...")},m(t,l){I(t,e,l)},p:Q,d(t){t&&i(e)}}}function Ie(n){let e,t,l,a={ctx:n,current:null,token:null,hasCatch:!0,pending:nt,then:lt,catch:tt,value:24,error:28};return de(t=n[21],a),{c(){e=p("tr"),a.block.c(),l=L()},l(s){e=v(s,"TR",{});var r=A(e);a.block.l(r),l=M(r),r.forEach(i)},m(s,r){I(s,e,r),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,f(e,l)},p(s,r){n=s,a.ctx=n,r[0]&32&&t!==(t=n[21])&&de(t,a)||He(a,n,r)},d(s){s&&i(e),a.block.d(),a.token=null,a=null}}}function st(n){let e;return{c(){e=P("enter text and click go")},l(t){e=x(t,"enter text and click go")},m(t,l){I(t,e,l)},p:Q,i:Q,o:Q,d(t){t&&i(e)}}}function ot(n){let e,t,l,a,s,r,u,h="ATT&CK Extractor",m,y,k=`Extracts ATT&amp;CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the <a href="/tools/d3fend-extractor">D3FEND Extractor</a>
      or the <a href="/tools/artifact-extractor">Artifact Extractor.</a>`,T,D,S="<i>Paste any text containing ATT&amp;CK IDs:</i>",j,g,c,E,_,d,C="GO",w,V,H,R,J,q,X,Y,O;e=new Ke({props:{title:"ATT&CK Extractor | Tools | "}}),a=new Fe({});let B={ctx:n,current:null,token:null,hasCatch:!0,pending:st,then:Xe,catch:Je,value:20,error:28,blocks:[,,,]};return de(q=n[5],B),{c(){ce(e.$$.fragment),t=L(),l=p("section"),ce(a.$$.fragment),s=L(),r=p("div"),u=p("h1"),u.textContent=h,m=L(),y=p("p"),y.innerHTML=k,T=L(),D=p("p"),D.innerHTML=S,j=L(),g=p("div"),c=p("textarea"),E=L(),_=p("div"),d=p("button"),d.textContent=C,w=L(),V=p("br"),H=L(),R=p("br"),J=L(),B.block.c(),this.h()},l(b){fe(e.$$.fragment,b),t=M(b),l=v(b,"SECTION",{class:!0});var o=A(l);fe(a.$$.fragment,o),s=M(o),r=v(o,"DIV",{class:!0});var N=A(r);u=v(N,"H1",{"data-svelte-h":!0}),G(u)!=="svelte-of1ivt"&&(u.textContent=h),m=M(N),y=v(N,"P",{"data-svelte-h":!0}),G(y)!=="svelte-12tzzip"&&(y.innerHTML=k),T=M(N),D=v(N,"P",{class:!0,"data-svelte-h":!0}),G(D)!=="svelte-10wdblh"&&(D.innerHTML=S),j=M(N),g=v(N,"DIV",{});var F=A(g);c=v(F,"TEXTAREA",{class:!0}),A(c).forEach(i),F.forEach(i),E=M(N),_=v(N,"DIV",{});var z=A(_);d=v(z,"BUTTON",{class:!0,"data-svelte-h":!0}),G(d)!=="svelte-88k995"&&(d.textContent=C),z.forEach(i),w=M(N),V=v(N,"BR",{}),N.forEach(i),H=M(o),R=v(o,"BR",{}),J=M(o),B.block.l(o),o.forEach(i),this.h()},h(){$(D,"class","text-2"),$(c,"class","svelte-xumjr3"),$(d,"class","button"),$(r,"class","card"),$(l,"class"," svelte-xumjr3")},m(b,o){ue(e,b,o),I(b,t,o),I(b,l,o),ue(a,l,null),f(l,s),f(l,r),f(r,u),f(r,m),f(r,y),f(r,T),f(r,D),f(r,j),f(r,g),f(g,c),me(c,n[1]),f(r,E),f(r,_),f(_,d),f(r,w),f(r,V),f(l,H),f(l,R),f(l,J),B.block.m(l,B.anchor=null),B.mount=()=>l,B.anchor=null,X=!0,Y||(O=[se(c,"input",n[12]),se(c,"keypress",n[10]),se(d,"click",n[7])],Y=!0)},p(b,o){n=b,o[0]&2&&me(c,n[1]),B.ctx=n,o[0]&32&&q!==(q=n[5])&&de(q,B)||He(B,n,o)},i(b){X||(W(e.$$.fragment,b),W(a.$$.fragment,b),W(B.block),X=!0)},o(b){Z(e.$$.fragment,b),Z(a.$$.fragment,b);for(let o=0;o<3;o+=1){const N=B.blocks[o];Z(N)}X=!1},d(b){b&&(i(t),i(l)),he(e,b),he(a),B.block.d(),B.token=null,B=null,Y=!1,Se(O)}}}function it(){document.execCommand("copy")}function Ne(n){let e=new Set,t=[];return n.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function ct(n,e,t){let l;Be(n,Ue,w=>t(6,l=w));let{data:a}=e;const s=new ge(a.techniques,{index:!0,index_key:"d3f:attack-id"});let r,u="",h=!1,m=!0,y,k=[];function T(){t(0,r=[]),t(2,h=!1),t(3,m=!0),k=[]}y=l.url.searchParams.get("q");let D=!1;async function S(w){let V="/api/offensive-technique/attack/"+w+".json";const H=await fetch(V);if(H.status==404)return{id:w,off_to_def:[],description:{graph:[]},status:H.status};if(H.ok){const R=await H.json();return{id:w,off_to_def:R.off_to_def,description:new ge(R.description)}}else throw console.log(`Error processing ${w}, response status: ${H.status}`),console.dir(H),new Error(`Error processing ${w}, response status: ${H.status}`)}async function j(){return T(),t(0,r=Array.from(new Set(Oe(u,s)))),r?(r.forEach(function(w){let V;V=S(w),V&&k.push(V)}),l.url.searchParams.set("q",JSON.stringify(r)),history.replaceState(null,"mapping",l.url)):(T(),console.debug("no matches")),k}let g=j();function c(){t(5,g=j()),t(3,m=!1)}function E(){window.getSelection().removeAllRanges(),t(2,h=!1),t(4,D=!1)}function _(){t(4,D=!0);let w="mappings";const V=window.getSelection();V.removeAllRanges();let H=document.getElementById(w);const R=document.createRange();R.selectNodeContents(H),V.addRange(R),t(2,h=!0)}function d(w){w.ctrlKey==!0&&w.keyCode==13&&c()}Re(async()=>{y?(t(1,u=y),console.log("handlingclick"),c()):(console.log("starting blank"),t(1,u=""))});function C(){u=this.value,t(1,u)}return n.$$set=w=>{"data"in w&&t(11,a=w.data)},[r,u,h,m,D,g,l,c,E,_,d,a,C]}class Tt extends Pe{constructor(e){super(),xe(this,e,ct,ot,Ve,{data:11},null,[-1,-1])}}export{Tt as component,Et as universal};
