import{s as ae,A as _e,k as O,i as _,o as ve,c as ke,e as N,b as y,d as I,f as S,j as L,w as g,N as le,C as ue,l as k,u as Ce,g as we,a as Me,a1 as Se,I as Fe,al as Zl,t as U,h as G,H as ut,p as j,m as Pe,y as ge,Q as dt,z as Bl,n as K,x as it,v as Ee,M as Te,am as lt,an as ul,q as dl,r as te,V as Ne,Y as ml,O as xe,P as et,a4 as Ue,ao as Xe,ap as pl,_ as hl,T as Rl,W as jl}from"../chunks/scheduler.7zAg_eaB.js";import{h as mt,u as Fl}from"../chunks/await_block.9xoawilt.js";import{S as ce,i as fe,t as b,g as Y,a as C,e as x,p as ye,c as V,b as Z,m as A,d as H,h as st,j as _l,f as Ul}from"../chunks/index.vxbr_JN5.js";import{p as Gl}from"../chunks/stores.bUOSBtvh.js";import{b as Kl,g as at}from"../chunks/entry.wLCUkRYN.js";import{s as Jl,L as Ql,J as Wl}from"../chunks/dialog.3Chx4qpX.js";import{w as ft,d as Xl}from"../chunks/index.wZ80w3Bq.js";import{s as tt,a as Ae,f as Ge}from"../chunks/index.hWGBC9hZ.js";import{m as Q,c as ct,a as Yl}from"../chunks/measures.pOV5d6Py.js";import{e as Oe}from"../chunks/each.VblL_ow5.js";/* empty css                             */import{S as X,M as ie,P as Le}from"../chunks/consts.d4TzO-0d.js";import{a as je,T as xl}from"../chunks/updateDefendTree.qqE8uPg9.js";import{S as en}from"../chunks/SimpleAutocomplete.1w6EEtpq.js";import{D as tn}from"../chunks/D3FMatrix.ChwEDLAz.js";import{T as ln}from"../chunks/Title.3Sn_73zX.js";import{T as nn}from"../chunks/Technique.NZLdRsww.js";const pt=(n,e=[])=>{let l=()=>{};for(let{query:t,transition:i,...s}of e)if(window.matchMedia(t).matches)return i(n,s);return l},sn=n=>({}),ht=n=>({}),on=n=>({}),_t=n=>({id:"matrix-slot"}),rn=n=>({}),gt=n=>({id:"drawer-content"});function bt(n){let e,l,t,i,s,o=n[0].isDrawerOpen&&$t(n);const r=n[2].matrix,a=ke(r,n,n[1],_t),c=n[2].legend,p=ke(c,n,n[1],ht);return{c(){e=N("main"),o&&o.c(),l=y(),t=N("section"),a&&a.c(),i=y(),p&&p.c(),this.h()},l(f){e=I(f,"MAIN",{style:!0,class:!0});var m=S(e);o&&o.l(m),l=L(m),t=I(m,"SECTION",{id:!0,class:!0});var u=S(t);a&&a.l(u),i=L(u),p&&p.l(u),u.forEach(_),m.forEach(_),this.h()},h(){g(t,"id","container-matrix"),g(t,"class","svelte-mlvs39"),le(t,"expand-matrix",n[0].isDrawerOpen),ue(e,"--drawer-width",cn),ue(e,"--ANIMATION_TIMING",We),g(e,"class","svelte-mlvs39")},m(f,m){O(f,e,m),o&&o.m(e,null),k(e,l),k(e,t),a&&a.m(t,null),k(t,i),p&&p.m(t,null),s=!0},p(f,m){f[0].isDrawerOpen?o?(o.p(f,m),m&1&&b(o,1)):(o=$t(f),o.c(),b(o,1),o.m(e,l)):o&&(Y(),C(o,1,1,()=>{o=null}),x()),a&&a.p&&(!s||m&2)&&Ce(a,r,f,f[1],s?Me(r,f[1],m,on):we(f[1]),_t),p&&p.p&&(!s||m&2)&&Ce(p,c,f,f[1],s?Me(c,f[1],m,sn):we(f[1]),ht),(!s||m&1)&&le(t,"expand-matrix",f[0].isDrawerOpen)},i(f){s||(b(o),b(a,f),b(p,f),s=!0)},o(f){C(o),C(a,f),C(p,f),s=!1},d(f){f&&_(e),o&&o.d(),a&&a.d(f),p&&p.d(f)}}}function $t(n){let e,l,t;const i=n[2].drawer,s=ke(i,n,n[1],gt);return{c(){e=N("aside"),s&&s.c(),this.h()},l(o){e=I(o,"ASIDE",{id:!0,class:!0});var r=S(e);s&&s.l(r),r.forEach(_),this.h()},h(){g(e,"id","container-drawer"),g(e,"class","svelte-mlvs39"),le(e,"drawer-closed",!n[0].isDrawerOpen)},m(o,r){O(o,e,r),s&&s.m(e,null),t=!0},p(o,r){n=o,s&&s.p&&(!t||r&2)&&Ce(s,i,n,n[1],t?Me(i,n[1],r,rn):we(n[1]),gt),(!t||r&1)&&le(e,"drawer-closed",!n[0].isDrawerOpen)},i(o){t||(b(s,o),o&&Se(()=>{t&&(l||(l=ye(e,pt,[{query:"(min-width: 501px)",transition:tt,duration:We,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:tt,duration:We,axis:"y"}],!0)),l.run(1))}),t=!0)},o(o){C(s,o),o&&(l||(l=ye(e,pt,[{query:"(min-width: 501px)",transition:tt,duration:We,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:tt,duration:We,axis:"y"}],!1)),l.run(0)),t=!1},d(o){o&&_(e),s&&s.d(o),o&&l&&l.end()}}}function an(n){let e,l,t=n[0]&&bt(n);return{c(){t&&t.c(),e=_e()},l(i){t&&t.l(i),e=_e()},m(i,s){t&&t.m(i,s),O(i,e,s),l=!0},p(i,[s]){i[0]?t?(t.p(i,s),s&1&&b(t,1)):(t=bt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(Y(),C(t,1,1,()=>{t=null}),x())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}const $e=ft({}),We=1e3;let cn="25vw";function fn(n,e,l){let t;ve(n,Q,o=>l(0,t=o));let{$$slots:i={},$$scope:s}=e;return n.$$set=o=>{"$$scope"in o&&l(1,s=o.$$scope)},[t,s,i]}class un extends ce{constructor(e){super(),fe(this,e,fn,an,ae,{})}}function vt(n,e,l){const t=n.slice();return t[9]=e[l],t[11]=l,t}function kt(n,e,l){const t=n.slice();return t[9]=e[l],t}const dn=n=>({}),Ct=n=>({});function wt(n){let e,l;const t=n[6].header,i=ke(t,n,n[5],Ct);return{c(){e=N("div"),i&&i.c(),this.h()},l(s){e=I(s,"DIV",{id:!0,class:!0});var o=S(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","header"),g(e,"class","svelte-12bfztt")},m(s,o){O(s,e,o),i&&i.m(e,null),l=!0},p(s,o){i&&i.p&&(!l||o&32)&&Ce(i,t,s,s[5],l?Me(t,s[5],o,dn):we(s[5]),Ct)},i(s){l||(b(i,s),l=!0)},o(s){C(i,s),l=!1},d(s){s&&_(e),i&&i.d(s)}}}function Mt(n){let e,l,t=n[9].label+"",i,s,o,r,a;function c(...f){return n[7](n[9],...f)}function p(...f){return n[8](n[9],...f)}return{c(){e=N("li"),l=N("span"),i=U(t),s=y(),this.h()},l(f){e=I(f,"LI",{class:!0});var m=S(e);l=I(m,"SPAN",{role:!0,tabindex:!0,class:!0});var u=S(l);i=G(u,t),u.forEach(_),s=L(m),m.forEach(_),this.h()},h(){g(l,"role","menuitem"),g(l,"tabindex","0"),g(l,"class","svelte-12bfztt"),g(e,"class",o=ut(n[1]===n[9].value?"active":"")+" svelte-12bfztt")},m(f,m){O(f,e,m),k(e,l),k(l,i),k(e,s),r||(a=[j(l,"click",c),j(l,"keydown",p)],r=!0)},p(f,m){n=f,m&1&&t!==(t=n[9].label+"")&&Pe(i,t),m&3&&o!==(o=ut(n[1]===n[9].value?"active":"")+" svelte-12bfztt")&&g(e,"class",o)},d(f){f&&_(e),r=!1,ge(a)}}}function Et(n){let e,l,t,i,s,o;var r=n[9].component;function a(c,p){return{props:{component:c[0][c[11]]}}}return r&&(l=dt(r,a(n))),{c(){e=N("div"),l&&V(l.$$.fragment),t=y(),this.h()},l(c){e=I(c,"DIV",{class:!0});var p=S(e);l&&Z(l.$$.fragment,p),t=L(p),p.forEach(_),this.h()},h(){g(e,"class","tab svelte-12bfztt")},m(c,p){O(c,e,p),l&&A(l,e,null),k(e,t),o=!0},p(c,p){if(p&1&&r!==(r=c[9].component)){if(l){Y();const f=l;C(f.$$.fragment,1,0,()=>{H(f,1)}),x()}r?(l=dt(r,a(c)),V(l.$$.fragment),b(l.$$.fragment,1),A(l,e,t)):l=null}else if(r){const f={};p&1&&(f.component=c[0][c[11]]),l.$set(f)}},i(c){o||(l&&b(l.$$.fragment,c),c&&Se(()=>{o&&(s&&s.end(1),i=st(e,Ae,{duration:400,delay:400}),i.start())}),o=!0)},o(c){l&&C(l.$$.fragment,c),i&&i.invalidate(),c&&(s=_l(e,Ae,{duration:400})),o=!1},d(c){c&&_(e),l&&H(l),c&&s&&s.end()}}}function Tt(n){let e,l,t=n[1]===n[9].value&&Et(n);return{c(){t&&t.c(),e=_e()},l(i){t&&t.l(i),e=_e()},m(i,s){t&&t.m(i,s),O(i,e,s),l=!0},p(i,s){i[1]===i[9].value?t?(t.p(i,s),s&3&&b(t,1)):(t=Et(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(Y(),C(t,1,1,()=>{t=null}),x())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function mn(n){let e,l,t,i,s,o=n[4].header&&wt(n),r=Oe(n[0]),a=[];for(let m=0;m<r.length;m+=1)a[m]=Mt(kt(n,r,m));let c=Oe(n[0]),p=[];for(let m=0;m<c.length;m+=1)p[m]=Tt(vt(n,c,m));const f=m=>C(p[m],1,1,()=>{p[m]=null});return{c(){e=N("section"),o&&o.c(),l=y(),t=N("ul");for(let m=0;m<a.length;m+=1)a[m].c();i=y();for(let m=0;m<p.length;m+=1)p[m].c();this.h()},l(m){e=I(m,"SECTION",{id:!0,class:!0});var u=S(e);o&&o.l(u),l=L(u),t=I(u,"UL",{class:!0});var d=S(t);for(let h=0;h<a.length;h+=1)a[h].l(d);d.forEach(_),i=L(u);for(let h=0;h<p.length;h+=1)p[h].l(u);u.forEach(_),this.h()},h(){g(t,"class","svelte-12bfztt"),g(e,"id","tabs--container"),g(e,"class","svelte-12bfztt")},m(m,u){O(m,e,u),o&&o.m(e,null),k(e,l),k(e,t);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);k(e,i);for(let d=0;d<p.length;d+=1)p[d]&&p[d].m(e,null);s=!0},p(m,[u]){if(m[4].header?o?(o.p(m,u),u&16&&b(o,1)):(o=wt(m),o.c(),b(o,1),o.m(e,l)):o&&(Y(),C(o,1,1,()=>{o=null}),x()),u&15){r=Oe(m[0]);let d;for(d=0;d<r.length;d+=1){const h=kt(m,r,d);a[d]?a[d].p(h,u):(a[d]=Mt(h),a[d].c(),a[d].m(t,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=r.length}if(u&3){c=Oe(m[0]);let d;for(d=0;d<c.length;d+=1){const h=vt(m,c,d);p[d]?(p[d].p(h,u),b(p[d],1)):(p[d]=Tt(h),p[d].c(),b(p[d],1),p[d].m(e,null))}for(Y(),d=c.length;d<p.length;d+=1)f(d);x()}},i(m){if(!s){b(o);for(let u=0;u<c.length;u+=1)b(p[u]);s=!0}},o(m){C(o),p=p.filter(Boolean);for(let u=0;u<p.length;u+=1)C(p[u]);s=!1},d(m){m&&_(e),o&&o.d(),Fe(a,m),Fe(p,m)}}}function pn(n,e,l){let{$$slots:t={},$$scope:i}=e;const s=Zl(t);let{tabs:o=[]}=e,{activeTabValue:r}=e,{clickTab:a}=e;const c=(m,u,d)=>{m.code==="Enter"&&u(d)},p=(m,u)=>a(m.value,m.value),f=(m,u)=>c(u,a,m.value);return n.$$set=m=>{"tabs"in m&&l(0,o=m.tabs),"activeTabValue"in m&&l(1,r=m.activeTabValue),"clickTab"in m&&l(2,a=m.clickTab),"$$scope"in m&&l(5,i=m.$$scope)},[o,r,a,c,s,i,t,p,f]}class hn extends ce{constructor(e){super(),fe(this,e,pn,mn,ae,{tabs:0,activeTabValue:1,clickTab:2})}}function _n(n){let e,l,t,i;const s=n[1].default,o=ke(s,n,n[0],null);return{c(){e=N("h2"),o&&o.c(),l=y(),t=N("hr"),this.h()},l(r){e=I(r,"H2",{class:!0});var a=S(e);o&&o.l(a),a.forEach(_),l=L(r),t=I(r,"HR",{class:!0}),this.h()},h(){g(e,"class","text-center svelte-1j2cwkl"),g(t,"class","svelte-1j2cwkl")},m(r,a){O(r,e,a),o&&o.m(e,null),O(r,l,a),O(r,t,a),i=!0},p(r,[a]){o&&o.p&&(!i||a&1)&&Ce(o,s,r,r[0],i?Me(s,r[0],a,null):we(r[0]),null)},i(r){i||(b(o,r),i=!0)},o(r){C(o,r),i=!1},d(r){r&&(_(e),_(l),_(t)),o&&o.d(r)}}}function gn(n,e,l){let{$$slots:t={},$$scope:i}=e;return n.$$set=s=>{"$$scope"in s&&l(0,i=s.$$scope)},[i,t]}class bn extends ce{constructor(e){super(),fe(this,e,gn,_n,ae,{})}}const $n=n=>({}),Nt=n=>({}),vn=n=>({}),It=n=>({});function kn(n){let e,l,t,i,s,o,r,a,c;const p=n[5].submit,f=ke(p,n,n[4],It),m=n[5].cancel,u=ke(m,n,n[4],Nt);return{c(){e=N("hr"),l=y(),t=N("section"),i=N("button"),f&&f.c(),s=y(),o=N("button"),u&&u.c(),this.h()},l(d){e=I(d,"HR",{class:!0}),l=L(d),t=I(d,"SECTION",{id:!0,class:!0});var h=S(t);i=I(h,"BUTTON",{});var $=S(i);f&&f.l($),$.forEach(_),s=L(h),o=I(h,"BUTTON",{});var P=S(o);u&&u.l(P),P.forEach(_),h.forEach(_),this.h()},h(){g(e,"class","svelte-7f2jjs"),g(t,"id","btns"),g(t,"class","svelte-7f2jjs")},m(d,h){O(d,e,h),O(d,l,h),O(d,t,h),k(t,i),f&&f.m(i,null),k(t,s),k(t,o),u&&u.m(o,null),r=!0,a||(c=[j(i,"click",n[6]),j(o,"click",function(){Bl(n[2])&&n[2].apply(this,arguments)})],a=!0)},p(d,[h]){n=d,f&&f.p&&(!r||h&16)&&Ce(f,p,n,n[4],r?Me(p,n[4],h,vn):we(n[4]),It),u&&u.p&&(!r||h&16)&&Ce(u,m,n,n[4],r?Me(m,n[4],h,$n):we(n[4]),Nt)},i(d){r||(b(f,d),b(u,d),r=!0)},o(d){C(f,d),C(u,d),r=!1},d(d){d&&(_(e),_(l),_(t)),f&&f.d(d),u&&u.d(d),a=!1,ge(c)}}}function Cn(n,e,l){let t,i=K,s=()=>(i(),i=it(a,m=>l(3,t=m)),a);n.$$.on_destroy.push(()=>i());let{$$slots:o={},$$scope:r}=e,{item:a}=e;s();let{handleOnSubmit:c}=e,{handleCloseModal:p}=e;const f=()=>c(t);return n.$$set=m=>{"item"in m&&s(l(0,a=m.item)),"handleOnSubmit"in m&&l(1,c=m.handleOnSubmit),"handleCloseModal"in m&&l(2,p=m.handleCloseModal),"$$scope"in m&&l(4,r=m.$$scope)},[a,c,p,t,r,o,f]}class wn extends ce{constructor(e){super(),fe(this,e,Cn,kn,ae,{item:0,handleOnSubmit:1,handleCloseModal:2})}}function Ot(n,e,l){const t=n.slice();return t[3]=e[l],t}function Pt(n){let e,l=n[3].name+"",t,i;return{c(){e=N("option"),t=U(l),this.h()},l(s){e=I(s,"OPTION",{});var o=S(e);t=G(o,l),o.forEach(_),this.h()},h(){e.__value=i=n[3],Te(e,e.__value)},m(s,o){O(s,e,o),k(e,t)},p(s,o){o&2&&l!==(l=s[3].name+"")&&Pe(t,l),o&2&&i!==(i=s[3])&&(e.__value=i,Te(e,e.__value))},d(s){s&&_(e)}}}function Mn(n){let e,l,t="NAME",i,s,o,r,a=`Select Capability from Templates...
      `,c,p,f,m=n[0].name+"",u,d,h,$,P=Oe(n[1]),T=[];for(let v=0;v<P.length;v+=1)T[v]=Pt(Ot(n,P,v));return{c(){e=N("div"),l=N("label"),l.textContent=t,i=y(),s=N("div"),o=N("select"),r=N("option"),r.textContent=a;for(let v=0;v<T.length;v+=1)T[v].c();c=y(),p=N("p"),f=U("The Template Capability ("),u=U(m),d=U(`) will incorporate all
    child Capabilities and associated Techniques.`),this.h()},l(v){e=I(v,"DIV",{id:!0,class:!0});var w=S(e);l=I(w,"LABEL",{"aria-label":!0,for:!0,"data-svelte-h":!0}),Ee(l)!=="svelte-l4gr53"&&(l.textContent=t),i=L(w),s=I(w,"DIV",{id:!0});var E=S(s);o=I(E,"SELECT",{id:!0,class:!0});var D=S(o);r=I(D,"OPTION",{"data-svelte-h":!0}),Ee(r)!=="svelte-1t4hjue"&&(r.textContent=a);for(let J=0;J<T.length;J+=1)T[J].l(D);D.forEach(_),E.forEach(_),c=L(w),p=I(w,"P",{class:!0});var z=S(p);f=G(z,"The Template Capability ("),u=G(z,m),d=G(z,`) will incorporate all
    child Capabilities and associated Techniques.`),z.forEach(_),w.forEach(_),this.h()},h(){g(l,"aria-label","Capability Name"),g(l,"for","capability-name"),r.selected=!0,r.disabled=!0,r.__value="",Te(r,r.__value),g(o,"id","capability--select"),o.required=!0,g(o,"class","svelte-7ni84h"),n[0]===void 0&&Se(()=>n[2].call(o)),g(s,"id","autocomplete"),g(p,"class","form-info"),le(p,"non--existing",n[0]),g(e,"id","measure-input-form"),g(e,"class","svelte-7ni84h")},m(v,w){O(v,e,w),k(e,l),k(e,i),k(e,s),k(s,o),k(o,r);for(let E=0;E<T.length;E+=1)T[E]&&T[E].m(o,null);lt(o,n[0],!0),k(e,c),k(e,p),k(p,f),k(p,u),k(p,d),h||($=j(o,"change",n[2]),h=!0)},p(v,[w]){if(w&2){P=Oe(v[1]);let E;for(E=0;E<P.length;E+=1){const D=Ot(v,P,E);T[E]?T[E].p(D,w):(T[E]=Pt(D),T[E].c(),T[E].m(o,null))}for(;E<T.length;E+=1)T[E].d(1);T.length=P.length}w&3&&lt(o,v[0]),w&1&&m!==(m=v[0].name+"")&&Pe(u,m),w&1&&le(p,"non--existing",v[0])},i:K,o:K,d(v){v&&_(e),Fe(T,v),h=!1,$()}}}function En(n,e,l){let{selectedCapability:t=null}=e,{capabilities:i}=e;function s(){t=ul(this),l(0,t),l(1,i)}return n.$$set=o=>{"selectedCapability"in o&&l(0,t=o.selectedCapability),"capabilities"in o&&l(1,i=o.capabilities)},[t,i,s]}class Tn extends ce{constructor(e){super(),fe(this,e,En,Mn,ae,{selectedCapability:0,capabilities:1})}}function Nn(n){let e,l,t,i,s,o,r,a,c,p,f,m,u,d,h;return{c(){e=N("div"),l=N("form"),t=N("label"),i=N("p"),s=U(n[1]),o=y(),r=N("input"),a=y(),c=N("label"),p=N("p"),f=U(n[2]),m=y(),u=N("textarea"),this.h()},l($){e=I($,"DIV",{id:!0,class:!0});var P=S(e);l=I(P,"FORM",{class:!0,autocomplete:!0});var T=S(l);t=I(T,"LABEL",{"aria-label":!0,for:!0});var v=S(t);i=I(v,"P",{});var w=S(i);s=G(w,n[1]),w.forEach(_),v.forEach(_),o=L(T),r=I(T,"INPUT",{id:!0,type:!0,name:!0,class:!0,"aria-describedby":!0,oninvalid:!0}),a=L(T),c=I(T,"LABEL",{"aria-label":!0,for:!0});var E=S(c);p=I(E,"P",{});var D=S(p);f=G(D,n[2]),D.forEach(_),E.forEach(_),m=L(T),u=I(T,"TEXTAREA",{id:!0,name:!0,class:!0}),S(u).forEach(_),T.forEach(_),P.forEach(_),this.h()},h(){g(t,"aria-label","-measure input"),g(t,"for","measure-name"),g(r,"id","measure-name"),g(r,"type","text"),g(r,"name","Measure"),g(r,"class","measure-input svelte-1j4utks"),r.required=!0,g(r,"aria-describedby","measurename-error"),g(r,"oninvalid",n[5]("This field is required.")),g(c,"aria-label","-measure input"),g(c,"for","measure-input"),g(u,"id","measure-description"),g(u,"name","Description"),g(u,"class","measure-input svelte-1j4utks"),u.required=!0,g(l,"class","measure-input-form svelte-1j4utks"),g(l,"autocomplete","off"),g(e,"id","container-measure-form"),g(e,"class","svelte-1j4utks")},m($,P){O($,e,P),k(e,l),k(l,t),k(t,i),k(i,s),k(l,o),k(l,r),Te(r,n[4].name),k(l,a),k(l,c),k(c,p),k(p,f),k(l,m),k(l,u),Te(u,n[4].description),n[9](l),d||(h=[j(r,"input",n[7]),j(u,"input",n[8])],d=!0)},p($,[P]){P&2&&Pe(s,$[1]),P&16&&r.value!==$[4].name&&Te(r,$[4].name),P&4&&Pe(f,$[2]),P&16&&Te(u,$[4].description)},i:K,o:K,d($){$&&_(e),n[9](null),d=!1,ge(h)}}}function In(n,e,l){let t,i=K,s=()=>(i(),i=it(o,h=>l(4,t=h)),o);n.$$.on_destroy.push(()=>i());let{item:o}=e;s();let{textInput:r}=e,{textArea:a}=e,{submit:c}=e,p;dl(()=>{te(o,t.name="",t),te(o,t.description="",t)});const f=h=>h;function m(){t.name=this.value,o.set(t)}function u(){t.description=this.value,o.set(t)}function d(h){Ne[h?"unshift":"push"](()=>{p=h,l(3,p)})}return n.$$set=h=>{"item"in h&&s(l(0,o=h.item)),"textInput"in h&&l(1,r=h.textInput),"textArea"in h&&l(2,a=h.textArea),"submit"in h&&l(6,c=h.submit)},[o,r,a,p,t,f,c,m,u,d]}class On extends ce{constructor(e){super(),fe(this,e,In,Nn,ae,{item:0,textInput:1,textArea:2,submit:6})}}const Pn=n=>({}),Dt=n=>({M:n[1],item:n[0]});function Dn(n){let e,l;const t=n[3].default,i=ke(t,n,n[2],Dt);return{c(){e=N("section"),i&&i.c(),this.h()},l(s){e=I(s,"SECTION",{id:!0,class:!0});var o=S(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","dialog--container"),g(e,"class","svelte-1jrgukv")},m(s,o){O(s,e,o),i&&i.m(e,null),l=!0},p(s,[o]){i&&i.p&&(!l||o&4)&&Ce(i,t,s,s[2],l?Me(t,s[2],o,Pn):we(s[2]),Dt)},i(s){l||(b(i,s),l=!0)},o(s){C(i,s),l=!1},d(s){s&&_(e),i&&i.d(s)}}}function Sn(n,e,l){let{$$slots:t={},$$scope:i}=e;const s=ft({}),o={Title:bn,Buttons:wn,Select:Tn,Create:On};return n.$$set=r=>{"$$scope"in r&&l(2,i=r.$$scope)},[s,o,i,t]}class ot extends ce{constructor(e){super(),fe(this,e,Sn,Dn,ae,{})}}function St(n,e,l){const t=n.slice();return t[12]=e[l],t}function yt(n){let e,l=n[12].name+"",t;return{c(){e=N("option"),t=U(l),this.h()},l(i){e=I(i,"OPTION",{});var s=S(e);t=G(s,l),s.forEach(_),this.h()},h(){e.__value=n[12],Te(e,e.__value)},m(i,s){O(i,e,s),k(e,t)},p:K,d(i){i&&_(e)}}}function yn(n){let e,l,t,i,s,o,r,a,c,p="NAME",f,m,u,d,h=`Select Capability from Templates...
          `,$,P,T,v=n[0].name+"",w,E,D,z,J,B,W,de="Save",pe,he,F="Cancel",oe,Ie,ze=Oe(n[3]),re=[];for(let ee=0;ee<ze.length;ee+=1)re[ee]=yt(St(n,ze,ee));return{c(){e=N("section"),l=N("h2"),t=U(n[1]),i=y(),s=N("hr"),o=y(),r=N("article"),a=N("div"),c=N("label"),c.textContent=p,f=y(),m=N("div"),u=N("select"),d=N("option"),d.textContent=h;for(let ee=0;ee<re.length;ee+=1)re[ee].c();$=y(),P=N("p"),T=U("The Template Capability ("),w=U(v),E=U(`) will incorporate all
        associated Techniques.`),D=y(),z=N("hr"),J=y(),B=N("section"),W=N("button"),W.textContent=de,pe=y(),he=N("button"),he.textContent=F,this.h()},l(ee){e=I(ee,"SECTION",{id:!0,class:!0});var me=S(e);l=I(me,"H2",{class:!0});var se=S(l);t=G(se,n[1]),se.forEach(_),i=L(me),s=I(me,"HR",{}),o=L(me),r=I(me,"ARTICLE",{id:!0});var De=S(r);a=I(De,"DIV",{id:!0,class:!0});var Ve=S(a);c=I(Ve,"LABEL",{"aria-label":!0,for:!0,class:!0,"data-svelte-h":!0}),Ee(c)!=="svelte-l4gr53"&&(c.textContent=p),f=L(Ve),m=I(Ve,"DIV",{id:!0,class:!0});var Ye=S(m);u=I(Ye,"SELECT",{id:!0,class:!0});var Ke=S(u);d=I(Ke,"OPTION",{"data-svelte-h":!0}),Ee(d)!=="svelte-1lnlsc6"&&(d.textContent=h);for(let Je=0;Je<re.length;Je+=1)re[Je].l(Ke);Ke.forEach(_),Ye.forEach(_),$=L(Ve),P=I(Ve,"P",{class:!0});var Be=S(P);T=G(Be,"The Template Capability ("),w=G(Be,v),E=G(Be,`) will incorporate all
        associated Techniques.`),Be.forEach(_),Ve.forEach(_),D=L(De),z=I(De,"HR",{}),J=L(De),B=I(De,"SECTION",{id:!0,class:!0});var Re=S(B);W=I(Re,"BUTTON",{"data-svelte-h":!0}),Ee(W)!=="svelte-syg9fy"&&(W.textContent=de),pe=L(Re),he=I(Re,"BUTTON",{"data-svelte-h":!0}),Ee(he)!=="svelte-1alkrs9"&&(he.textContent=F),Re.forEach(_),De.forEach(_),me.forEach(_),this.h()},h(){g(l,"class","text-center"),g(c,"aria-label","Capability Name"),g(c,"for","capability-name"),g(c,"class","svelte-1fbhrmf"),d.selected=!0,d.disabled=!0,d.__value="",Te(d,d.__value),g(u,"id","capability--select"),u.required=!0,g(u,"class","svelte-1fbhrmf"),n[0]===void 0&&Se(()=>n[9].call(u)),g(m,"id","autocomplete"),g(m,"class","svelte-1fbhrmf"),g(P,"class","form-info svelte-1fbhrmf"),le(P,"non--existing",!n[2].templates[n[0]?.id]),g(a,"id","measure-input-form"),g(a,"class","svelte-1fbhrmf"),g(B,"id","measure-btns"),g(B,"class","svelte-1fbhrmf"),g(r,"id","container-capability-form"),g(e,"id","dialog--container"),g(e,"class","svelte-1fbhrmf")},m(ee,me){O(ee,e,me),k(e,l),k(l,t),k(e,i),k(e,s),k(e,o),k(e,r),k(r,a),k(a,c),k(a,f),k(a,m),k(m,u),k(u,d);for(let se=0;se<re.length;se+=1)re[se]&&re[se].m(u,null);lt(u,n[0],!0),k(a,$),k(a,P),k(P,T),k(P,w),k(P,E),k(r,D),k(r,z),k(r,J),k(r,B),k(B,W),k(B,pe),k(B,he),oe||(Ie=[j(u,"change",n[9]),j(W,"click",n[4]),j(he,"click",n[5])],oe=!0)},p(ee,[me]){if(me&2&&Pe(t,ee[1]),me&8){ze=Oe(ee[3]);let se;for(se=0;se<ze.length;se+=1){const De=St(ee,ze,se);re[se]?re[se].p(De,me):(re[se]=yt(De),re[se].c(),re[se].m(u,null))}for(;se<re.length;se+=1)re[se].d(1);re.length=ze.length}me&9&&lt(u,ee[0]),me&1&&v!==(v=ee[0].name+"")&&Pe(w,v),me&5&&le(P,"non--existing",!ee[2].templates[ee[0]?.id])},i:K,o:K,d(ee){ee&&_(e),Fe(re,ee),oe=!1,ge(Ie)}}}function Ln(n,e,l){let t;ve(n,Q,h=>l(2,t=h));let{dialog:i}=e,{title:s}=e,{selectedCapability:o=""}=e,{store:r}=e,{copyHandler:a}=e;const c=ml(),p=Object.values(t.rootTemplates.map(h=>t.templates[h])),f=(h,$,P=[])=>{P.push(h);for(const T of h?.children||[])f($[T],$,P);return P},m=h=>{const $=f(o,r);a($),c("closeModal",{dialog:i,dialogName:"copy"})},u=h=>{c("closeModal",{dialog:i,dialogName:"copy"})};function d(){o=ul(this),l(0,o),l(3,p)}return n.$$set=h=>{"dialog"in h&&l(6,i=h.dialog),"title"in h&&l(1,s=h.title),"selectedCapability"in h&&l(0,o=h.selectedCapability),"store"in h&&l(7,r=h.store),"copyHandler"in h&&l(8,a=h.copyHandler)},[o,s,t,p,m,u,i,r,a,d]}class qn extends ce{constructor(e){super(),fe(this,e,Ln,yn,ae,{dialog:6,title:1,selectedCapability:0,store:7,copyHandler:8})}}function Lt(n){let e,l,t,i,s,o,r;return{c(){e=N("button"),l=U("Save Techniques"),t=y(),i=N("button"),s=U("Remove"),this.h()},l(a){e=I(a,"BUTTON",{class:!0,title:!0});var c=S(e);l=G(c,"Save Techniques"),c.forEach(_),t=L(a),i=I(a,"BUTTON",{class:!0,title:!0});var p=S(i);s=G(p,"Remove"),p.forEach(_),this.h()},h(){g(e,"class","control-btn svelte-1sz3pl3"),e.disabled=n[1],g(e,"title","Save Techniques to currently highlighted Capabilities"),g(i,"class","control-btn svelte-1sz3pl3"),i.disabled=n[1],g(i,"title","Remove Techniques from currently highlighted Capabilities")},m(a,c){O(a,e,c),k(e,l),O(a,t,c),O(a,i,c),k(i,s),o||(r=[j(e,"click",n[7]),j(i,"click",n[8])],o=!0)},p(a,c){c&2&&(e.disabled=a[1]),c&2&&(i.disabled=a[1])},d(a){a&&(_(e),_(t),_(i)),o=!1,ge(r)}}}function zn(n){let e,l=!n[2].isReadonly&&Lt(n);return{c(){e=N("div"),l&&l.c(),this.h()},l(t){e=I(t,"DIV",{id:!0,class:!0});var i=S(e);l&&l.l(i),i.forEach(_),this.h()},h(){g(e,"id","row-persist-btns"),g(e,"class","svelte-1sz3pl3")},m(t,i){O(t,e,i),l&&l.m(e,null)},p(t,[i]){t[2].isReadonly?l&&(l.d(1),l=null):l?l.p(t,i):(l=Lt(t),l.c(),l.m(e,null))},i:K,o:K,d(t){t&&_(e),l&&l.d()}}}function Vn(n,e,l){let t,i,s,o;ve(n,$e,m=>l(0,i=m)),ve(n,Q,m=>l(2,s=m)),ve(n,je,m=>l(3,o=m));let{selectedStore:r}=e;const a=(m,u)=>{Q.saveTechniques(m,u,r),je.reset()},c=(m,u)=>{Q.removeTechniques(m,u,r),je.reset()},p=()=>a(o.treeMap,i),f=()=>c(o.treeMap,i);return n.$$set=m=>{"selectedStore"in m&&l(6,r=m.selectedStore)},n.$$.update=()=>{n.$$.dirty&1&&l(1,t=!Object.values(i).some(m=>m===X.selected))},[i,t,s,o,a,c,r,p,f]}class gl extends ce{constructor(e){super(),fe(this,e,Vn,zn,ae,{selectedStore:6})}}const qt={setting:"M19.5 12c0 .34-.03.66-.07.98l2.11 1.65c.19.15.24.42.12.64l-2 3.46c-.12.22-.38.31-.61.22l-2.49-1c-.52.39-1.08.73-1.69.98l-.38 2.65c-.03.24-.24.42-.49.42h-4c-.25 0-.46-.18-.49-.42l-.38-2.65c-.61-.25-1.17-.58-1.69-.98l-2.49 1c-.22.08-.49 0-.61-.22l-2-3.46a.505.505 0 0 1 .12-.64l2.11-1.65A7.93 7.93 0 0 1 4.5 12c0-.33.03-.66.07-.98L2.46 9.37a.493.493 0 0 1-.12-.64l2-3.46c.12-.22.38-.31.61-.22l2.49 1c.52-.39 1.08-.73 1.69-.98l.38-2.65c.03-.24.24-.42.49-.42h4c.25 0 .46.18.49.42l.38 2.65c.61.25 1.17.58 1.69.98l2.49-1c.22-.08.49 0 .61.22l2 3.46c.12.22.07.49-.12.64l-2.11 1.65c.04.32.07.64.07.98Zm-11 0c0 1.93 1.57 3.5 3.5 3.5s3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5-3.5 1.57-3.5 3.5Z","color picker":"M12 3a9 9 0 0 0 0 18c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8Zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12ZM8 6.5C8 7.33 8.67 8 9.5 8S11 7.33 11 6.5 10.33 5 9.5 5 8 5.67 8 6.5ZM14.5 8c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8Zm1.5 2.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5S18.33 9 17.5 9s-1.5.67-1.5 1.5Z",create:"M20.71 5.63c.39.39.39 1.02 0 1.41l-1.83 1.83-3.75-3.75 1.83-1.83a.996.996 0 0 1 1.41 0l2.34 2.34ZM3 20.5v-3.04c0-.14.05-.26.15-.36L14.06 6.19l3.75 3.75L6.89 20.85a.47.47 0 0 1-.35.15H3.5c-.28 0-.5-.22-.5-.5Z",delete:"M16 2v4h6v2h-2v14H4V8H2V6h6V2zm-2 2h-4v2h4zm0 4H6v12h12V8zm-5 2h2v8H9zm6 0h-2v8h2z","create portfolio":"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v1c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-1h5c1.1 0 2-.9 2-2V5a2 2 0 0 0-2-2Zm0 13c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h16c.55 0 1 .45 1 1v10Zm-6-4c.55 0 1-.45 1-1s-.45-1-1-1h-2V8c0-.55-.45-1-1-1s-1 .45-1 1v2H9c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2Z",heatMap:"M10.5 2A3.5 3.5 0 0 1 14 5.5v6.758a5.5 5.5 0 1 1-7 0V5.499A3.5 3.5 0 0 1 10.5 2Zm0 2a1.5 1.5 0 0 0-1.493 1.355L9 5.5v7.699l-.726.6a3.5 3.5 0 1 0 4.609.137l-.156-.136-.726-.6L12 5.5a1.5 1.5 0 0 0-1.355-1.493L10.5 4Zm.5 1.5a.5.5 0 0 0-1 0v8.55a2.5 2.5 0 1 0 1 0V5.5Zm9 5.5a1 1 0 1 1 0 2h-3a1 1 0 1 1 0-2h3Zm-1-2a1 1 0 0 0-1-1h-1a1 1 0 1 0 0 2h1a1 1 0 0 0 1-1Zm1-4a1 1 0 1 1 0 2h-3a1 1 0 1 1 0-2h3Zm-1-2a1 1 0 0 0-1-1h-1a1 1 0 1 0 0 2h1a1 1 0 0 0 1-1Z",multiColor:"M6.34 19.24c-3.12-3.12-3.12-8.19 0-11.31l4.96-4.95a.996.996 0 0 1 1.41 0l4.95 4.95c3.12 3.12 3.12 8.19 0 11.31A7.98 7.98 0 0 1 12 21.58c-2.05 0-4.1-.78-5.66-2.34Zm1.42-1.41A5.928 5.928 0 0 0 12 19.59V5.1L7.76 9.35A5.928 5.928 0 0 0 6 13.59c0 1.6.62 3.1 1.76 4.24Z",info:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1Zm-1-8h2V7h-2v2Z",plus:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1Z",arrowLeft:"M14.71 6.71a.996.996 0 0 0-1.41 0L8.71 11.3a.996.996 0 0 0 0 1.41l4.59 4.59a.996.996 0 1 0 1.41-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41Z",arrowRight:"M9.29 6.71a.996.996 0 0 0 0 1.41L13.17 12l-3.88 3.88a.996.996 0 1 0 1.41 1.41l4.59-4.59a.996.996 0 0 0 0-1.41L10.7 6.7c-.38-.38-1.02-.38-1.41.01Z",chart:"M5 3h14c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2Zm1 16c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H6Zm6-2c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v8c0 .55-.45 1-1 1Zm-4 0c-.55 0-1-.45-1-1v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 .55-.45 1-1 1Zm7-1c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1v2Z",plus_circle:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2m0 18a8 8 0 1 1 8-8a8 8 0 0 1-8 8m4-9h-3V8a1 1 0 0 0-2 0v3H8a1 1 0 0 0 0 2h3v3a1 1 0 0 0 2 0v-3h3a1 1 0 0 0 0-2",export:"M11.78 7.159a.75.75 0 0 0-1.06 0l-1.97 1.97V1.75a.75.75 0 0 0-1.5 0v7.379l-1.97-1.97a.75.75 0 0 0-1.06 1.06l3.25 3.25L8 12l.53-.53l3.25-3.25a.75.75 0 0 0 0-1.061ZM2.5 9.75a.75.75 0 1 0-1.5 0V13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9.75a.75.75 0 0 0-1.5 0V13a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V9.75Z",import:"M11.78 5.841a.75.75 0 0 1-1.06 0l-1.97-1.97v7.379a.75.75 0 0 1-1.5 0V3.871l-1.97 1.97a.75.75 0 0 1-1.06-1.06l3.25-3.25L8 1l.53.53l3.25 3.25a.75.75 0 0 1 0 1.061ZM2.5 9.75a.75.75 0 0 0-1.5 0V13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9.75a.75.75 0 0 0-1.5 0V13a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V9.75Z",edit:"m19.71 8.04l-2.34 2.33l-3.75-3.75l2.34-2.33c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25L13.06 7.18l3.75 3.75L6.75 21H3zM16.62 5.04l-1.54 1.54l2.34 2.34l1.54-1.54zM15.36 11L13 8.64l-9 9.02V20h2.34z",check:"M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41L9 16.17z",close:"M6.793 6.793a1 1 0 0 1 1.414 0L12 10.586l3.793-3.793a1 1 0 1 1 1.414 1.414L13.414 12l3.793 3.793a1 1 0 0 1-1.414 1.414L12 13.414l-3.793 3.793a1 1 0 0 1-1.414-1.414L10.586 12L6.793 8.207a1 1 0 0 1 0-1.414Z",copy:"M21 8.94a1.31 1.31 0 0 0-.06-.27v-.09a1.07 1.07 0 0 0-.19-.28l-6-6a1.07 1.07 0 0 0-.28-.19a.32.32 0 0 0-.09 0a.88.88 0 0 0-.33-.11H10a3 3 0 0 0-3 3v1H6a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3v-1h1a3 3 0 0 0 3-3V8.94Zm-6-3.53L17.59 8H16a1 1 0 0 1-1-1ZM15 19a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h1v7a3 3 0 0 0 3 3h5Zm4-4a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h3v3a3 3 0 0 0 3 3h3Z",childrenMultiColor:"M8 30H2v-6h6zm-4-2h2v-2H4zm15 2h-6v-6h6zm-4-2h2v-2h-2zm15 2h-6v-6h6zm-4-2h2v-2h-2zM16 10a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4m0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2m10 12h-5a4.005 4.005 0 0 1-4-4h-2a4.005 4.005 0 0 1-4 4H6a2.002 2.002 0 0 0-2 2v4h2v-4h5a5.97 5.97 0 0 0 4-1.54V22h2v-5.54A5.97 5.97 0 0 0 21 18h5v4h2v-4a2.002 2.002 0 0 0-2-2"};function An(n){let e,l,t,i,s,o,r,a,c,p,f,m,u;const d=n[8].default,h=ke(d,n,n[7],null);return{c(){e=N("button"),l=xe("svg"),t=xe("title"),i=U(n[3]),s=xe("path"),r=xe("metadata"),a=U(n[3]),p=y(),h&&h.c(),this.h()},l($){e=I($,"BUTTON",{style:!0,"data-icon":!0,class:!0,title:!0,"aria-label":!0});var P=S(e);l=et(P,"svg",{xmlns:!0,viewBox:!0,class:!0});var T=S(l);t=et(T,"title",{});var v=S(t);i=G(v,n[3]),v.forEach(_),s=et(T,"path",{"fill-rule":!0,d:!0,fill:!0}),S(s).forEach(_),r=et(T,"metadata",{});var w=S(r);a=G(w,n[3]),w.forEach(_),T.forEach(_),p=L(P),h&&h.l(P),P.forEach(_),this.h()},h(){g(s,"fill-rule","evenodd"),g(s,"d",o=qt[n[2]]),g(s,"fill",n[5]),g(l,"xmlns","http://www.w3.org/2000/svg"),g(l,"viewBox",c="0 0 "+n[1]+" "+n[1]),g(l,"class","svelte-fbph36"),le(l,"icon-disabled",n[4]),ue(e,"--size",n[0]),g(e,"data-icon",n[2]),g(e,"class","fab svelte-fbph36"),g(e,"title",n[3]),g(e,"aria-label",n[3]),e.disabled=n[4]},m($,P){O($,e,P),k(e,l),k(l,t),k(t,i),k(l,s),k(l,r),k(r,a),k(e,p),h&&h.m(e,null),f=!0,m||(u=j(e,"click",n[6],!0),m=!0)},p($,[P]){(!f||P&8)&&Pe(i,$[3]),(!f||P&4&&o!==(o=qt[$[2]]))&&g(s,"d",o),(!f||P&32)&&g(s,"fill",$[5]),(!f||P&8)&&Pe(a,$[3]),(!f||P&2&&c!==(c="0 0 "+$[1]+" "+$[1]))&&g(l,"viewBox",c),(!f||P&16)&&le(l,"icon-disabled",$[4]),h&&h.p&&(!f||P&128)&&Ce(h,d,$,$[7],f?Me(d,$[7],P,null):we($[7]),null),(!f||P&1)&&ue(e,"--size",$[0]),(!f||P&4)&&g(e,"data-icon",$[2]),(!f||P&8)&&g(e,"title",$[3]),(!f||P&8)&&g(e,"aria-label",$[3]),(!f||P&16)&&(e.disabled=$[4])},i($){f||(b(h,$),f=!0)},o($){C(h,$),f=!1},d($){$&&_(e),h&&h.d($),m=!1,u()}}}function Hn(n,e,l){let{$$slots:t={},$$scope:i}=e,{size:s}=e,{viewBox:o=24}=e,{iconName:r}=e,{description:a}=e,{disabled:c=!1}=e,{pathColor:p="black"}=e;const f=new ml,m=u=>{f("iconClick",{event:u})};return n.$$set=u=>{"size"in u&&l(0,s=u.size),"viewBox"in u&&l(1,o=u.viewBox),"iconName"in u&&l(2,r=u.iconName),"description"in u&&l(3,a=u.description),"disabled"in u&&l(4,c=u.disabled),"pathColor"in u&&l(5,p=u.pathColor),"$$scope"in u&&l(7,i=u.$$scope)},[s,o,r,a,c,p,m,i,t]}class ne extends ce{constructor(e){super(),fe(this,e,Hn,An,ae,{size:0,viewBox:1,iconName:2,description:3,disabled:4,pathColor:5})}}function zt(n,e,l){const t=n.slice();t[9]=e[l],t[12]=l;const i=t[4]===0?t[9]:t[3];return t[10]=i,t}const Zn=n=>({capability:n&8192,parent:n&37,level:n&16,idx:n&4096,root:n&61}),Vt=n=>({capability:n[13],parent:n[9],level:n[4],idx:n[12],root:n[10]}),Bn=n=>({capability:n&37,level:n&16,root:n&61}),At=n=>({parent:null,capability:n[9],level:n[4],idx:n[12],root:n[10]});function Rn(n){let e;return{c(){e=U("No slot")},l(l){e=G(l,"No slot")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Ht(n){let e,l;return e=new bl({props:{capabilities:n[9].children,level:n[4]+1,root:n[10],store:n[1],storeProp:n[2],$$slots:{default:[Fn,({capability:t,level:i,idx:s})=>({13:t,4:i,12:s}),({capability:t,level:i,idx:s})=>(t?8192:0)|(i?16:0)|(s?4096:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i&37&&(s.capabilities=t[9].children),i&16&&(s.level=t[4]+1),i&61&&(s.root=t[10]),i&2&&(s.store=t[1]),i&4&&(s.storeProp=t[2]),i&12605&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function jn(n){let e;return{c(){e=U("No slot")},l(l){e=G(l,"No slot")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Zt(n){let e;const l=n[6].default,t=ke(l,n,n[8],Vt),i=t||jn();return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,o){i&&i.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&12605)&&Ce(t,l,s,s[8],e?Me(l,s[8],o,Zn):we(s[8]),Vt)},i(s){e||(b(i,s),e=!0)},o(s){C(i,s),e=!1},d(s){i&&i.d(s)}}}function Fn(n){let e=n[9],l,t,i=Zt(n);return{c(){i.c(),l=y()},l(s){i.l(s),l=L(s)},m(s,o){i.m(s,o),O(s,l,o),t=!0},p(s,o){o&37&&ae(e,e=s[9])?(Y(),C(i,1,1,K),x(),i=Zt(s),i.c(),b(i,1),i.m(l.parentNode,l)):i.p(s,o)},i(s){t||(b(i),t=!0)},o(s){C(i),t=!1},d(s){s&&_(l),i.d(s)}}}function Bt(n){let e,l,t;const i=n[6].default,s=ke(i,n,n[8],At),o=s||Rn();let r=n[9]?.children?.length>0&&Ht(n);return{c(){o&&o.c(),e=y(),r&&r.c(),l=_e()},l(a){o&&o.l(a),e=L(a),r&&r.l(a),l=_e()},m(a,c){o&&o.m(a,c),O(a,e,c),r&&r.m(a,c),O(a,l,c),t=!0},p(a,c){s&&s.p&&(!t||c&317)&&Ce(s,i,a,a[8],t?Me(i,a[8],c,Bn):we(a[8]),At),a[9]?.children?.length>0?r?(r.p(a,c),c&37&&b(r,1)):(r=Ht(a),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(Y(),C(r,1,1,()=>{r=null}),x())},i(a){t||(b(o,a),b(r),t=!0)},o(a){C(o,a),C(r),t=!1},d(a){a&&(_(e),_(l)),o&&o.d(a),r&&r.d(a)}}}function Un(n){let e,l,t=Oe(n[0].map(n[7])),i=[];for(let o=0;o<t.length;o+=1)i[o]=Bt(zt(n,t,o));const s=o=>C(i[o],1,1,()=>{i[o]=null});return{c(){for(let o=0;o<i.length;o+=1)i[o].c();e=_e()},l(o){for(let r=0;r<i.length;r+=1)i[r].l(o);e=_e()},m(o,r){for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(o,r);O(o,e,r),l=!0},p(o,[r]){if(r&12607){t=Oe(o[0].map(o[7]));let a;for(a=0;a<t.length;a+=1){const c=zt(o,t,a);i[a]?(i[a].p(c,r),b(i[a],1)):(i[a]=Bt(c),i[a].c(),b(i[a],1),i[a].m(e.parentNode,e))}for(Y(),a=t.length;a<i.length;a+=1)s(a);x()}},i(o){if(!l){for(let r=0;r<t.length;r+=1)b(i[r]);l=!0}},o(o){i=i.filter(Boolean);for(let r=0;r<i.length;r+=1)C(i[r]);l=!1},d(o){o&&_(e),Fe(i,o)}}}function Gn(n,e,l){let t,i=K,s=()=>(i(),i=it(c,d=>l(5,t=d)),c);n.$$.on_destroy.push(()=>i());let{$$slots:o={},$$scope:r}=e,{capabilities:a=[]}=e,{store:c}=e;s();let{storeProp:p}=e,{level:f=0}=e,{root:m=null}=e;const u=d=>t[p][d];return n.$$set=d=>{"capabilities"in d&&l(0,a=d.capabilities),"store"in d&&s(l(1,c=d.store)),"storeProp"in d&&l(2,p=d.storeProp),"level"in d&&l(4,f=d.level),"root"in d&&l(3,m=d.root),"$$scope"in d&&l(8,r=d.$$scope)},[a,c,p,m,f,t,o,u,r]}class bl extends ce{constructor(e){super(),fe(this,e,Gn,Un,ae,{capabilities:0,store:1,storeProp:2,level:4,root:3})}}const Kn=n=>({}),Rt=n=>({});function jt(n){const e=n[8][n[61].id];n[64]=e}function Jn(n){let e,l,t,i,s,o,r,a,c,p;function f(...T){return n[42](n[61],...T)}function m(T,v){return T[64]===X.editing?Xn:Wn}let u=m(n),d=u(n);const h=[xn,Yn],$=[];function P(T,v){return T[64]===X.selected?0:T[64]===X.editing?1:-1}return~(o=P(n))&&(r=$[o]=h[o](n)),{c(){e=N("div"),l=N("input"),i=y(),d.c(),s=y(),r&&r.c(),this.h()},l(T){e=I(T,"DIV",{class:!0,style:!0});var v=S(e);l=I(v,"INPUT",{class:!0,type:!0,name:!0,style:!0}),i=L(v),d.l(v),s=L(v),r&&r.l(v),v.forEach(_),this.h()},h(){g(l,"class","check-box svelte-1eikbdh"),g(l,"type","checkbox"),g(l,"name","include"),l.checked=t=n[61]?.checked,ue(l,"accent-color",n[12][n[9].techniqueMappingMode]({root:n[63],capability:n[61]})),g(e,"class","measure-child measure-hover svelte-1eikbdh"),ue(e,"--level",n[11]),le(e,"selected-measure",n[64]===X.selected)},m(T,v){O(T,e,v),k(e,l),k(e,i),d.m(e,null),k(e,s),~o&&$[o].m(e,null),a=!0,c||(p=j(l,"click",Ue(f)),c=!0)},p(T,v){n=T,(!a||v[1]&1073741824&&t!==(t=n[61]?.checked))&&(l.checked=t),(!a||v[0]&512|v[1]&1073741824|v[2]&2)&&ue(l,"accent-color",n[12][n[9].techniqueMappingMode]({root:n[63],capability:n[61]})),u===(u=m(n))&&d?d.p(n,v):(d.d(1),d=u(n),d&&(d.c(),d.m(e,s)));let w=o;o=P(n),o===w?~o&&$[o].p(n,v):(r&&(Y(),C($[w],1,1,()=>{$[w]=null}),x()),~o?(r=$[o],r?r.p(n,v):(r=$[o]=h[o](n),r.c()),b(r,1),r.m(e,null)):r=null),(!a||v[0]&2048)&&ue(e,"--level",n[11]),(!a||v[0]&256|v[1]&1073741824)&&le(e,"selected-measure",n[64]===X.selected)},i(T){a||(b(r),a=!0)},o(T){C(r),a=!1},d(T){T&&_(e),d.d(),~o&&$[o].d(),c=!1,p()}}}function Qn(n){let e,l,t,i,s,o,r,a,c,p,f,m;function u(...w){return n[29](n[61],...w)}function d(w,E){return w[64]===X.editing?ti:ei}let h=d(n),$=h(n);const P=[ni,li],T=[];function v(w,E){return w[64]===X.selected||w[64]===X.parent?0:w[64]===X.editing?1:-1}return~(r=v(n))&&(a=T[r]=P[r](n)),{c(){e=N("div"),l=N("form"),t=N("input"),s=y(),$.c(),o=y(),a&&a.c(),this.h()},l(w){e=I(w,"DIV",{class:!0,title:!0});var E=S(e);l=I(E,"FORM",{});var D=S(l);t=I(D,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0,style:!0}),D.forEach(_),s=L(E),$.l(E),o=L(E),a&&a.l(E),E.forEach(_),this.h()},h(){g(t,"class","check-box svelte-1eikbdh"),g(t,"type","checkbox"),g(t,"name","include"),t.checked=i=n[61]?.checked,g(t,"tabindex","0"),ue(t,"accent-color",n[12][n[9].techniqueMappingMode]({root:n[63],capability:n[61]})),g(e,"class","measure-parent svelte-1eikbdh"),g(e,"title",c=`Definition: 

`+n[61].description),le(e,"selected-measure",n[64]===X.selected),le(e,"measure-hover",!n[61]?.children?.length)},m(w,E){O(w,e,E),k(e,l),k(l,t),k(e,s),$.m(e,null),k(e,o),~r&&T[r].m(e,null),p=!0,f||(m=j(t,"click",Ue(u)),f=!0)},p(w,E){n=w,(!p||E[1]&1073741824&&i!==(i=n[61]?.checked))&&(t.checked=i),(!p||E[0]&512|E[1]&1073741824|E[2]&2)&&ue(t,"accent-color",n[12][n[9].techniqueMappingMode]({root:n[63],capability:n[61]})),h===(h=d(n))&&$?$.p(n,E):($.d(1),$=h(n),$&&($.c(),$.m(e,o)));let D=r;r=v(n),r===D?~r&&T[r].p(n,E):(a&&(Y(),C(T[D],1,1,()=>{T[D]=null}),x()),~r?(a=T[r],a?a.p(n,E):(a=T[r]=P[r](n),a.c()),b(a,1),a.m(e,null)):a=null),(!p||E[1]&1073741824&&c!==(c=`Definition: 

`+n[61].description))&&g(e,"title",c),(!p||E[0]&256|E[1]&1073741824)&&le(e,"selected-measure",n[64]===X.selected),(!p||E[1]&1073741824)&&le(e,"measure-hover",!n[61]?.children?.length)},i(w){p||(b(a),p=!0)},o(w){C(a),p=!1},d(w){w&&_(e),$.d(),~r&&T[r].d(),f=!1,m()}}}function Wn(n){let e,l=n[61].name+"",t,i,s,o;function r(...c){return n[45](n[61],n[10],...c)}function a(...c){return n[46](n[61],n[10],...c)}return{c(){e=N("span"),t=U(l),this.h()},l(c){e=I(c,"SPAN",{class:!0,title:!0,tabindex:!0,role:!0});var p=S(e);t=G(p,l),p.forEach(_),this.h()},h(){g(e,"class","measure-text svelte-1eikbdh"),g(e,"title",i=n[61].description),g(e,"tabindex","0"),g(e,"role","button")},m(c,p){O(c,e,p),k(e,t),s||(o=[j(e,"click",Xe(r)),j(e,"keydown",Xe(a))],s=!0)},p(c,p){n=c,p[1]&1073741824&&l!==(l=n[61].name+"")&&Pe(t,l),p[1]&1073741824&&i!==(i=n[61].description)&&g(e,"title",i)},d(c){c&&_(e),s=!1,ge(o)}}}function Xn(n){let e,l,t;function i(...s){return n[44](n[61],n[63],...s)}return{c(){e=N("input"),this.h()},l(s){e=I(s,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","measure-text text-cursor svelte-1eikbdh")},m(s,o){O(s,e,o),Te(e,n[7]),l||(t=[pl(n[26].call(null,e)),j(e,"input",n[43]),j(e,"keydown",Ue(i))],l=!0)},p(s,o){n=s,o[0]&128&&e.value!==n[7]&&Te(e,n[7])},d(s){s&&_(e),l=!1,ge(t)}}}function Yn(n){let e,l,t,i,s,o;function r(...c){return n[53](n[61],n[63],...c)}l=new ne({props:{size:nt,iconName:"check",description:"Save Capability"}}),l.$on("iconClick",r);function a(...c){return n[54](n[61],...c)}return i=new ne({props:{size:nt,iconName:"close",description:"close"}}),i.$on("iconClick",a),{c(){e=N("div"),V(l.$$.fragment),t=y(),V(i.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var p=S(e);Z(l.$$.fragment,p),t=L(p),Z(i.$$.fragment,p),p.forEach(_),this.h()},h(){g(e,"class","capability-form-btns svelte-1eikbdh")},m(c,p){O(c,e,p),A(l,e,null),k(e,t),A(i,e,null),o=!0},p(c,p){n=c},i(c){o||(b(l.$$.fragment,c),b(i.$$.fragment,c),c&&(s||Se(()=>{s=st(e,Ge,{duration:700,delay:100,axis:"x",x:10}),s.start()})),o=!0)},o(c){C(l.$$.fragment,c),C(i.$$.fragment,c),o=!1},d(c){c&&_(e),H(l),H(i)}}}function xn(n){let e,l,t,i,s,o,r,a,c;function p(...d){return n[47](n[61],n[11],...d)}l=new ne({props:{size:Ze,iconName:"plus",description:"Create Child Layer"}}),l.$on("iconClick",p);function f(...d){return n[48](n[61],n[10],...d)}i=new ne({props:{size:Ze,iconName:"edit",description:"Edit Layer"}}),i.$on("iconClick",f);function m(...d){return n[49](n[61],n[10],...d)}o=new ne({props:{size:28,iconName:"delete",description:"Delete Layer"}}),o.$on("iconClick",m);let u=n[9].techniqueMappingMode!==ie.heatMap&&Ft(n);return{c(){e=N("div"),V(l.$$.fragment),t=y(),V(i.$$.fragment),s=y(),V(o.$$.fragment),r=y(),u&&u.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var h=S(e);Z(l.$$.fragment,h),t=L(h),Z(i.$$.fragment,h),s=L(h),Z(o.$$.fragment,h),r=L(h),u&&u.l(h),h.forEach(_),this.h()},h(){g(e,"class","capability-btns svelte-1eikbdh")},m(d,h){O(d,e,h),A(l,e,null),k(e,t),A(i,e,null),k(e,s),A(o,e,null),k(e,r),u&&u.m(e,null),c=!0},p(d,h){n=d,n[9].techniqueMappingMode!==ie.heatMap?u?(u.p(n,h),h[0]&512&&b(u,1)):(u=Ft(n),u.c(),b(u,1),u.m(e,null)):u&&(Y(),C(u,1,1,()=>{u=null}),x())},i(d){c||(b(l.$$.fragment,d),b(i.$$.fragment,d),b(o.$$.fragment,d),b(u),d&&Se(()=>{c&&(a||(a=ye(e,Ge,{axis:"x",duration:200,x:-5},!0)),a.run(1))}),c=!0)},o(d){C(l.$$.fragment,d),C(i.$$.fragment,d),C(o.$$.fragment,d),C(u),d&&(a||(a=ye(e,Ge,{axis:"x",duration:200,x:-5},!1)),a.run(0)),c=!1},d(d){d&&_(e),H(l),H(i),H(o),u&&u.d(),d&&a&&a.end()}}}function Ft(n){let e,l,t,i,s=n[61],o,r,a;function c(...u){return n[50](n[61],n[10],n[62],...u)}e=new ne({props:{size:Ze,iconName:"color picker",description:"Pick Capability Color"}}),e.$on("iconClick",c);const p=()=>n[51](t,s),f=()=>n[51](null,s);function m(...u){return n[52](n[61],...u)}return{c(){V(e.$$.fragment),l=y(),t=N("input"),this.h()},l(u){Z(e.$$.fragment,u),l=L(u),t=I(u,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[61].color,ue(t,"display","none")},m(u,d){A(e,u,d),O(u,l,d),O(u,t,d),p(),o=!0,r||(a=j(t,"change",m),r=!0)},p(u,d){n=u,(!o||d[1]&1073741824&&i!==(i=n[61].color))&&(t.value=i),s!==n[61]&&(f(),s=n[61],p())},i(u){o||(b(e.$$.fragment,u),o=!0)},o(u){C(e.$$.fragment,u),o=!1},d(u){u&&(_(l),_(t)),H(e,u),f(),r=!1,a()}}}function ei(n){let e,l=n[61].name+"",t,i,s;function o(...a){return n[32](n[61],...a)}function r(...a){return n[33](n[61],...a)}return{c(){e=N("span"),t=U(l),this.h()},l(a){e=I(a,"SPAN",{class:!0,tabindex:!0,role:!0});var c=S(e);t=G(c,l),c.forEach(_),this.h()},h(){g(e,"class","measure-text svelte-1eikbdh"),g(e,"tabindex","0"),g(e,"role","button"),le(e,"parent-measure",n[61].children?.length>0)},m(a,c){O(a,e,c),k(e,t),i||(s=[j(e,"click",Xe(o)),j(e,"keydown",Xe(r))],i=!0)},p(a,c){n=a,c[1]&1073741824&&l!==(l=n[61].name+"")&&Pe(t,l),c[1]&1073741824&&le(e,"parent-measure",n[61].children?.length>0)},d(a){a&&_(e),i=!1,ge(s)}}}function ti(n){let e,l,t;function i(...s){return n[31](n[61],n[63],...s)}return{c(){e=N("input"),this.h()},l(s){e=I(s,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","measure-text text-cursor svelte-1eikbdh")},m(s,o){O(s,e,o),Te(e,n[7]),l||(t=[pl(n[26].call(null,e)),j(e,"input",n[30]),j(e,"keydown",Ue(i))],l=!0)},p(s,o){n=s,o[0]&128&&e.value!==n[7]&&Te(e,n[7])},d(s){s&&_(e),l=!1,ge(t)}}}function li(n){let e,l,t,i,s,o;function r(){return n[40](n[61],n[63])}l=new ne({props:{size:nt,iconName:"check",description:"Edit Layer"}}),l.$on("iconClick",r);function a(...c){return n[41](n[61],...c)}return i=new ne({props:{size:nt,iconName:"close",description:"close"}}),i.$on("iconClick",a),{c(){e=N("div"),V(l.$$.fragment),t=y(),V(i.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var p=S(e);Z(l.$$.fragment,p),t=L(p),Z(i.$$.fragment,p),p.forEach(_),this.h()},h(){g(e,"class","capability-form-btns svelte-1eikbdh")},m(c,p){O(c,e,p),A(l,e,null),k(e,t),A(i,e,null),o=!0},p(c,p){n=c},i(c){o||(b(l.$$.fragment,c),b(i.$$.fragment,c),c&&(s||Se(()=>{s=st(e,Ge,{duration:700,delay:100,axis:"x",x:10}),s.start()})),o=!0)},o(c){C(l.$$.fragment,c),C(i.$$.fragment,c),o=!1},d(c){c&&_(e),H(l),H(i)}}}function ni(n){let e,l,t,i,s,o,r,a,c;function p(...d){return n[34](n[61],n[11],...d)}l=new ne({props:{size:Ze,iconName:"plus",description:"Create Child Layer"}}),l.$on("iconClick",p);function f(...d){return n[35](n[61],n[10],...d)}i=new ne({props:{size:Ze,iconName:"edit",description:"Edit Layer"}}),i.$on("iconClick",f);function m(...d){return n[36](n[61],...d)}o=new ne({props:{size:Ze,iconName:"delete",description:"Delete Layer and Children"}}),o.$on("iconClick",m);let u=n[9].techniqueMappingMode!==ie.heatMap&&Ut(n);return{c(){e=N("div"),V(l.$$.fragment),t=y(),V(i.$$.fragment),s=y(),V(o.$$.fragment),r=y(),u&&u.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var h=S(e);Z(l.$$.fragment,h),t=L(h),Z(i.$$.fragment,h),s=L(h),Z(o.$$.fragment,h),r=L(h),u&&u.l(h),h.forEach(_),this.h()},h(){g(e,"class","capability-btns svelte-1eikbdh")},m(d,h){O(d,e,h),A(l,e,null),k(e,t),A(i,e,null),k(e,s),A(o,e,null),k(e,r),u&&u.m(e,null),c=!0},p(d,h){n=d,n[9].techniqueMappingMode!==ie.heatMap?u?(u.p(n,h),h[0]&512&&b(u,1)):(u=Ut(n),u.c(),b(u,1),u.m(e,null)):u&&(Y(),C(u,1,1,()=>{u=null}),x())},i(d){c||(b(l.$$.fragment,d),b(i.$$.fragment,d),b(o.$$.fragment,d),b(u),d&&Se(()=>{c&&(a||(a=ye(e,Ge,{axis:"x",duration:100,x:-10},!0)),a.run(1))}),c=!0)},o(d){C(l.$$.fragment,d),C(i.$$.fragment,d),C(o.$$.fragment,d),C(u),d&&(a||(a=ye(e,Ge,{axis:"x",duration:100,x:-10},!1)),a.run(0)),c=!1},d(d){d&&_(e),H(l),H(i),H(o),u&&u.d(),d&&a&&a.end()}}}function Ut(n){let e,l,t,i,s=n[61],o,r,a;function c(...u){return n[37](n[61],n[10],n[62],...u)}e=new ne({props:{size:Ze,iconName:"color picker",description:"Pick Layer Color"}}),e.$on("iconClick",c);const p=()=>n[38](t,s),f=()=>n[38](null,s);function m(...u){return n[39](n[61],...u)}return{c(){V(e.$$.fragment),l=y(),t=N("input"),this.h()},l(u){Z(e.$$.fragment,u),l=L(u),t=I(u,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[61].color,ue(t,"display","none")},m(u,d){A(e,u,d),O(u,l,d),O(u,t,d),p(),o=!0,r||(a=j(t,"input",Xe(hl(m))),r=!0)},p(u,d){n=u,(!o||d[1]&1073741824&&i!==(i=n[61].color))&&(t.value=i),s!==n[61]&&(f(),s=n[61],p())},i(u){o||(b(e.$$.fragment,u),o=!0)},o(u){C(e.$$.fragment,u),o=!1},d(u){u&&(_(l),_(t)),H(e,u),f(),r=!1,a()}}}function ii(n){jt(n);let e,l,t,i;const s=[Qn,Jn],o=[];function r(a,c){return a[11]===0?0:a[11]!==0?1:-1}return~(e=r(n))&&(l=o[e]=s[e](n)),{c(){l&&l.c(),t=_e()},l(a){l&&l.l(a),t=_e()},m(a,c){~e&&o[e].m(a,c),O(a,t,c),i=!0},p(a,c){jt(a);let p=e;e=r(a),e===p?~e&&o[e].p(a,c):(l&&(Y(),C(o[p],1,1,()=>{o[p]=null}),x()),~e?(l=o[e],l?l.p(a,c):(l=o[e]=s[e](a),l.c()),b(l,1),l.m(t.parentNode,t)):l=null)},i(a){i||(b(l),i=!0)},o(a){C(l),i=!1},d(a){a&&_(t),~e&&o[e].d(a)}}}function Gt(n){let e,l;return e=new ot({props:{$$slots:{default:[ai,({M:t,item:i})=>({59:t,60:i}),({M:t,item:i})=>[0,(t?268435456:0)|(i?536870912:0)]]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i[0]&3092|i[1]&671088640&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function si(n){let e;return{c(){e=U("Create Child Capability Layer")},l(l){e=G(l,"Create Child Capability Layer")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function oi(n){let e;return{c(){e=U("Create")},l(l){e=G(l,"Create")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function ri(n){let e;return{c(){e=U("Cancel")},l(l){e=G(l,"Cancel")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function ai(n){let e,l,t,i,s,o;return e=new n[59].Title({props:{$$slots:{default:[si]},$$scope:{ctx:n}}}),t=new n[59].Create({props:{item:n[60],textInput:"Name",textArea:"Description"}}),s=new n[59].Buttons({props:{item:n[60],handleCloseModal:n[18],handleOnSubmit:n[55],$$slots:{cancel:[ri],submit:[oi]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment),i=y(),V(s.$$.fragment)},l(r){Z(e.$$.fragment,r),l=L(r),Z(t.$$.fragment,r),i=L(r),Z(s.$$.fragment,r)},m(r,a){A(e,r,a),O(r,l,a),A(t,r,a),O(r,i,a),A(s,r,a),o=!0},p(r,a){const c={};a[1]&134217728&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const p={};a[1]&536870912&&(p.item=r[60]),t.$set(p);const f={};a[1]&536870912&&(f.item=r[60]),a[0]&3092&&(f.handleOnSubmit=r[55]),a[1]&134217728&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){o||(b(e.$$.fragment,r),b(t.$$.fragment,r),b(s.$$.fragment,r),o=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),C(s.$$.fragment,r),o=!1},d(r){r&&(_(l),_(i)),H(e,r),H(t,r),H(s,r)}}}function ci(n){let e,l,t,i,s,o,r;e=new bl({props:{capabilities:n[0]||[],store:n[1],storeProp:n[2],$$slots:{default:[ii,({capability:f,idx:m,level:u,parent:d,root:h})=>({61:f,62:m,11:u,10:d,63:h}),({capability:f,idx:m,level:u,parent:d,root:h})=>[(u?2048:0)|(d?1024:0),f?1073741824:0,(m?1:0)|(h?2:0)]]},$$scope:{ctx:n}}});const a=n[28].buttons,c=ke(a,n,n[58],Rt);let p=n[6]&&Gt(n);return{c(){V(e.$$.fragment),l=y(),c&&c.c(),t=y(),i=N("dialog"),p&&p.c(),this.h()},l(f){Z(e.$$.fragment,f),l=L(f),c&&c.l(f),t=L(f),i=I(f,"DIALOG",{id:!0});var m=S(i);p&&p.l(m),m.forEach(_),this.h()},h(){i.open=n[6],g(i,"id","create--capability--dialog")},m(f,m){A(e,f,m),O(f,l,m),c&&c.m(f,m),O(f,t,m),O(f,i,m),p&&p.m(i,null),n[56](i),s=!0,o||(r=j(i,"close",n[57]),o=!0)},p(f,m){const u={};m[0]&1&&(u.capabilities=f[0]||[]),m[0]&2&&(u.store=f[1]),m[0]&4&&(u.storeProp=f[2]),m[0]&4012|m[1]&1207959552|m[2]&3&&(u.$$scope={dirty:m,ctx:f}),e.$set(u),c&&c.p&&(!s||m[1]&134217728)&&Ce(c,a,f,f[58],s?Me(a,f[58],m,Kn):we(f[58]),Rt),f[6]?p?(p.p(f,m),m[0]&64&&b(p,1)):(p=Gt(f),p.c(),b(p,1),p.m(i,null)):p&&(Y(),C(p,1,1,()=>{p=null}),x()),(!s||m[0]&64)&&(i.open=f[6])},i(f){s||(b(e.$$.fragment,f),b(c,f),b(p),s=!0)},o(f){C(e.$$.fragment,f),C(c,f),C(p),s=!1},d(f){f&&(_(l),_(t),_(i)),H(e,f),c&&c.d(f),p&&p.d(),n[56](null),o=!1,r()}}}const Ze=28,nt=33;function fi(n,e,l){let t,i,s=K,o=()=>(s(),s=it(p,M=>l(9,i=M)),p);ve(n,$e,M=>l(8,t=M)),n.$$.on_destroy.push(()=>s());let{$$slots:r={},$$scope:a}=e,{capabilities:c}=e,{store:p}=e;o();let{storeProp:f}=e,{handlers:m}=e;const u={[ie.multiColor]:({root:M})=>M.color,[ie.childrenMultiColor]:({capability:M})=>M.color,[ie.heatMap]:({root:M})=>M.color};let d,h={},$,P,T=!1,v=null;const w=(M,q,R,be)=>{if(i.isReadonly||!be)return;const qe=q.id,Qe=R?.id;t[qe]||te($e,t[qe]=X.noop,t),M.shiftKey?t[qe]===X.noop?te($e,t[qe]=X.selected,t):te($e,t[qe]=X.noop,t):Object.entries(t).forEach(([He,rt])=>{He===qe?((!rt||rt===X.noop)&&te($e,t[He]=X.selected,t),rt===X.selected&&te($e,t[He]=X.noop,t)):te($e,t[He]=X.noop,t)}),Qe&&te($e,t[Qe]=X.parent,t),console.log({$selectedCapabilities:t})},E=M=>{const q=i[f][M.id].checked;te(p,i[f][M.id].checked=!q,i)},D=(M,q,R,be)=>{M.code==="Enter"&&q(M,R,be)},z=(M,q)=>{const R=q===void 0?i[f][M.id].checked:q;if(te(p,i[f][M.id].checked=!R,i),!!M?.children?.length)for(const be of M.children)z(i[f][be],R)},J=(M,q,R)=>{M.detail.event.stopPropagation(),l(10,$=q),l(11,P=R),l(6,T=!0),d.showModal()},B=()=>{l(6,T=!1),d.close()},W=({name:M,description:q},R,be,qe,Qe)=>{const He={id:null,name:M,description:q,techniques:[],children:[],checked:!1,color:"#0075FF"};qe===0?p.addChild(be,He,qe,Qe):p.addNonRootChild(be,He,Qe),R.close()},de=(M,q,R)=>{M.detail.event.stopPropagation(),te($e,t[q.id]=X.editing,t),te($e,t[R?.id]=X.noop,t),l(7,v=q.name)},pe=(M,q,R)=>{p.deleteSubmeasure(q,M,R)},he=(M,q,R)=>{M.detail.event.stopPropagation(),te($e,t[q.id]=X.selected,t),R&&te($e,t[R.id]=X.parent,t),l(7,v="")},F=(M,q,R,be)=>{p.editName(M.id,R,be),te($e,t[M.id]=X.selected,t),q&&te($e,t[q?.id]=X.parent,t)},oe=(M,q,R)=>{p.saveMeasureColor(q,M.srcElement.value,R)},Ie=(M,q,R,be)=>{console.log({event:M}),h[q.id].click()},ze=M=>{M.focus()},re=(M,q,R)=>{M.stopPropagation(),M.code==="Enter"&&F(q,R,v,f)},ee=(M,q)=>z(M);function me(){v=this.value,l(7,v)}const se=(M,q,R)=>re(R,M,q),De=(M,q)=>w(q,M,null,M.children.length===0),Ve=(M,q)=>D(q,w,M,null,M.children.length===0),Ye=(M,q,R)=>J(R,M,q),Ke=(M,q,R)=>de(R,M,q),Be=(M,q)=>m.deleteCapability(M),Re=(M,q,R,be)=>Ie(be,M);function Je(M,q){Ne[M?"unshift":"push"](()=>{h[q.id]=M,l(5,h)})}const kl=(M,q)=>oe(q,M,f),Cl=(M,q)=>F(M,q,v,f),wl=(M,q)=>he(q,M),Ml=(M,q)=>E(M);function El(){v=this.value,l(7,v)}const Tl=(M,q,R)=>re(R,M,q),Nl=(M,q,R)=>w(R,M,q,!0),Il=(M,q,R)=>D(R,w,M,q),Ol=(M,q,R)=>J(R,M,q),Pl=(M,q,R)=>de(R,M,q),Dl=(M,q,R)=>pe(M,q,f),Sl=(M,q,R,be)=>Ie(be,M);function yl(M,q){Ne[M?"unshift":"push"](()=>{h[q.id]=M,l(5,h)})}const Ll=(M,q)=>oe(q,M,f),ql=(M,q,R)=>F(M,q,v,f),zl=(M,q)=>he(q,M),Vl=M=>W(M,d,$,P,f);function Al(M){Ne[M?"unshift":"push"](()=>{d=M,l(4,d)})}const Hl=()=>l(6,T=!1);return n.$$set=M=>{"capabilities"in M&&l(0,c=M.capabilities),"store"in M&&o(l(1,p=M.store)),"storeProp"in M&&l(2,f=M.storeProp),"handlers"in M&&l(3,m=M.handlers),"$$scope"in M&&l(58,a=M.$$scope)},[c,p,f,m,d,h,T,v,t,i,$,P,u,w,E,D,z,J,B,W,de,pe,he,F,oe,Ie,ze,re,r,ee,me,se,De,Ve,Ye,Ke,Be,Re,Je,kl,Cl,wl,Ml,El,Tl,Nl,Il,Ol,Pl,Dl,Sl,yl,Ll,ql,zl,Vl,Al,Hl,a]}class $l extends ce{constructor(e){super(),fe(this,e,fi,ci,ae,{capabilities:0,store:1,storeProp:2,handlers:3},null,[-1,-1,-1])}}const ui=n=>({}),Kt=n=>({}),di=n=>({}),Jt=n=>({});function Qt(n){let e,l,t,i,s,o,r,a,c;const p=n[6].popover,f=ke(p,n,n[5],Kt);return{c(){e=N("div"),l=N("div"),i=y(),s=N("div"),f&&f.c(),this.h()},l(m){e=I(m,"DIV",{role:!0,tabindex:!0,"aria-labelledby":!0,"aria-describedby":!0,class:!0,style:!0});var u=S(e);l=I(u,"DIV",{class:!0}),S(l).forEach(_),i=L(u),s=I(u,"DIV",{class:!0});var d=S(s);f&&f.l(d),d.forEach(_),u.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-zv51ll"),g(s,"class","wrapper svelte-zv51ll"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-labelledby","Chart"),g(e,"aria-describedby","Description"),g(e,"class","popover svelte-zv51ll"),ue(e,"--popover-top",`${n[2]}px`),ue(e,"--popover-left",`${n[3]}px`)},m(m,u){O(m,e,u),k(e,l),k(e,i),k(e,s),f&&f.m(s,null),r=!0,a||(c=[j(l,"click",Ue(n[11])),j(e,"click",Ue(n[7]))],a=!0)},p(m,u){f&&f.p&&(!r||u&32)&&Ce(f,p,m,m[5],r?Me(p,m[5],u,ui):we(m[5]),Kt),(!r||u&4)&&ue(e,"--popover-top",`${m[2]}px`),(!r||u&8)&&ue(e,"--popover-left",`${m[3]}px`)},i(m){r||(m&&Se(()=>{r&&(t||(t=ye(l,Ae,{delay:25,duration:150},!0)),t.run(1))}),b(f,m),m&&Se(()=>{r&&(o||(o=ye(e,Ae,{},!0)),o.run(1))}),r=!0)},o(m){m&&(t||(t=ye(l,Ae,{delay:25,duration:150},!1)),t.run(0)),C(f,m),m&&(o||(o=ye(e,Ae,{},!1)),o.run(0)),r=!1},d(m){m&&_(e),m&&t&&t.end(),f&&f.d(m),m&&o&&o.end(),a=!1,ge(c)}}}function mi(n){let e,l,t,i,s,o;const r=n[6].popoverClick,a=ke(r,n,n[5],Jt);let c=n[1]&&Qt(n);return{c(){e=N("div"),a&&a.c(),l=y(),c&&c.c(),t=_e(),this.h()},l(p){e=I(p,"DIV",{role:!0,tabindex:!0});var f=S(e);a&&a.l(f),f.forEach(_),l=L(p),c&&c.l(p),t=_e(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(p,f){O(p,e,f),a&&a.m(e,null),n[10](e),O(p,l,f),c&&c.m(p,f),O(p,t,f),i=!0,s||(o=[j(window,"resize",n[8]),j(e,"click",n[9])],s=!0)},p(p,[f]){a&&a.p&&(!i||f&32)&&Ce(a,r,p,p[5],i?Me(r,p[5],f,di):we(p[5]),Jt),p[1]?c?(c.p(p,f),f&2&&b(c,1)):(c=Qt(p),c.c(),b(c,1),c.m(t.parentNode,t)):c&&(Y(),C(c,1,1,()=>{c=null}),x())},i(p){i||(b(a,p),b(c),i=!0)},o(p){C(a,p),C(c),i=!1},d(p){p&&(_(e),_(l),_(t)),a&&a.d(p),n[10](null),c&&c.d(p),s=!1,ge(o)}}}function pi(n,e,l){let{$$slots:t={},$$scope:i}=e,s=!1,o,r,a;const c=h=>setTimeout(()=>{l(2,{bottom:r,left:a}=h?.getBoundingClientRect()??{bottom:0,left:0},r,l(3,a))},1e3);function p(h){Rl.call(this,n,h)}const f=h=>c(o),m=()=>l(1,s=!0);function u(h){Ne[h?"unshift":"push"](()=>{o=h,l(0,o)})}const d=()=>l(1,s=!1);return n.$$set=h=>{"$$scope"in h&&l(5,i=h.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&c(o)},[o,s,r,a,c,i,t,p,f,m,u,d]}class hi extends ce{constructor(e){super(),fe(this,e,pi,mi,ae,{})}}function Wt(n){let e,l,t,i;return e=new ne({props:{size:33,iconName:"create portfolio",description:"Create New Profile"}}),e.$on("iconClick",n[15]),t=new ne({props:{size:33,iconName:"delete",description:"Delete Portfolio"}}),t.$on("iconClick",n[16]),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment)},l(s){Z(e.$$.fragment,s),l=L(s),Z(t.$$.fragment,s)},m(s,o){A(e,s,o),O(s,l,o),A(t,s,o),i=!0},p:K,i(s){i||(b(e.$$.fragment,s),b(t.$$.fragment,s),i=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),i=!1},d(s){s&&_(l),H(e,s),H(t,s)}}}function _i(n){let e,l;return e=new ne({props:{size:30,iconName:"chart",description:"Change Layout",slot:"popoverClick"}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p:K,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function gi(n){let e,l,t,i,s,o="Aggregate Multi-Colored",r,a,c,p,f,m="Multi-Colored",u,d,h,$,P,T="Heatmap",v,w,E;return t=new ne({props:{size:30,iconName:ie.multiColor,description:"Aggregate"}}),c=new ne({props:{size:30,viewBox:32,iconName:ie.childrenMultiColor,description:"Children Multi-Color"}}),h=new ne({props:{size:30,iconName:ie.heatMap,description:"Heatmap"}}),{c(){e=N("div"),l=N("button"),V(t.$$.fragment),i=y(),s=N("span"),s.textContent=o,r=y(),a=N("button"),V(c.$$.fragment),p=y(),f=N("span"),f.textContent=m,u=y(),d=N("button"),V(h.$$.fragment),$=y(),P=N("span"),P.textContent=T,this.h()},l(D){e=I(D,"DIV",{id:!0,slot:!0,class:!0});var z=S(e);l=I(z,"BUTTON",{class:!0});var J=S(l);Z(t.$$.fragment,J),i=L(J),s=I(J,"SPAN",{class:!0,"data-svelte-h":!0}),Ee(s)!=="svelte-okyth3"&&(s.textContent=o),J.forEach(_),r=L(z),a=I(z,"BUTTON",{class:!0});var B=S(a);Z(c.$$.fragment,B),p=L(B),f=I(B,"SPAN",{class:!0,"data-svelte-h":!0}),Ee(f)!=="svelte-17kog5w"&&(f.textContent=m),B.forEach(_),u=L(z),d=I(z,"BUTTON",{class:!0});var W=S(d);Z(h.$$.fragment,W),$=L(W),P=I(W,"SPAN",{class:!0,"data-svelte-h":!0}),Ee(P)!=="svelte-1cpq3q6"&&(P.textContent=T),W.forEach(_),z.forEach(_),this.h()},h(){g(s,"class","pop-text"),g(l,"class","btn svelte-1xhu43s"),le(l,"selected-mode",n[5].techniqueMappingMode===ie.multiColor),g(f,"class","pop-text"),g(a,"class","btn svelte-1xhu43s"),le(a,"selected-mode",n[5].techniqueMappingMode===ie.childrenMultiColor),g(P,"class","pop-text"),g(d,"class","btn svelte-1xhu43s"),le(d,"selected-mode",n[5].techniqueMappingMode===ie.heatMap),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-1xhu43s")},m(D,z){O(D,e,z),k(e,l),A(t,l,null),k(l,i),k(l,s),k(e,r),k(e,a),A(c,a,null),k(a,p),k(a,f),k(e,u),k(e,d),A(h,d,null),k(d,$),k(d,P),v=!0,w||(E=[j(l,"click",n[19]),j(a,"click",n[20]),j(d,"click",n[21])],w=!0)},p(D,z){(!v||z&32)&&le(l,"selected-mode",D[5].techniqueMappingMode===ie.multiColor),(!v||z&32)&&le(a,"selected-mode",D[5].techniqueMappingMode===ie.childrenMultiColor),(!v||z&32)&&le(d,"selected-mode",D[5].techniqueMappingMode===ie.heatMap)},i(D){v||(b(t.$$.fragment,D),b(c.$$.fragment,D),b(h.$$.fragment,D),v=!0)},o(D){C(t.$$.fragment,D),C(c.$$.fragment,D),C(h.$$.fragment,D),v=!1},d(D){D&&_(e),H(t),H(c),H(h),w=!1,ge(E)}}}function Xt(n){let e,l,t,i;return e=new ne({props:{size:33,iconName:"import",description:"Import Portfolio",$$slots:{default:[bi]},$$scope:{ctx:n}}}),e.$on("iconClick",n[11]),t=new ne({props:{size:33,iconName:"export",description:"Export Portfolio"}}),t.$on("iconClick",n[10]),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment)},l(s){Z(e.$$.fragment,s),l=L(s),Z(t.$$.fragment,s)},m(s,o){A(e,s,o),O(s,l,o),A(t,s,o),i=!0},p(s,o){const r={};o&536870915&&(r.$$scope={dirty:o,ctx:s}),e.$set(r)},i(s){i||(b(e.$$.fragment,s),b(t.$$.fragment,s),i=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),i=!1},d(s){s&&_(l),H(e,s),H(t,s)}}}function bi(n){let e,l,t;return{c(){e=N("input"),this.h()},l(i){e=I(i,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){g(e,"type","file"),g(e,"id","file"),g(e,"name","file"),e.hidden=!0,g(e,"accept",".json")},m(i,s){O(i,e,s),n[22](e),l||(t=[j(e,"change",n[23]),j(e,"change",n[12])],l=!0)},p:K,d(i){i&&_(e),n[22](null),l=!1,ge(t)}}}function Yt(n){let e,l;return e=new ot({props:{$$slots:{default:[Ci,({M:t,item:i})=>({27:t,28:i}),({M:t,item:i})=>(t?134217728:0)|(i?268435456:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i&805306372&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function $i(n){let e;return{c(){e=U("Create New Profile")},l(l){e=G(l,"Create New Profile")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function vi(n){let e;return{c(){e=U("Create")},l(l){e=G(l,"Create")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function ki(n){let e;return{c(){e=U("Cancel")},l(l){e=G(l,"Cancel")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Ci(n){let e,l,t,i,s,o;return e=new n[27].Title({props:{$$slots:{default:[$i]},$$scope:{ctx:n}}}),t=new n[27].Create({props:{item:n[28],textInput:"Name",textArea:"Description"}}),s=new n[27].Buttons({props:{item:n[28],handleCloseModal:n[14],handleOnSubmit:n[24],$$slots:{cancel:[ki],submit:[vi]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment),i=y(),V(s.$$.fragment)},l(r){Z(e.$$.fragment,r),l=L(r),Z(t.$$.fragment,r),i=L(r),Z(s.$$.fragment,r)},m(r,a){A(e,r,a),O(r,l,a),A(t,r,a),O(r,i,a),A(s,r,a),o=!0},p(r,a){const c={};a&536870912&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const p={};a&268435456&&(p.item=r[28]),t.$set(p);const f={};a&268435456&&(f.item=r[28]),a&4&&(f.handleOnSubmit=r[24]),a&536870912&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){o||(b(e.$$.fragment,r),b(t.$$.fragment,r),b(s.$$.fragment,r),o=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),C(s.$$.fragment,r),o=!1},d(r){r&&(_(l),_(i)),H(e,r),H(t,r),H(s,r)}}}function wi(n){let e,l,t,i,s,o,r,a,c,p,f,m,u,d,h=!n[5].isReadonly&&Wt(n);function $(w){n[18](w)}let P={inputClassName:"autocomplete-cursor-select",items:n[5]?.portfolios,readonly:!1,labelFieldName:"name",onChange:n[17]};n[4]!==void 0&&(P.selectedItem=n[4]),i=new en({props:P}),Ne.push(()=>Ul(i,"selectedItem",$)),a=new hi({props:{$$slots:{popover:[gi],popoverClick:[_i]},$$scope:{ctx:n}}});let T=!n[5].isReadonly&&Xt(n),v=n[3]&&Yt(n);return{c(){e=N("section"),l=N("div"),h&&h.c(),t=y(),V(i.$$.fragment),o=y(),r=N("div"),V(a.$$.fragment),c=y(),T&&T.c(),p=y(),f=N("dialog"),v&&v.c(),this.h()},l(w){e=I(w,"SECTION",{id:!0,class:!0});var E=S(e);l=I(E,"DIV",{id:!0,class:!0});var D=S(l);h&&h.l(D),t=L(D),Z(i.$$.fragment,D),o=L(D),r=I(D,"DIV",{id:!0,class:!0});var z=S(r);Z(a.$$.fragment,z),z.forEach(_),c=L(D),T&&T.l(D),D.forEach(_),E.forEach(_),p=L(w),f=I(w,"DIALOG",{});var J=S(f);v&&v.l(J),J.forEach(_),this.h()},h(){g(r,"id","measure-btns"),g(r,"class","svelte-1xhu43s"),g(l,"id","portfolio-controls"),g(l,"class","svelte-1xhu43s"),g(e,"id","container-portfolio"),g(e,"class","svelte-1xhu43s"),f.open=n[3]},m(w,E){O(w,e,E),k(e,l),h&&h.m(l,null),k(l,t),A(i,l,null),k(l,o),k(l,r),A(a,r,null),k(l,c),T&&T.m(l,null),O(w,p,E),O(w,f,E),v&&v.m(f,null),n[25](f),m=!0,u||(d=j(f,"close",n[26]),u=!0)},p(w,[E]){w[5].isReadonly?h&&(Y(),C(h,1,1,()=>{h=null}),x()):h?(h.p(w,E),E&32&&b(h,1)):(h=Wt(w),h.c(),b(h,1),h.m(l,t));const D={};E&32&&(D.items=w[5]?.portfolios),!s&&E&16&&(s=!0,D.selectedItem=w[4],jl(()=>s=!1)),i.$set(D);const z={};E&536870944&&(z.$$scope={dirty:E,ctx:w}),a.$set(z),w[5].isReadonly?T&&(Y(),C(T,1,1,()=>{T=null}),x()):T?(T.p(w,E),E&32&&b(T,1)):(T=Xt(w),T.c(),b(T,1),T.m(l,null)),w[3]?v?(v.p(w,E),E&8&&b(v,1)):(v=Yt(w),v.c(),b(v,1),v.m(f,null)):v&&(Y(),C(v,1,1,()=>{v=null}),x()),(!m||E&8)&&(f.open=w[3])},i(w){m||(b(h),b(i.$$.fragment,w),b(a.$$.fragment,w),b(T),b(v),m=!0)},o(w){C(h),C(i.$$.fragment,w),C(a.$$.fragment,w),C(T),C(v),m=!1},d(w){w&&(_(e),_(p),_(f)),h&&h.d(),H(i),H(a),T&&T.d(),v&&v.d(),n[25](null),u=!1,d()}}}function Mi(n,e,l){let t;ve(n,Q,F=>l(5,t=F));let i,s,o,r=!1,a=t?.portfolios?.[t?.selectedPortfolio]||null;const c=F=>{if(F){const oe=t.portfolios.findIndex(({id:Ie})=>Ie===F.id);te(Q,t.selectedPortfolio=oe,t),l(4,a=t?.portfolios?.[oe]||null),je.reset()}else te(Q,t.selectedPortfolio=null,t),l(4,a=F)},p=()=>{l(3,r=!0),o.showModal()},f=({name:F,description:oe},Ie)=>{Q.createPortfolio({name:F,description:oe}),l(4,a=t.portfolios[t.selectedPortfolio]||null),Ie.close()},m=F=>{confirm("Deleting Portfolio will delete whole portfolio.")&&(Q.deletePortfolio(),l(4,a=t.portfolios[t.selectedPortfolio]||{name:""}))},u=()=>{const F=JSON.stringify(t),oe=new Blob([F],{type:"application/json;charset=utf-8"});Jl(oe,"d3fend-profile.json")},d=()=>{i.click()},h=async()=>{const F=await i.files[0];if(console.log({file:F}),F){let oe;try{oe=JSON.parse(await F.text())}catch(Ie){return alert("Unable to parse file"),console.error(Ie)}Q.set(oe),alert("Profile imported Successfully")}},$=F=>{te(Q,t.techniqueMappingMode=F,t)},P=()=>{l(3,r=!1),o.close()},T=F=>p(),v=F=>m(),w=F=>c(F);function E(F){a=F,l(4,a)}const D=()=>$(ie.multiColor),z=()=>$(ie.childrenMultiColor),J=()=>$(ie.heatMap);function B(F){Ne[F?"unshift":"push"](()=>{i=F,l(0,i)})}function W(){s=this.files,l(1,s)}const de=F=>f(F,o);function pe(F){Ne[F?"unshift":"push"](()=>{o=F,l(2,o)})}return[i,s,o,r,a,t,c,p,f,m,u,d,h,$,P,T,v,w,E,D,z,J,B,W,de,pe,()=>l(3,r=!1)]}class Ei extends ce{constructor(e){super(),fe(this,e,Mi,wi,ae,{})}}function xt(n){let e,l,t,i;return e=new ne({props:{size:33,iconName:"plus_circle",description:"Create Capability Layer",disabled:!n[0].portfolios.length>0}}),e.$on("iconClick",n[13]),t=new ne({props:{size:35,iconName:"copy",description:"Copy From Templates",disabled:!n[0].portfolios.length>0}}),t.$on("iconClick",n[14]),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment)},l(s){Z(e.$$.fragment,s),l=L(s),Z(t.$$.fragment,s)},m(s,o){A(e,s,o),O(s,l,o),A(t,s,o),i=!0},p(s,o){const r={};o&1&&(r.disabled=!s[0].portfolios.length>0),e.$set(r);const a={};o&1&&(a.disabled=!s[0].portfolios.length>0),t.$set(a)},i(s){i||(b(e.$$.fragment,s),b(t.$$.fragment,s),i=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),i=!1},d(s){s&&_(l),H(e,s),H(t,s)}}}function Ti(n){let e,l,t=!n[0].isReadonly&&xt(n);return{c(){e=N("div"),t&&t.c(),this.h()},l(i){e=I(i,"DIV",{id:!0,slot:!0});var s=S(e);t&&t.l(s),s.forEach(_),this.h()},h(){g(e,"id","capability--btns"),g(e,"slot","buttons")},m(i,s){O(i,e,s),t&&t.m(e,null),l=!0},p(i,s){i[0].isReadonly?t&&(Y(),C(t,1,1,()=>{t=null}),x()):t?(t.p(i,s),s&1&&b(t,1)):(t=xt(i),t.c(),b(t,1),t.m(e,null))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d()}}}function el(n){let e,l;return e=new ot({props:{$$slots:{default:[Pi,({M:t,item:i})=>({22:t,23:i}),({M:t,item:i})=>(t?4194304:0)|(i?8388608:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i&25165826&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ni(n){let e;return{c(){e=U("Create Capability Layer")},l(l){e=G(l,"Create Capability Layer")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Ii(n){let e;return{c(){e=U("Create")},l(l){e=G(l,"Create")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Oi(n){let e;return{c(){e=U("Cancel")},l(l){e=G(l,"Cancel")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Pi(n){let e,l,t,i,s,o;return e=new n[22].Title({props:{$$slots:{default:[Ni]},$$scope:{ctx:n}}}),t=new n[22].Create({props:{item:n[23],textInput:"Name",textArea:"Description"}}),s=new n[22].Buttons({props:{item:n[23],handleCloseModal:n[11],handleOnSubmit:n[15],$$slots:{cancel:[Oi],submit:[Ii]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment),i=y(),V(s.$$.fragment)},l(r){Z(e.$$.fragment,r),l=L(r),Z(t.$$.fragment,r),i=L(r),Z(s.$$.fragment,r)},m(r,a){A(e,r,a),O(r,l,a),A(t,r,a),O(r,i,a),A(s,r,a),o=!0},p(r,a){const c={};a&16777216&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const p={};a&8388608&&(p.item=r[23]),t.$set(p);const f={};a&8388608&&(f.item=r[23]),a&2&&(f.handleOnSubmit=r[15]),a&16777216&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){o||(b(e.$$.fragment,r),b(t.$$.fragment,r),b(s.$$.fragment,r),o=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),C(s.$$.fragment,r),o=!1},d(r){r&&(_(l),_(i)),H(e,r),H(t,r),H(s,r)}}}function tl(n){let e,l;return e=new qn({props:{dialog:n[3],title:"Copy Capability From Templates",store:n[0].templates,copyHandler:n[9]}}),e.$on("closeModal",n[10]),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i&8&&(s.dialog=t[3]),i&1&&(s.store=t[0].templates),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Di(n){let e,l,t,i,s,o="Layers",r,a,c,p,f,m,u,d,h,$,P,T,v;t=new Ei({}),c=new $l({props:{capabilities:n[5]?.includedMeasures||[],store:Q,storeProp:Le.measures,handlers:n[12],$$slots:{buttons:[Ti]},$$scope:{ctx:n}}}),m=new gl({});let w=n[2]&&el(n),E=n[4]&&tl(n);return{c(){e=N("main"),l=N("section"),V(t.$$.fragment),i=y(),s=N("div"),s.textContent=o,r=y(),a=N("section"),V(c.$$.fragment),p=y(),f=N("section"),V(m.$$.fragment),u=y(),d=N("dialog"),w&&w.c(),h=y(),$=N("dialog"),E&&E.c(),this.h()},l(D){e=I(D,"MAIN",{class:!0});var z=S(e);l=I(z,"SECTION",{id:!0});var J=S(l);Z(t.$$.fragment,J),J.forEach(_),i=L(z),s=I(z,"DIV",{class:!0,"data-svelte-h":!0}),Ee(s)!=="svelte-1mcdf1q"&&(s.textContent=o),r=L(z),a=I(z,"SECTION",{id:!0});var B=S(a);Z(c.$$.fragment,B),B.forEach(_),p=L(z),f=I(z,"SECTION",{id:!0});var W=S(f);Z(m.$$.fragment,W),W.forEach(_),u=L(z),d=I(z,"DIALOG",{id:!0});var de=S(d);w&&w.l(de),de.forEach(_),h=L(z),$=I(z,"DIALOG",{id:!0});var pe=S($);E&&E.l(pe),pe.forEach(_),z.forEach(_),this.h()},h(){g(l,"id","container-header"),g(s,"class","text- fancy-font"),g(a,"id","container-measure"),g(f,"id","container-btns"),d.open=n[2],g(d,"id","capability--dialog"),$.open=n[4],g($,"id","capability--dialog"),g(e,"class","svelte-1mkmdvu")},m(D,z){O(D,e,z),k(e,l),A(t,l,null),k(e,i),k(e,s),k(e,r),k(e,a),A(c,a,null),k(e,p),k(e,f),A(m,f,null),k(e,u),k(e,d),w&&w.m(d,null),n[16](d),k(e,h),k(e,$),E&&E.m($,null),n[18]($),P=!0,T||(v=[j(d,"close",n[17]),j($,"close",n[19])],T=!0)},p(D,[z]){const J={};z&32&&(J.capabilities=D[5]?.includedMeasures||[]),z&16777217&&(J.$$scope={dirty:z,ctx:D}),c.$set(J),D[2]?w?(w.p(D,z),z&4&&b(w,1)):(w=el(D),w.c(),b(w,1),w.m(d,null)):w&&(Y(),C(w,1,1,()=>{w=null}),x()),(!P||z&4)&&(d.open=D[2]),D[4]?E?(E.p(D,z),z&16&&b(E,1)):(E=tl(D),E.c(),b(E,1),E.m($,null)):E&&(Y(),C(E,1,1,()=>{E=null}),x()),(!P||z&16)&&($.open=D[4])},i(D){P||(b(t.$$.fragment,D),b(c.$$.fragment,D),b(m.$$.fragment,D),b(w),b(E),P=!0)},o(D){C(t.$$.fragment,D),C(c.$$.fragment,D),C(m.$$.fragment,D),C(w),C(E),P=!1},d(D){D&&_(e),H(t),H(c),H(m),w&&w.d(),n[16](null),E&&E.d(),n[18](null),T=!1,ge(v)}}}function Si(n,e,l){let t,i;ve(n,Q,B=>l(0,i=B));let s,o=!1,r,a=!1;const c=B=>{Q.deleteMeasure(B.id)},p=(B,W,de)=>{Q.deleteSubmeasure(de,W)},f=B=>{l(2,o=!0),s.showModal()},m=B=>{l(4,a=!0),r.showModal()},u=({name:B,description:W},de)=>{const pe={id:ct(B),name:B,description:W,techniques:[],children:[],checked:!1,color:"#0075FF"};Q.addMeasure(pe),de.close()},d=B=>{const{newArray:W,mappedIds:de}=B.reduce((he,F)=>{const oe=ct(F.name);return he.newArray.push({...F,id:oe}),he.mappedIds[F.id]=oe,he},{newArray:[],mappedIds:{}}),pe=Yl(W,de);Q.bulkAddMeasure(pe,pe[0].id)},h=({detail:{dialog:B,dialogName:W}})=>{W==="copy"?(console.log("closed"),l(4,a=!1),r.close()):W==="create"&&l(2,o=!1)},$=()=>{l(2,o=!1),s.close()},P={deleteCapability:c,deleteChildCapability:p},T=B=>f(),v=B=>m(),w=B=>u(B,s);function E(B){Ne[B?"unshift":"push"](()=>{s=B,l(1,s)})}const D=()=>l(2,o=!1);function z(B){Ne[B?"unshift":"push"](()=>{r=B,l(3,r)})}const J=()=>l(4,a=!1);return n.$$.update=()=>{n.$$.dirty&1&&l(5,t=i?.portfolios?.[i?.selectedPortfolio])},[i,s,o,r,a,t,f,m,u,d,h,$,P,T,v,w,E,D,z,J]}class yi extends ce{constructor(e){super(),fe(this,e,Si,Di,ae,{})}}function ll(n){let e,l;return e=new ne({props:{size:33,iconName:"plus_circle",description:"Create Template Capability"}}),e.$on("iconClick",n[7]),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p:K,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Li(n){let e,l,t=!n[2].isReadonly&&ll(n);return{c(){e=N("div"),t&&t.c(),this.h()},l(i){e=I(i,"DIV",{id:!0,slot:!0});var s=S(e);t&&t.l(s),s.forEach(_),this.h()},h(){g(e,"id","capability--btns"),g(e,"slot","buttons")},m(i,s){O(i,e,s),t&&t.m(e,null),l=!0},p(i,s){i[2].isReadonly?t&&(Y(),C(t,1,1,()=>{t=null}),x()):t?(t.p(i,s),s&4&&b(t,1)):(t=ll(i),t.c(),b(t,1),t.m(e,null))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d()}}}function nl(n){let e,l;return e=new ot({props:{$$slots:{default:[Ai,({M:t,item:i})=>({13:t,14:i}),({M:t,item:i})=>(t?8192:0)|(i?16384:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p(t,i){const s={};i&49153&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function qi(n){let e;return{c(){e=U("Create Template Capability")},l(l){e=G(l,"Create Template Capability")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function zi(n){let e;return{c(){e=U("Create")},l(l){e=G(l,"Create")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Vi(n){let e;return{c(){e=U("Cancel")},l(l){e=G(l,"Cancel")},m(l,t){O(l,e,t)},d(l){l&&_(e)}}}function Ai(n){let e,l,t,i,s,o;return e=new n[13].Title({props:{$$slots:{default:[qi]},$$scope:{ctx:n}}}),t=new n[13].Create({props:{item:n[14],textInput:"Name",textArea:"Description"}}),s=new n[13].Buttons({props:{item:n[14],handleCloseModal:n[4],handleOnSubmit:n[8],$$slots:{cancel:[Vi],submit:[zi]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment),i=y(),V(s.$$.fragment)},l(r){Z(e.$$.fragment,r),l=L(r),Z(t.$$.fragment,r),i=L(r),Z(s.$$.fragment,r)},m(r,a){A(e,r,a),O(r,l,a),A(t,r,a),O(r,i,a),A(s,r,a),o=!0},p(r,a){const c={};a&32768&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const p={};a&16384&&(p.item=r[14]),t.$set(p);const f={};a&16384&&(f.item=r[14]),a&1&&(f.handleOnSubmit=r[8]),a&32768&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){o||(b(e.$$.fragment,r),b(t.$$.fragment,r),b(s.$$.fragment,r),o=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),C(s.$$.fragment,r),o=!1},d(r){r&&(_(l),_(i)),H(e,r),H(t,r),H(s,r)}}}function Hi(n){let e,l,t,i,s,o,r,a,c,p,f;t=new $l({props:{capabilities:n[2].rootTemplates||[],store:Q,storeProp:Le.templates,handlers:n[6],$$slots:{buttons:[Li]},$$scope:{ctx:n}}}),o=new gl({props:{selectedStore:Le.templates}});let m=n[1]&&nl(n);return{c(){e=N("main"),l=N("section"),V(t.$$.fragment),i=y(),s=N("section"),V(o.$$.fragment),r=y(),a=N("dialog"),m&&m.c(),this.h()},l(u){e=I(u,"MAIN",{class:!0});var d=S(e);l=I(d,"SECTION",{id:!0});var h=S(l);Z(t.$$.fragment,h),h.forEach(_),i=L(d),s=I(d,"SECTION",{id:!0});var $=S(s);Z(o.$$.fragment,$),$.forEach(_),r=L(d),a=I(d,"DIALOG",{id:!0});var P=S(a);m&&m.l(P),P.forEach(_),d.forEach(_),this.h()},h(){g(l,"id","container-measure"),g(s,"id","container-btns"),a.open=n[1],g(a,"id","capability--dialog"),g(e,"class","svelte-1mkmdvu")},m(u,d){O(u,e,d),k(e,l),A(t,l,null),k(e,i),k(e,s),A(o,s,null),k(e,r),k(e,a),m&&m.m(a,null),n[9](a),c=!0,p||(f=j(a,"close",n[10]),p=!0)},p(u,[d]){const h={};d&4&&(h.capabilities=u[2].rootTemplates||[]),d&32772&&(h.$$scope={dirty:d,ctx:u}),t.$set(h),u[1]?m?(m.p(u,d),d&2&&b(m,1)):(m=nl(u),m.c(),b(m,1),m.m(a,null)):m&&(Y(),C(m,1,1,()=>{m=null}),x()),(!c||d&2)&&(a.open=u[1])},i(u){c||(b(t.$$.fragment,u),b(o.$$.fragment,u),b(m),c=!0)},o(u){C(t.$$.fragment,u),C(o.$$.fragment,u),C(m),c=!1},d(u){u&&_(e),H(t),H(o),m&&m.d(),n[9](null),p=!1,f()}}}function Zi(n,e,l){let t;ve(n,Q,$=>l(2,t=$));let i,s=!1;const o=$=>{Q.deleteTemplate($.id)},r=($,P,T)=>{Q.deleteSubmeasure(T,P,Le.templates)},a=$=>{l(1,s=!0),i.showModal()},c=()=>{l(1,s=!1),i.close()},p=({name:$,description:P},T)=>{const v={id:ct($),name:$,description:P,techniques:[],children:[],checked:!1,color:"#0075FF"};Q.addTemplate(v),T.close()},f={deleteCapability:o,deleteChildCapability:r},m=$=>a(),u=$=>p($,i);function d($){Ne[$?"unshift":"push"](()=>{i=$,l(0,i)})}return[i,s,t,a,c,p,f,m,u,d,()=>l(1,s=!1)]}class Bi extends ce{constructor(e){super(),fe(this,e,Zi,Hi,ae,{})}}function Ri(n){let e,l="D3FEND PROFILE";return{c(){e=N("h2"),e.textContent=l,this.h()},l(t){e=I(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),Ee(e)!=="svelte-u9fo7w"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){O(t,e,i)},p:K,d(t){t&&_(e)}}}function ji(n){let e,l,t,i,s;return l=new hn({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[Ri]},$$scope:{ctx:n}}}),{c(){e=N("section"),V(l.$$.fragment),this.h()},l(o){e=I(o,"SECTION",{class:!0});var r=S(e);Z(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","svelte-qzr7y6")},m(o,r){O(o,e,r),A(l,e,null),s=!0},p(o,[r]){const a={};r&1&&(a.tabs=o[0]),r&2&&(a.activeTabValue=o[1]),r&32&&(a.$$scope={dirty:r,ctx:o}),l.$set(a)},i(o){s||(b(l.$$.fragment,o),o&&Se(()=>{s&&(i&&i.end(1),t=st(e,Ae,{delay:400}),t.start())}),s=!0)},o(o){C(l.$$.fragment,o),t&&t.invalidate(),o&&(i=_l(e,Ae,{duration:100})),s=!1},d(o){o&&_(e),H(l),o&&i&&i.end()}}}function Fi(n,e,l){let t,i,s;ve(n,Q,a=>l(4,i=a));const o=ft(i.selectedStore);ve(n,o,a=>l(1,s=a));const r=(a,c)=>{te(o,s=a,s),te(Q,i.selectedStore=c,i)};return l(0,t=[{label:"Profiles",value:Le.measures,component:yi},{label:"Templates",value:Le.templates,component:Bi}]),[t,s,o,r]}class Ui extends ce{constructor(e){super(),fe(this,e,Fi,ji,ae,{})}}function il(n,e,l){const t=n.slice();return t[4]=e[l],t}function sl(n){let e,l,t,i,s,o;return t=new ne({props:{size:33,iconName:n[0]?.isDrawerOpen?"arrowLeft":"arrowRight",description:"Profile Controls",pathColor:"white"}}),{c(){e=N("div"),l=N("span"),V(t.$$.fragment),this.h()},l(r){e=I(r,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var a=S(e);l=I(a,"SPAN",{});var c=S(l);Z(t.$$.fragment,c),c.forEach(_),a.forEach(_),this.h()},h(){g(e,"id","drawer-btn"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"class","svelte-mz34j1")},m(r,a){O(r,e,a),k(e,l),A(t,l,null),i=!0,s||(o=[j(e,"click",n[2]),j(e,"keyup",null)],s=!0)},p(r,a){const c={};a&1&&(c.iconName=r[0]?.isDrawerOpen?"arrowLeft":"arrowRight"),t.$set(c)},i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){C(t.$$.fragment,r),i=!1},d(r){r&&_(e),H(t),s=!1,ge(o)}}}function ol(n){let e,l=Oe(n[1].list.map(n[3]).reverse()),t=[];for(let i=0;i<l.length;i+=1)t[i]=al(il(n,l,i));return{c(){e=N("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{id:!0,class:!0});var s=S(e);for(let o=0;o<t.length;o+=1)t[o].l(s);s.forEach(_),this.h()},h(){g(e,"id","legend"),g(e,"class","svelte-mz34j1")},m(i,s){O(i,e,s);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(i,s){if(s&3){l=Oe(i[1].list.map(i[3]).reverse());let o;for(o=0;o<l.length;o+=1){const r=il(i,l,o);t[o]?t[o].p(r,s):(t[o]=al(r),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(i){i&&_(e),Fe(t,i)}}}function rl(n){let e,l=n[4].name+"",t,i;return{c(){e=N("div"),t=U(l),i=y(),this.h()},l(s){e=I(s,"DIV",{class:!0,style:!0});var o=S(e);t=G(o,l),i=L(o),o.forEach(_),this.h()},h(){g(e,"class","legend-item svelte-mz34j1"),ue(e,"background",n[4].color)},m(s,o){O(s,e,o),k(e,t),k(e,i)},p(s,o){o&3&&l!==(l=s[4].name+"")&&Pe(t,l),o&3&&ue(e,"background",s[4].color)},d(s){s&&_(e)}}}function al(n){let e,l=n[4].checked&&rl(n);return{c(){l&&l.c(),e=_e()},l(t){l&&l.l(t),e=_e()},m(t,i){l&&l.m(t,i),O(t,e,i)},p(t,i){t[4].checked?l?l.p(t,i):(l=rl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&_(e),l&&l.d(t)}}}function Gi(n){let e,l,t,i=!n[0]?.isReadonly&&sl(n),s=n[0]?.showLegend&&n[0]?.techniqueMappingMode!=="heatMap"&&n[1].list?.length>0&&ol(n);return{c(){i&&i.c(),e=y(),l=N("div"),s&&s.c(),this.h()},l(o){i&&i.l(o),e=L(o),l=I(o,"DIV",{id:!0,class:!0});var r=S(l);s&&s.l(r),r.forEach(_),this.h()},h(){g(l,"id","container-legend"),g(l,"class","svelte-mz34j1")},m(o,r){i&&i.m(o,r),O(o,e,r),O(o,l,r),s&&s.m(l,null),t=!0},p(o,[r]){o[0]?.isReadonly?i&&(Y(),C(i,1,1,()=>{i=null}),x()):i?(i.p(o,r),r&1&&b(i,1)):(i=sl(o),i.c(),b(i,1),i.m(e.parentNode,e)),o[0]?.showLegend&&o[0]?.techniqueMappingMode!=="heatMap"&&o[1].list?.length>0?s?s.p(o,r):(s=ol(o),s.c(),s.m(l,null)):s&&(s.d(1),s=null)},i(o){t||(b(i),t=!0)},o(o){C(i),t=!1},d(o){o&&(_(e),_(l)),i&&i.d(o),s&&s.d()}}}function Ki(n,e,l){let t,i;ve(n,Q,r=>l(0,i=r));const s=()=>{te(Q,i.isDrawerOpen=!i.isDrawerOpen,i)},o=r=>i[t.store][r];return n.$$.update=()=>{n.$$.dirty&1&&l(1,t=i.selectedStore===Le.measures?{list:i?.portfolios[i.selectedPortfolio]?.includedMeasures,store:Le.measures}:{list:i?.rootTemplates,store:Le.templates})},[i,t,s,o]}class Ji extends ce{constructor(e){super(),fe(this,e,Ki,Gi,ae,{})}}const Qi=(n,e)=>{const l={max:0,count:{},highlighted:{}};return Xl([n,e],([t,i],s)=>{if(!i?.tree.length||!n){s(xl);return}l.count={},l.highlighted=Object.entries(l.highlighted).reduce((f,[m,u])=>(f[m]=!1,f),{});const o=t.techniqueMappingMode===ie.multiColor,r=t.selectedStore===Le.measures?{list:t?.portfolios[t.selectedPortfolio]?.includedMeasures,store:t?.measures}:{list:t?.rootTemplates,store:t?.templates},{highlightedTechniques:a,techniqueColors:c}=vl(r.list,r.store,o,0),p=Object.entries(c).reduce((f,[m,u])=>(f[m]=[...new Set(u)],f),{});a.forEach(f=>{l.highlighted[f]=!0,l.count[f]?l.count[f]+=1:l.count[f]=1}),l.max=Object.values(l.count).reduce((f,m)=>f>m?f:m,-1/0),Object.entries(l.highlighted).forEach(([f,m])=>{if(m){const u=Xi[t.techniqueMappingMode]({colors:p[f],count:l.count,max:l.max,technique:f});i.treeMap[f].classes.isHighlighted=!0,i.treeMap[f].classes.color=u}else i.treeMap[f].classes.isHighlighted=!1,i.treeMap[f].classes.color=null}),s(i)})},cl=n=>{const{colors:e}=n,l=e.length,t=l-1,i=(1/l*100).toFixed(1);if(l===1)return e[0];let s="linear-gradient( to right,";for(let o=0;o<l;o++){const r=e[o];if(o===0){s+=` ${r} ${i}%`;continue}if(o===t){s+=`, ${r} ${i*t}%`;continue}s+=`, ${r} ${i*o}% ${i*(o+1)}%`}return s+=")",s},Wi=n=>{const{count:e,max:l,technique:t}=n,i=e[t]/l*100;return`color-mix(in srgb, green ${i<20?20:i}%, white)`},Xi={[ie.multiColor]:n=>cl(n),[ie.heatMap]:n=>Wi(n),[ie.childrenMultiColor]:n=>cl(n)},vl=(n=[],e,l,t,i=null,s=[],o={})=>{for(let r=0;r<n.length;r++){const a=e[n[r]],c=t===0||!l?a.color:i,p=t+1;a.checked&&(s.push(...a.techniques),a.techniques.forEach(f=>{(o[f]||(o[f]=[]))&&o[f].push(c)})),a.children&&vl(a.children,e,l,p,c,s,o)}return{highlightedTechniques:s,techniqueColors:o}},Yi=Qi(Q,je);function xi(n){let e,l;return e=new Ui({props:{slot:"drawer"}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p:K,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function es(n){let e,l;return e=new tn({props:{treeStore:Yi,theme:"main",slot:"matrix",scroll_indicator:!1}}),e.$on("elementClick",n[4]),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p:K,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function ts(n){let e,l;return e=new Ji({props:{slot:"legend"}}),{c(){V(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,i){A(e,t,i),l=!0},p:K,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function ls(n){return{c:K,l:K,m:K,p:K,i:K,o:K,d:K}}function ns(n){let e,l,t=n[3]&&fl(n);return{c(){t&&t.c(),e=_e()},l(i){t&&t.l(i),e=_e()},m(i,s){t&&t.m(i,s),O(i,e,s),l=!0},p(i,s){i[3]?t?(t.p(i,s),s&8&&b(t,1)):(t=fl(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(Y(),C(t,1,1,()=>{t=null}),x())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function fl(n){let e,l="esc",t,i,s,o,r;return i=new nn({props:{technique_id:n[0].technique_id,technique:n[16]}}),{c(){e=N("button"),e.textContent=l,t=y(),V(i.$$.fragment)},l(a){e=I(a,"BUTTON",{"data-svelte-h":!0}),Ee(e)!=="svelte-1ejhv6h"&&(e.textContent=l),t=L(a),Z(i.$$.fragment,a)},m(a,c){O(a,e,c),O(a,t,c),A(i,a,c),s=!0,o||(r=j(e,"click",hl(n[8])),o=!0)},p(a,c){const p={};c&1&&(p.technique_id=a[0].technique_id),c&8&&(p.technique=a[16]),i.$set(p)},i(a){s||(b(i.$$.fragment,a),s=!0)},o(a){C(i.$$.fragment,a),s=!1},d(a){a&&(_(e),_(t)),H(i,a),o=!1,r()}}}function is(n){let e,l="loading...";return{c(){e=N("span"),e.textContent=l},l(t){e=I(t,"SPAN",{"data-svelte-h":!0}),Ee(e)!=="svelte-sermp4"&&(e.textContent=l)},m(t,i){O(t,e,i)},p:K,i:K,o:K,d(t){t&&_(e)}}}function ss(n){let e,l,t,i,s,o,r,a,c,p,f,m;e=new ln({props:{title:"D3FEND Profile Studio",og_title:"D3FEND Profile Studio",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Profile Studio lets you organize and communicate your defensive cyber capabilities!"}}),t=new un({props:{$$slots:{legend:[ts],matrix:[es],drawer:[xi]},$$scope:{ctx:n}}});let u={ctx:n,current:null,token:null,hasCatch:!1,pending:is,then:ns,catch:ls,value:16,blocks:[,,,]};return mt(o=n[3],u),c=new Ql({}),{c(){V(e.$$.fragment),l=y(),V(t.$$.fragment),i=y(),s=N("dialog"),u.block.c(),r=y(),a=N("dialog"),V(c.$$.fragment),this.h()},l(d){Z(e.$$.fragment,d),l=L(d),Z(t.$$.fragment,d),i=L(d),s=I(d,"DIALOG",{class:!0});var h=S(s);u.block.l(h),h.forEach(_),r=L(d),a=I(d,"DIALOG",{class:!0});var $=S(a);Z(c.$$.fragment,$),$.forEach(_),this.h()},h(){g(s,"class","technique-dialog"),g(a,"class","iframe-dialog")},m(d,h){A(e,d,h),O(d,l,h),A(t,d,h),O(d,i,h),O(d,s,h),u.block.m(s,u.anchor=null),u.mount=()=>s,u.anchor=null,n[9](s),O(d,r,h),O(d,a,h),A(c,a,null),n[11](a),p=!0,f||(m=[j(s,"close",n[10]),j(a,"close",n[12])],f=!0)},p(d,[h]){n=d;const $={};h&131072&&($.$$scope={dirty:h,ctx:n}),t.$set($),u.ctx=n,h&8&&o!==(o=n[3])&&mt(o,u)||Fl(u,n,h)},i(d){p||(b(e.$$.fragment,d),b(t.$$.fragment,d),b(u.block),b(c.$$.fragment,d),p=!0)},o(d){C(e.$$.fragment,d),C(t.$$.fragment,d);for(let h=0;h<3;h+=1){const $=u.blocks[h];C($)}C(c.$$.fragment,d),p=!1},d(d){d&&(_(l),_(i),_(s),_(r),_(a)),H(e,d),H(t,d),u.block.d(),u.token=null,u=null,n[9](null),H(c),n[11](null),f=!1,ge(m)}}}function os(n,e,l){let t,i;ve(n,Gl,v=>l(7,t=v)),ve(n,Q,v=>l(14,i=v));let{data:s}=e,o,r,a,c=null,p=!1;dl(()=>{if(window.location!==window.parent.location&&(p=!0),!p&&i.localStorageWarning&&a.showModal(),l(6,o=document.getElementsByTagName("body")[0]),t.url.searchParams.size){const v=t.url.searchParams.get("technique_id"),w=t.url.searchParams.get("technique_id");if(v&&(l(3,c=u(s.technique_id)),at(`/profile/?technique_id=${techniqueIdQueryParam}`)),w){const E=Wl.uncrush(s.profile),D=JSON.parse(E);te(Q,i=D,i)}}}),Kl(()=>{o?.classList.remove("scroll--none")});const f=v=>{const w=v.detail.element["@id"];if(!v.detail.event.ctrlKey&&!v.detail.event.metaKey){const E=v.detail.element["@id"];l(3,c=u(E)),at(`/profile/?technique_id=${E}`);return}je.selectTechnique(w)},m=v=>{v.close(),at("/profile/")},u=async v=>{const w=await fetch(`/api/technique/${v}.json`),E=await w.json();if(w.ok)return E;throw new Error(E)},d=()=>m(r);function h(v){Ne[v?"unshift":"push"](()=>{r=v,l(1,r)})}const $=()=>m(r);function P(v){Ne[v?"unshift":"push"](()=>{a=v,l(2,a)})}const T=()=>m(a);return n.$$set=v=>{"data"in v&&l(0,s=v.data)},n.$$.update=()=>{n.$$.dirty&194&&(r&&t.url.searchParams.get("technique_id")?(r.showModal(),o?.classList.add("scroll--none")):r&&(r.close(),o?.classList.remove("scroll--none")))},[s,r,a,c,f,m,o,t,d,h,$,P,T]}class Ms extends ce{constructor(e){super(),fe(this,e,os,ss,ae,{data:0})}}export{Ms as component};
