import{s as Ze,M as Te,e as i,b as E,t as ie,d as r,v as le,j as w,f as b,i as c,h as re,w as a,k as ve,l as t,p as me,a4 as xe,V as Ue,m as qe,y as et,o as Je,r as _e,K as lt,E as Qe,q as ot}from"../chunks/scheduler.BPS8Q4IK.js";import{S as tt,i as nt,f as Ve,c as De,b as Ie,m as Ne,t as Pe,a as ke,d as $e}from"../chunks/index.RHoRrSTo.js";import{p as it}from"../chunks/stores.CeDY58-m.js";import{T as rt}from"../chunks/Title.COl1UWhB.js";import{b as ct}from"../chunks/entry.DY9xS5Q0.js";import{S as We}from"../chunks/SimpleAutocomplete.fP67AFST.js";import{l as oe}from"../chunks/layers.BEw10rv0.js";import{t as dt}from"../chunks/updateDefendTree.BuI9vq1U.js";/* empty css                             */import{J as ut,L as mt,s as ft}from"../chunks/dialog.DoVWTud0.js";function pt(e){var Ke;let f,m="Settings",n,d,g,O="Profile",S,p,U,h,N,K="Matrix Overlay",F,C,V,W,_,T,k,I,o,y,s,M="Matrix Readonly",H,z,$,A,ee,fe,L,be="Show Side Capabilities",ce,Z,P,q,de,j,R,B="Show Legend",pe,X,te,Ce,l,v,Y=(e[3].containerSize*100).toFixed(0)+"",Q,ge,Ee,J,ne,ae="60",we,x,Se,se,He="100",ue,ze,je;function at(u){e[10](u)}let Be={inputClassName:"autocomplete-cursor-select",items:(Ke=e[3])==null?void 0:Ke.profiles,readonly:!0,labelFieldName:"name",onChange:e[9]};e[2]!==void 0&&(Be.selectedItem=e[2]),p=new We({props:Be}),Te.push(()=>Ve(p,"selectedItem",at));function st(u){e[12](u)}let Ge={inputClassName:"autocomplete-cursor-select",items:Object.values(e[4]),labelFieldName:"name",readonly:!0,onChange:e[11]};return e[1]!==void 0&&(Ge.selectedItem=e[1]),C=new We({props:Ge}),Te.push(()=>Ve(C,"selectedItem",st)),{c(){f=i("h3"),f.textContent=m,n=E(),d=i("article"),g=i("div"),g.textContent=O,S=E(),De(p.$$.fragment),h=E(),N=i("div"),N.textContent=K,F=E(),De(C.$$.fragment),W=E(),_=i("section"),T=i("article"),k=i("form"),I=i("input"),y=E(),s=i("span"),s.textContent=M,H=E(),z=i("article"),$=i("form"),A=i("input"),fe=E(),L=i("span"),L.textContent=be,ce=E(),Z=i("article"),P=i("form"),q=i("input"),j=E(),R=i("span"),R.textContent=B,pe=E(),X=i("article"),te=i("div"),Ce=ie("Container Scale"),l=i("span"),v=ie("("),Q=ie(Y),ge=ie(")"),Ee=E(),J=i("div"),ne=i("span"),ne.textContent=ae,we=E(),x=i("input"),Se=E(),se=i("span"),se.textContent=He,this.h()},l(u){f=r(u,"H3",{class:!0,"data-svelte-h":!0}),le(f)!=="svelte-ihiao5"&&(f.textContent=m),n=w(u),d=r(u,"ARTICLE",{class:!0});var D=b(d);g=r(D,"DIV",{class:!0,"data-svelte-h":!0}),le(g)!=="svelte-nczzpi"&&(g.textContent=O),S=w(D),Ie(p.$$.fragment,D),h=w(D),N=r(D,"DIV",{class:!0,"data-svelte-h":!0}),le(N)!=="svelte-czypmm"&&(N.textContent=K),F=w(D),Ie(C.$$.fragment,D),D.forEach(c),W=w(u),_=r(u,"SECTION",{class:!0});var G=b(_);T=r(G,"ARTICLE",{class:!0});var Me=b(T);k=r(Me,"FORM",{class:!0});var he=b(k);I=r(he,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),y=w(he),s=r(he,"SPAN",{class:!0,"data-svelte-h":!0}),le(s)!=="svelte-1saz4fh"&&(s.textContent=M),he.forEach(c),Me.forEach(c),H=w(G),z=r(G,"ARTICLE",{class:!0});var Xe=b(z);$=r(Xe,"FORM",{class:!0});var Le=b($);A=r(Le,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),fe=w(Le),L=r(Le,"SPAN",{class:!0,"data-svelte-h":!0}),le(L)!=="svelte-lt3qpu"&&(L.textContent=be),Le.forEach(c),Xe.forEach(c),ce=w(G),Z=r(G,"ARTICLE",{class:!0});var Ye=b(Z);P=r(Ye,"FORM",{class:!0});var Oe=b(P);q=r(Oe,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),j=w(Oe),R=r(Oe,"SPAN",{class:!0,"data-svelte-h":!0}),le(R)!=="svelte-1kzsxpu"&&(R.textContent=B),Oe.forEach(c),Ye.forEach(c),pe=w(G),X=r(G,"ARTICLE",{class:!0});var Fe=b(X);te=r(Fe,"DIV",{class:!0});var Ae=b(te);Ce=re(Ae,"Container Scale"),l=r(Ae,"SPAN",{});var Re=b(l);v=re(Re,"("),Q=re(Re,Y),ge=re(Re,")"),Re.forEach(c),Ae.forEach(c),Ee=w(Fe),J=r(Fe,"DIV",{class:!0});var ye=b(J);ne=r(ye,"SPAN",{"data-svelte-h":!0}),le(ne)!=="svelte-nt3n7g"&&(ne.textContent=ae),we=w(ye),x=r(ye,"INPUT",{type:!0,min:!0,max:!0,class:!0,id:!0}),Se=w(ye),se=r(ye,"SPAN",{"data-svelte-h":!0}),le(se)!=="svelte-rbuf0z"&&(se.textContent=He),ye.forEach(c),Fe.forEach(c),G.forEach(c),this.h()},h(){a(f,"class","text-center"),a(g,"class","select-name svelte-1d9uoe9"),a(N,"class","select-name svelte-1d9uoe9"),a(d,"class","select-setting svelte-1d9uoe9"),a(I,"class","check-box"),a(I,"type","checkbox"),a(I,"name","readonly"),I.checked=o=e[3].isReadonly,a(I,"tabindex","0"),a(s,"class","layer-text"),a(k,"class","svelte-1d9uoe9"),a(T,"class","setting"),a(A,"class","check-box"),a(A,"type","checkbox"),a(A,"name","drawer open"),A.checked=ee=e[3].isDrawerOpen,a(A,"tabindex","0"),a(L,"class","layer-text"),a($,"class","svelte-1d9uoe9"),a(z,"class","setting"),a(q,"class","check-box"),a(q,"type","checkbox"),a(q,"name","show legend"),q.checked=de=e[3].showLegend,a(q,"tabindex","0"),a(R,"class","layer-text"),a(P,"class","svelte-1d9uoe9"),a(Z,"class","setting"),a(te,"class","select-name svelte-1d9uoe9"),a(x,"type","range"),a(x,"min","60"),a(x,"max","99"),x.value="80",a(x,"class","slider"),a(x,"id","myRange"),a(J,"class","size-slider svelte-1d9uoe9"),a(X,"class","setting"),a(_,"class","setting-checks-container svelte-1d9uoe9")},m(u,D){ve(u,f,D),ve(u,n,D),ve(u,d,D),t(d,g),t(d,S),Ne(p,d,null),t(d,h),t(d,N),t(d,F),Ne(C,d,null),ve(u,W,D),ve(u,_,D),t(_,T),t(T,k),t(k,I),t(k,y),t(k,s),t(_,H),t(_,z),t(z,$),t($,A),t($,fe),t($,L),t(_,ce),t(_,Z),t(Z,P),t(P,q),t(P,j),t(P,R),t(_,pe),t(_,X),t(X,te),t(te,Ce),t(te,l),t(l,v),t(l,Q),t(l,ge),t(X,Ee),t(X,J),t(J,ne),t(J,we),t(J,x),e[16](x),t(J,Se),t(J,se),ue=!0,ze||(je=[me(I,"click",xe(e[13])),me(A,"click",xe(e[14])),me(q,"click",xe(e[15])),me(x,"input",e[8])],ze=!0)},p(u,[D]){var he;const G={};D&8&&(G.items=(he=u[3])==null?void 0:he.profiles),!U&&D&4&&(U=!0,G.selectedItem=u[2],Ue(()=>U=!1)),p.$set(G);const Me={};!V&&D&2&&(V=!0,Me.selectedItem=u[1],Ue(()=>V=!1)),C.$set(Me),(!ue||D&8&&o!==(o=u[3].isReadonly))&&(I.checked=o),(!ue||D&8&&ee!==(ee=u[3].isDrawerOpen))&&(A.checked=ee),(!ue||D&8&&de!==(de=u[3].showLegend))&&(q.checked=de),(!ue||D&8)&&Y!==(Y=(u[3].containerSize*100).toFixed(0)+"")&&qe(Q,Y)},i(u){ue||(Pe(p.$$.fragment,u),Pe(C.$$.fragment,u),ue=!0)},o(u){ke(p.$$.fragment,u),ke(C.$$.fragment,u),ue=!1},d(u){u&&(c(f),c(n),c(d),c(W),c(_)),$e(p),$e(C),e[16](null),ze=!1,et(je)}}}function gt(e,f,m){var I;let n;Je(e,oe,o=>m(3,n=o));let d=null;const g={multiColor:{name:"multiColor",showLegend:!0},heatMap:{name:"heatMap",showLegend:!1}};let O=g[n==null?void 0:n.techniqueMappingMode]||null,S=((I=n==null?void 0:n.profiles)==null?void 0:I[n==null?void 0:n.selectedProfile])||null;const p=o=>{_e(oe,n[o]=!n[o],n)},U=o=>{var y;if(o){const s=n.profiles.findIndex(({id:M})=>M===o.id);_e(oe,n.selectedProfile=s,n),m(2,S=((y=n==null?void 0:n.profiles)==null?void 0:y[s])||null),dt.reset()}else _e(oe,n.selectedProfile=null,n),m(2,S=o)},h=o=>{if(typeof o=="string")m(1,O=o);else if(o&&o.name){const{name:y="none",showLegend:s}=o;m(1,O=o),_e(oe,n.techniqueMappingMode=y,n),_e(oe,n.showLegend=s,n)}},N=o=>{_e(oe,n.containerSize=o.target.value/100,n)},K=o=>U(o);function F(o){S=o,m(2,S)}const C=o=>h(o);function V(o){O=o,m(1,O)}const W=()=>p("isReadonly"),_=()=>p("isDrawerOpen"),T=()=>p("showLegend");function k(o){Te[o?"unshift":"push"](()=>{d=o,m(0,d)})}return[d,O,S,n,g,p,U,h,N,K,F,C,V,W,_,T,k]}class ht extends tt{constructor(f){super(),nt(this,f,gt,pt,Ze,{})}}const _t=({size:e,domain:f},m="<embed-data>")=>`
<script>
  let iframe = null;

  const user_data = ${JSON.stringify(m,null,2)};

  const post_layers = (event) => {
    if (event.data?.call === "FromParent") {
      iframe.contentWindow.postMessage(
        {
          call: "toParent",
          value: user_data,
        },
        event.origin
      );
    }
  };
  <\/script>

  <svelte:window on:message={post_layers} />

  <main>
    <iframe
      id="iframe"
      bind:this={iframe}
      src="${f}/profile/"
      title="D3FEND Embedded" />
  </main>

  <style>
    #iframe {
      display: block;
      margin: 0 auto;
      width: 100%;
      height: 100vh;
      transform: scale(${e});
      -moz-transform: scale(${e});
      -o-transform: scale(${e});
      -webkit-transform: scale(${e});
    }
  </style>
  `,vt=({size:e,domain:f},m="<embed-data>")=>`
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>D3FEND EMBEDDED</title>

  <script>
    const user_data = ${JSON.stringify(m,null,2)};

    const post_layers = (event) => {
      const iframe = document.getElementById("iframe");

      if (event.data?.call === "FromParent") {
        iframe.contentWindow.postMessage(
          {
            call: "toParent",
            value: user_data,
          },
          event.origin
        );
      }
    };

    window.addEventListener("message", (event) => {

      if (event.origin !== "${f}") return;

      post_layers(event);
    });
  <\/script>

  <style>
    #iframe {
      display: block;
      margin: 0 auto;
      width: 100%;
      height: 100vh;
      transform: scale(${e});
      -moz-transform: scale(${e});
      -o-transform: scale(${e});
      -webkit-transform: scale(${e});
    }
  </style>
</head>

<main>
  <iframe
          id="iframe"
          src="${f}/profile/"
          title="D3FEND Embedded" />
</main>

</html>
`,bt=({domain:e,data:f})=>{const m=JSON.stringify(f),n=ut.crush(m),d=encodeURIComponent(n);return`${e}/profile/?profile=${d}`};function Ct(e){let f,m,n,d,g=`<h1 class="svelte-a38n6n"><span class="fancy-font">D3FEND</span> Embeddable Widget</h1> <h6 class="svelte-a38n6n">Use the D3FEND Embeddable Widget to embed an interactive D3FEND Profile in
      another webpage.</h6>`,O,S,p,U,h,N,K,F,C,V,W,_,T,k=e[3].func({size:e[0].containerSize,domain:e[4],data:e[0]})+"",I,o,y,s,M=e[3].text+"",H,z,$,A,ee,fe,L,be,ce,Z,P,q,de,j,R,B,pe,X;f=new rt({props:{title:"Embedded D3FEND Matrix",og_title:"MITRE Embedded D3FEND Layers",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Capability Layers Analysis."}}),p=new ht({});function te(l){e[13](l)}let Ce={inputClassName:"autocomplete-cursor-select",items:Object.values(e[5]),labelFieldName:"name",readonly:!0,onChange:e[12]};return e[3]!==void 0&&(Ce.selectedItem=e[3]),C=new We({props:Ce}),Te.push(()=>Ve(C,"selectedItem",te)),R=new mt({}),{c(){De(f.$$.fragment),m=E(),n=i("main"),d=i("section"),d.innerHTML=g,O=E(),S=i("code"),De(p.$$.fragment),U=E(),h=i("code"),N=i("h3"),K=ie(`Embed Code

      `),F=i("span"),De(C.$$.fragment),W=E(),_=i("div"),T=i("pre"),I=ie(k),o=E(),y=i("div"),s=i("div"),H=ie(M),z=E(),$=i("button"),A=ie("Download"),fe=E(),L=i("button"),be=ie("Copy to Clipboard"),Z=E(),P=i("iframe"),de=E(),j=i("dialog"),De(R.$$.fragment),this.h()},l(l){Ie(f.$$.fragment,l),m=w(l),n=r(l,"MAIN",{style:!0,class:!0});var v=b(n);d=r(v,"SECTION",{id:!0,class:!0,"data-svelte-h":!0}),le(d)!=="svelte-1maub7"&&(d.innerHTML=g),O=w(v),S=r(v,"CODE",{id:!0,class:!0});var Y=b(S);Ie(p.$$.fragment,Y),Y.forEach(c),U=w(v),h=r(v,"CODE",{id:!0,class:!0});var Q=b(h);N=r(Q,"H3",{class:!0});var ge=b(N);K=re(ge,`Embed Code

      `),F=r(ge,"SPAN",{id:!0,class:!0});var Ee=b(F);Ie(C.$$.fragment,Ee),Ee.forEach(c),ge.forEach(c),W=w(Q),_=r(Q,"DIV",{id:!0,class:!0});var J=b(_);T=r(J,"PRE",{class:!0});var ne=b(T);I=re(ne,k),ne.forEach(c),J.forEach(c),o=w(Q),y=r(Q,"DIV",{id:!0,class:!0});var ae=b(y);s=r(ae,"DIV",{});var we=b(s);H=re(we,M),we.forEach(c),z=w(ae),$=r(ae,"BUTTON",{class:!0});var x=b($);A=re(x,"Download"),x.forEach(c),fe=w(ae),L=r(ae,"BUTTON",{class:!0});var Se=b(L);be=re(Se,"Copy to Clipboard"),Se.forEach(c),ae.forEach(c),Q.forEach(c),Z=w(v),P=r(v,"IFRAME",{id:!0,src:!0,title:!0,class:!0}),b(P).forEach(c),de=w(v),j=r(v,"DIALOG",{class:!0});var se=b(j);Ie(R.$$.fragment,se),se.forEach(c),v.forEach(c),this.h()},h(){a(d,"id","header"),a(d,"class","svelte-a38n6n"),a(S,"id","embed-settings"),a(S,"class","svelte-a38n6n"),a(F,"id","download-options"),a(F,"class","svelte-a38n6n"),a(N,"class","svelte-a38n6n"),a(T,"class","svelte-a38n6n"),a(_,"id","code-container"),a(_,"class","svelte-a38n6n"),a($,"class","download-code svelte-a38n6n"),$.disabled=ee=e[3].name==="Config Settings",a(L,"class","download-code svelte-a38n6n"),L.disabled=ce=e[3].name==="Config Settings",a(y,"id","download-container"),a(y,"class","svelte-a38n6n"),a(h,"id","embed-code"),a(h,"class","config-container svelte-a38n6n"),a(P,"id","layers-iframe"),lt(P.src,q="/profile/")||a(P,"src",q),a(P,"title","D3FEND Embedded"),a(P,"class","svelte-a38n6n"),a(j,"class","iframe-dialog"),Qe(n,"--container-size",e[0].containerSize),a(n,"class","svelte-a38n6n")},m(l,v){Ne(f,l,v),ve(l,m,v),ve(l,n,v),t(n,d),t(n,O),t(n,S),Ne(p,S,null),t(n,U),t(n,h),t(h,N),t(N,K),t(N,F),Ne(C,F,null),t(h,W),t(h,_),t(_,T),t(T,I),t(h,o),t(h,y),t(y,s),t(s,H),t(y,z),t(y,$),t($,A),t(y,fe),t(y,L),t(L,be),t(n,Z),t(n,P),e[16](P),t(n,de),t(n,j),Ne(R,j,null),e[17](j),B=!0,pe||(X=[me(window,"message",e[6]),me($,"click",e[14]),me(L,"click",e[15]),me(j,"close",e[18])],pe=!0)},p(l,[v]){const Y={};!V&&v&8&&(V=!0,Y.selectedItem=l[3],Ue(()=>V=!1)),C.$set(Y),(!B||v&25)&&k!==(k=l[3].func({size:l[0].containerSize,domain:l[4],data:l[0]})+"")&&qe(I,k),(!B||v&8)&&M!==(M=l[3].text+"")&&qe(H,M),(!B||v&8&&ee!==(ee=l[3].name==="Config Settings"))&&($.disabled=ee),(!B||v&8&&ce!==(ce=l[3].name==="Config Settings"))&&(L.disabled=ce),(!B||v&1)&&Qe(n,"--container-size",l[0].containerSize)},i(l){B||(Pe(f.$$.fragment,l),Pe(p.$$.fragment,l),Pe(C.$$.fragment,l),Pe(R.$$.fragment,l),B=!0)},o(l){ke(f.$$.fragment,l),ke(p.$$.fragment,l),ke(C.$$.fragment,l),ke(R.$$.fragment,l),B=!1},d(l){l&&(c(m),c(n)),$e(f,l),$e(p),$e(C),e[16](null),$e(R),e[17](null),pe=!1,et(X)}}}function Et(e,f,m){let n,d,g,O;Je(e,oe,s=>m(0,g=s)),Je(e,it,s=>m(11,O=s));let S=null,p=null;const U={"Config Settings":{name:"Config Settings",text:"Profile Config Settings",func:()=>d},"index.html":{name:"index.html",download:"index.html",text:"Complete HTML/Javascript runnable script",func:vt},"Svelte Compenent":{name:"Svelte Compenent",download:"D3fendProfile.svelte",text:"Composable Svelte Compoenent runnable in Svelte Application",func:_t},"Profile data":{name:"Profile data",text:"Export Profile Data",func:()=>JSON.stringify(g,null,2).trim()},"Profile URL":{name:"Profile URL",text:"URL to D3FEND Custom Profile",func:bt}};let h=U["Config Settings"];ot(()=>{g.localStorageWarning&&p.showModal()}),ct(()=>{_e(oe,g.isReadonly=!1,g)});const N=s=>{var M;((M=s.data)==null?void 0:M.call)==="FromParent"&&S.contentWindow.postMessage({call:"toParent",value:g},s.origin)},K=s=>{s&&s.text&&m(3,h=s)},F=async(s,{func:M,download:H})=>{const z=M({size:g.containerSize,domain:n},g);ft(z,H)},C=async(s,{func:M})=>{const H=M({size:g.containerSize,domain:n},g);try{await navigator.clipboard.writeText(H)}catch(z){console.error("Failed to copy: ",z)}},V=s=>{s.close()},W=s=>K(s);function _(s){h=s,m(3,h)}const T=s=>F(s,h),k=s=>C(s,h);function I(s){Te[s?"unshift":"push"](()=>{S=s,m(1,S)})}function o(s){Te[s?"unshift":"push"](()=>{p=s,m(2,p)})}const y=()=>V(p);return e.$$.update=()=>{e.$$.dirty&2048&&m(4,n=O.url.origin),e.$$.dirty&1&&(d=JSON.stringify(g,["isReadonly","isDrawerOpen","showLegend","techniqueMappingMode","selectedProfile","matrixSize","containerSize"],2).trim())},[g,S,p,h,n,U,N,K,F,C,V,O,W,_,T,k,I,o,y]}class Mt extends tt{constructor(f){super(),nt(this,f,Et,Ct,Ze,{})}}export{Mt as component};
