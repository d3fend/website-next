import{s as pe,p as ke,k as I,i as _,o as ne,am as on,c as He,e as y,b as A,d as w,f as E,j as S,r as g,F as se,D as ve,l as $,u as Re,g as Fe,a as Be,a0 as Pe,L as We,an as sn,t as fe,h as ue,Z as Mt,P as W,m as Me,x as Te,S as Pt,ak as an,ao as xe,v as we,J as De,n as G,V as yt,O as Z,y as cn,w as Ve,N as ze,ap as mt,aq as Kl,E as Jl,a4 as Qe,W as fn,al as nt,Y as Wl,a3 as wt,ar as un}from"../chunks/scheduler.xR-uXgLO.js";import{h as ht,u as $t}from"../chunks/await_block.CzfUJDHk.js";import{S as ge,i as be,t as b,g as ie,a as C,e as re,p as Se,c as V,b as F,m as j,d as H,h as Xe,j as Tt,f as Et}from"../chunks/index.BpaDVXPB.js";import{w as Ne,d as dn}from"../chunks/index.iaz6iIjv.js";import{p as mn}from"../chunks/stores.CJvb1AwE.js";import{g as dt,b as hn}from"../chunks/entry.L0ZC9Jhl.js";import{J as pn}from"../chunks/JSONCrush.BlUS0oeb.js";import{D as _n}from"../chunks/D3FMatrix.DJDJGZIW.js";import{T as gn}from"../chunks/Title.lz_tL8Gl.js";import{R as bn,T as vn}from"../chunks/Technique.DysRw_2w.js";import{s as $n,L as kn}from"../chunks/dialog.BCRB1U6H.js";import{l as _e,T as Dt,M as ce,s as Cn,j as yn,S as he,P as Ye}from"../chunks/layers.DpT2z-xz.js";import{s as Ze,a as Oe,f as it}from"../chunks/index.BxqCZUUx.js";import{e as qe}from"../chunks/each.BfH-wj2E.js";import{f as Je,a as qt,b as wn,c as At,m as Tn}from"../chunks/utils.xEKteSAW.js";import{S as Zl}from"../chunks/SimpleAutocomplete.De_s21ke.js";import{I as te,c as En,f as Yl}from"../chunks/Loading.BOvGI8JW.js";import{c as St}from"../chunks/lib.CK1iMZjQ.js";/* empty css                             */import{t as Ke,T as In}from"../chunks/updateDefendTree.YJzIXIzN.js";import{c as Nn,o as Mn,s as Pn}from"../chunks/TreeTable.rb9EVKji.js";import"../chunks/marked.esm.D23x4JZT.js";import"../chunks/Button.9UMRg2GD.js";/* empty css                                                    *//* empty css                                                      */import"../chunks/index.g5YcAAdQ.js";import"../chunks/config.Cv25jCO5.js";import"../chunks/jsonld.CYnguqZs.js";const Ot=(n,e=[])=>{let l=()=>{};for(let{query:t,transition:i,...r}of e)if(window.matchMedia(t).matches)return i(n,r);return l},Dn=n=>({}),Lt=n=>({}),qn=n=>({}),zt=n=>({}),An=n=>({}),Vt=n=>({}),Sn=n=>({}),jt=n=>({id:"matrix-slot"}),On=n=>({}),Ht=n=>({id:"drawer-content"});function Rt(n){let e,l,t,i,r,o,s,a=n[0].isDrawerOpen&&Ft(n);const c=n[3].matrix,f=He(c,n,n[2],jt),u=n[3].legend,d=He(u,n,n[2],Vt),m=n[3].matrixControls,h=He(m,n,n[2],zt),p=n[3].sideToggle,k=He(p,n,n[2],Lt);return{c(){e=y("main"),a&&a.c(),l=A(),t=y("section"),f&&f.c(),i=A(),d&&d.c(),r=A(),h&&h.c(),o=A(),k&&k.c(),this.h()},l(v){e=w(v,"MAIN",{style:!0,class:!0});var M=E(e);a&&a.l(M),l=S(M),t=w(M,"SECTION",{id:!0,class:!0});var P=E(t);f&&f.l(P),i=S(P),d&&d.l(P),r=S(P),h&&h.l(P),o=S(P),k&&k.l(P),P.forEach(_),M.forEach(_),this.h()},h(){g(t,"id","container-matrix"),g(t,"class","svelte-mlvs39"),se(t,"expand-matrix",n[0].isDrawerOpen),ve(e,"--drawer-width",zn),ve(e,"--ANIMATION_TIMING",lt),g(e,"class","svelte-mlvs39")},m(v,M){I(v,e,M),a&&a.m(e,null),$(e,l),$(e,t),f&&f.m(t,null),$(t,i),d&&d.m(t,null),$(t,r),h&&h.m(t,null),$(t,o),k&&k.m(t,null),s=!0},p(v,M){v[0].isDrawerOpen?a?(a.p(v,M),M&1&&b(a,1)):(a=Ft(v),a.c(),b(a,1),a.m(e,l)):a&&(ie(),C(a,1,1,()=>{a=null}),re()),f&&f.p&&(!s||M&4)&&Re(f,c,v,v[2],s?Be(c,v[2],M,Sn):Fe(v[2]),jt),d&&d.p&&(!s||M&4)&&Re(d,u,v,v[2],s?Be(u,v[2],M,An):Fe(v[2]),Vt),h&&h.p&&(!s||M&4)&&Re(h,m,v,v[2],s?Be(m,v[2],M,qn):Fe(v[2]),zt),k&&k.p&&(!s||M&4)&&Re(k,p,v,v[2],s?Be(p,v[2],M,Dn):Fe(v[2]),Lt),(!s||M&1)&&se(t,"expand-matrix",v[0].isDrawerOpen)},i(v){s||(b(a),b(f,v),b(d,v),b(h,v),b(k,v),s=!0)},o(v){C(a),C(f,v),C(d,v),C(h,v),C(k,v),s=!1},d(v){v&&_(e),a&&a.d(),f&&f.d(v),d&&d.d(v),h&&h.d(v),k&&k.d(v)}}}function Ft(n){let e,l,t;const i=n[3].drawer,r=He(i,n,n[2],Ht);return{c(){e=y("aside"),r&&r.c(),this.h()},l(o){e=w(o,"ASIDE",{id:!0,class:!0});var s=E(e);r&&r.l(s),s.forEach(_),this.h()},h(){g(e,"id","container-drawer"),g(e,"class","svelte-mlvs39"),se(e,"drawer-closed",!n[0].isDrawerOpen)},m(o,s){I(o,e,s),r&&r.m(e,null),t=!0},p(o,s){n=o,r&&r.p&&(!t||s&4)&&Re(r,i,n,n[2],t?Be(i,n[2],s,On):Fe(n[2]),Ht),(!t||s&1)&&se(e,"drawer-closed",!n[0].isDrawerOpen)},i(o){t||(b(r,o),o&&Pe(()=>{t&&(l||(l=Se(e,Ot,[{query:"(min-width: 501px)",transition:Ze,duration:lt,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:Ze,duration:lt,axis:"y"}],!0)),l.run(1))}),t=!0)},o(o){C(r,o),o&&(l||(l=Se(e,Ot,[{query:"(min-width: 501px)",transition:Ze,duration:lt,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:Ze,duration:lt,axis:"y"}],!1)),l.run(0)),t=!1},d(o){o&&_(e),r&&r.d(o),o&&l&&l.end()}}}function Ln(n){let e,l,t=n[0]&&Rt(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[0]?t?(t.p(i,r),r&1&&b(t,1)):(t=Rt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}const Ae=28,pt=33,lt=1e3,zn="25vw";function Vn(n,e,l){let t;ne(n,_e,s=>l(0,t=s));let{$$slots:i={},$$scope:r}=e,{profileConfig:o}=e;return on("profile-config",o),n.$$set=s=>{"profileConfig"in s&&l(1,o=s.profileConfig),"$$scope"in s&&l(2,r=s.$$scope)},[t,o,r,i]}class jn extends ge{constructor(e){super(),be(this,e,Vn,Ln,pe,{profileConfig:1})}}function Bt(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Ut(n,e,l){const t=n.slice();return t[10]=e[l],t}const Hn=n=>({}),Gt=n=>({});function Kt(n){let e,l;const t=n[6].header,i=He(t,n,n[5],Gt);return{c(){e=y("div"),i&&i.c(),this.h()},l(r){e=w(r,"DIV",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","header"),g(e,"class","svelte-zl7ap5")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,o){i&&i.p&&(!l||o&32)&&Re(i,t,r,r[5],l?Be(t,r[5],o,Hn):Fe(r[5]),Gt)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function Jt(n){let e,l,t=n[10].label+"",i,r,o,s,a;function c(...u){return n[7](n[10],...u)}function f(...u){return n[8](n[10],...u)}return{c(){e=y("li"),l=y("span"),i=fe(t),r=A(),this.h()},l(u){e=w(u,"LI",{class:!0});var d=E(e);l=w(d,"SPAN",{role:!0,tabindex:!0,class:!0});var m=E(l);i=ue(m,t),m.forEach(_),r=S(d),d.forEach(_),this.h()},h(){g(l,"role","menuitem"),g(l,"tabindex","0"),g(l,"class","svelte-zl7ap5"),g(e,"class",o=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")},m(u,d){I(u,e,d),$(e,l),$(l,i),$(e,r),s||(a=[W(l,"click",c),W(l,"keydown",f)],s=!0)},p(u,d){n=u,d&1&&t!==(t=n[10].label+"")&&Me(i,t),d&3&&o!==(o=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")&&g(e,"class",o)},d(u){u&&_(e),s=!1,Te(a)}}}function Wt(n){let e,l,t,i,r,o,s;var a=n[10].component;function c(f,u){return{props:{component:f[0][f[12]],containerHeight:f[3]}}}return a&&(l=Pt(a,c(n))),{c(){e=y("div"),l&&V(l.$$.fragment),t=A(),this.h()},l(f){e=w(f,"DIV",{class:!0});var u=E(e);l&&F(l.$$.fragment,u),t=S(u),u.forEach(_),this.h()},h(){g(e,"class","tab svelte-zl7ap5"),Pe(()=>n[9].call(e))},m(f,u){I(f,e,u),l&&j(l,e,null),$(e,t),i=an(e,n[9].bind(e)),s=!0},p(f,u){if(u&1&&a!==(a=f[10].component)){if(l){ie();const d=l;C(d.$$.fragment,1,0,()=>{H(d,1)}),re()}a?(l=Pt(a,c(f)),V(l.$$.fragment),b(l.$$.fragment,1),j(l,e,t)):l=null}else if(a){const d={};u&1&&(d.component=f[0][f[12]]),u&8&&(d.containerHeight=f[3]),l.$set(d)}},i(f){s||(l&&b(l.$$.fragment,f),f&&Pe(()=>{s&&(o&&o.end(1),r=Xe(e,Oe,{duration:400,delay:400}),r.start())}),s=!0)},o(f){l&&C(l.$$.fragment,f),r&&r.invalidate(),f&&(o=Tt(e,Oe,{duration:400})),s=!1},d(f){f&&_(e),l&&H(l),i(),f&&o&&o.end()}}}function Zt(n){let e,l,t=n[1]===n[10].value&&Wt(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,r){i[1]===i[10].value?t?(t.p(i,r),r&3&&b(t,1)):(t=Wt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Rn(n){let e,l,t,i,r,o=n[4].header&&Kt(n),s=qe(n[0]),a=[];for(let d=0;d<s.length;d+=1)a[d]=Jt(Ut(n,s,d));let c=qe(n[0]),f=[];for(let d=0;d<c.length;d+=1)f[d]=Zt(Bt(n,c,d));const u=d=>C(f[d],1,1,()=>{f[d]=null});return{c(){e=y("section"),o&&o.c(),l=A(),t=y("ul");for(let d=0;d<a.length;d+=1)a[d].c();i=A();for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){e=w(d,"SECTION",{id:!0,class:!0});var m=E(e);o&&o.l(m),l=S(m),t=w(m,"UL",{class:!0});var h=E(t);for(let p=0;p<a.length;p+=1)a[p].l(h);h.forEach(_),i=S(m);for(let p=0;p<f.length;p+=1)f[p].l(m);m.forEach(_),this.h()},h(){g(t,"class","svelte-zl7ap5"),g(e,"id","tabs--container"),g(e,"class","svelte-zl7ap5")},m(d,m){I(d,e,m),o&&o.m(e,null),$(e,l),$(e,t);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(t,null);$(e,i);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(e,null);r=!0},p(d,[m]){if(d[4].header?o?(o.p(d,m),m&16&&b(o,1)):(o=Kt(d),o.c(),b(o,1),o.m(e,l)):o&&(ie(),C(o,1,1,()=>{o=null}),re()),m&7){s=qe(d[0]);let h;for(h=0;h<s.length;h+=1){const p=Ut(d,s,h);a[h]?a[h].p(p,m):(a[h]=Jt(p),a[h].c(),a[h].m(t,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=s.length}if(m&11){c=qe(d[0]);let h;for(h=0;h<c.length;h+=1){const p=Bt(d,c,h);f[h]?(f[h].p(p,m),b(f[h],1)):(f[h]=Zt(p),f[h].c(),b(f[h],1),f[h].m(e,null))}for(ie(),h=c.length;h<f.length;h+=1)u(h);re()}},i(d){if(!r){b(o);for(let m=0;m<c.length;m+=1)b(f[m]);r=!0}},o(d){C(o),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)C(f[m]);r=!1},d(d){d&&_(e),o&&o.d(),We(a,d),We(f,d)}}}function Fn(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=sn(t);let{tabs:o=[]}=e,{activeTabValue:s}=e,{clickTab:a}=e,c;const f=(m,h)=>a(h,m.value),u=(m,h)=>Je(h,a,m.value);function d(){c=this.clientHeight,l(3,c)}return n.$$set=m=>{"tabs"in m&&l(0,o=m.tabs),"activeTabValue"in m&&l(1,s=m.activeTabValue),"clickTab"in m&&l(2,a=m.clickTab),"$$scope"in m&&l(5,i=m.$$scope)},[o,s,a,c,r,i,t,f,u,d]}class Ql extends ge{constructor(e){super(),be(this,e,Fn,Rn,pe,{tabs:0,activeTabValue:1,clickTab:2})}}function Yt(n,e,l){const t=n.slice();return t[34]=e[l],t}function Bn(n){return{c:G,l:G,m:G,p:G,i:G,o:G,d:G}}function Un(n){let e,l,t,i,r,o;function s(d){n[21](d)}let a={items:Object.values(n[37]),labelFunction:n[19],keywordsFunction:n[20],placeholder:"ATT&CK Lookup"};n[4]!==void 0&&(a.selectedItem=n[4]),l=new Zl({props:a}),De.push(()=>Et(l,"selectedItem",s));function c(d,m){return d[4]?Gn:Kn}let f=c(n),u=f(n);return{c(){e=y("span"),V(l.$$.fragment),i=A(),u.c(),r=ke(),this.h()},l(d){e=w(d,"SPAN",{id:!0});var m=E(e);F(l.$$.fragment,m),m.forEach(_),i=S(d),u.l(d),r=ke(),this.h()},h(){g(e,"id","offensive")},m(d,m){I(d,e,m),j(l,e,null),I(d,i,m),u.m(d,m),I(d,r,m),o=!0},p(d,m){const h={};!t&&m[0]&16&&(t=!0,h.selectedItem=d[4],yt(()=>t=!1)),l.$set(h),f===(f=c(d))&&u?u.p(d,m):(u.d(1),u=f(d),u&&(u.c(),u.m(r.parentNode,r)))},i(d){o||(b(l.$$.fragment,d),o=!0)},o(d){C(l.$$.fragment,d),o=!1},d(d){d&&(_(e),_(i),_(r)),H(l),u.d(d)}}}function Gn(n){let e,l,t="Justification:",i,r,o,s,a="save",c,f;return{c(){e=y("div"),l=y("label"),l.textContent=t,i=A(),r=y("input"),o=A(),s=y("button"),s.textContent=a,this.h()},l(u){e=w(u,"DIV",{});var d=E(e);l=w(d,"LABEL",{for:!0,"data-svelte-h":!0}),we(l)!=="svelte-u8h1xa"&&(l.textContent=t),i=S(d),r=w(d,"INPUT",{id:!0,type:!0}),o=S(d),s=w(d,"BUTTON",{"data-svelte-h":!0}),we(s)!=="svelte-4u68nx"&&(s.textContent=a),d.forEach(_),this.h()},h(){g(l,"for","attack--justification"),g(r,"id","attack--justification"),g(r,"type","text")},m(u,d){I(u,e,d),$(e,l),$(e,i),$(e,r),n[22](r),$(e,o),$(e,s),c||(f=W(s,"click",n[14]),c=!0)},p:G,d(u){u&&_(e),n[22](null),c=!1,f()}}}function Kn(n){let e,l="<i>Select ATT&amp;CK Technique to associate to Layer</i>";return{c(){e=y("span"),e.innerHTML=l},l(t){e=w(t,"SPAN",{"data-svelte-h":!0}),we(e)!=="svelte-1d39b1v"&&(e.innerHTML=l)},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function Jn(n){let e;return{c(){e=fe("...loading")},l(l){e=ue(l,"...loading")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function Qt(n){let e,l,t,i='<th class="svelte-pjnk5u">ID</th> <th class="svelte-pjnk5u">Tactic</th> <th class="svelte-pjnk5u">Technique</th> <th class="svelte-pjnk5u">SubTechnique</th> <th class="svelte-pjnk5u">Justification</th> <th class="svelte-pjnk5u"></th>',r,o,s,a=qe(n[2]),c=[];for(let u=0;u<a.length;u+=1)c[u]=Xt(Yt(n,a,u));const f=u=>C(c[u],1,1,()=>{c[u]=null});return{c(){e=y("section"),l=y("table"),t=y("thead"),t.innerHTML=i,r=A(),o=y("tbody");for(let u=0;u<c.length;u+=1)c[u].c();this.h()},l(u){e=w(u,"SECTION",{});var d=E(e);l=w(d,"TABLE",{class:!0});var m=E(l);t=w(m,"THEAD",{"data-svelte-h":!0}),we(t)!=="svelte-1rtdzpr"&&(t.innerHTML=i),r=S(m),o=w(m,"TBODY",{});var h=E(o);for(let p=0;p<c.length;p+=1)c[p].l(h);h.forEach(_),m.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u")},m(u,d){I(u,e,d),$(e,l),$(l,t),$(l,r),$(l,o);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(o,null);s=!0},p(u,d){if(d[0]&32772){a=qe(u[2]);let m;for(m=0;m<a.length;m+=1){const h=Yt(u,a,m);c[m]?(c[m].p(h,d),b(c[m],1)):(c[m]=Xt(h),c[m].c(),b(c[m],1),c[m].m(o,null))}for(ie(),m=a.length;m<c.length;m+=1)f(m);re()}},i(u){if(!s){for(let d=0;d<a.length;d+=1)b(c[d]);s=!0}},o(u){c=c.filter(Boolean);for(let d=0;d<c.length;d+=1)C(c[d]);s=!1},d(u){u&&_(e),We(c,u)}}}function Xt(n){let e,l,t=n[34].id.replace("d3f:","")+"",i,r,o,s=n[34].tactic+"",a,c,f,u=n[34].technique+"",d,m,h,p=(n[34].subTechnique||"")+"",k,v,M,P=(n[34].justification||"")+"",z,D,T,q,O,L,Y,de;return q=new te({props:{size:33,iconName:"edit",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),q.$on("iconClick",n[23]),L=new te({props:{size:33,iconName:"delete",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),L.$on("iconClick",n[24]),{c(){e=y("tr"),l=y("td"),i=fe(t),r=A(),o=y("td"),a=fe(s),c=A(),f=y("td"),d=fe(u),m=A(),h=y("td"),k=fe(p),v=A(),M=y("td"),z=fe(P),D=A(),T=y("td"),V(q.$$.fragment),O=A(),V(L.$$.fragment),Y=A(),this.h()},l(le){e=w(le,"TR",{});var x=E(e);l=w(x,"TD",{class:!0});var ee=E(l);i=ue(ee,t),ee.forEach(_),r=S(x),o=w(x,"TD",{class:!0});var Ie=E(o);a=ue(Ie,s),Ie.forEach(_),c=S(x),f=w(x,"TD",{class:!0});var me=E(f);d=ue(me,u),me.forEach(_),m=S(x),h=w(x,"TD",{class:!0});var U=E(h);k=ue(U,p),U.forEach(_),v=S(x),M=w(x,"TD",{class:!0});var J=E(M);z=ue(J,P),J.forEach(_),D=S(x),T=w(x,"TD",{class:!0});var K=E(T);F(q.$$.fragment,K),O=S(K),F(L.$$.fragment,K),K.forEach(_),Y=S(x),x.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u"),g(o,"class","svelte-pjnk5u"),g(f,"class","svelte-pjnk5u"),g(h,"class","svelte-pjnk5u"),g(M,"class","svelte-pjnk5u"),g(T,"class","table--no--border svelte-pjnk5u")},m(le,x){I(le,e,x),$(e,l),$(l,i),$(e,r),$(e,o),$(o,a),$(e,c),$(e,f),$(f,d),$(e,m),$(e,h),$(h,k),$(e,v),$(e,M),$(M,z),$(e,D),$(e,T),j(q,T,null),$(T,O),j(L,T,null),$(e,Y),de=!0},p(le,x){(!de||x[0]&4)&&t!==(t=le[34].id.replace("d3f:","")+"")&&Me(i,t),(!de||x[0]&4)&&s!==(s=le[34].tactic+"")&&Me(a,s),(!de||x[0]&4)&&u!==(u=le[34].technique+"")&&Me(d,u),(!de||x[0]&4)&&p!==(p=(le[34].subTechnique||"")+"")&&Me(k,p),(!de||x[0]&4)&&P!==(P=(le[34].justification||"")+"")&&Me(z,P)},i(le){de||(b(q.$$.fragment,le),b(L.$$.fragment,le),de=!0)},o(le){C(q.$$.fragment,le),C(L.$$.fragment,le),de=!1},d(le){le&&_(e),H(q),H(L)}}}function Wn(n){let e,l="Something Went Wrong";return{c(){e=y("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-14i7fbl"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Zn(n){let e,l,t,i,r;const o=[Qn,Yn],s=[];function a(c,f){return f[0]&64&&(e=null),e==null&&(e=Object.values(c[6]).length>0),e?0:1}return l=a(n,[-1,-1]),t=s[l]=o[l](n),{c(){t.c(),i=ke()},l(c){t.l(c),i=ke()},m(c,f){s[l].m(c,f),I(c,i,f),r=!0},p(c,f){let u=l;l=a(c,f),l===u?s[l].p(c,f):(ie(),C(s[u],1,1,()=>{s[u]=null}),re(),t=s[l],t?t.p(c,f):(t=s[l]=o[l](c),t.c()),b(t,1),t.m(i.parentNode,i))},i(c){r||(b(t),r=!0)},o(c){C(t),r=!1},d(c){c&&_(i),s[l].d(c)}}}function Yn(n){let e,l="No Associated ATT&CK Techniques...";return{c(){e=y("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-1l1k2ul"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Qn(n){let e,l;return e=new bn({props:{related_matrix:n[6],d_digital_artifacts:n[1].digital_artifacts,d_technique:n[3],d3fend_layer_color:n[8],additional_techniques:n[7]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&64&&(r.related_matrix=t[6]),i[0]&2&&(r.d_digital_artifacts=t[1].digital_artifacts),i[0]&8&&(r.d_technique=t[3]),i[0]&256&&(r.d3fend_layer_color=t[8]),i[0]&128&&(r.additional_techniques=t[7]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Xn(n){let e,l="loading...";return{c(){e=y("p"),e.textContent=l},l(t){e=w(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-qeejp2"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function xn(n){let e,l,t,i,r,o={ctx:n,current:null,token:null,hasCatch:!1,pending:Jn,then:Un,catch:Bn,value:37,blocks:[,,,]};ht(n[13],o);let s=n[2].length>0&&Qt(n),a={ctx:n,current:null,token:null,hasCatch:!0,pending:Xn,then:Zn,catch:Wn,value:32,error:33,blocks:[,,,]};return ht(n[12],a),{c(){e=y("main"),l=y("section"),o.block.c(),t=A(),s&&s.c(),i=A(),a.block.c(),this.h()},l(c){e=w(c,"MAIN",{style:!0,class:!0});var f=E(e);l=w(f,"SECTION",{id:!0,class:!0});var u=E(l);o.block.l(u),u.forEach(_),t=S(f),s&&s.l(f),i=S(f),a.block.l(f),f.forEach(_),this.h()},h(){g(l,"id","attack--input"),g(l,"class","svelte-pjnk5u"),ve(e,"--container-height",n[0]+"px"),g(e,"class","svelte-pjnk5u")},m(c,f){I(c,e,f),$(e,l),o.block.m(l,o.anchor=null),o.mount=()=>l,o.anchor=null,$(e,t),s&&s.m(e,null),$(e,i),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null,r=!0},p(c,f){n=c,$t(o,n,f),n[2].length>0?s?(s.p(n,f),f[0]&4&&b(s,1)):(s=Qt(n),s.c(),b(s,1),s.m(e,i)):s&&(ie(),C(s,1,1,()=>{s=null}),re()),$t(a,n,f),(!r||f[0]&1)&&ve(e,"--container-height",n[0]+"px")},i(c){r||(b(o.block),b(s),b(a.block),r=!0)},o(c){for(let f=0;f<3;f+=1){const u=o.blocks[f];C(u)}C(s);for(let f=0;f<3;f+=1){const u=a.blocks[f];C(u)}r=!1},d(c){c&&_(e),o.block.d(),o.token=null,o=null,s&&s.d(),a.block.d(),a.token=null,a=null}}}function ei(n,e,l){let t,i,r,o,s,a,c;ne(n,_e,U=>l(18,c=U));let{containerHeight:f}=e;const{selectedD3fendId:u,selectedLayerId:d,selectedLayerColor:m}=xe("profile-config");ne(n,u,U=>l(3,o=U)),ne(n,d,U=>l(17,s=U)),ne(n,m,U=>l(8,a=U));let h,p,k,v,M=qt(`/api/technique/${o}.json`).then(U=>l(1,h=U)),P=qt("/api/offensive-technique/heirarchy.json").then(U=>(l(16,p=U["@graph"].reduce((J,K)=>(K!=null&&K["d3f:attack-id"]&&(J[K["@id"]]=K),J),{})),p));const z=(U,J)=>U&&J?U.map(({id:K,justification:Q,tactic:oe})=>({...O(J[K]),tactic:oe,justification:Q,id:K})):[],D=U=>U.reduce((J,{tactic:K,technique:Q,subTechnique:oe,id:B})=>(oe&&(J[oe]={tactic:K,name:oe,color:a,id:B}),J[Q]={name:Q,color:a,id:B},J),{}),T=(U,J)=>U?J.length===0?U:J.reduce((Q,{tactic:oe,technique:B,subTechnique:N,id:R})=>{const ae={off_tech_label:{type:"literal",value:B},off_tech_id:{type:"literal",value:R}},Ee=N?[ae,{off_tech_label:{type:"literal",value:N},off_tech_id:{type:"literal",value:R}}]:[ae];if(Q[oe]){const $e=Q[oe].findIndex(Ue=>Ue[0]===B);$e!==-1?(Q[oe][$e][1].push(ae),N&&Q[oe][$e][1].push(Ee[1])):Q[oe].push([B,Ee])}else Q[oe]=[[B,Ee]];return Q},{...U}):[],q=U=>U.replace("d3f:","").split(/(?=[A-Z])/).slice(0,-1).join(" "),O=(U,J={})=>{const K=U==null?void 0:U["rdfs:subClassOf"];return Object.values(J).length===0&&(J.id=U["@id"],J.subTechnique=U["rdfs:label"]),U.hasOwnProperty("d3f:attack-id")||(Array.isArray(U)?J.tactic=U.map(Q=>q(Q["@id"])):J.tactic=[q(U["@id"])]),typeof K=="object"||Array.isArray(K)?(J.technique=U["rdfs:label"],{...J,...O(K,J)}):J},L=U=>{const J=v.value,K=s,Q=o,oe=O(p[k["@id"]]);oe.technique===oe.subTechnique&&(oe.subTechnique=null),oe.tactic.reduce((N,R)=>(N.push({...oe,tactic:R,justification:J}),N),[]).forEach(N=>{const R={id:N.id,justification:N.justification,tactic:N.tactic};_e.addUserAssociatedAttack(K,Q,R)})},Y=U=>{},de=U=>{if(U!=null)return U["d3f:attack-id"]+" - "+St(U)},le=U=>U["d3f:attack-id"]+" - "+St(U);function x(U){k=U,l(4,k)}function ee(U){De[U?"unshift":"push"](()=>{v=U,l(5,v)})}const Ie=U=>Y(),me=U=>Y();return n.$$set=U=>{"containerHeight"in U&&l(0,f=U.containerHeight)},n.$$.update=()=>{var U,J;n.$$.dirty[0]&458760&&l(2,t=z((J=(U=c.attack)==null?void 0:U[s])==null?void 0:J[o],p)),n.$$.dirty[0]&4&&l(7,i=D(t)),n.$$.dirty[0]&6&&l(6,r=T(h==null?void 0:h.related_offensive_matrix,t))},[f,h,t,o,k,v,r,i,a,u,d,m,M,P,L,Y,p,s,c,de,le,x,ee,Ie,me]}class ti extends ge{constructor(e){super(),be(this,e,ei,xn,pe,{containerHeight:0},null,[-1,-1])}}function li(n){let e,l="D3FEND Layer Mapper";return{c(){e=y("h2"),e.textContent=l,this.h()},l(t){e=w(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-lb758t"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function ni(n){let e,l,t,i,r;return l=new Ql({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[li]},$$scope:{ctx:n}}}),{c(){e=y("section"),V(l.$$.fragment),this.h()},l(o){e=w(o,"SECTION",{class:!0});var s=E(e);F(l.$$.fragment,s),s.forEach(_),this.h()},h(){g(e,"class","svelte-1ymr2vu")},m(o,s){I(o,e,s),j(l,e,null),r=!0},p(o,[s]){const a={};s&1&&(a.tabs=o[0]),s&2&&(a.activeTabValue=o[1]),s&16&&(a.$$scope={dirty:s,ctx:o}),l.$set(a)},i(o){r||(b(l.$$.fragment,o),o&&Pe(()=>{r&&(i&&i.end(1),t=Xe(e,Oe,{delay:400}),t.start())}),r=!0)},o(o){C(l.$$.fragment,o),t&&t.invalidate(),o&&(i=Tt(e,Oe,{duration:100})),r=!1},d(o){o&&_(e),H(l),o&&i&&i.end()}}}function ii(n,e,l){let t,i;const r=Ne(Dt.attack);ne(n,r,s=>l(1,i=s));const o=(s,a)=>{Z(r,i=a,i)};return l(0,t=[{label:"ATT&CK",value:Dt.attack,component:ti}]),[t,i,r,o]}class ri extends ge{constructor(e){super(),be(this,e,ii,ni,pe,{})}}function oi(n){let e,l,t,i;const r=n[1].default,o=He(r,n,n[0],null);return{c(){e=y("h2"),o&&o.c(),l=A(),t=y("hr"),this.h()},l(s){e=w(s,"H2",{class:!0});var a=E(e);o&&o.l(a),a.forEach(_),l=S(s),t=w(s,"HR",{class:!0}),this.h()},h(){g(e,"class","text-center svelte-1j2cwkl"),g(t,"class","svelte-1j2cwkl")},m(s,a){I(s,e,a),o&&o.m(e,null),I(s,l,a),I(s,t,a),i=!0},p(s,[a]){o&&o.p&&(!i||a&1)&&Re(o,r,s,s[0],i?Be(r,s[0],a,null):Fe(s[0]),null)},i(s){i||(b(o,s),i=!0)},o(s){C(o,s),i=!1},d(s){s&&(_(e),_(l),_(t)),o&&o.d(s)}}}function si(n,e,l){let{$$slots:t={},$$scope:i}=e;return n.$$set=r=>{"$$scope"in r&&l(0,i=r.$$scope)},[i,t]}class ai extends ge{constructor(e){super(),be(this,e,si,oi,pe,{})}}const ci=n=>({}),xt=n=>({}),fi=n=>({}),el=n=>({});function ui(n){let e,l,t,i,r,o,s,a,c;const f=n[5].submit,u=He(f,n,n[4],el),d=n[5].cancel,m=He(d,n,n[4],xt);return{c(){e=y("hr"),l=A(),t=y("section"),i=y("button"),u&&u.c(),r=A(),o=y("button"),m&&m.c(),this.h()},l(h){e=w(h,"HR",{class:!0}),l=S(h),t=w(h,"SECTION",{id:!0,class:!0});var p=E(t);i=w(p,"BUTTON",{});var k=E(i);u&&u.l(k),k.forEach(_),r=S(p),o=w(p,"BUTTON",{});var v=E(o);m&&m.l(v),v.forEach(_),p.forEach(_),this.h()},h(){g(e,"class","svelte-7f2jjs"),g(t,"id","btns"),g(t,"class","svelte-7f2jjs")},m(h,p){I(h,e,p),I(h,l,p),I(h,t,p),$(t,i),u&&u.m(i,null),$(t,r),$(t,o),m&&m.m(o,null),s=!0,a||(c=[W(i,"click",n[6]),W(o,"click",function(){cn(n[2])&&n[2].apply(this,arguments)})],a=!0)},p(h,[p]){n=h,u&&u.p&&(!s||p&16)&&Re(u,f,n,n[4],s?Be(f,n[4],p,fi):Fe(n[4]),el),m&&m.p&&(!s||p&16)&&Re(m,d,n,n[4],s?Be(d,n[4],p,ci):Fe(n[4]),xt)},i(h){s||(b(u,h),b(m,h),s=!0)},o(h){C(u,h),C(m,h),s=!1},d(h){h&&(_(e),_(l),_(t)),u&&u.d(h),m&&m.d(h),a=!1,Te(c)}}}function di(n,e,l){let t,i=G,r=()=>(i(),i=Ve(a,d=>l(3,t=d)),a);n.$$.on_destroy.push(()=>i());let{$$slots:o={},$$scope:s}=e,{item:a}=e;r();let{handleOnSubmit:c}=e,{handleCloseModal:f}=e;const u=()=>c(t);return n.$$set=d=>{"item"in d&&r(l(0,a=d.item)),"handleOnSubmit"in d&&l(1,c=d.handleOnSubmit),"handleCloseModal"in d&&l(2,f=d.handleCloseModal),"$$scope"in d&&l(4,s=d.$$scope)},[a,c,f,t,s,o,u]}class mi extends ge{constructor(e){super(),be(this,e,di,ui,pe,{item:0,handleOnSubmit:1,handleCloseModal:2})}}function tl(n,e,l){const t=n.slice();return t[3]=e[l],t}function ll(n){let e,l=n[3].name+"",t,i;return{c(){e=y("option"),t=fe(l),this.h()},l(r){e=w(r,"OPTION",{});var o=E(e);t=ue(o,l),o.forEach(_),this.h()},h(){e.__value=i=n[3],ze(e,e.__value)},m(r,o){I(r,e,o),$(e,t)},p(r,o){o&2&&l!==(l=r[3].name+"")&&Me(t,l),o&2&&i!==(i=r[3])&&(e.__value=i,ze(e,e.__value))},d(r){r&&_(e)}}}function hi(n){let e,l,t="NAME",i,r,o,s,a=`Select Capability from Templates...
      `,c,f,u,d=n[0].name+"",m,h,p,k,v=qe(n[1]),M=[];for(let P=0;P<v.length;P+=1)M[P]=ll(tl(n,v,P));return{c(){e=y("div"),l=y("label"),l.textContent=t,i=A(),r=y("div"),o=y("select"),s=y("option"),s.textContent=a;for(let P=0;P<M.length;P+=1)M[P].c();c=A(),f=y("p"),u=fe("The Template Capability ("),m=fe(d),h=fe(`) will incorporate all
    child Capabilities and associated Techniques.`),this.h()},l(P){e=w(P,"DIV",{id:!0,class:!0});var z=E(e);l=w(z,"LABEL",{"aria-label":!0,for:!0,"data-svelte-h":!0}),we(l)!=="svelte-l4gr53"&&(l.textContent=t),i=S(z),r=w(z,"DIV",{id:!0});var D=E(r);o=w(D,"SELECT",{id:!0,class:!0});var T=E(o);s=w(T,"OPTION",{"data-svelte-h":!0}),we(s)!=="svelte-1t4hjue"&&(s.textContent=a);for(let O=0;O<M.length;O+=1)M[O].l(T);T.forEach(_),D.forEach(_),c=S(z),f=w(z,"P",{class:!0});var q=E(f);u=ue(q,"The Template Capability ("),m=ue(q,d),h=ue(q,`) will incorporate all
    child Capabilities and associated Techniques.`),q.forEach(_),z.forEach(_),this.h()},h(){g(l,"aria-label","Capability Name"),g(l,"for","capability-name"),s.selected=!0,s.disabled=!0,s.__value="",ze(s,s.__value),g(o,"id","capability--select"),o.required=!0,g(o,"class","svelte-3hjn8y"),n[0]===void 0&&Pe(()=>n[2].call(o)),g(r,"id","autocomplete"),g(f,"class","form-info"),se(f,"non--existing",n[0]),g(e,"id","layer-input-form"),g(e,"class","svelte-3hjn8y")},m(P,z){I(P,e,z),$(e,l),$(e,i),$(e,r),$(r,o),$(o,s);for(let D=0;D<M.length;D+=1)M[D]&&M[D].m(o,null);mt(o,n[0],!0),$(e,c),$(e,f),$(f,u),$(f,m),$(f,h),p||(k=W(o,"change",n[2]),p=!0)},p(P,[z]){if(z&2){v=qe(P[1]);let D;for(D=0;D<v.length;D+=1){const T=tl(P,v,D);M[D]?M[D].p(T,z):(M[D]=ll(T),M[D].c(),M[D].m(o,null))}for(;D<M.length;D+=1)M[D].d(1);M.length=v.length}z&3&&mt(o,P[0]),z&1&&d!==(d=P[0].name+"")&&Me(m,d),z&1&&se(f,"non--existing",P[0])},i:G,o:G,d(P){P&&_(e),We(M,P),p=!1,k()}}}function pi(n,e,l){let{selectedCapability:t=null}=e,{capabilities:i}=e;function r(){t=Kl(this),l(0,t),l(1,i)}return n.$$set=o=>{"selectedCapability"in o&&l(0,t=o.selectedCapability),"capabilities"in o&&l(1,i=o.capabilities)},[t,i,r]}class _i extends ge{constructor(e){super(),be(this,e,pi,hi,pe,{selectedCapability:0,capabilities:1})}}function gi(n){let e,l,t,i,r,o,s,a,c,f,u,d,m,h,p;return{c(){e=y("div"),l=y("form"),t=y("label"),i=y("p"),r=fe(n[1]),o=A(),s=y("input"),a=A(),c=y("label"),f=y("p"),u=fe(n[2]),d=A(),m=y("textarea"),this.h()},l(k){e=w(k,"DIV",{id:!0,class:!0});var v=E(e);l=w(v,"FORM",{class:!0,autocomplete:!0});var M=E(l);t=w(M,"LABEL",{"aria-label":!0,for:!0});var P=E(t);i=w(P,"P",{});var z=E(i);r=ue(z,n[1]),z.forEach(_),P.forEach(_),o=S(M),s=w(M,"INPUT",{id:!0,type:!0,name:!0,class:!0,"aria-describedby":!0,oninvalid:!0}),a=S(M),c=w(M,"LABEL",{"aria-label":!0,for:!0});var D=E(c);f=w(D,"P",{});var T=E(f);u=ue(T,n[2]),T.forEach(_),D.forEach(_),d=S(M),m=w(M,"TEXTAREA",{id:!0,name:!0,class:!0}),E(m).forEach(_),M.forEach(_),v.forEach(_),this.h()},h(){g(t,"aria-label","layer name"),g(t,"for","layer-name"),g(s,"id","layer-name"),g(s,"type","text"),g(s,"name","Layer"),g(s,"class","layer-input svelte-s0zavs"),s.required=!0,g(s,"aria-describedby","layername-error"),g(s,"oninvalid",n[5]("This field is required.")),g(c,"aria-label","layer description"),g(c,"for","layer-description"),g(m,"id","layer-description"),g(m,"name","Description"),g(m,"class","layer-input svelte-s0zavs"),m.required=!0,g(l,"class","layer-input-form svelte-s0zavs"),g(l,"autocomplete","off"),g(e,"id","container-layer-form"),g(e,"class","svelte-s0zavs")},m(k,v){I(k,e,v),$(e,l),$(l,t),$(t,i),$(i,r),$(l,o),$(l,s),ze(s,n[4].name),$(l,a),$(l,c),$(c,f),$(f,u),$(l,d),$(l,m),ze(m,n[4].description),n[9](l),h||(p=[W(s,"input",n[7]),W(m,"input",n[8])],h=!0)},p(k,[v]){v&2&&Me(r,k[1]),v&16&&s.value!==k[4].name&&ze(s,k[4].name),v&4&&Me(u,k[2]),v&16&&ze(m,k[4].description)},i:G,o:G,d(k){k&&_(e),n[9](null),h=!1,Te(p)}}}function bi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,p=>l(4,t=p)),o);n.$$.on_destroy.push(()=>i());let{item:o}=e;r();let{textInput:s}=e,{textArea:a}=e,{submit:c}=e,f;Jl(()=>{Z(o,t.name="",t),Z(o,t.description="",t)});const u=p=>p;function d(){t.name=this.value,o.set(t)}function m(){t.description=this.value,o.set(t)}function h(p){De[p?"unshift":"push"](()=>{f=p,l(3,f)})}return n.$$set=p=>{"item"in p&&r(l(0,o=p.item)),"textInput"in p&&l(1,s=p.textInput),"textArea"in p&&l(2,a=p.textArea),"submit"in p&&l(6,c=p.submit)},[o,s,a,f,t,u,c,d,m,h]}class vi extends ge{constructor(e){super(),be(this,e,bi,gi,pe,{item:0,textInput:1,textArea:2,submit:6})}}const $i=n=>({}),nl=n=>({M:n[1],item:n[0]});function ki(n){let e,l;const t=n[3].default,i=He(t,n,n[2],nl);return{c(){e=y("section"),i&&i.c(),this.h()},l(r){e=w(r,"SECTION",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","dialog--container"),g(e,"class","svelte-1jrgukv")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,[o]){i&&i.p&&(!l||o&4)&&Re(i,t,r,r[2],l?Be(t,r[2],o,$i):Fe(r[2]),nl)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function Ci(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=Ne({}),o={Title:ai,Buttons:mi,Select:_i,Create:vi};return n.$$set=s=>{"$$scope"in s&&l(2,i=s.$$scope)},[r,o,i,t]}class It extends ge{constructor(e){super(),be(this,e,Ci,ki,pe,{})}}function il(n){let e,l,t,i,r,o,s,a;e=new te({props:{size:33,iconName:"create profile",description:"Create Profile",title:"Create Profile"}}),e.$on("iconClick",n[9]),t=new te({props:{size:33,iconName:"delete",description:"Delete Profile",title:"Delete Profile"}}),t.$on("iconClick",n[10]);let c=n[3]&&rl(n);return{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),r=y("dialog"),c&&c.c(),this.h()},l(f){F(e.$$.fragment,f),l=S(f),F(t.$$.fragment,f),i=S(f),r=w(f,"DIALOG",{});var u=E(r);c&&c.l(u),u.forEach(_),this.h()},h(){r.open=n[3]},m(f,u){j(e,f,u),I(f,l,u),j(t,f,u),I(f,i,u),I(f,r,u),c&&c.m(r,null),n[12](r),o=!0,s||(a=W(r,"close",n[13]),s=!0)},p(f,u){f[3]?c?(c.p(f,u),u&8&&b(c,1)):(c=rl(f),c.c(),b(c,1),c.m(r,null)):c&&(ie(),C(c,1,1,()=>{c=null}),re()),(!o||u&8)&&(r.open=f[3])},i(f){o||(b(e.$$.fragment,f),b(t.$$.fragment,f),b(c),o=!0)},o(f){C(e.$$.fragment,f),C(t.$$.fragment,f),C(c),o=!1},d(f){f&&(_(l),_(i),_(r)),H(e,f),H(t,f),c&&c.d(),n[12](null),s=!1,a()}}}function rl(n){let e,l;return e=new It({props:{$$slots:{default:[Ei,({M:t,item:i})=>({15:t,16:i}),({M:t,item:i})=>(t?32768:0)|(i?65536:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&196612&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function yi(n){let e;return{c(){e=fe("Create New Profile")},l(l){e=ue(l,"Create New Profile")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function wi(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ti(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ei(n){let e,l,t,i,r,o;return e=new n[15].Title({props:{$$slots:{default:[yi]},$$scope:{ctx:n}}}),t=new n[15].Create({props:{item:n[16],textInput:"Name",textArea:"Description"}}),r=new n[15].Buttons({props:{item:n[16],handleCloseModal:n[8],handleOnSubmit:n[11],$$slots:{cancel:[Ti],submit:[wi]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=S(s),F(t.$$.fragment,s),i=S(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a&131072&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a&65536&&(f.item=s[16]),t.$set(f);const u={};a&65536&&(u.item=s[16]),a&4&&(u.handleOnSubmit=s[11]),a&131072&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function Ii(n){let e,l,t=!n[4].isReadonly&&il(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[4].isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(i,r),r&16&&b(t,1)):(t=il(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Ni(n,e,l){let t,i=G,r=()=>(i(),i=Ve(c,T=>l(4,t=T)),c),o,s=G,a=()=>(s(),s=Ve(f,T=>l(14,o=T)),f);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>s());let{store:c}=e;r();let{selectedProfile:f}=e;a();let u,d=!1;const m=()=>{l(3,d=!0),u.showModal()},h=T=>{confirm("Deleting Profile will delete all associated Capabilities.")&&(c.deleteProfile(),Z(f,o=t.profiles[t.selectedProfile]||{name:""},o))},p=({name:T,description:q},O)=>{c.createProfile({name:T,description:q}),Z(f,o=t.profiles[t.selectedProfile]||null,o),O.close()},k=()=>{l(3,d=!1),u.close()},v=T=>m(),M=T=>h(),P=T=>p(T,u);function z(T){De[T?"unshift":"push"](()=>{u=T,l(2,u)})}const D=()=>l(3,d=!1);return n.$$set=T=>{"store"in T&&r(l(0,c=T.store)),"selectedProfile"in T&&a(l(1,f=T.selectedProfile))},[c,f,u,d,t,m,h,p,k,v,M,P,z,D]}class Mi extends ge{constructor(e){super(),be(this,e,Ni,Ii,pe,{store:0,selectedProfile:1})}}function Pi(n){var o;let e,l,t;function i(s){n[6](s)}let r={inputClassName:"autocomplete-cursor-select",items:(o=n[2])==null?void 0:o.profiles,readonly:!1,labelFieldName:"name",onChange:n[5]};return n[3]!==void 0&&(r.selectedItem=n[3]),e=new Zl({props:r}),De.push(()=>Et(e,"selectedItem",i)),{c(){V(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,a){j(e,s,a),t=!0},p(s,[a]){var f;const c={};a&4&&(c.items=(f=s[2])==null?void 0:f.profiles),!l&&a&8&&(l=!0,c.selectedItem=s[3],yt(()=>l=!1)),e.$set(c)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function Di(n,e,l){let t,i=G,r=()=>(i(),i=Ve(c,h=>l(2,t=h)),c),o,s=G,a=()=>(s(),s=Ve(f,h=>l(3,o=h)),f);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>s());let{store:c}=e;r();let{selectedProfile:f}=e;a();const u=h=>{var p;if(h){const k=t==null?void 0:t.profiles.findIndex(({id:v})=>v===h.id);Z(c,t.selectedProfile=k,t),Z(f,o=((p=t==null?void 0:t.profiles)==null?void 0:p[k])||null,o),Ke.reset()}else Z(c,t.selectedProfile=null,t)},d=h=>u(h);function m(h){o=h,f.set(o)}return n.$$set=h=>{"store"in h&&r(l(0,c=h.store)),"selectedProfile"in h&&a(l(1,f=h.selectedProfile))},[c,f,t,o,u,d,m]}class qi extends ge{constructor(e){super(),be(this,e,Di,Pi,pe,{store:0,selectedProfile:1})}}const Ai=n=>({}),ol=n=>({}),Si=n=>({}),sl=n=>({});function al(n){let e,l,t,i,r,o,s,a,c;const f=n[6].popover,u=He(f,n,n[5],ol);return{c(){e=y("div"),l=y("div"),i=A(),r=y("div"),u&&u.c(),this.h()},l(d){e=w(d,"DIV",{class:!0,role:!0,tabindex:!0,"aria-describedby":!0,style:!0});var m=E(e);l=w(m,"DIV",{class:!0,tabindex:!0,role:!0}),E(l).forEach(_),i=S(m),r=w(m,"DIV",{class:!0});var h=E(r);u&&u.l(h),h.forEach(_),m.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-zv51ll"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-zv51ll"),g(e,"class","popover svelte-zv51ll"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-describedby","Comment"),ve(e,"--popover-top",`${n[2]}px`),ve(e,"--popover-left",`${n[3]}px`)},m(d,m){I(d,e,m),$(e,l),$(e,i),$(e,r),u&&u.m(r,null),s=!0,a||(c=[W(l,"click",Qe(n[11])),W(e,"click",Qe(n[7]))],a=!0)},p(d,m){u&&u.p&&(!s||m&32)&&Re(u,f,d,d[5],s?Be(f,d[5],m,Ai):Fe(d[5]),ol),(!s||m&4)&&ve(e,"--popover-top",`${d[2]}px`),(!s||m&8)&&ve(e,"--popover-left",`${d[3]}px`)},i(d){s||(d&&Pe(()=>{s&&(t||(t=Se(l,Oe,{delay:25,duration:150},!0)),t.run(1))}),b(u,d),d&&Pe(()=>{s&&(o||(o=Se(e,Oe,{},!0)),o.run(1))}),s=!0)},o(d){d&&(t||(t=Se(l,Oe,{delay:25,duration:150},!1)),t.run(0)),C(u,d),d&&(o||(o=Se(e,Oe,{},!1)),o.run(0)),s=!1},d(d){d&&_(e),d&&t&&t.end(),u&&u.d(d),d&&o&&o.end(),a=!1,Te(c)}}}function Oi(n){let e,l,t,i,r,o;const s=n[6].popoverClick,a=He(s,n,n[5],sl);let c=n[1]&&al(n);return{c(){e=y("div"),a&&a.c(),l=A(),c&&c.c(),t=ke(),this.h()},l(f){e=w(f,"DIV",{role:!0,tabindex:!0});var u=E(e);a&&a.l(u),u.forEach(_),l=S(f),c&&c.l(f),t=ke(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(f,u){I(f,e,u),a&&a.m(e,null),n[10](e),I(f,l,u),c&&c.m(f,u),I(f,t,u),i=!0,r||(o=[W(window,"resize",n[8]),W(e,"click",n[9])],r=!0)},p(f,[u]){a&&a.p&&(!i||u&32)&&Re(a,s,f,f[5],i?Be(s,f[5],u,Si):Fe(f[5]),sl),f[1]?c?(c.p(f,u),u&2&&b(c,1)):(c=al(f),c.c(),b(c,1),c.m(t.parentNode,t)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){i||(b(a,f),b(c),i=!0)},o(f){C(a,f),C(c),i=!1},d(f){f&&(_(e),_(l),_(t)),a&&a.d(f),n[10](null),c&&c.d(f),r=!1,Te(o)}}}function Li(n,e,l){let{$$slots:t={},$$scope:i}=e,r=!1,o,s,a;const c=p=>setTimeout(()=>{l(2,{bottom:s,left:a}=(p==null?void 0:p.getBoundingClientRect())??{bottom:0,left:0},s,l(3,a))},1e3);function f(p){fn.call(this,n,p)}const u=p=>c(o),d=()=>l(1,r=!0);function m(p){De[p?"unshift":"push"](()=>{o=p,l(0,o)})}const h=()=>l(1,r=!1);return n.$$set=p=>{"$$scope"in p&&l(5,i=p.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&c(o)},[o,r,s,a,c,i,t,f,u,d,m,h]}class Xl extends ge{constructor(e){super(),be(this,e,Li,Oi,pe,{})}}function zi(n){let e,l;return e=new te({props:{size:30,iconName:"grid",description:"Select Visualization Mode",title:"Select Visualization Mode",slot:"popoverClick"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Vi(n){let e,l,t,i,r,o="Root Colored",s,a,c,f,u,d="Multi-Colored",m,h,p,k,v,M="Heatmap",P,z,D;return t=new te({props:{size:30,iconName:ce.rootColor,description:"Root Colored",title:"Root Colored"}}),c=new te({props:{size:30,viewBox:32,iconName:ce.childrenMultiColor,description:"Children Multi-Color",title:"Children Multi-Color"}}),p=new te({props:{size:30,iconName:ce.heatMap,description:"Heatmap",title:"Heatmap"}}),{c(){e=y("div"),l=y("button"),V(t.$$.fragment),i=A(),r=y("span"),r.textContent=o,s=A(),a=y("button"),V(c.$$.fragment),f=A(),u=y("span"),u.textContent=d,m=A(),h=y("button"),V(p.$$.fragment),k=A(),v=y("span"),v.textContent=M,this.h()},l(T){e=w(T,"DIV",{id:!0,slot:!0,class:!0});var q=E(e);l=w(q,"BUTTON",{class:!0});var O=E(l);F(t.$$.fragment,O),i=S(O),r=w(O,"SPAN",{class:!0,"data-svelte-h":!0}),we(r)!=="svelte-1mm9720"&&(r.textContent=o),O.forEach(_),s=S(q),a=w(q,"BUTTON",{class:!0});var L=E(a);F(c.$$.fragment,L),f=S(L),u=w(L,"SPAN",{class:!0,"data-svelte-h":!0}),we(u)!=="svelte-17kog5w"&&(u.textContent=d),L.forEach(_),m=S(q),h=w(q,"BUTTON",{class:!0});var Y=E(h);F(p.$$.fragment,Y),k=S(Y),v=w(Y,"SPAN",{class:!0,"data-svelte-h":!0}),we(v)!=="svelte-1cpq3q6"&&(v.textContent=M),Y.forEach(_),q.forEach(_),this.h()},h(){g(r,"class","pop-text"),g(l,"class","row--mode btn svelte-1l620nw"),se(l,"selected-mode",n[1].techniqueMappingMode===ce.rootColor),g(u,"class","pop-text"),g(a,"class","row--mode btn svelte-1l620nw"),se(a,"selected-mode",n[1].techniqueMappingMode===ce.childrenMultiColor),g(v,"class","pop-text"),g(h,"class","row--mode btn svelte-1l620nw"),se(h,"selected-mode",n[1].techniqueMappingMode===ce.heatMap),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-1l620nw")},m(T,q){I(T,e,q),$(e,l),j(t,l,null),$(l,i),$(l,r),$(e,s),$(e,a),j(c,a,null),$(a,f),$(a,u),$(e,m),$(e,h),j(p,h,null),$(h,k),$(h,v),P=!0,z||(D=[W(l,"click",n[3]),W(a,"click",n[4]),W(h,"click",n[5])],z=!0)},p(T,q){(!P||q&2)&&se(l,"selected-mode",T[1].techniqueMappingMode===ce.rootColor),(!P||q&2)&&se(a,"selected-mode",T[1].techniqueMappingMode===ce.childrenMultiColor),(!P||q&2)&&se(h,"selected-mode",T[1].techniqueMappingMode===ce.heatMap)},i(T){P||(b(t.$$.fragment,T),b(c.$$.fragment,T),b(p.$$.fragment,T),P=!0)},o(T){C(t.$$.fragment,T),C(c.$$.fragment,T),C(p.$$.fragment,T),P=!1},d(T){T&&_(e),H(t),H(c),H(p),z=!1,Te(D)}}}function ji(n){let e,l,t;return l=new Xl({props:{$$slots:{popover:[Vi],popoverClick:[zi]},$$scope:{ctx:n}}}),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"id","layer-btns"),g(e,"class","svelte-1l620nw")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,[r]){const o={};r&66&&(o.$$scope={dirty:r,ctx:i}),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Hi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,u=>l(1,t=u)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();const s=u=>{Z(o,t.techniqueMappingMode=u,t)},a=()=>s(ce.rootColor),c=()=>s(ce.childrenMultiColor),f=()=>s(ce.heatMap);return n.$$set=u=>{"store"in u&&r(l(0,o=u.store))},[o,t,s,a,c,f]}class Ri extends ge{constructor(e){super(),be(this,e,Hi,ji,pe,{store:0})}}function cl(n){let e=n[3],l,t,i=fl(n);return{c(){i.c(),l=ke()},l(r){i.l(r),l=ke()},m(r,o){i.m(r,o),I(r,l,o),t=!0},p(r,o){o&8&&pe(e,e=r[3])?(ie(),C(i,1,1,G),re(),i=fl(r),i.c(),b(i,1),i.m(l.parentNode,l)):i.p(r,o)},i(r){t||(b(i),t=!0)},o(r){C(i),t=!1},d(r){r&&_(l),i.d(r)}}}function Fi(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){g(e,"type","file"),g(e,"id","file"),g(e,"name","file"),e.hidden=!0,g(e,"accept",".json")},m(i,r){I(i,e,r),n[8](e),l||(t=[W(e,"change",n[9]),W(e,"change",n[6])],l=!0)},p:G,d(i){i&&_(e),n[8](null),l=!1,Te(t)}}}function fl(n){let e,l,t,i;return e=new te({props:{size:33,iconName:"import",description:"Import Profile",title:"Import Profile",$$slots:{default:[Fi]},$$scope:{ctx:n}}}),e.$on("iconClick",n[5]),t=new te({props:{size:33,iconName:"export",description:"Export Profile",title:"Export Profile"}}),t.$on("iconClick",n[7]),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=S(r),F(t.$$.fragment,r)},m(r,o){j(e,r,o),I(r,l,o),j(t,r,o),i=!0},p(r,o){const s={};o&1030&&(s.$$scope={dirty:o,ctx:r}),e.$set(s)},i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),i=!1},d(r){r&&_(l),H(e,r),H(t,r)}}}function Bi(n){let e,l,t=!n[4].isReadonly&&cl(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[4].isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(i,r),r&16&&b(t,1)):(t=cl(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Ui(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,p=>l(4,t=p)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s,a,c=!1;const f=()=>{s.click()},u=async()=>{const p=await s.files[0];if(p)try{const k=Cn.parser(yn,{requireStringValidation:!1,mode:"lax",includeErrors:!0,allErrors:!0}),v=await p.text();let M=JSON.parse(v);(M==null?void 0:M.version)!=="1"&&(M=wn(M));const{valid:P,error:z,errors:D,value:T}=k(JSON.stringify(M));if(!P)throw new AggregateError([z,...D||[]],`Error Parsing Initial Profile Layer: ${z}`);o.set(T),alert("Profile imported Successfully")}catch(k){if(console.error(k),(k==null?void 0:k.errors)!==void 0)for(let v=0;v<k.errors.length;v++){const M=k.errors[v];console.error(M)}confirm("Error Importing/Parsing Profile. Check error logs.")}l(3,c=!c)},d=()=>{const p=JSON.stringify(t),k=new Blob([p],{type:"application/json;charset=utf-8"});$n(k,"d3fend-profile.json")};function m(p){De[p?"unshift":"push"](()=>{s=p,l(1,s)})}function h(){a=this.files,l(2,a)}return n.$$set=p=>{"store"in p&&r(l(0,o=p.store))},[o,s,a,c,t,f,u,d,m,h]}class Gi extends ge{constructor(e){super(),be(this,e,Ui,Bi,pe,{store:0})}}function Ki(n){let e,l,t,i,r,o,s;return{c(){e=y("div"),l=y("span"),t=fe(n[1]),i=A(),r=y("button"),this.h()},l(a){e=w(a,"DIV",{class:!0,style:!0});var c=E(e);l=w(c,"SPAN",{id:!0});var f=E(l);t=ue(f,n[1]),f.forEach(_),i=S(c),r=w(c,"BUTTON",{role:!0,"aria-checked":!0,"aria-labelledby":!0,class:!0});var u=E(r);u.forEach(_),c.forEach(_),this.h()},h(){g(l,"id","switch"),g(r,"role","switch"),g(r,"aria-checked",n[0]),g(r,"aria-labelledby","switch"),g(r,"class","svelte-115nhtf"),g(e,"class","s--slider svelte-115nhtf"),ve(e,"font-size",n[2]+"px")},m(a,c){I(a,e,c),$(e,l),$(l,t),$(e,i),$(e,r),o||(s=W(r,"click",n[3]),o=!0)},p(a,[c]){c&2&&Me(t,a[1]),c&1&&g(r,"aria-checked",a[0]),c&4&&ve(e,"font-size",a[2]+"px")},i:G,o:G,d(a){a&&_(e),o=!1,s()}}}function Ji(n,e,l){let{label:t}=e,{fontSize:i=16}=e,{value:r="on"}=e,{checked:o}=e,{clickHandler:s}=e;function a(c){const u=c.target.getAttribute("aria-checked");l(0,o=u!=="true"),l(4,r=o===!0?"off":"on"),s()}return n.$$set=c=>{"label"in c&&l(1,t=c.label),"fontSize"in c&&l(2,i=c.fontSize),"value"in c&&l(4,r=c.value),"checked"in c&&l(0,o=c.checked),"clickHandler"in c&&l(5,s=c.clickHandler)},[o,t,i,a,r,s]}class Wi extends ge{constructor(e){super(),be(this,e,Ji,Ki,pe,{label:1,fontSize:2,value:4,checked:0,clickHandler:5})}}function Zi(n){let e,l;return e=new te({props:{size:30,iconName:"filter",description:"Tree Control",title:"Tree Control",slot:"popoverClick"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Yi(n){let e,l,t,i,r,o,s,a,c,f="ATT&CK Associations",u,d,m;function h(k){n[5](k)}let p={label:"Mapping Mode",design:"slider",checked:n[2].associationMode,clickHandler:n[3]};return n[1]!==void 0&&(p.value=n[1]),t=new Wi({props:p}),De.push(()=>Et(t,"value",h)),s=new te({props:{size:30,iconName:"linking",description:"Associated ATT&CK Techniques",title:"Associated ATT&CK Techniques"}}),{c(){e=y("div"),l=y("div"),V(t.$$.fragment),r=A(),o=y("button"),V(s.$$.fragment),a=A(),c=y("span"),c.textContent=f,this.h()},l(k){e=w(k,"DIV",{id:!0,slot:!0,class:!0});var v=E(e);l=w(v,"DIV",{class:!0});var M=E(l);F(t.$$.fragment,M),M.forEach(_),r=S(v),o=w(v,"BUTTON",{class:!0});var P=E(o);F(s.$$.fragment,P),a=S(P),c=w(P,"SPAN",{class:!0,"data-svelte-h":!0}),we(c)!=="svelte-rreezx"&&(c.textContent=f),P.forEach(_),v.forEach(_),this.h()},h(){g(l,"class","row--mode toggle svelte-69rrcm"),g(c,"class","pop-text"),g(o,"class","row--mode btn svelte-69rrcm"),se(o,"selected-mode",n[2].techniqueMappingMode===ce["ATT&CK"]),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-69rrcm")},m(k,v){I(k,e,v),$(e,l),j(t,l,null),$(e,r),$(e,o),j(s,o,null),$(o,a),$(o,c),u=!0,d||(m=W(o,"click",n[6]),d=!0)},p(k,v){const M={};v&4&&(M.checked=k[2].associationMode),!i&&v&2&&(i=!0,M.value=k[1],yt(()=>i=!1)),t.$set(M),(!u||v&4)&&se(o,"selected-mode",k[2].techniqueMappingMode===ce["ATT&CK"])},i(k){u||(b(t.$$.fragment,k),b(s.$$.fragment,k),u=!0)},o(k){C(t.$$.fragment,k),C(s.$$.fragment,k),u=!1},d(k){k&&_(e),H(t),H(s),d=!1,m()}}}function Qi(n){let e,l,t;return l=new Xl({props:{$$slots:{popover:[Yi],popoverClick:[Zi]},$$scope:{ctx:n}}}),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"id","layer-btns"),g(e,"class","svelte-69rrcm")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,[r]){const o={};r&134&&(o.$$scope={dirty:r,ctx:i}),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Xi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,d=>l(2,t=d)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s;const a=()=>{Z(o,t.associationMode=!t.associationMode,t)},c=d=>{Z(o,t.techniqueMappingMode=d,t)};function f(d){s=d,l(1,s)}const u=()=>c(ce["ATT&CK"]);return n.$$set=d=>{"store"in d&&r(l(0,o=d.store))},[o,s,t,a,c,f,u]}class xi extends ge{constructor(e){super(),be(this,e,Xi,Qi,pe,{store:0})}}function ul(n){let e,l,t,i,r,o,s,a="Root Colored",c,f,u,d,m,h="Multi-Colored",p,k,v,M,P,z="Heatmap",D,T,q,O;return r=new te({props:{size:30,iconName:ce.rootColor,description:"Root Colored",title:"Root Colored"}}),u=new te({props:{size:30,viewBox:32,iconName:ce.childrenMultiColor,description:"Children Multi-Color",title:"Children Multi-Color"}}),v=new te({props:{size:30,iconName:ce.heatMap,description:"Heatmap",title:"Heatmap"}}),{c(){e=y("div"),l=y("div"),t=y("div"),i=y("button"),V(r.$$.fragment),o=A(),s=y("span"),s.textContent=a,c=A(),f=y("button"),V(u.$$.fragment),d=A(),m=y("span"),m.textContent=h,p=A(),k=y("button"),V(v.$$.fragment),M=A(),P=y("span"),P.textContent=z,this.h()},l(L){e=w(L,"DIV",{id:!0,class:!0});var Y=E(e);l=w(Y,"DIV",{class:!0});var de=E(l);t=w(de,"DIV",{id:!0,class:!0});var le=E(t);i=w(le,"BUTTON",{class:!0});var x=E(i);F(r.$$.fragment,x),o=S(x),s=w(x,"SPAN",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-1mm9720"&&(s.textContent=a),x.forEach(_),c=S(le),f=w(le,"BUTTON",{class:!0});var ee=E(f);F(u.$$.fragment,ee),d=S(ee),m=w(ee,"SPAN",{class:!0,"data-svelte-h":!0}),we(m)!=="svelte-17kog5w"&&(m.textContent=h),ee.forEach(_),p=S(le),k=w(le,"BUTTON",{class:!0});var Ie=E(k);F(v.$$.fragment,Ie),M=S(Ie),P=w(Ie,"SPAN",{class:!0,"data-svelte-h":!0}),we(P)!=="svelte-1cpq3q6"&&(P.textContent=z),Ie.forEach(_),le.forEach(_),de.forEach(_),Y.forEach(_),this.h()},h(){g(s,"class","pop-text"),g(i,"class","row--mode btn svelte-1ya1wil"),se(i,"selected-mode",n[4].techniqueMappingMode===ce.rootColor),g(m,"class","pop-text"),g(f,"class","row--mode btn svelte-1ya1wil"),se(f,"selected-mode",n[4].techniqueMappingMode===ce.childrenMultiColor),g(P,"class","pop-text"),g(k,"class","row--mode btn svelte-1ya1wil"),se(k,"selected-mode",n[4].techniqueMappingMode===ce.heatMap),g(t,"id","btn-group"),g(t,"class","svelte-1ya1wil"),g(l,"class","mapping--popover svelte-1ya1wil"),g(e,"id","backdrop"),g(e,"class","svelte-1ya1wil")},m(L,Y){I(L,e,Y),$(e,l),$(l,t),$(t,i),j(r,i,null),$(i,o),$(i,s),$(t,c),$(t,f),j(u,f,null),$(f,d),$(f,m),$(t,p),$(t,k),j(v,k,null),$(k,M),$(k,P),n[14](l),T=!0,q||(O=[W(i,"click",n[11]),W(f,"click",n[12]),W(k,"click",n[13]),nt(n[6].call(null,l)),nt(En.call(null,l)),W(l,"outsideclick",n[7])],q=!0)},p(L,Y){(!T||Y&16)&&se(i,"selected-mode",L[4].techniqueMappingMode===ce.rootColor),(!T||Y&16)&&se(f,"selected-mode",L[4].techniqueMappingMode===ce.childrenMultiColor),(!T||Y&16)&&se(k,"selected-mode",L[4].techniqueMappingMode===ce.heatMap)},i(L){T||(b(r.$$.fragment,L),b(u.$$.fragment,L),b(v.$$.fragment,L),L&&Pe(()=>{T&&(D||(D=Se(e,Oe,{delay:25,duration:150},!0)),D.run(1))}),T=!0)},o(L){C(r.$$.fragment,L),C(u.$$.fragment,L),C(v.$$.fragment,L),L&&(D||(D=Se(e,Oe,{delay:25,duration:150},!1)),D.run(0)),T=!1},d(L){L&&_(e),H(r),H(u),H(v),n[14](null),L&&D&&D.end(),q=!1,Te(O)}}}function er(n){let e,l,t,i,r,o,s;t=new te({props:{size:30,iconName:"grid",description:"Select Visualization Mode",title:"Select Visualization Mode"}});let a=n[1]&&ul(n);return{c(){e=y("div"),l=y("div"),V(t.$$.fragment),i=A(),a&&a.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=E(e);l=w(f,"DIV",{class:!0,href:!0,tabindex:!0,role:!0});var u=E(l);F(t.$$.fragment,u),u.forEach(_),i=S(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(l,"class","layer-trigger"),g(l,"href",null),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-container")},m(c,f){I(c,e,f),$(e,l),j(t,l,null),n[9](l),$(e,i),a&&a.m(e,null),r=!0,o||(s=[nt(n[5].call(null,l)),W(l,"click",n[7]),W(l,"keydown",n[10])],o=!0)},p(c,[f]){c[1]?a?(a.p(c,f),f&2&&b(a,1)):(a=ul(c),a.c(),b(a,1),a.m(e,null)):a&&(ie(),C(a,1,1,()=>{a=null}),re())},i(c){r||(b(t.$$.fragment,c),b(a),r=!0)},o(c){C(t.$$.fragment,c),C(a),r=!1},d(c){c&&_(e),H(t),n[9](null),a&&a.d(),o=!1,Te(s)}}}function tr(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,z=>l(4,t=z)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s,a,c;const[f,u]=Nn({strategy:"fixed",placement:"right-end",middleware:[Mn(20),Pn()]}),d=()=>{l(1,s=!s)},m=z=>{Z(o,t.techniqueMappingMode=z,t)};function h(z){De[z?"unshift":"push"](()=>{a=z,l(2,a)})}const p=z=>Je(z,d),k=()=>m(ce.rootColor),v=()=>m(ce.childrenMultiColor),M=()=>m(ce.heatMap);function P(z){De[z?"unshift":"push"](()=>{c=z,l(3,c)})}return n.$$set=z=>{"store"in z&&r(l(0,o=z.store))},[o,s,a,c,t,f,u,d,m,h,p,k,v,M,P]}class lr extends ge{constructor(e){super(),be(this,e,tr,er,pe,{store:0})}}function nr(n){let e,l;return e=new te({props:{size:30,iconName:"noComment",description:"Select comment Mode",title:"Select comment Mode"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function ir(n){let e,l;return e=new te({props:{size:30,iconName:"commentOn",description:"Select comment Mode",title:"Select comment Mode"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function rr(n){let e,l,t,i,r,o,s;const a=[ir,nr],c=[];function f(u,d){return u[1].matrixCommentMode?0:1}return t=f(n),i=c[t]=a[t](n),{c(){e=y("div"),l=y("div"),i.c(),this.h()},l(u){e=w(u,"DIV",{class:!0});var d=E(e);l=w(d,"DIV",{class:!0,href:!0,tabindex:!0,role:!0});var m=E(l);i.l(m),m.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","layer-trigger"),g(l,"href",null),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-container")},m(u,d){I(u,e,d),$(e,l),c[t].m(l,null),r=!0,o||(s=[W(l,"click",n[2]),W(l,"keydown",n[3])],o=!0)},p(u,[d]){let m=t;t=f(u),t!==m&&(ie(),C(c[m],1,1,()=>{c[m]=null}),re(),i=c[t],i||(i=c[t]=a[t](u),i.c()),b(i,1),i.m(l,null))},i(u){r||(b(i),r=!0)},o(u){C(i),r=!1},d(u){u&&_(e),c[t].d(),o=!1,Te(s)}}}function or(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,c=>l(1,t=c)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();const s=()=>{Z(o,t.matrixCommentMode=!t.matrixCommentMode,t)},a=c=>Je(c,s);return n.$$set=c=>{"store"in c&&r(l(0,o=c.store))},[o,t,s,a]}class sr extends ge{constructor(e){super(),be(this,e,or,rr,pe,{store:0})}}const ar=n=>({store:n&1}),dl=n=>({H:n[1],store:n[0]});function cr(n){let e,l;const t=n[3].default,i=He(t,n,n[2],dl);return{c(){e=y("section"),i&&i.c(),this.h()},l(r){e=w(r,"SECTION",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","header--container"),g(e,"class","svelte-1yjouu8")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,[o]){i&&i.p&&(!l||o&5)&&Re(i,t,r,r[2],l?Be(t,r[2],o,ar):Fe(r[2]),dl)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function fr(n,e,l){let{$$slots:t={},$$scope:i}=e,{store:r}=e;const o={ProfileButtons:Mi,ProfileSelect:qi,MappingMode:Ri,ExportImport:Gi,FilterMode:xi,MatrixMappingPopover:lr,MatrixCommentToggle:sr};return n.$$set=s=>{"store"in s&&l(0,r=s.store),"$$scope"in s&&l(2,i=s.$$scope)},[r,o,i,t]}class kt extends ge{constructor(e){super(),be(this,e,fr,cr,pe,{store:0})}}function ml(n,e,l){const t=n.slice();return t[12]=e[l],t}function hl(n){let e,l=n[12].name+"",t;return{c(){e=y("option"),t=fe(l),this.h()},l(i){e=w(i,"OPTION",{});var r=E(e);t=ue(r,l),r.forEach(_),this.h()},h(){e.__value=n[12],ze(e,e.__value)},m(i,r){I(i,e,r),$(e,t)},p:G,d(i){i&&_(e)}}}function ur(n){let e,l,t,i,r,o,s,a,c,f="NAME",u,d,m,h,p=`Select Capability from Templates...
          `,k,v,M,P=n[0].name+"",z,D,T,q,O,L,Y,de="Save",le,x,ee="Cancel",Ie,me,U=qe(n[3]),J=[];for(let K=0;K<U.length;K+=1)J[K]=hl(ml(n,U,K));return{c(){e=y("section"),l=y("h2"),t=fe(n[1]),i=A(),r=y("hr"),o=A(),s=y("article"),a=y("div"),c=y("label"),c.textContent=f,u=A(),d=y("div"),m=y("select"),h=y("option"),h.textContent=p;for(let K=0;K<J.length;K+=1)J[K].c();k=A(),v=y("p"),M=fe("The Template Capability ("),z=fe(P),D=fe(`) will incorporate all
        associated Techniques.`),T=A(),q=y("hr"),O=A(),L=y("section"),Y=y("button"),Y.textContent=de,le=A(),x=y("button"),x.textContent=ee,this.h()},l(K){e=w(K,"SECTION",{id:!0,class:!0});var Q=E(e);l=w(Q,"H2",{class:!0});var oe=E(l);t=ue(oe,n[1]),oe.forEach(_),i=S(Q),r=w(Q,"HR",{}),o=S(Q),s=w(Q,"ARTICLE",{id:!0});var B=E(s);a=w(B,"DIV",{id:!0,class:!0});var N=E(a);c=w(N,"LABEL",{"aria-label":!0,for:!0,class:!0,"data-svelte-h":!0}),we(c)!=="svelte-l4gr53"&&(c.textContent=f),u=S(N),d=w(N,"DIV",{id:!0,class:!0});var R=E(d);m=w(R,"SELECT",{id:!0,class:!0});var ae=E(m);h=w(ae,"OPTION",{"data-svelte-h":!0}),we(h)!=="svelte-1lnlsc6"&&(h.textContent=p);for(let Ue=0;Ue<J.length;Ue+=1)J[Ue].l(ae);ae.forEach(_),R.forEach(_),k=S(N),v=w(N,"P",{class:!0});var Ee=E(v);M=ue(Ee,"The Template Capability ("),z=ue(Ee,P),D=ue(Ee,`) will incorporate all
        associated Techniques.`),Ee.forEach(_),N.forEach(_),T=S(B),q=w(B,"HR",{}),O=S(B),L=w(B,"SECTION",{id:!0,class:!0});var $e=E(L);Y=w($e,"BUTTON",{"data-svelte-h":!0}),we(Y)!=="svelte-syg9fy"&&(Y.textContent=de),le=S($e),x=w($e,"BUTTON",{"data-svelte-h":!0}),we(x)!=="svelte-1alkrs9"&&(x.textContent=ee),$e.forEach(_),B.forEach(_),Q.forEach(_),this.h()},h(){var K;g(l,"class","text-center"),g(c,"aria-label","Capability Name"),g(c,"for","capability-name"),g(c,"class","svelte-3ehrko"),h.selected=!0,h.disabled=!0,h.__value="",ze(h,h.__value),g(m,"id","capability--select"),m.required=!0,g(m,"class","svelte-3ehrko"),n[0]===void 0&&Pe(()=>n[9].call(m)),g(d,"id","autocomplete"),g(d,"class","svelte-3ehrko"),g(v,"class","form-info svelte-3ehrko"),se(v,"non--existing",!n[2].templates[(K=n[0])==null?void 0:K.id]),g(a,"id","layer-input-form"),g(a,"class","svelte-3ehrko"),g(L,"id","layer-btns"),g(L,"class","svelte-3ehrko"),g(s,"id","container-capability-form"),g(e,"id","dialog--container"),g(e,"class","svelte-3ehrko")},m(K,Q){I(K,e,Q),$(e,l),$(l,t),$(e,i),$(e,r),$(e,o),$(e,s),$(s,a),$(a,c),$(a,u),$(a,d),$(d,m),$(m,h);for(let oe=0;oe<J.length;oe+=1)J[oe]&&J[oe].m(m,null);mt(m,n[0],!0),$(a,k),$(a,v),$(v,M),$(v,z),$(v,D),$(s,T),$(s,q),$(s,O),$(s,L),$(L,Y),$(L,le),$(L,x),Ie||(me=[W(m,"change",n[9]),W(Y,"click",n[4]),W(x,"click",n[5])],Ie=!0)},p(K,[Q]){var oe;if(Q&2&&Me(t,K[1]),Q&8){U=qe(K[3]);let B;for(B=0;B<U.length;B+=1){const N=ml(K,U,B);J[B]?J[B].p(N,Q):(J[B]=hl(N),J[B].c(),J[B].m(m,null))}for(;B<J.length;B+=1)J[B].d(1);J.length=U.length}Q&9&&mt(m,K[0]),Q&1&&P!==(P=K[0].name+"")&&Me(z,P),Q&5&&se(v,"non--existing",!K[2].templates[(oe=K[0])==null?void 0:oe.id])},i:G,o:G,d(K){K&&_(e),We(J,K),Ie=!1,Te(me)}}}function dr(n,e,l){let t;ne(n,_e,p=>l(2,t=p));let{dialog:i}=e,{title:r}=e,{selectedCapability:o=""}=e,{store:s}=e,{copyHandler:a}=e;const c=Wl(),f=Object.values(t.rootTemplates.map(p=>t.templates[p])),u=(p,k,v=[])=>{v.push(p);for(const M of(p==null?void 0:p.children)||[])u(k[M],k,v);return v},d=p=>{const k=u(o,s);a(k),c("closeModal",{dialog:i,dialogName:"copy"})},m=p=>{c("closeModal",{dialog:i,dialogName:"copy"})};function h(){o=Kl(this),l(0,o),l(3,f)}return n.$$set=p=>{"dialog"in p&&l(6,i=p.dialog),"title"in p&&l(1,r=p.title),"selectedCapability"in p&&l(0,o=p.selectedCapability),"store"in p&&l(7,s=p.store),"copyHandler"in p&&l(8,a=p.copyHandler)},[o,r,t,f,d,m,i,s,a,h]}class mr extends ge{constructor(e){super(),be(this,e,dr,ur,pe,{dialog:6,title:1,selectedCapability:0,store:7,copyHandler:8})}}function pl(n){let e,l,t,i,r,o,s;return{c(){e=y("button"),l=fe("Save Techniques"),t=A(),i=y("button"),r=fe("Remove Techniques"),this.h()},l(a){e=w(a,"BUTTON",{class:!0,title:!0});var c=E(e);l=ue(c,"Save Techniques"),c.forEach(_),t=S(a),i=w(a,"BUTTON",{class:!0,title:!0});var f=E(i);r=ue(f,"Remove Techniques"),f.forEach(_),this.h()},h(){g(e,"class","control-btn svelte-1sz3pl3"),e.disabled=n[1],g(e,"title","Save Techniques to currently highlighted Capabilities"),g(i,"class","control-btn svelte-1sz3pl3"),i.disabled=n[1],g(i,"title","Remove Techniques from currently highlighted Capabilities")},m(a,c){I(a,e,c),$(e,l),I(a,t,c),I(a,i,c),$(i,r),o||(s=[W(e,"click",n[8]),W(i,"click",n[9])],o=!0)},p(a,c){c&2&&(e.disabled=a[1]),c&2&&(i.disabled=a[1])},d(a){a&&(_(e),_(t),_(i)),o=!1,Te(s)}}}function hr(n){let e,l=!n[2].isReadonly&&pl(n);return{c(){e=y("div"),l&&l.c(),this.h()},l(t){e=w(t,"DIV",{id:!0,class:!0});var i=E(e);l&&l.l(i),i.forEach(_),this.h()},h(){g(e,"id","row-persist-btns"),g(e,"class","svelte-1sz3pl3")},m(t,i){I(t,e,i),l&&l.m(e,null)},p(t,[i]){t[2].isReadonly?l&&(l.d(1),l=null):l?l.p(t,i):(l=pl(t),l.c(),l.m(e,null))},i:G,o:G,d(t){t&&_(e),l&&l.d()}}}function pr(n,e,l){let t,i,r,o;ne(n,_e,m=>l(2,r=m)),ne(n,Ke,m=>l(3,o=m));let{selectedStore:s}=e;const{selected:a}=xe("profile-config");ne(n,a,m=>l(0,i=m));const c=(m,h)=>{_e.saveTechniques(m,h,s),Ke.reset()},f=(m,h)=>{_e.removeTechniques(m,h,s),Ke.reset()},u=()=>c(o.treeMap,i),d=()=>f(o.treeMap,i);return n.$$set=m=>{"selectedStore"in m&&l(7,s=m.selectedStore)},n.$$.update=()=>{n.$$.dirty&1&&l(1,t=!Object.values(i).some(m=>m===he.selected))},[i,t,r,o,a,c,f,s,u,d]}class _r extends ge{constructor(e){super(),be(this,e,pr,hr,pe,{selectedStore:7})}}const gr=n=>({}),_l=n=>({});function gl(n){let e,l,t,i,r,o,s,a,c,f,u;const d=[vr,br],m=[];function h(p,k){return p[2]?0:1}return o=h(n),s=m[o]=d[o](n),{c(){e=y("div"),l=y("div"),i=A(),r=y("div"),s.c(),this.h()},l(p){e=w(p,"DIV",{class:!0,role:!0,tabindex:!0,"aria-describedby":!0,style:!0});var k=E(e);l=w(k,"DIV",{class:!0,tabindex:!0,role:!0}),E(l).forEach(_),i=S(k),r=w(k,"DIV",{class:!0,role:!0,tabindex:!0});var v=E(r);s.l(v),v.forEach(_),k.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-i6sid7"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-i6sid7"),g(r,"role","button"),g(r,"tabindex","0"),g(e,"class","popover svelte-i6sid7"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-describedby","Comment"),ve(e,"--popover-y",n[5].top+"px"),ve(e,"--popover-right",n[5].right+10+"px"),ve(e,"--color-icon",n[1])},m(p,k){I(p,e,k),$(e,l),$(e,i),$(e,r),m[o].m(r,null),c=!0,f||(u=[W(l,"click",wt(n[8])),W(r,"mouseleave",n[7])],f=!0)},p(p,k){let v=o;o=h(p),o===v?m[o].p(p,k):(ie(),C(m[v],1,1,()=>{m[v]=null}),re(),s=m[o],s?s.p(p,k):(s=m[o]=d[o](p),s.c()),b(s,1),s.m(r,null)),(!c||k&32)&&ve(e,"--popover-y",p[5].top+"px"),(!c||k&32)&&ve(e,"--popover-right",p[5].right+10+"px"),(!c||k&2)&&ve(e,"--color-icon",p[1])},i(p){c||(p&&Pe(()=>{c&&(t||(t=Se(l,Oe,{delay:25,duration:150},!0)),t.run(1))}),b(s),p&&Pe(()=>{c&&(a||(a=Se(e,Oe,{duration:150},!0)),a.run(1))}),c=!0)},o(p){p&&(t||(t=Se(l,Oe,{delay:25,duration:150},!1)),t.run(0)),C(s),p&&(a||(a=Se(e,Oe,{duration:150},!1)),a.run(0)),c=!1},d(p){p&&_(e),p&&t&&t.end(),m[o].d(),p&&a&&a.end(),f=!1,Te(u)}}}function br(n){let e,l,t,i,r,o,s,a,c,f,u;return a=new te({props:{size:33,iconName:"edit",description:"Edit Description",title:"Edit Description",pathColor:"black"}}),{c(){e=y("div"),l=y("pre"),t=fe(n[3]),r=A(),o=y("div"),s=y("span"),V(a.$$.fragment),this.h()},l(d){e=w(d,"DIV",{class:!0,id:!0});var m=E(e);l=w(m,"PRE",{class:!0});var h=E(l);t=ue(h,n[3]),h.forEach(_),m.forEach(_),r=S(d),o=w(d,"DIV",{class:!0,role:!0,tabindex:!0});var p=E(o);s=w(p,"SPAN",{});var k=E(s);F(a.$$.fragment,k),k.forEach(_),p.forEach(_),this.h()},h(){g(l,"class","popover-text svelte-i6sid7"),g(e,"class","popover-comment svelte-i6sid7"),g(e,"id",i=n[0].id),g(o,"class","edit-btn svelte-i6sid7"),g(o,"role","button"),g(o,"tabindex","0")},m(d,m){I(d,e,m),$(e,l),$(l,t),I(d,r,m),I(d,o,m),$(o,s),j(a,s,null),c=!0,f||(u=[W(o,"click",n[9]),W(o,"keyup",null)],f=!0)},p(d,m){(!c||m&8)&&Me(t,d[3]),(!c||m&1&&i!==(i=d[0].id))&&g(e,"id",i)},i(d){c||(b(a.$$.fragment,d),c=!0)},o(d){C(a.$$.fragment,d),c=!1},d(d){d&&(_(e),_(r),_(o)),H(a),f=!1,Te(u)}}}function vr(n){let e,l,t,i,r,o,s,a,c,f,u;return o=new te({props:{size:33,iconName:"check",description:"Save Description",title:"Save Description"}}),o.$on("iconClick",n[10]),a=new te({props:{size:33,iconName:"close",description:"close",title:"close"}}),a.$on("iconClick",n[11]),{c(){e=y("div"),l=y("textarea"),i=A(),r=y("div"),V(o.$$.fragment),s=A(),V(a.$$.fragment),this.h()},l(d){e=w(d,"DIV",{class:!0,id:!0});var m=E(e);l=w(m,"TEXTAREA",{id:!0,name:!0,class:!0}),E(l).forEach(_),m.forEach(_),i=S(d),r=w(d,"DIV",{class:!0});var h=E(r);F(o.$$.fragment,h),s=S(h),F(a.$$.fragment,h),h.forEach(_),this.h()},h(){g(l,"id","layer-description"),g(l,"name","Description"),l.required=!0,g(l,"class","svelte-i6sid7"),g(e,"class","popover-comment svelte-i6sid7"),g(e,"id",t=n[0].id),g(r,"class","popover-btns svelte-i6sid7")},m(d,m){I(d,e,m),$(e,l),ze(l,n[3]),I(d,i,m),I(d,r,m),j(o,r,null),$(r,s),j(a,r,null),c=!0,f||(u=W(l,"input",n[16]),f=!0)},p(d,m){m&8&&ze(l,d[3]),(!c||m&1&&t!==(t=d[0].id))&&g(e,"id",t)},i(d){c||(b(o.$$.fragment,d),b(a.$$.fragment,d),c=!0)},o(d){C(o.$$.fragment,d),C(a.$$.fragment,d),c=!1},d(d){d&&(_(e),_(i),_(r)),H(o),H(a),f=!1,u()}}}function $r(n){let e,l,t,i,r,o;const s=n[14].popoverHover,a=He(s,n,n[13],_l);let c=(n[4]||n[2])&&gl(n);return{c(){e=y("div"),a&&a.c(),l=A(),c&&c.c(),t=ke(),this.h()},l(f){e=w(f,"DIV",{role:!0,tabindex:!0});var u=E(e);a&&a.l(u),u.forEach(_),l=S(f),c&&c.l(f),t=ke(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(f,u){I(f,e,u),a&&a.m(e,null),I(f,l,u),c&&c.m(f,u),I(f,t,u),i=!0,r||(o=[W(e,"click",n[6]),W(e,"keydown",n[15])],r=!0)},p(f,[u]){a&&a.p&&(!i||u&8192)&&Re(a,s,f,f[13],i?Be(s,f[13],u,gr):Fe(f[13]),_l),f[4]||f[2]?c?(c.p(f,u),u&20&&b(c,1)):(c=gl(f),c.c(),b(c,1),c.m(t.parentNode,t)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){i||(b(a,f),b(c),i=!0)},o(f){C(a,f),C(c),i=!1},d(f){f&&(_(e),_(l),_(t)),a&&a.d(f),c&&c.d(f),r=!1,Te(o)}}}const _t=Ne(null),gt=Ne(!1),ft=Ne(!1),bl=Ne({}),bt=Ne({});let ut;const kr=n=>(n==null?void 0:n.getBoundingClientRect())??{bottom:0,left:0};function Cr(n,e,l){let t,i,r,o,s;ne(n,ft,T=>l(2,t=T)),ne(n,_t,T=>l(17,i=T)),ne(n,bt,T=>l(3,r=T)),ne(n,gt,T=>l(4,o=T)),ne(n,bl,T=>l(5,s=T));let{$$slots:a={},$$scope:c}=e,{item:f}=e,{color:u}=e,{comment:d}=e;const m=Wl(),h=T=>{clearTimeout(ut),ut=setTimeout(()=>{Z(_t,i=f.id,i),Z(bl,s=kr(T.target),s),Z(gt,o=!0,o),Z(bt,r=d,r)},500)},p=T=>{clearTimeout(ut),ut=setTimeout(()=>{k()},1500)},k=()=>{Z(_t,i=null,i),Z(gt,o=!1,o),Z(ft,t=!1,t)},v=()=>{Z(ft,t=!0,t)},M=T=>{m("submit",{e:T,item:f,comment:r,layerId:i}),k()},P=()=>{Z(ft,t=!1,t),k()},z=T=>Je(T,h);function D(){r=this.value,bt.set(r)}return n.$$set=T=>{"item"in T&&l(0,f=T.item),"color"in T&&l(1,u=T.color),"comment"in T&&l(12,d=T.comment),"$$scope"in T&&l(13,c=T.$$scope)},[f,u,t,r,o,s,h,p,k,v,M,P,d,c,a,z,D]}class Nt extends ge{constructor(e){super(),be(this,e,Cr,$r,pe,{item:0,color:1,comment:12})}}function yr(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{class:!0}),E(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-1pe53dj")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function wr(n){let e,l,t;return l=new te({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[20]),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-1pe53dj"),se(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&se(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Tr(n){let e,l=n[0].name+"",t,i,r;return{c(){e=y("span"),t=fe(l),this.h()},l(o){e=w(o,"SPAN",{class:!0,tabindex:!0,role:!0});var s=E(e);t=ue(s,l),s.forEach(_),this.h()},h(){var o;g(e,"class","layer-text svelte-1pe53dj"),g(e,"tabindex","0"),g(e,"role","button"),se(e,"root-layer",((o=n[0].children)==null?void 0:o.length)>0)},m(o,s){I(o,e,s),$(e,t),i||(r=[W(e,"click",n[24]),W(e,"keydown",n[25])],i=!0)},p(o,s){var a;s[0]&1&&l!==(l=o[0].name+"")&&Me(t,l),s[0]&1&&se(e,"root-layer",((a=o[0].children)==null?void 0:a.length)>0)},d(o){o&&_(e),i=!1,Te(r)}}}function Er(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-1pe53dj")},m(i,r){I(i,e,r),ze(e,n[6]),l||(t=[nt(Yl.call(null,e)),W(e,"input",n[22]),W(e,"keydown",Qe(n[23]))],l=!0)},p(i,r){r[0]&64&&e.value!==i[6]&&ze(e,i[6])},d(i){i&&_(e),l=!1,Te(t)}}}function Ir(n){let e,l,t,i,r,o;return l=new te({props:{size:pt,iconName:"check",description:"Edit Capability",title:"Edit Capability"}}),l.$on("iconClick",n[32]),i=new te({props:{size:pt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[33]),{c(){e=y("div"),V(l.$$.fragment),t=A(),V(i.$$.fragment),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=E(e);F(l.$$.fragment,a),t=S(a),F(i.$$.fragment,a),a.forEach(_),this.h()},h(){g(e,"class","layer-form-btns svelte-1pe53dj")},m(s,a){I(s,e,a),j(l,e,null),$(e,t),j(i,e,null),o=!0},p:G,i(s){o||(b(l.$$.fragment,s),b(i.$$.fragment,s),s&&(r||Pe(()=>{r=Xe(e,it,{duration:700,delay:100,axis:"x",x:10}),r.start()})),o=!0)},o(s){C(l.$$.fragment,s),C(i.$$.fragment,s),o=!1},d(s){s&&_(e),H(l),H(i)}}}function Nr(n){let e,l,t,i,r,o,s,a,c,f,u;l=new te({props:{size:Ae,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[26]),i=new te({props:{size:Ae,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[27]),o=new te({props:{size:Ae,iconName:"delete",description:"Delete Capability and Children",title:"Delete Capability and Children"}}),o.$on("iconClick",n[28]),a=new Nt({props:{item:n[0],color:n[0].color,comment:n[0].comment,$$slots:{popoverHover:[Mr]},$$scope:{ctx:n}}}),a.$on("submit",n[19]);let d=n[8].techniqueMappingMode!==ce.heatMap&&vl(n);return{c(){e=y("div"),V(l.$$.fragment),t=A(),V(i.$$.fragment),r=A(),V(o.$$.fragment),s=A(),V(a.$$.fragment),c=A(),d&&d.c(),this.h()},l(m){e=w(m,"DIV",{class:!0});var h=E(e);F(l.$$.fragment,h),t=S(h),F(i.$$.fragment,h),r=S(h),F(o.$$.fragment,h),s=S(h),F(a.$$.fragment,h),c=S(h),d&&d.l(h),h.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-1pe53dj")},m(m,h){I(m,e,h),j(l,e,null),$(e,t),j(i,e,null),$(e,r),j(o,e,null),$(e,s),j(a,e,null),$(e,c),d&&d.m(e,null),u=!0},p(m,h){const p={};h[0]&1&&(p.item=m[0]),h[0]&1&&(p.color=m[0].color),h[0]&1&&(p.comment=m[0].comment),h[1]&8&&(p.$$scope={dirty:h,ctx:m}),a.$set(p),m[8].techniqueMappingMode!==ce.heatMap?d?(d.p(m,h),h[0]&256&&b(d,1)):(d=vl(m),d.c(),b(d,1),d.m(e,null)):d&&(ie(),C(d,1,1,()=>{d=null}),re())},i(m){u||(b(l.$$.fragment,m),b(i.$$.fragment,m),b(o.$$.fragment,m),b(a.$$.fragment,m),b(d),m&&(f||Pe(()=>{f=Xe(e,it,{axis:"x",duration:100,x:-10}),f.start()})),u=!0)},o(m){C(l.$$.fragment,m),C(i.$$.fragment,m),C(o.$$.fragment,m),C(a.$$.fragment,m),C(d),u=!1},d(m){m&&_(e),H(l),H(i),H(o),H(a),d&&d.d()}}}function Mr(n){let e,l;return e=new te({props:{size:Ae,iconName:"infoOutline",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function vl(n){let e,l,t,i,r,o,s;return e=new te({props:{size:Ae,iconName:"color picker",description:"Pick Capability Family Color",title:"Pick Capability Family Color"}}),e.$on("iconClick",n[29]),{c(){V(e.$$.fragment),l=A(),t=y("input"),this.h()},l(a){F(e.$$.fragment,a),l=S(a),t=w(a,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,ve(t,"display","none")},m(a,c){j(e,a,c),I(a,l,c),I(a,t,c),n[30](t),r=!0,o||(s=W(t,"change",un(wt(n[31]))),o=!0)},p(a,c){(!r||c[0]&1&&i!==(i=a[0].color))&&(t.value=i)},i(a){r||(b(e.$$.fragment,a),r=!0)},o(a){C(e.$$.fragment,a),r=!1},d(a){a&&(_(l),_(t)),H(e,a),n[30](null),o=!1,s()}}}function Pr(n){let e,l,t,i,r,o,s,a,c,f,u,d,m,h;const p=[wr,yr],k=[];function v(O,L){return O[4]?0:1}l=v(n),t=k[l]=p[l](n);function M(O,L){return O[7][O[0].id]===he.editing?Er:Tr}let P=M(n),z=P(n);const D=[Nr,Ir],T=[];function q(O,L){return O[7][O[0].id]===he.selected||O[7][O[0].id]===he.root?0:O[7][O[0].id]===he.editing?1:-1}return~(f=q(n))&&(u=T[f]=D[f](n)),{c(){e=y("div"),t.c(),i=A(),r=y("form"),o=y("input"),a=A(),z.c(),c=A(),u&&u.c(),this.h()},l(O){e=w(O,"DIV",{class:!0,style:!0});var L=E(e);t.l(L),i=S(L),r=w(L,"FORM",{});var Y=E(r);o=w(Y,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0,style:!0}),Y.forEach(_),a=S(L),z.l(L),c=S(L),u&&u.l(L),L.forEach(_),this.h()},h(){var O,L,Y;g(o,"class","check-box svelte-1pe53dj"),g(o,"type","checkbox"),g(o,"name","include"),o.checked=s=(O=n[0])==null?void 0:O.checked,g(o,"tabindex","0"),ve(o,"accent-color",n[0].color),g(e,"class","layer-parent svelte-1pe53dj"),ve(e,"--expanded-width",Ae+"px"),se(e,"selected-layer",n[7][n[0].id]===he.selected),se(e,"layer-hover",!((Y=(L=n[0])==null?void 0:L.children)!=null&&Y.length))},m(O,L){I(O,e,L),k[l].m(e,null),$(e,i),$(e,r),$(r,o),$(e,a),z.m(e,null),$(e,c),~f&&T[f].m(e,null),d=!0,m||(h=W(o,"click",Qe(n[21])),m=!0)},p(O,L){var le,x,ee;let Y=l;l=v(O),l===Y?k[l].p(O,L):(ie(),C(k[Y],1,1,()=>{k[Y]=null}),re(),t=k[l],t?t.p(O,L):(t=k[l]=p[l](O),t.c()),b(t,1),t.m(e,i)),(!d||L[0]&1&&s!==(s=(le=O[0])==null?void 0:le.checked))&&(o.checked=s),(!d||L[0]&1)&&ve(o,"accent-color",O[0].color),P===(P=M(O))&&z?z.p(O,L):(z.d(1),z=P(O),z&&(z.c(),z.m(e,c)));let de=f;f=q(O),f===de?~f&&T[f].p(O,L):(u&&(ie(),C(T[de],1,1,()=>{T[de]=null}),re()),~f?(u=T[f],u?u.p(O,L):(u=T[f]=D[f](O),u.c()),b(u,1),u.m(e,null)):u=null),(!d||L[0]&129)&&se(e,"selected-layer",O[7][O[0].id]===he.selected),(!d||L[0]&1)&&se(e,"layer-hover",!((ee=(x=O[0])==null?void 0:x.children)!=null&&ee.length))},i(O){d||(b(t),b(u),d=!0)},o(O){C(t),C(u),d=!1},d(O){O&&_(e),k[l].d(),z.d(),~f&&T[f].d(),m=!1,h()}}}function Dr(n,e,l){let t,i,r,o,s=G,a=()=>(s(),s=Ve(u,N=>l(8,o=N)),u),c;n.$$.on_destroy.push(()=>s());let{layer:f}=e,{store:u}=e;a();let{storeProp:d}=e,{handlers:m}=e,{expandable:h}=e;const{expanded:p,selected:k,editingName:v,colorPicker:M}=xe("profile-config");ne(n,p,N=>l(9,c=N)),ne(n,k,N=>l(7,r=N)),ne(n,v,N=>l(6,i=N)),ne(n,M,N=>l(5,t=N));const P=(N,R)=>{Z(p,c[R.id]=!c[R.id],c)},z=(N,R)=>{var Ee;const ae=R===void 0?o[d][N.id].checked:R;if(Z(u,o[d][N.id].checked=!ae,o),!!((Ee=N==null?void 0:N.children)!=null&&Ee.length))for(const $e of N.children)z(o[d][$e],ae)},D=(N,R,ae)=>{N.detail.event.stopPropagation(),Z(k,r[R.id]=he.editing,r),Z(k,r[ae.id]=he.noop,r),Z(v,i=R.name,i)},T=(N,R)=>{t[R.id].click()},q=(N,R,ae)=>{u.saveLayerColor(R,N.srcElement.value,ae)},O=N=>{const{item:R,comment:ae}=N.detail;u.editLayerComment(R.id,ae,d)},L=N=>P(N,f),Y=N=>z(f);function de(){i=this.value,v.set(i)}const le=N=>Je(N,m.saveCapabilityName,f.id,i,d),x=N=>m.selectLayer(N,f,f.children.length!==0),ee=N=>Je(N,m.selectLayer,f,f.children.length!==0),Ie=N=>m.showCreateLayerDialog(N,f,null),me=N=>D(N,f,parent),U=N=>m.deleteCapability(f),J=N=>T(N,f);function K(N){De[N?"unshift":"push"](()=>{t[f.id]=N,M.set(t)})}const Q=N=>q(N,f,d),oe=N=>m.saveCapabilityName(f.id,null,i,d),B=N=>m.cancelEdit(N,f);return n.$$set=N=>{"layer"in N&&l(0,f=N.layer),"store"in N&&a(l(1,u=N.store)),"storeProp"in N&&l(2,d=N.storeProp),"handlers"in N&&l(3,m=N.handlers),"expandable"in N&&l(4,h=N.expandable)},[f,u,d,m,h,t,i,r,o,c,p,k,v,M,P,z,D,T,q,O,L,Y,de,le,x,ee,Ie,me,U,J,K,Q,oe,B]}class qr extends ge{constructor(e){super(),be(this,e,Dr,Pr,pe,{layer:0,store:1,storeProp:2,handlers:3,expandable:4},null,[-1,-1])}}function Ar(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{class:!0}),E(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-bodng4")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function Sr(n){let e,l,t;return l=new te({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[20]),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-bodng4"),se(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&se(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Or(n){let e,l=n[0].name+"",t,i,r;return{c(){e=y("span"),t=fe(l),this.h()},l(o){e=w(o,"SPAN",{class:!0,tabindex:!0,role:!0});var s=E(e);t=ue(s,l),s.forEach(_),this.h()},h(){g(e,"class","layer-text svelte-bodng4"),g(e,"tabindex","0"),g(e,"role","button")},m(o,s){I(o,e,s),$(e,t),i||(r=[W(e,"click",n[25]),W(e,"keydown",Qe(n[26]))],i=!0)},p(o,s){s[0]&1&&l!==(l=o[0].name+"")&&Me(t,l)},d(o){o&&_(e),i=!1,Te(r)}}}function Lr(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-bodng4")},m(i,r){I(i,e,r),ze(e,n[11]),l||(t=[nt(Yl.call(null,e)),W(e,"input",n[23]),W(e,"keydown",Qe(n[24]))],l=!0)},p(i,r){r[0]&2048&&e.value!==i[11]&&ze(e,i[11])},d(i){i&&_(e),l=!1,Te(t)}}}function zr(n){let e,l,t,i,r,o;return l=new te({props:{size:pt,iconName:"check",description:"Save Capability",title:"Save Capability"}}),l.$on("iconClick",n[33]),i=new te({props:{size:pt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[34]),{c(){e=y("div"),V(l.$$.fragment),t=A(),V(i.$$.fragment),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=E(e);F(l.$$.fragment,a),t=S(a),F(i.$$.fragment,a),a.forEach(_),this.h()},h(){g(e,"class","layer-form-btns svelte-bodng4")},m(s,a){I(s,e,a),j(l,e,null),$(e,t),j(i,e,null),o=!0},p:G,i(s){o||(b(l.$$.fragment,s),b(i.$$.fragment,s),s&&(r||Pe(()=>{r=Xe(e,it,{duration:700,delay:100,axis:"x",x:10}),r.start()})),o=!0)},o(s){C(l.$$.fragment,s),C(i.$$.fragment,s),o=!1},d(s){s&&_(e),H(l),H(i)}}}function Vr(n){let e,l,t,i,r,o,s,a,c,f,u;l=new te({props:{size:Ae,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[27]),i=new te({props:{size:Ae,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[28]),o=new te({props:{size:28,iconName:"delete",description:"Delete Capability",title:"Delete Capability"}}),o.$on("iconClick",n[29]),a=new Nt({props:{item:n[0],color:n[0].color,comment:n[0].comment,$$slots:{popoverHover:[jr]},$$scope:{ctx:n}}}),a.$on("submit",n[19]);let d=n[8].techniqueMappingMode!==ce.heatMap&&$l(n);return{c(){e=y("div"),V(l.$$.fragment),t=A(),V(i.$$.fragment),r=A(),V(o.$$.fragment),s=A(),V(a.$$.fragment),c=A(),d&&d.c(),this.h()},l(m){e=w(m,"DIV",{class:!0});var h=E(e);F(l.$$.fragment,h),t=S(h),F(i.$$.fragment,h),r=S(h),F(o.$$.fragment,h),s=S(h),F(a.$$.fragment,h),c=S(h),d&&d.l(h),h.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-bodng4")},m(m,h){I(m,e,h),j(l,e,null),$(e,t),j(i,e,null),$(e,r),j(o,e,null),$(e,s),j(a,e,null),$(e,c),d&&d.m(e,null),u=!0},p(m,h){const p={};h[0]&1&&(p.item=m[0]),h[0]&1&&(p.color=m[0].color),h[0]&1&&(p.comment=m[0].comment),h[1]&16&&(p.$$scope={dirty:h,ctx:m}),a.$set(p),m[8].techniqueMappingMode!==ce.heatMap?d?(d.p(m,h),h[0]&256&&b(d,1)):(d=$l(m),d.c(),b(d,1),d.m(e,null)):d&&(ie(),C(d,1,1,()=>{d=null}),re())},i(m){u||(b(l.$$.fragment,m),b(i.$$.fragment,m),b(o.$$.fragment,m),b(a.$$.fragment,m),b(d),m&&(f||Pe(()=>{f=Xe(e,it,{axis:"x",duration:200,x:-5}),f.start()})),u=!0)},o(m){C(l.$$.fragment,m),C(i.$$.fragment,m),C(o.$$.fragment,m),C(a.$$.fragment,m),C(d),u=!1},d(m){m&&_(e),H(l),H(i),H(o),H(a),d&&d.d()}}}function jr(n){let e,l;return e=new te({props:{size:Ae,iconName:"infoOutline",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function $l(n){let e,l,t,i,r,o,s;return e=new te({props:{size:Ae,iconName:"color picker",description:"Pick Capability Color",title:"Pick Capability Color"}}),e.$on("iconClick",n[30]),{c(){V(e.$$.fragment),l=A(),t=y("input"),this.h()},l(a){F(e.$$.fragment,a),l=S(a),t=w(a,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,ve(t,"display","none")},m(a,c){j(e,a,c),I(a,l,c),I(a,t,c),n[31](t),r=!0,o||(s=W(t,"change",n[32]),o=!0)},p(a,c){(!r||c[0]&1&&i!==(i=a[0].color))&&(t.value=i)},i(a){r||(b(e.$$.fragment,a),r=!0)},o(a){C(e.$$.fragment,a),r=!1},d(a){a&&(_(l),_(t)),H(e,a),n[31](null),o=!1,s()}}}function Hr(n){let e,l,t,i,r,o,s,a,c,f,u,d,m;const h=[Sr,Ar],p=[];function k(q,O){return q[6]?0:1}l=k(n),t=p[l]=h[l](n);function v(q,O){return q[10][q[0].id]===he.editing?Lr:Or}let M=v(n),P=M(n);const z=[Vr,zr],D=[];function T(q,O){return q[10][q[0].id]===he.selected?0:q[10][q[0].id]===he.editing?1:-1}return~(c=T(n))&&(f=D[c]=z[c](n)),{c(){e=y("div"),t.c(),i=A(),r=y("input"),s=A(),P.c(),a=A(),f&&f.c(),this.h()},l(q){e=w(q,"DIV",{class:!0,style:!0});var O=E(e);t.l(O),i=S(O),r=w(O,"INPUT",{class:!0,type:!0,name:!0,style:!0}),s=S(O),P.l(O),a=S(O),f&&f.l(O),O.forEach(_),this.h()},h(){var q;g(r,"class","check-box svelte-bodng4"),g(r,"type","checkbox"),g(r,"name","include"),r.checked=o=(q=n[0])==null?void 0:q.checked,ve(r,"accent-color",n[0].color),g(e,"class","layer-child layer-hover svelte-bodng4"),ve(e,"--expanded-icon-width",Ae+"px"),se(e,"selected-layer",n[10][n[0].id]===he.selected)},m(q,O){I(q,e,O),p[l].m(e,null),$(e,i),$(e,r),$(e,s),P.m(e,null),$(e,a),~c&&D[c].m(e,null),u=!0,d||(m=[W(r,"click",Qe(n[21])),W(r,"keydown",n[22])],d=!0)},p(q,O){var de;let L=l;l=k(q),l===L?p[l].p(q,O):(ie(),C(p[L],1,1,()=>{p[L]=null}),re(),t=p[l],t?t.p(q,O):(t=p[l]=h[l](q),t.c()),b(t,1),t.m(e,i)),(!u||O[0]&1&&o!==(o=(de=q[0])==null?void 0:de.checked))&&(r.checked=o),(!u||O[0]&1)&&ve(r,"accent-color",q[0].color),M===(M=v(q))&&P?P.p(q,O):(P.d(1),P=M(q),P&&(P.c(),P.m(e,a)));let Y=c;c=T(q),c===Y?~c&&D[c].p(q,O):(f&&(ie(),C(D[Y],1,1,()=>{D[Y]=null}),re()),~c?(f=D[c],f?f.p(q,O):(f=D[c]=z[c](q),f.c()),b(f,1),f.m(e,null)):f=null),(!u||O[0]&1025)&&se(e,"selected-layer",q[10][q[0].id]===he.selected)},i(q){u||(b(t),b(f),u=!0)},o(q){C(t),C(f),u=!1},d(q){q&&_(e),p[l].d(),P.d(),~c&&D[c].d(),d=!1,Te(m)}}}function Rr(n,e,l){let t,i,r=G,o=()=>(r(),r=Ve(m,R=>l(8,i=R)),m),s,a,c;n.$$.on_destroy.push(()=>r());let{layer:f}=e,{parent:u}=e,{root:d}=e,{store:m}=e;o();let{storeProp:h}=e,{handlers:p}=e,{expandable:k}=e;const{expanded:v,selected:M,editingName:P,colorPicker:z}=xe("profile-config");ne(n,v,R=>l(9,s=R)),ne(n,M,R=>l(10,a=R)),ne(n,P,R=>l(11,c=R)),ne(n,z,R=>l(7,t=R));const D=(R,ae)=>{Z(v,s[ae.id]=!s[ae.id],s)},T=R=>{const ae=i[h][R.id].checked;Z(m,i[h][R.id].checked=!ae,i)},q=(R,ae)=>{t[ae.id].click()},O=R=>{const{item:ae,comment:Ee}=R.detail;m.editLayerComment(ae.id,Ee,h)},L=R=>D(R,f),Y=R=>T(f),de=R=>Je(R,T,f);function le(){c=this.value,P.set(c)}const x=R=>Je(R,p.saveCapabilityName,f.id,d,c,h),ee=R=>p.selectLayer(R,f,!1,d),Ie=R=>Je(R,p.selectLayer,f,!1,d),me=R=>p.showCreateLayerDialog(R,f,d),U=R=>p.editCapability(R,f,u),J=R=>p.deleteChildCapability(f,u,h),K=R=>q(R,f);function Q(R){De[R?"unshift":"push"](()=>{t[f.id]=R,z.set(t)})}const oe=R=>p.updateCapabilityColor(R,f,h),B=R=>p.saveCapabilityName(f.id,d,c,h),N=R=>p.cancelEdit(R,f);return n.$$set=R=>{"layer"in R&&l(0,f=R.layer),"parent"in R&&l(1,u=R.parent),"root"in R&&l(2,d=R.root),"store"in R&&o(l(3,m=R.store)),"storeProp"in R&&l(4,h=R.storeProp),"handlers"in R&&l(5,p=R.handlers),"expandable"in R&&l(6,k=R.expandable)},[f,u,d,m,h,p,k,t,i,s,a,c,v,M,P,z,D,T,q,O,L,Y,de,le,x,ee,Ie,me,U,J,K,Q,oe,B,N]}class Fr extends ge{constructor(e){super(),be(this,e,Rr,Hr,pe,{layer:0,parent:1,root:2,store:3,storeProp:4,handlers:5,expandable:6},null,[-1,-1])}}function kl(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{title:!0,class:!0}),E(e).forEach(_),this.h()},h(){g(e,"title","Commented Technique"),g(e,"class","dot svelte-bodng4")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Cl(n){let e,l,t,i,r,o,s;l=new te({props:{size:Ae,iconName:"info",description:"Technique Info",title:"Technique Info"}}),l.$on("iconClick",n[13]),i=new te({props:{size:Ae,iconName:"linking",description:"Edit ATT&CK Associations",title:"Edit ATT&CK Associations"}}),i.$on("iconClick",n[14]);let a=!n[6].isReadonly&&yl(n);return{c(){e=y("div"),V(l.$$.fragment),t=A(),V(i.$$.fragment),r=A(),a&&a.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=E(e);F(l.$$.fragment,f),t=S(f),F(i.$$.fragment,f),r=S(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-bodng4")},m(c,f){I(c,e,f),j(l,e,null),$(e,t),j(i,e,null),$(e,r),a&&a.m(e,null),s=!0},p(c,f){c[6].isReadonly?a&&(ie(),C(a,1,1,()=>{a=null}),re()):a?(a.p(c,f),f&64&&b(a,1)):(a=yl(c),a.c(),b(a,1),a.m(e,null))},i(c){s||(b(l.$$.fragment,c),b(i.$$.fragment,c),b(a),c&&(o||Pe(()=>{o=Xe(e,it,{axis:"x",duration:200,x:-5}),o.start()})),s=!0)},o(c){C(l.$$.fragment,c),C(i.$$.fragment,c),C(a),s=!1},d(c){c&&_(e),H(l),H(i),a&&a.d()}}}function yl(n){let e,l;return e=new Nt({props:{item:n[1],color:n[1].color,comment:n[1].techniques.find(n[15]).comment,$$slots:{popoverHover:[Br]},$$scope:{ctx:n}}}),e.$on("submit",n[9]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&2&&(r.item=t[1]),i&2&&(r.color=t[1].color),i&3&&(r.comment=t[1].techniques.find(t[15]).comment),i&65536&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Br(n){let e,l;return e=new te({props:{size:Ae,iconName:"comment",description:"Add D3FEND Comment",title:"Add D3FEND Comment",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ur(n){var d;let e,l,t=((d=n[5].treeMap)==null?void 0:d[n[0].id]["rdfs:label"])+"",i,r,o,s,a,c,f=n[0].comment!==""&&kl(),u=n[4]===n[0].id&&Cl(n);return{c(){e=y("li"),l=y("span"),i=fe(t),r=A(),f&&f.c(),o=A(),u&&u.c(),this.h()},l(m){e=w(m,"LI",{class:!0});var h=E(e);l=w(h,"SPAN",{class:!0,tabindex:!0,role:!0});var p=E(l);i=ue(p,t),r=S(p),f&&f.l(p),p.forEach(_),o=S(h),u&&u.l(h),h.forEach(_),this.h()},h(){g(l,"class","layer-text d3fend-technique svelte-bodng4"),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-child layer-technique svelte-bodng4"),se(e,"selected-layer",n[4]===n[0].id)},m(m,h){I(m,e,h),$(e,l),$(l,i),$(l,r),f&&f.m(l,null),$(e,o),u&&u.m(e,null),s=!0,a||(c=[W(l,"click",n[11]),W(l,"keydown",Qe(n[12]))],a=!0)},p(m,[h]){var p;(!s||h&33)&&t!==(t=((p=m[5].treeMap)==null?void 0:p[m[0].id]["rdfs:label"])+"")&&Me(i,t),m[0].comment!==""?f||(f=kl(),f.c(),f.m(l,null)):f&&(f.d(1),f=null),m[4]===m[0].id?u?(u.p(m,h),h&17&&b(u,1)):(u=Cl(m),u.c(),b(u,1),u.m(e,null)):u&&(ie(),C(u,1,1,()=>{u=null}),re()),(!s||h&17)&&se(e,"selected-layer",m[4]===m[0].id)},i(m){s||(b(u),s=!0)},o(m){C(u),s=!1},d(m){m&&_(e),f&&f.d(),u&&u.d(),a=!1,Te(c)}}}function Gr(n,e,l){let t,i=G,r=()=>(i(),i=Ve(f,D=>l(4,t=D)),f),o,s;ne(n,Ke,D=>l(5,o=D)),ne(n,_e,D=>l(6,s=D)),n.$$.on_destroy.push(()=>i());let{technique:a}=e,{layer:c}=e,{selectedTechnique:f}=e;r();let{handlers:u}=e,{storeProp:d}=e;const m=(D,T,q)=>{if(t===T){Z(f,t=null,t),Ke.deselectTechnique(T);return}if(t===null){Z(f,t=T,t),Ke.selectTechnique(T);return}Ke.deselectTechnique(t),Ke.selectTechnique(T),Z(f,t=T,t)},h=D=>{dt(`/profile/?technique_id=${a.id}`)},p=D=>{const{comment:T,layerId:q}=D.detail;_e.saveLayerTechniqueComment(q,a.id,T,d),Z(f,t=null,t)},k=D=>m(D,a.id),v=D=>Je(D,m,a.id,"keydown"),M=D=>h(a.id),P=D=>u.openAttackDialog(D,a.id,c.id,c.color),z=D=>D.id===a.id;return n.$$set=D=>{"technique"in D&&l(0,a=D.technique),"layer"in D&&l(1,c=D.layer),"selectedTechnique"in D&&r(l(2,f=D.selectedTechnique)),"handlers"in D&&l(3,u=D.handlers),"storeProp"in D&&l(10,d=D.storeProp)},[a,c,f,u,t,o,s,m,h,p,d,k,v,M,P,z]}class Kr extends ge{constructor(e){super(),be(this,e,Gr,Ur,pe,{technique:0,layer:1,selectedTechnique:2,handlers:3,storeProp:10})}}function wl(n,e,l){const t=n.slice();return t[11]=e[l],t}function Tl(n){let e,l,t,i=qe(n[2]),r=[];for(let s=0;s<i.length;s+=1)r[s]=El(wl(n,i,s));const o=s=>C(r[s],1,1,()=>{r[s]=null});return{c(){e=y("ul");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=w(s,"UL",{class:!0});var a=E(e);for(let c=0;c<r.length;c+=1)r[c].l(a);a.forEach(_),this.h()},h(){g(e,"class","svelte-1vl1zhs")},m(s,a){I(s,e,a);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);t=!0},p(s,a){if(a&159){i=qe(s[2]);let c;for(c=0;c<i.length;c+=1){const f=wl(s,i,c);r[c]?(r[c].p(f,a),b(r[c],1)):(r[c]=El(f),r[c].c(),b(r[c],1),r[c].m(e,null))}for(ie(),c=i.length;c<r.length;c+=1)o(c);re()}},i(s){if(!t){for(let a=0;a<i.length;a+=1)b(r[a]);s&&Pe(()=>{t&&(l||(l=Se(e,Ze,{duration:200},!0)),l.run(1))}),t=!0}},o(s){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)C(r[a]);s&&(l||(l=Se(e,Ze,{duration:200},!1)),l.run(0)),t=!1},d(s){s&&_(e),We(r,s),s&&l&&l.end()}}}function El(n){let e,l;return e=new Kr({props:{technique:n[11],root:n[1],layer:n[0],selectedTechnique:n[7],handlers:n[3],storeProp:n[4]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&4&&(r.technique=t[11]),i&2&&(r.root=t[1]),i&1&&(r.layer=t[0]),i&8&&(r.handlers=t[3]),i&16&&(r.storeProp=t[4]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Jr(n){let e,l,t,i,r,o,s,a=`D3FEND (${n[2].length||0})`,c,f,u,d,m,h;t=new te({props:{size:Ae,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),r=new te({props:{size:Ae,iconName:"folder",description:"Techniques"}});let p=n[5][n[0].id]&&Tl(n);return{c(){e=y("div"),l=y("div"),V(t.$$.fragment),i=A(),V(r.$$.fragment),o=A(),s=y("div"),c=fe(a),f=A(),p&&p.c(),u=ke(),this.h()},l(k){e=w(k,"DIV",{class:!0,role:!0,tabindex:!0});var v=E(e);l=w(v,"DIV",{class:!0});var M=E(l);F(t.$$.fragment,M),M.forEach(_),i=S(v),F(r.$$.fragment,v),o=S(v),s=w(v,"DIV",{});var P=E(s);c=ue(P,a),P.forEach(_),v.forEach(_),f=S(k),p&&p.l(k),u=ke(),this.h()},h(){g(l,"class","expanded-btn svelte-1vl1zhs"),se(l,"expanded",n[5][n[0].id]),g(e,"class","layer-parent svelte-1vl1zhs"),g(e,"role","button"),g(e,"tabindex","0")},m(k,v){I(k,e,v),$(e,l),j(t,l,null),$(e,i),j(r,e,null),$(e,o),$(e,s),$(s,c),I(k,f,v),p&&p.m(k,v),I(k,u,v),d=!0,m||(h=[W(e,"click",n[9]),W(e,"keydown",n[10])],m=!0)},p(k,[v]){(!d||v&33)&&se(l,"expanded",k[5][k[0].id]),(!d||v&4)&&a!==(a=`D3FEND (${k[2].length||0})`)&&Me(c,a),k[5][k[0].id]?p?(p.p(k,v),v&33&&b(p,1)):(p=Tl(k),p.c(),b(p,1),p.m(u.parentNode,u)):p&&(ie(),C(p,1,1,()=>{p=null}),re())},i(k){d||(b(t.$$.fragment,k),b(r.$$.fragment,k),b(p),d=!0)},o(k){C(t.$$.fragment,k),C(r.$$.fragment,k),C(p),d=!1},d(k){k&&(_(e),_(f),_(u)),H(t),H(r),p&&p.d(k),m=!1,Te(h)}}}function Wr(n,e,l){let t,{layer:i}=e,{root:r}=e,{techniques:o}=e,{handlers:s}=e,{storeProp:a}=e;const{expandedTechniques:c,selectedTechnique:f}=xe("profile-config");ne(n,c,h=>l(5,t=h));const u=(h,p)=>{Z(c,t[p]=!t[p],t)},d=h=>u(h,i.id),m=h=>Je(h,u,i.id);return n.$$set=h=>{"layer"in h&&l(0,i=h.layer),"root"in h&&l(1,r=h.root),"techniques"in h&&l(2,o=h.techniques),"handlers"in h&&l(3,s=h.handlers),"storeProp"in h&&l(4,a=h.storeProp)},[i,r,o,s,a,t,c,f,u,d,m]}class Zr extends ge{constructor(e){super(),be(this,e,Wr,Jr,pe,{layer:0,root:1,techniques:2,handlers:3,storeProp:4})}}function Il(n,e,l){const t=n.slice();return t[13]=e[l],t}function vt(n){const e=n.slice(),l=e[2]?e[2]:e[7];return e[12]=l,e}function Yr(n){let e,l;return e=new Fr({props:{layer:n[7],parent:n[3],root:n[2],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.layer=t[7]),i&8&&(r.parent=t[3]),i&4&&(r.root=t[2]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Qr(n){let e,l;return e=new qr({props:{layer:n[7],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.layer=t[7]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Nl(n){let e,l,t,i,r=qe(n[7].children||[]),o=[];for(let c=0;c<r.length;c+=1)o[c]=Ml(Il(n,r,c));const s=c=>C(o[c],1,1,()=>{o[c]=null});let a=n[7].techniques.length>0&&n[8].associationMode&&Pl(n);return{c(){e=y("ul");for(let c=0;c<o.length;c+=1)o[c].c();l=A(),a&&a.c(),this.h()},l(c){e=w(c,"UL",{class:!0});var f=E(e);for(let u=0;u<o.length;u+=1)o[u].l(f);l=S(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(e,"class","svelte-1pe53dj")},m(c,f){I(c,e,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null);$(e,l),a&&a.m(e,null),i=!0},p(c,f){if(n=c,f&244){r=qe(n[7].children||[]);let u;for(u=0;u<r.length;u+=1){const d=Il(n,r,u);o[u]?(o[u].p(d,f),b(o[u],1)):(o[u]=Ml(d),o[u].c(),b(o[u],1),o[u].m(e,l))}for(ie(),u=r.length;u<o.length;u+=1)s(u);re()}n[7].techniques.length>0&&n[8].associationMode?a?(a.p(n,f),f&384&&b(a,1)):(a=Pl(n),a.c(),b(a,1),a.m(e,null)):a&&(ie(),C(a,1,1,()=>{a=null}),re())},i(c){if(!i){for(let f=0;f<r.length;f+=1)b(o[f]);b(a),c&&Pe(()=>{i&&(t||(t=Se(e,Ze,{duration:Dl},!0)),t.run(1))}),i=!0}},o(c){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)C(o[f]);C(a),c&&(t||(t=Se(e,Ze,{duration:Dl},!1)),t.run(0)),i=!1},d(c){c&&_(e),We(o,c),a&&a.d(),c&&t&&t.end()}}}function Ml(n){let e,l,t;return l=new xl({props:{layerId:n[13],root:n[12],parent:n[7],store:n[4],storeProp:n[5],handlers:n[6]}}),{c(){e=y("li"),V(l.$$.fragment),this.h()},l(i){e=w(i,"LI",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","svelte-1pe53dj")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){const o={};r&128&&(o.layerId=i[13]),r&132&&(o.root=i[12]),r&128&&(o.parent=i[7]),r&16&&(o.store=i[4]),r&32&&(o.storeProp=i[5]),r&64&&(o.handlers=i[6]),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Pl(n){let e,l;return e=new Zr({props:{techniques:n[7].techniques,handlers:n[6],root:n[2],layer:n[7],store:n[4],storeProp:n[5]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.techniques=t[7].techniques),i&64&&(r.handlers=t[6]),i&4&&(r.root=t[2]),i&128&&(r.layer=t[7]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Xr(n){let e,l,t,i,r;const o=[Qr,Yr],s=[];function a(f,u){return f[2]?f[1]?1:-1:0}~(e=a(n))&&(l=s[e]=o[e](n));let c=n[10][n[0]]&&n[1]&&Nl(vt(n));return{c(){l&&l.c(),t=A(),c&&c.c(),i=ke()},l(f){l&&l.l(f),t=S(f),c&&c.l(f),i=ke()},m(f,u){~e&&s[e].m(f,u),I(f,t,u),c&&c.m(f,u),I(f,i,u),r=!0},p(f,[u]){let d=e;e=a(f),e===d?~e&&s[e].p(f,u):(l&&(ie(),C(s[d],1,1,()=>{s[d]=null}),re()),~e?(l=s[e],l?l.p(f,u):(l=s[e]=o[e](f),l.c()),b(l,1),l.m(t.parentNode,t)):l=null),f[10][f[0]]&&f[1]?c?(c.p(vt(f),u),u&1027&&b(c,1)):(c=Nl(vt(f)),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){r||(b(l),b(c),r=!0)},o(f){C(l),C(c),r=!1},d(f){f&&(_(t),_(i)),~e&&s[e].d(f),c&&c.d(f)}}}const Dl=200;function xr(n,e,l){let t,i,r,o=G,s=()=>(o(),o=Ve(m,v=>l(8,r=v)),m),a;n.$$.on_destroy.push(()=>o());let{layerId:c}=e,{isLayer:f=!0}=e,{root:u=null}=e,{parent:d=null}=e,{store:m}=e;s();let{storeProp:h}=e,{handlers:p}=e;const{expanded:k}=xe("profile-config");return ne(n,k,v=>l(10,a=v)),n.$$set=v=>{"layerId"in v&&l(0,c=v.layerId),"isLayer"in v&&l(1,f=v.isLayer),"root"in v&&l(2,u=v.root),"parent"in v&&l(3,d=v.parent),"store"in v&&s(l(4,m=v.store)),"storeProp"in v&&l(5,h=v.storeProp),"handlers"in v&&l(6,p=v.handlers)},n.$$.update=()=>{var v,M;n.$$.dirty&289&&l(7,t=r[h][c]),n.$$.dirty&386&&l(9,i=f?((v=t.children)==null?void 0:v.length)>0||((M=t.techniques)==null?void 0:M.length)>0&&r.associationMode:!1)},[c,f,u,d,m,h,p,t,r,i,a,k]}class xl extends ge{constructor(e){super(),be(this,e,xr,Xr,pe,{layerId:0,isLayer:1,root:2,parent:3,store:4,storeProp:5,handlers:6})}}function ql(n,e,l){const t=n.slice();return t[55]=e[l],t}function eo(n){let e,l,t,i,r,o;return e=new n[58].ProfileButtons({props:{store:_e,selectedProfile:n[16]}}),t=new n[58].ProfileSelect({props:{store:_e,selectedProfile:n[16]}}),r=new n[58].ExportImport({props:{store:_e,storeProp:Ye.layers}}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=S(s),F(t.$$.fragment,s),i=S(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p:G,i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function to(n){let e,l;return e=new n[58].FilterMode({props:{store:_e}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Al(n){let e,l;return e=new xl({props:{layerId:n[55],store:_e,storeProp:Ye.layers,handlers:n[22]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&1024&&(r.layerId=t[55]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Sl(n){let e,l;return e=new te({props:{size:33,iconName:"plus_circle",description:"Create Capability",title:"Create Capability",disabled:!n[0].profiles.length>0}}),e.$on("iconClick",n[23]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&1&&(r.disabled=!t[0].profiles.length>0),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ol(n){let e,l;return e=new It({props:{$$slots:{default:[ro,({M:t,item:i})=>({53:t,54:i}),({M:t,item:i})=>[0,(t?4194304:0)|(i?8388608:0)]]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&12|i[1]&276824064&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function lo(n){let e;return{c(){e=fe("Create Capability")},l(l){e=ue(l,"Create Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function no(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function io(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function ro(n){let e,l,t,i,r,o;return e=new n[53].Title({props:{$$slots:{default:[lo]},$$scope:{ctx:n}}}),t=new n[53].Create({props:{item:n[54],textInput:"Name",textArea:"Description"}}),r=new n[53].Buttons({props:{item:n[54],handleCloseModal:n[24],handleOnSubmit:n[25],$$slots:{cancel:[io],submit:[no]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=S(s),F(t.$$.fragment,s),i=S(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a[1]&268435456&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a[1]&8388608&&(f.item=s[54]),t.$set(f);const u={};a[1]&8388608&&(u.item=s[54]),a[0]&12&&(u.handleCloseModal=s[24]),a[0]&4&&(u.handleOnSubmit=s[25]),a[1]&268435456&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function Ll(n){let e,l;return e=new It({props:{$$slots:{default:[co,({M:t,item:i})=>({53:t,54:i}),({M:t,item:i})=>[0,(t?4194304:0)|(i?8388608:0)]]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&50|i[1]&276824064&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function oo(n){let e;return{c(){e=fe("Create Child Capability")},l(l){e=ue(l,"Create Child Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function so(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function ao(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function co(n){let e,l,t,i,r,o;return e=new n[53].Title({props:{$$slots:{default:[oo]},$$scope:{ctx:n}}}),t=new n[53].Create({props:{item:n[54],textInput:"Name",textArea:"Description"}}),r=new n[53].Buttons({props:{item:n[54],handleCloseModal:n[28],handleOnSubmit:n[29],$$slots:{cancel:[ao],submit:[so]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=S(s),F(t.$$.fragment,s),i=S(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a[1]&268435456&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a[1]&8388608&&(f.item=s[54]),t.$set(f);const u={};a[1]&8388608&&(u.item=s[54]),a[0]&48&&(u.handleCloseModal=s[28]),a[0]&18&&(u.handleOnSubmit=s[29]),a[1]&268435456&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function zl(n){let e,l;return e=new mr({props:{dialog:n[8],title:"Copy Capability From Templates",store:n[0].templates,copyHandler:n[19]}}),e.$on("closeModal",n[32]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&256&&(r.dialog=t[8]),i[0]&1&&(r.store=t[0].templates),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Vl(n){let e,l;return e=new ri({}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function fo(n){var oe;let e,l,t,i,r,o,s,a="LAYERS",c,f,u,d,m,h,p,k,v,M,P,z,D,T,q,O,L,Y,de,le;t=new kt({props:{$$slots:{default:[eo,({H:B})=>({58:B}),({H:B})=>[0,B?134217728:0]]},$$scope:{ctx:n}}}),f=new kt({props:{$$slots:{default:[to,({H:B})=>({58:B}),({H:B})=>[0,B?134217728:0]]},$$scope:{ctx:n}}});let x=qe(((oe=n[10])==null?void 0:oe.includedLayers)||[]),ee=[];for(let B=0;B<x.length;B+=1)ee[B]=Al(ql(n,x,B));const Ie=B=>C(ee[B],1,1,()=>{ee[B]=null});let me=!n[0].isReadonly&&Sl(n);v=new _r({});let U=n[3]&&Ol(n),J=n[5]&&Ll(n),K=n[9]&&zl(n),Q=n[7]&&Vl();return{c(){e=y("main"),l=y("section"),V(t.$$.fragment),i=A(),r=y("section"),o=y("div"),s=y("div"),s.textContent=a,c=A(),u=y("div"),V(f.$$.fragment),d=A();for(let B=0;B<ee.length;B+=1)ee[B].c();m=A(),h=y("div"),me&&me.c(),p=A(),k=y("section"),V(v.$$.fragment),M=A(),P=y("dialog"),U&&U.c(),z=A(),D=y("dialog"),J&&J.c(),T=A(),q=y("dialog"),K&&K.c(),O=A(),L=y("dialog"),Q&&Q.c(),this.h()},l(B){e=w(B,"MAIN",{class:!0});var N=E(e);l=w(N,"SECTION",{id:!0});var R=E(l);F(t.$$.fragment,R),R.forEach(_),i=S(N),r=w(N,"SECTION",{id:!0});var ae=E(r);o=w(ae,"DIV",{id:!0});var Ee=E(o);s=w(Ee,"DIV",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-2ugh1g"&&(s.textContent=a),c=S(Ee),u=w(Ee,"DIV",{style:!0});var $e=E(u);F(f.$$.fragment,$e),Ee.forEach(_),d=S(ae);for(let tt=0;tt<ee.length;tt+=1)ee[tt].l(ae);m=S(ae),h=w(ae,"DIV",{id:!0});var Ue=E(h);me&&me.l(Ue),Ue.forEach(_),ae.forEach(_),p=S(N),k=w(N,"SECTION",{id:!0});var rt=E(k);F(v.$$.fragment,rt),rt.forEach(_),M=S(N),P=w(N,"DIALOG",{id:!0});var ot=E(P);U&&U.l(ot),ot.forEach(_),z=S(N),D=w(N,"DIALOG",{id:!0});var st=E(D);J&&J.l(st),st.forEach(_),T=S(N),q=w(N,"DIALOG",{id:!0});var at=E(q);K&&K.l(at),at.forEach(_),O=S(N),L=w(N,"DIALOG",{id:!0,class:!0});var ct=E(L);Q&&Q.l(ct),ct.forEach(_),N.forEach(_),this.h()},h(){g(l,"id","container-header"),g(s,"class","layer-header-text text-center fancy-font"),ve(u,"display","contents"),ve(u,"--margin","0"),g(o,"id","layer-header"),g(h,"id","capability--btns"),g(r,"id","container-layer"),g(k,"id","container-btns"),P.open=n[3],g(P,"id","capability--dialog"),D.open=n[5],g(D,"id","create--capability--dialog"),q.open=n[9],g(q,"id","capability--dialog"),L.open=n[7],g(L,"id","attack--dialog"),g(L,"class","svelte-1jgw4yd"),g(e,"class","svelte-1jgw4yd")},m(B,N){I(B,e,N),$(e,l),j(t,l,null),$(e,i),$(e,r),$(r,o),$(o,s),$(o,c),$(o,u),j(f,u,null),$(r,d);for(let R=0;R<ee.length;R+=1)ee[R]&&ee[R].m(r,null);$(r,m),$(r,h),me&&me.m(h,null),$(e,p),$(e,k),j(v,k,null),$(e,M),$(e,P),U&&U.m(P,null),n[26](P),$(e,z),$(e,D),J&&J.m(D,null),n[30](D),$(e,T),$(e,q),K&&K.m(q,null),n[33](q),$(e,O),$(e,L),Q&&Q.m(L,null),n[35](L),Y=!0,de||(le=[W(P,"close",n[27]),W(D,"close",n[31]),W(q,"close",n[34]),W(L,"close",n[36])],de=!0)},p(B,N){var Ee;const R={};N[1]&268435456&&(R.$$scope={dirty:N,ctx:B}),t.$set(R);const ae={};if(N[1]&268435456&&(ae.$$scope={dirty:N,ctx:B}),f.$set(ae),N[0]&4195328){x=qe(((Ee=B[10])==null?void 0:Ee.includedLayers)||[]);let $e;for($e=0;$e<x.length;$e+=1){const Ue=ql(B,x,$e);ee[$e]?(ee[$e].p(Ue,N),b(ee[$e],1)):(ee[$e]=Al(Ue),ee[$e].c(),b(ee[$e],1),ee[$e].m(r,m))}for(ie(),$e=x.length;$e<ee.length;$e+=1)Ie($e);re()}B[0].isReadonly?me&&(ie(),C(me,1,1,()=>{me=null}),re()):me?(me.p(B,N),N[0]&1&&b(me,1)):(me=Sl(B),me.c(),b(me,1),me.m(h,null)),B[3]?U?(U.p(B,N),N[0]&8&&b(U,1)):(U=Ol(B),U.c(),b(U,1),U.m(P,null)):U&&(ie(),C(U,1,1,()=>{U=null}),re()),(!Y||N[0]&8)&&(P.open=B[3]),B[5]?J?(J.p(B,N),N[0]&32&&b(J,1)):(J=Ll(B),J.c(),b(J,1),J.m(D,null)):J&&(ie(),C(J,1,1,()=>{J=null}),re()),(!Y||N[0]&32)&&(D.open=B[5]),B[9]?K?(K.p(B,N),N[0]&512&&b(K,1)):(K=zl(B),K.c(),b(K,1),K.m(q,null)):K&&(ie(),C(K,1,1,()=>{K=null}),re()),(!Y||N[0]&512)&&(q.open=B[9]),B[7]?Q?N[0]&128&&b(Q,1):(Q=Vl(),Q.c(),b(Q,1),Q.m(L,null)):Q&&(ie(),C(Q,1,1,()=>{Q=null}),re()),(!Y||N[0]&128)&&(L.open=B[7])},i(B){if(!Y){b(t.$$.fragment,B),b(f.$$.fragment,B);for(let N=0;N<x.length;N+=1)b(ee[N]);b(me),b(v.$$.fragment,B),b(U),b(J),b(K),b(Q),Y=!0}},o(B){C(t.$$.fragment,B),C(f.$$.fragment,B),ee=ee.filter(Boolean);for(let N=0;N<ee.length;N+=1)C(ee[N]);C(me),C(v.$$.fragment,B),C(U),C(J),C(K),C(Q),Y=!1},d(B){B&&_(e),H(t),H(f),We(ee,B),me&&me.d(),H(v),U&&U.d(),n[26](null),J&&J.d(),n[30](null),K&&K.d(),n[33](null),Q&&Q.d(),n[35](null),de=!1,Te(le)}}}function uo(n,e,l){let t,i,r,o,s,a,c;ne(n,_e,X=>l(0,a=X));const{selected:f,editingName:u,selectedD3fendId:d,selectedLayerId:m,selectedLayerColor:h}=xe("profile-config");ne(n,f,X=>l(38,t=X)),ne(n,u,X=>l(42,s=X)),ne(n,d,X=>l(41,o=X)),ne(n,m,X=>l(40,r=X)),ne(n,h,X=>l(39,i=X));const p=Ne(a.profiles[a==null?void 0:a.selectedProfile]);ne(n,p,X=>l(10,c=X));let k,v=null,M,P=!1,z,D=!1,T,q=!1,O,L=!1;const Y=X=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&_e.deleteLayer(X.id)},de=(X,Ce,ye=null)=>{X.detail.event.stopPropagation(),l(1,k=Ce),v=ye,l(5,D=!0),z.showModal()},le=(X,Ce,ye,je=null)=>{if(a.isReadonly)return;const Le=Ce.id;if(t[Le]||Z(f,t[Le]=he.noop,t),ye){t[Le]===he.noop?Z(f,t[Le]=he.root,t):Z(f,t[Le]=he.noop,t);return}X.shiftKey?t[Le]===he.noop?Z(f,t[Le]=he.selected,t):Z(f,t[Le]=he.noop,t):(Object.entries(t).forEach(([Ge,et])=>{Ge===Le?((!et||et===he.noop)&&Z(f,t[Ge]=he.selected,t),et===he.selected&&Z(f,t[Ge]=he.noop,t)):Z(f,t[Ge]=he.noop,t)}),Z(f,t[je.id]=he.root,t))},x=(X,Ce,ye,je)=>{_e.editName(X,ye,je),Z(f,t[X]=he.selected,t),Ce&&Z(f,t[Ce.id]=he.parent,t)},ee=(X,Ce,ye)=>{X.detail.event.stopPropagation(),Z(f,t[Ce.id]=he.editing,t),Z(f,t[ye==null?void 0:ye.id]=he.noop,t),Z(u,s=Ce.name,s)},Ie=(X,Ce,ye)=>{X.detail.event.stopPropagation(),Z(f,t[Ce.id]=he.selected,t),ye&&Z(f,t[ye.id]=he.parent,t),Z(u,s="",s)},me=(X,Ce,ye)=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&_e.deleteSublayer(X,Ce.id,ye)},U=(X,Ce,ye)=>{_e.saveLayerColor(Ce,X.srcElement.value,ye)},J=(X,Ce,ye,je)=>{X.detail.event.stopPropagation(),Z(d,o=Ce,o),Z(m,r=ye,r),Z(h,i=je,i),l(7,q=!0),T.showModal()},K=X=>{l(3,P=!0),M.showModal()},Q=({name:X,description:Ce},ye)=>{const je={id:At(X),name:X,description:Ce,techniques:[],children:[],checked:!1,color:"#0075FF"};_e.addLayer(je),ye.close()},oe=X=>{const{newArray:Ce,mappedIds:ye}=X.reduce((Le,Ge)=>{const et=At(Ge.name);return Le.newArray.push({...Ge,id:et}),Le.mappedIds[Ge.id]=et,Le},{newArray:[],mappedIds:{}}),je=Tn(Ce,ye);_e.bulkAddLayer(je,je[0].id)},B=(X,Ce)=>{Ce.close()},N=({name:X,description:Ce},ye,je,Le)=>{const Ge={id:null,name:X,description:Ce,techniques:[],children:[],checked:!1,color:"#0075FF"};v?_e.addNonRootChild(ye,Ge,je):(Z(f,t[ye.id]=he.root,t),_e.addChild(ye,Ge,je)),Le.close()},R={deleteCapability:Y,showCreateLayerDialog:de,selectLayer:le,saveCapabilityName:x,editCapability:ee,cancelEdit:Ie,deleteChildCapability:me,updateCapabilityColor:U,openAttackDialog:J},ae=X=>K(),Ee=()=>B(P,M),$e=X=>Q(X,M);function Ue(X){De[X?"unshift":"push"](()=>{M=X,l(2,M)})}const rt=()=>l(3,P=!1),ot=()=>B(D,z),st=X=>N(X,k,Ye.layers,z);function at(X){De[X?"unshift":"push"](()=>{z=X,l(4,z)})}const ct=()=>l(5,D=!1),tt=()=>B(L,O);function tn(X){De[X?"unshift":"push"](()=>{O=X,l(8,O)})}const ln=()=>l(9,L=!1);function nn(X){De[X?"unshift":"push"](()=>{T=X,l(6,T)})}const rn=()=>l(7,q=!1);return n.$$.update=()=>{n.$$.dirty[0]&1&&Z(p,c=(a==null?void 0:a.profiles[a==null?void 0:a.selectedProfile])||{name:""},c)},[a,k,M,P,z,D,T,q,O,L,c,f,u,d,m,h,p,K,Q,oe,B,N,R,ae,Ee,$e,Ue,rt,ot,st,at,ct,tt,tn,ln,nn,rn]}class mo extends ge{constructor(e){super(),be(this,e,uo,fo,pe,{},null,[-1,-1])}}function ho(n){let e,l="D3FEND PROFILE";return{c(){e=y("h2"),e.textContent=l,this.h()},l(t){e=w(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-u9fo7w"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function po(n){let e,l,t,i,r;return l=new Ql({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[ho]},$$scope:{ctx:n}}}),{c(){e=y("section"),V(l.$$.fragment),this.h()},l(o){e=w(o,"SECTION",{class:!0});var s=E(e);F(l.$$.fragment,s),s.forEach(_),this.h()},h(){g(e,"class","svelte-qzr7y6")},m(o,s){I(o,e,s),j(l,e,null),r=!0},p(o,[s]){const a={};s&1&&(a.tabs=o[0]),s&2&&(a.activeTabValue=o[1]),s&32&&(a.$$scope={dirty:s,ctx:o}),l.$set(a)},i(o){r||(b(l.$$.fragment,o),o&&Pe(()=>{r&&(i&&i.end(1),t=Xe(e,Oe,{delay:400}),t.start())}),r=!0)},o(o){C(l.$$.fragment,o),t&&t.invalidate(),o&&(i=Tt(e,Oe,{duration:100})),r=!1},d(o){o&&_(e),H(l),o&&i&&i.end()}}}function _o(n,e,l){let t,i,r;ne(n,_e,a=>l(4,i=a));const o=Ne(i.selectedStore);ne(n,o,a=>l(1,r=a));const s=(a,c)=>{Z(o,r=c,r),Z(_e,i.selectedStore=c,i)};return l(0,t=[{label:"Profiles",value:Ye.layers,component:mo}]),[t,r,o,s]}class go extends ge{constructor(e){super(),be(this,e,_o,po,pe,{})}}function bo(n){let e,l,t,i;return e=new n[0].MatrixMappingPopover({props:{store:_e}}),t=new n[0].MatrixCommentToggle({props:{store:_e}}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=S(r),F(t.$$.fragment,r)},m(r,o){j(e,r,o),I(r,l,o),j(t,r,o),i=!0},p:G,i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),i=!1},d(r){r&&_(l),H(e,r),H(t,r)}}}function vo(n){let e,l,t,i;return l=new kt({props:{$$slots:{default:[bo,({H:r})=>({0:r}),({H:r})=>r?1:0]},$$scope:{ctx:n}}}),{c(){e=y("div"),t=y("div"),V(l.$$.fragment),this.h()},l(r){e=w(r,"DIV",{id:!0,class:!0});var o=E(e);t=w(o,"DIV",{style:!0});var s=E(t);F(l.$$.fragment,s),o.forEach(_),this.h()},h(){ve(t,"display","contents"),ve(t,"--flexDir","column-reverse"),ve(t,"--margin","0"),g(e,"id","matrix-controls"),g(e,"class","svelte-1h1ci9x")},m(r,o){I(r,e,o),$(e,t),j(l,t,null),i=!0},p(r,[o]){const s={};o&2&&(s.$$scope={dirty:o,ctx:r}),l.$set(s)},i(r){i||(b(l.$$.fragment,r),i=!0)},o(r){C(l.$$.fragment,r),i=!1},d(r){r&&_(e),H(l)}}}class $o extends ge{constructor(e){super(),be(this,e,null,vo,pe,{})}}function jl(n){var s;let e,l,t,i,r,o;return t=new te({props:{size:33,iconName:(s=n[0])!=null&&s.isDrawerOpen?"arrowLeft":"arrowRight",description:"Profile Controls",title:"Profile Controls",pathColor:"white"}}),{c(){e=y("div"),l=y("span"),V(t.$$.fragment),this.h()},l(a){e=w(a,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var c=E(e);l=w(c,"SPAN",{});var f=E(l);F(t.$$.fragment,f),f.forEach(_),c.forEach(_),this.h()},h(){g(e,"id","drawer-btn"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"class","svelte-9eyiwp")},m(a,c){I(a,e,c),$(e,l),j(t,l,null),i=!0,r||(o=[W(e,"click",n[1]),W(e,"keyup",null)],r=!0)},p(a,c){var u;const f={};c&1&&(f.iconName=(u=a[0])!=null&&u.isDrawerOpen?"arrowLeft":"arrowRight"),t.$set(f)},i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){C(t.$$.fragment,a),i=!1},d(a){a&&_(e),H(t),r=!1,Te(o)}}}function ko(n){var i;let e,l,t=!((i=n[0])!=null&&i.isReadonly)&&jl(n);return{c(){t&&t.c(),e=ke()},l(r){t&&t.l(r),e=ke()},m(r,o){t&&t.m(r,o),I(r,e,o),l=!0},p(r,[o]){var s;(s=r[0])!=null&&s.isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(r,o),o&1&&b(t,1)):(t=jl(r),t.c(),b(t,1),t.m(e.parentNode,e))},i(r){l||(b(t),l=!0)},o(r){C(t),l=!1},d(r){r&&_(e),t&&t.d(r)}}}function Co(n,e,l){let t;return ne(n,_e,r=>l(0,t=r)),[t,()=>{Z(_e,t.isDrawerOpen=!t.isDrawerOpen,t)}]}class yo extends ge{constructor(e){super(),be(this,e,Co,ko,pe,{})}}function Hl(n,e,l){const t=n.slice();return t[3]=e[l],t}function Rl(n){let e,l=qe(n[1].list.map(n[2]).reverse()),t=[];for(let i=0;i<l.length;i+=1)t[i]=Bl(Hl(n,l,i));return{c(){e=y("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);for(let o=0;o<t.length;o+=1)t[o].l(r);r.forEach(_),this.h()},h(){g(e,"id","legend"),g(e,"class","svelte-1pkg19y")},m(i,r){I(i,e,r);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(i,r){if(r&3){l=qe(i[1].list.map(i[2]).reverse());let o;for(o=0;o<l.length;o+=1){const s=Hl(i,l,o);t[o]?t[o].p(s,r):(t[o]=Bl(s),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(i){i&&_(e),We(t,i)}}}function Fl(n){let e,l=n[3].name+"",t,i;return{c(){e=y("div"),t=fe(l),i=A(),this.h()},l(r){e=w(r,"DIV",{class:!0,style:!0});var o=E(e);t=ue(o,l),i=S(o),o.forEach(_),this.h()},h(){g(e,"class","legend-item svelte-1pkg19y"),ve(e,"background",n[3].color)},m(r,o){I(r,e,o),$(e,t),$(e,i)},p(r,o){o&3&&l!==(l=r[3].name+"")&&Me(t,l),o&3&&ve(e,"background",r[3].color)},d(r){r&&_(e)}}}function Bl(n){let e,l=n[3].checked&&Fl(n);return{c(){l&&l.c(),e=ke()},l(t){l&&l.l(t),e=ke()},m(t,i){l&&l.m(t,i),I(t,e,i)},p(t,i){t[3].checked?l?l.p(t,i):(l=Fl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&_(e),l&&l.d(t)}}}function wo(n){var t,i,r;let e,l=((t=n[0])==null?void 0:t.showLegend)&&((i=n[0])==null?void 0:i.techniqueMappingMode)!=="heatMap"&&((r=n[1].list)==null?void 0:r.length)>0&&Rl(n);return{c(){e=y("div"),l&&l.c(),this.h()},l(o){e=w(o,"DIV",{id:!0,class:!0});var s=E(e);l&&l.l(s),s.forEach(_),this.h()},h(){g(e,"id","container-legend"),g(e,"class","svelte-1pkg19y")},m(o,s){I(o,e,s),l&&l.m(e,null)},p(o,[s]){var a,c,f;(a=o[0])!=null&&a.showLegend&&((c=o[0])==null?void 0:c.techniqueMappingMode)!=="heatMap"&&((f=o[1].list)==null?void 0:f.length)>0?l?l.p(o,s):(l=Rl(o),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:G,o:G,d(o){o&&_(e),l&&l.d()}}}function To(n,e,l){let t,i;ne(n,_e,o=>l(0,i=o));const r=o=>i[t.store][o];return n.$$.update=()=>{var o;n.$$.dirty&1&&l(1,t=i.selectedStore===Ye.layers?{list:(o=i==null?void 0:i.profiles[i.selectedProfile])==null?void 0:o.includedLayers,store:Ye.layers}:{list:i==null?void 0:i.rootTemplates,store:Ye.templates})},[i,t,r]}class Eo extends ge{constructor(e){super(),be(this,e,To,wo,pe,{})}}const Io=(n,e)=>{const l={max:0,count:{},highlighted:{}};return dn([n,e],([t,i],r)=>{if(!(i!=null&&i.tree.length)||!n){r(In);return}l.count={},l.highlighted=Object.entries(l.highlighted).reduce((c,[f,u])=>(c[f]=!1,c),{});const{highlightedTechniques:o,techniqueColors:s}=Do(t),a=Object.entries(s).reduce((c,[f,u])=>(c[f]=[...new Set(u)],c),{});o.forEach(c=>{l.highlighted[c]=!0,l.count[c]?l.count[c]+=1:l.count[c]=1}),l.max=Object.values(l.count).reduce((c,f)=>c>f?c:f,-1/0),Object.entries(l.highlighted).forEach(([c,f])=>{if(f){const u=Po[t.techniqueMappingMode]({colors:a[c],count:l.count,max:l.max,technique:c,attack:t.attack});i.treeMap[c].classes.isHighlighted=!0,i.treeMap[c].classes.color=u}else i.treeMap[c].classes.isHighlighted=!1,i.treeMap[c].classes.color=null}),r(i)})},Ul=n=>{const{colors:e}=n,l=e.length,t=l-1,i=(1/l*100).toFixed(1);if(l===1)return e[0];let r="linear-gradient( to right,";for(let o=0;o<l;o++){const s=e[o];if(o===0){r+=` ${s} ${i}%`;continue}if(o===t){r+=`, ${s} ${i*t}%`;continue}r+=`, ${s} ${i*o}% ${i*(o+1)}%`}return r+=")",r},No=n=>{const{count:e,max:l,technique:t}=n,i=e[t]/l*100;return`color-mix(in srgb, green ${i<20?20:i}%, white)`},Mo=n=>{const{colors:e,attack:l,technique:t}=n;for(const i of Object.values(l))if(i[t]){const r=e.length,o=r-1,s=(1/r*100).toFixed(1);if(r===1)return e[0];let a="linear-gradient( to right,";for(let c=0;c<r;c++){const f=e[c];if(c===0){a+=` ${f} ${s}%`;continue}if(c===o){a+=`, ${f} ${s*o}%`;continue}a+=`, ${f} ${s*c}% ${s*(c+1)}%`}return a+=")",a}},Po={[ce.rootColor]:n=>Ul(n),[ce.heatMap]:n=>No(n),[ce.childrenMultiColor]:n=>Ul(n),[ce["ATT&CK"]]:n=>Mo(n)},Do=n=>{var t;let e=(t=n.profiles[n==null?void 0:n.selectedProfile])==null?void 0:t.includedLayers,l=n==null?void 0:n.layers;return n.selectedStore===Ye.templates&&(e=n.rootTemplates,l=n.templates),n.techniqueMappingMode===ce.rootColor?Ct(e,l,!0,0):n.techniqueMappingMode===ce["ATT&CK"]?en(e,l,n.attack,!1,0):Ct(e,l,!1,0)},en=(n=[],e,l,t=!1,i=0,r=null,o=[],s={})=>{const a=i===0||!t;for(let c=0;c<n.length;c++){const f=e[n[c]],u=a?f.color:r,d=i+1;if(f.checked){const m=l[n[c]];m&&Object.keys(m).map(h=>{o.push(h),(s[h]||(s[h]=[]))&&s[h].push(u)})}f.children&&en(f.children,e,l,t,d,u,o,s)}return{highlightedTechniques:o,techniqueColors:s}},Ct=(n=[],e,l,t,i=null,r=[],o={})=>{const s=t===0||!l;for(let a=0;a<n.length;a++){const c=e[n[a]],f=s?c.color:i,u=t+1;c.checked&&(r.push(...c.techniques.map(d=>d.id)),c.techniques.forEach(d=>{(o[d.id]||(o[d.id]=[]))&&o[d.id].push(f)})),c.children&&Ct(c.children,e,l,u,f,r,o)}return{highlightedTechniques:r,techniqueColors:o}},qo=Io(_e,Ke);function Ao(n){let e,l;return e=new go({props:{slot:"drawer"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function So(n){let e,l;return e=new _n({props:{treeStore:qo,theme:"main",slot:"matrix",scroll_indicator:!1}}),e.$on("elementClick",n[6]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Oo(n){let e,l;return e=new $o({props:{slot:"matrixControls"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Lo(n){let e,l;return e=new yo({props:{slot:"sideToggle"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function zo(n){let e,l;return e=new Eo({props:{slot:"legend"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Vo(n){return{c:G,l:G,m:G,p:G,i:G,o:G,d:G}}function jo(n){let e,l,t=n[3]&&Gl(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,r){i[3]?t?(t.p(i,r),r&8&&b(t,1)):(t=Gl(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Gl(n){let e,l="esc",t,i,r,o,s;return i=new vn({props:{technique_id:n[0].technique_id,technique:n[19]}}),{c(){e=y("button"),e.textContent=l,t=A(),V(i.$$.fragment)},l(a){e=w(a,"BUTTON",{"data-svelte-h":!0}),we(e)!=="svelte-1ejhv6h"&&(e.textContent=l),t=S(a),F(i.$$.fragment,a)},m(a,c){I(a,e,c),I(a,t,c),j(i,a,c),r=!0,o||(s=W(e,"click",wt(n[10])),o=!0)},p(a,c){const f={};c&1&&(f.technique_id=a[0].technique_id),c&8&&(f.technique=a[19]),i.$set(f)},i(a){r||(b(i.$$.fragment,a),r=!0)},o(a){C(i.$$.fragment,a),r=!1},d(a){a&&(_(e),_(t)),H(i,a),o=!1,s()}}}function Ho(n){let e,l="loading...";return{c(){e=y("span"),e.textContent=l},l(t){e=w(t,"SPAN",{"data-svelte-h":!0}),we(e)!=="svelte-sermp4"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Ro(n){let e,l,t,i,r,o,s,a,c,f,u,d;e=new gn({props:{title:"D3FEND Profile Studio",og_title:"D3FEND Profile Studio",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Profile Studio lets you organize and communicate your defensive cyber capabilities!"}}),t=new jn({props:{profileConfig:n[4],$$slots:{legend:[zo],sideToggle:[Lo],matrixControls:[Oo],matrix:[So],drawer:[Ao]},$$scope:{ctx:n}}});let m={ctx:n,current:null,token:null,hasCatch:!1,pending:Ho,then:jo,catch:Vo,value:19,blocks:[,,,]};return ht(o=n[3],m),c=new kn({}),{c(){V(e.$$.fragment),l=A(),V(t.$$.fragment),i=A(),r=y("dialog"),m.block.c(),s=A(),a=y("dialog"),V(c.$$.fragment),this.h()},l(h){F(e.$$.fragment,h),l=S(h),F(t.$$.fragment,h),i=S(h),r=w(h,"DIALOG",{class:!0});var p=E(r);m.block.l(p),p.forEach(_),s=S(h),a=w(h,"DIALOG",{class:!0});var k=E(a);F(c.$$.fragment,k),k.forEach(_),this.h()},h(){g(r,"class","technique-dialog"),g(a,"class","iframe-dialog")},m(h,p){j(e,h,p),I(h,l,p),j(t,h,p),I(h,i,p),I(h,r,p),m.block.m(r,m.anchor=null),m.mount=()=>r,m.anchor=null,n[11](r),I(h,s,p),I(h,a,p),j(c,a,null),n[13](a),f=!0,u||(d=[W(r,"close",n[12]),W(a,"close",n[14])],u=!0)},p(h,[p]){n=h;const k={};p&1048576&&(k.$$scope={dirty:p,ctx:n}),t.$set(k),m.ctx=n,p&8&&o!==(o=n[3])&&ht(o,m)||$t(m,n,p)},i(h){f||(b(e.$$.fragment,h),b(t.$$.fragment,h),b(m.block),b(c.$$.fragment,h),f=!0)},o(h){C(e.$$.fragment,h),C(t.$$.fragment,h);for(let p=0;p<3;p+=1){const k=m.blocks[p];C(k)}C(c.$$.fragment,h),f=!1},d(h){h&&(_(l),_(i),_(r),_(s),_(a)),H(e,h),H(t,h),m.block.d(),m.token=null,m=null,n[11](null),H(c),n[13](null),u=!1,Te(d)}}}function Fo(n,e,l){let t,i,r;ne(n,mn,T=>l(9,i=T)),ne(n,_e,T=>l(17,r=T));let{data:o}=e,s,a,c,f=null,u=!1;const d={expanded:Ne({}),expandedTechniques:Ne({}),selected:Ne({}),editingName:Ne(""),isCreateLayerDialogOpen:Ne(!1),colorPicker:Ne({}),selectedD3fendId:Ne(null),selectedLayerId:Ne(null),selectedTechnique:Ne(null),selectedLayerColor:Ne("#e1e1e1"),mappings:Ne(!1)},{selectedD3fendId:m}=d;ne(n,m,T=>l(16,t=T)),Jl(()=>{if(window.location!==window.parent.location&&(u=!0),!u&&r.localStorageWarning&&c.showModal(),l(8,s=document.getElementsByTagName("body")[0]),i.url.searchParams.get("technique_id")){const T=i.url.searchParams.get("technique_id");T&&(l(3,f=k(o.technique_id)),dt(`/profile/?technique_id=${T}`))}if(i.url.searchParams.get("profile")){const T=i.url.searchParams.get("profile"),q=pn.uncrush(T),O=JSON.parse(q);Z(_e,r=O,r)}}),hn(()=>{s==null||s.classList.remove("scroll--none")});const h=T=>{const q=T.detail.element["@id"],{href:O,event:{ctrlKey:L,metaKey:Y}}=T.detail;if(!L&&!Y){if(O){Z(m,t=q,t),l(3,f=k(q)),dt(`/profile/?technique_id=${q}`);return}return}Ke.toggleTechnique(q)},p=T=>{T.close(),dt("/profile/")},k=async T=>{const q=await fetch(`/api/technique/${T}.json`),O=await q.json();if(q.ok)return O;throw new Error(O)},v=()=>p(a);function M(T){De[T?"unshift":"push"](()=>{a=T,l(1,a)})}const P=()=>p(a);function z(T){De[T?"unshift":"push"](()=>{c=T,l(2,c)})}const D=()=>p(c);return n.$$set=T=>{"data"in T&&l(0,o=T.data)},n.$$.update=()=>{n.$$.dirty&770&&(a&&i.url.searchParams.size?(a.showModal(),s==null||s.classList.add("scroll--none")):a&&(a.close(),s==null||s.classList.remove("scroll--none")))},[o,a,c,f,d,m,h,p,s,i,v,M,P,z,D]}class gs extends ge{constructor(e){super(),be(this,e,Fo,Ro,pe,{data:0})}}export{gs as component};
