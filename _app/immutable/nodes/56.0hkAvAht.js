import{e as _t}from"../chunks/index.g5YcAAdQ.js";import{s as pt,b as I,e as p,j as N,d as m,f as y,p as R,i as h,q as w,k as $,l as u,N as lt,P as X,v as mt,o as vt,C as bt,t as O,h as B,B as gt,m as tt,n as j,H as nt,J as kt}from"../chunks/scheduler.CpyzObLs.js";import{h as st,u as Et}from"../chunks/await_block.v2v79I6O.js";import{e as ot}from"../chunks/each.9QANBvbJ.js";import{S as Dt,i as xt,c as Y,b as Q,m as W,t as P,a as F,d as Z,g as ht,e as dt}from"../chunks/index.CTZRj-VU.js";import{H as yt}from"../chunks/Header.jCTqvRC3.js";import{T as Ct}from"../chunks/Title.CJW-ouAc.js";/* empty css                                                    */import{e as wt,S as Tt}from"../chunks/extract.C_YZ3hQR.js";import{G as it}from"../chunks/lib.DCwHEN4o.js";import{p as qt}from"../chunks/stores.CT9xJHfr.js";async function It({fetch:o}){const t=await o("/api/dao/artifacts.json"),r=await t.json();return t.status!==200&&_t(500,data.message),{techniques:r}}const Ut=Object.freeze(Object.defineProperty({__proto__:null,load:It},Symbol.toStringTag,{value:"Module"}));function ct(o,t,r){const e=o.slice();return e[19]=t[r],e}function Nt(o){let t,r=o[22].message+"",e;return{c(){t=p("p"),e=O(r),this.h()},l(l){t=m(l,"P",{style:!0});var s=y(t);e=B(s,r),s.forEach(h),this.h()},h(){gt(t,"color","red")},m(l,s){$(l,t,s),u(t,e)},p(l,s){s&8&&r!==(r=l[22].message+"")&&tt(e,r)},i:j,o:j,d(l){l&&h(t)}}}function $t(o){let t,r,e,l;const s=[At,St],n=[];function i(c,v){return c[18].length>0?0:!c[2]&&c[18].length<1?1:-1}return~(t=i(o))&&(r=n[t]=s[t](o)),{c(){r&&r.c(),e=nt()},l(c){r&&r.l(c),e=nt()},m(c,v){~t&&n[t].m(c,v),$(c,e,v),l=!0},p(c,v){let k=t;t=i(c),t===k?~t&&n[t].p(c,v):(r&&(ht(),F(n[k],1,1,()=>{n[k]=null}),dt()),~t?(r=n[t],r?r.p(c,v):(r=n[t]=s[t](c),r.c()),P(r,1),r.m(e.parentNode,e)):r=null)},i(c){l||(P(r),l=!0)},o(c){F(r),l=!1},d(c){c&&h(e),~t&&n[t].d(c)}}}function St(o){let t,r="No D3FEND Artifacts found in text.";return{c(){t=p("div"),t.textContent=r,this.h()},l(e){t=m(e,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-505pc9"&&(t.textContent=r),this.h()},h(){w(t,"class","card")},m(e,l){$(e,t,l)},p:j,i:j,o:j,d(e){e&&h(t)}}}function At(o){let t,r,e=o[0]&&ft(o);return{c(){t=p("div"),e&&e.c(),this.h()},l(l){t=m(l,"DIV",{class:!0});var s=y(t);e&&e.l(s),s.forEach(h),this.h()},h(){w(t,"class","card")},m(l,s){$(l,t,s),e&&e.m(t,null),r=!0},p(l,s){l[0]?e?(e.p(l,s),s&1&&P(e,1)):(e=ft(l),e.c(),P(e,1),e.m(t,null)):e&&(ht(),F(e,1,1,()=>{e=null}),dt())},i(l){r||(P(e),r=!0)},o(l){F(e),r=!1},d(l){l&&h(t),e&&e.d()}}}function ft(o){let t,r,e,l,s,n,i,c,v=o[0].length+"",k,H,S,E,T;e=new Tt({props:{url:o[4].url}});let q=ot(o[0]),d=[];for(let a=0;a<q.length;a+=1)d[a]=ut(ct(o,q,a));return{c(){t=p("div"),r=p("div"),Y(e.$$.fragment),l=I(),s=p("div"),n=p("b"),i=p("i"),c=O("Extracted "),k=O(v),H=O(" unique IDs:"),S=I(),E=p("dl");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){t=m(a,"DIV",{class:!0});var g=y(t);r=m(g,"DIV",{class:!0});var _=y(r);Q(e.$$.fragment,_),_.forEach(h),g.forEach(h),l=N(a),s=m(a,"DIV",{class:!0});var f=y(s);n=m(f,"B",{});var A=y(n);i=m(A,"I",{});var V=y(i);c=B(V,"Extracted "),k=B(V,v),H=B(V," unique IDs:"),V.forEach(h),A.forEach(h),S=N(f),E=m(f,"DL",{class:!0});var M=y(E);for(let L=0;L<d.length;L+=1)d[L].l(M);M.forEach(h),f.forEach(h),this.h()},h(){w(r,"class","text-right"),w(t,"class","stretch"),w(E,"class","flex flex-wrap svelte-1bg32kq"),w(s,"class","")},m(a,g){$(a,t,g),u(t,r),W(e,r,null),$(a,l,g),$(a,s,g),u(s,n),u(n,i),u(i,c),u(i,k),u(i,H),u(s,S),u(s,E);for(let _=0;_<d.length;_+=1)d[_]&&d[_].m(E,null);T=!0},p(a,g){const _={};if(g&16&&(_.url=a[4].url),e.$set(_),(!T||g&1)&&v!==(v=a[0].length+"")&&tt(k,v),g&1){q=ot(a[0]);let f;for(f=0;f<q.length;f+=1){const A=ct(a,q,f);d[f]?d[f].p(A,g):(d[f]=ut(A),d[f].c(),d[f].m(E,null))}for(;f<d.length;f+=1)d[f].d(1);d.length=q.length}},i(a){T||(P(e.$$.fragment,a),T=!0)},o(a){F(e.$$.fragment,a),T=!1},d(a){a&&(h(t),h(l),h(s)),Z(e),kt(d,a)}}}function ut(o){let t,r,e=o[19]+"",l,s;return{c(){t=p("dd"),r=p("a"),l=O(e),this.h()},l(n){t=m(n,"DD",{});var i=y(t);r=m(i,"A",{href:!0});var c=y(r);l=B(c,e),c.forEach(h),i.forEach(h),this.h()},h(){w(r,"href",s="/dao/artifact/"+o[19])},m(n,i){$(n,t,i),u(t,r),u(r,l)},p(n,i){i&1&&e!==(e=n[19]+"")&&tt(l,e),i&1&&s!==(s="/dao/artifact/"+n[19])&&w(r,"href",s)},d(n){n&&h(t)}}}function Pt(o){let t;return{c(){t=O("enter text and click go")},l(r){t=B(r,"enter text and click go")},m(r,e){$(r,t,e)},p:j,i:j,o:j,d(r){r&&h(t)}}}function Ht(o){let t,r,e,l,s,n,i,c="D3FEND Artifact Extractor",v,k,H=`Extracts D3FEND artifacts from blobs of text. You may also want to try the <a href="/tools/d3fend-extractor">D3FEND Extractor</a>
      or <a href="/tools/attack-extractor">ATT&amp;CK Extractor.</a>`,S,E,T="<i>Paste any text containing D3FEND Artifacts:</i>",q,d,a,g,_,f,A="GO",V,M,L,K,J,z,G,U,et;t=new Ct({props:{title:"D3FEND Artifact Extractor | Tools | "}}),l=new yt({});let x={ctx:o,current:null,token:null,hasCatch:!0,pending:Pt,then:$t,catch:Nt,value:18,error:22,blocks:[,,,]};return st(z=o[3],x),{c(){Y(t.$$.fragment),r=I(),e=p("section"),Y(l.$$.fragment),s=I(),n=p("div"),i=p("h1"),i.textContent=c,v=I(),k=p("p"),k.innerHTML=H,S=I(),E=p("p"),E.innerHTML=T,q=I(),d=p("div"),a=p("textarea"),g=I(),_=p("div"),f=p("button"),f.textContent=A,V=I(),M=p("br"),L=I(),K=p("br"),J=I(),x.block.c(),this.h()},l(D){Q(t.$$.fragment,D),r=N(D),e=m(D,"SECTION",{class:!0});var b=y(e);Q(l.$$.fragment,b),s=N(b),n=m(b,"DIV",{class:!0});var C=y(n);i=m(C,"H1",{"data-svelte-h":!0}),R(i)!=="svelte-1veabte"&&(i.textContent=c),v=N(C),k=m(C,"P",{"data-svelte-h":!0}),R(k)!=="svelte-5bld3z"&&(k.innerHTML=H),S=N(C),E=m(C,"P",{class:!0,"data-svelte-h":!0}),R(E)!=="svelte-16bzqxf"&&(E.innerHTML=T),q=N(C),d=m(C,"DIV",{});var rt=y(d);a=m(rt,"TEXTAREA",{class:!0}),y(a).forEach(h),rt.forEach(h),g=N(C),_=m(C,"DIV",{});var at=y(_);f=m(at,"BUTTON",{class:!0,"data-svelte-h":!0}),R(f)!=="svelte-88k995"&&(f.textContent=A),at.forEach(h),V=N(C),M=m(C,"BR",{}),C.forEach(h),L=N(b),K=m(b,"BR",{}),J=N(b),x.block.l(b),b.forEach(h),this.h()},h(){w(E,"class","text-2"),w(a,"class","svelte-1bg32kq"),w(f,"class","button"),w(n,"class","card"),w(e,"class"," svelte-1bg32kq")},m(D,b){W(t,D,b),$(D,r,b),$(D,e,b),W(l,e,null),u(e,s),u(e,n),u(n,i),u(n,v),u(n,k),u(n,S),u(n,E),u(n,q),u(n,d),u(d,a),lt(a,o[1]),u(n,g),u(n,_),u(_,f),u(n,V),u(n,M),u(e,L),u(e,K),u(e,J),x.block.m(e,x.anchor=null),x.mount=()=>e,x.anchor=null,G=!0,U||(et=[X(a,"input",o[8]),X(a,"keypress",o[6]),X(f,"click",o[5])],U=!0)},p(D,[b]){o=D,b&2&&lt(a,o[1]),x.ctx=o,b&8&&z!==(z=o[3])&&st(z,x)||Et(x,o,b)},i(D){G||(P(t.$$.fragment,D),P(l.$$.fragment,D),P(x.block),G=!0)},o(D){F(t.$$.fragment,D),F(l.$$.fragment,D);for(let b=0;b<3;b+=1){const C=x.blocks[b];F(C)}G=!1},d(D){D&&(h(r),h(e)),Z(t,D),Z(l),x.block.d(),x.token=null,x=null,U=!1,mt(et)}}}function Vt(o,t,r){let e;vt(o,qt,a=>r(4,e=a));let{data:l}=t;const s=new it(l.techniques,{index:!0,index_key:"d3f:d3fend-id"});let n,i="",c=!0,v;v=e.url.searchParams.get("q");let k=[];async function H(a){const g=`/api/dao/artifact/${a}.json`,_=await fetch(g);if(_.status==404)return{id:a,def_to_off:[],description:{graph:[]},status:_.status};if(_.ok){const f=await _.json();return{id:a,def_to_off:f.def_to_off,description:new it(f.description)}}else throw new Error(i)}async function S(){let a=r(0,n=Array.from(new Set(wt(i,s))));return a&&(a.forEach(function(g){let _=H(g);_&&k.push(_)}),e.url.searchParams.set("q",JSON.stringify(a)),history.replaceState(null,"mapping",e.url)),k}let E=S();function T(){r(3,E=S()),r(2,c=!1)}function q(a){a.ctrlKey==!0&&a.keyCode==13&&T()}bt(async()=>{v?(r(1,i=v),T()):r(1,i="")});function d(){i=this.value,r(1,i)}return o.$$set=a=>{"data"in a&&r(7,l=a.data)},[n,i,c,E,e,T,q,l,d]}class Xt extends Dt{constructor(t){super(),xt(this,t,Vt,Ht,pt,{data:7})}}export{Xt as component,Ut as universal};
