import{e as dt}from"../chunks/index.5e2a9a64.js";import{s as pt,a as q,f as p,c as N,g as m,h as y,F as B,d as h,j as w,i as $,x as u,ab as rt,C as X,D as mt,z as vt,o as gt,l as O,m as z,k as bt,n as tt,y as j,e as nt,G as kt}from"../chunks/scheduler.3032ca4b.js";import{h as st,u as Et}from"../chunks/await_block.99b27d44.js";import{e as ot}from"../chunks/each.6507e059.js";import{S as Dt,i as xt,b as Y,d as Q,m as W,a as F,t as H,e as Z,g as ht,c as _t}from"../chunks/index.ee8739bf.js";import{H as yt}from"../chunks/Header.5827f038.js";import{T as Ct}from"../chunks/Title.8f901ed1.js";/* empty css                                                    */import{e as wt,S as Tt}from"../chunks/extract.b47da825.js";import{G as it}from"../chunks/lib.1df5c31c.js";import{p as It}from"../chunks/stores.d382b45a.js";async function qt({fetch:o}){const t=await o("/api/dao/artifacts.json"),a=await t.json();if(t.status!==200)throw dt(500,data.message);return{techniques:a}}const Jt=Object.freeze(Object.defineProperty({__proto__:null,load:qt},Symbol.toStringTag,{value:"Module"}));function ct(o,t,a){const e=o.slice();return e[19]=t[a],e}function Nt(o){let t,a=o[22].message+"",e;return{c(){t=p("p"),e=O(a),this.h()},l(r){t=m(r,"P",{style:!0});var s=y(t);e=z(s,a),s.forEach(h),this.h()},h(){bt(t,"color","red")},m(r,s){$(r,t,s),u(t,e)},p(r,s){s&8&&a!==(a=r[22].message+"")&&tt(e,a)},i:j,o:j,d(r){r&&h(t)}}}function $t(o){let t,a,e,r;const s=[At,St],n=[];function i(c,v){return c[18].length>0?0:!c[2]&&c[18].length<1?1:-1}return~(t=i(o))&&(a=n[t]=s[t](o)),{c(){a&&a.c(),e=nt()},l(c){a&&a.l(c),e=nt()},m(c,v){~t&&n[t].m(c,v),$(c,e,v),r=!0},p(c,v){let k=t;t=i(c),t===k?~t&&n[t].p(c,v):(a&&(ht(),H(n[k],1,1,()=>{n[k]=null}),_t()),~t?(a=n[t],a?a.p(c,v):(a=n[t]=s[t](c),a.c()),F(a,1),a.m(e.parentNode,e)):a=null)},i(c){r||(F(a),r=!0)},o(c){H(a),r=!1},d(c){c&&h(e),~t&&n[t].d(c)}}}function St(o){let t,a="No D3FEND Artifacts found in text.";return{c(){t=p("div"),t.textContent=a,this.h()},l(e){t=m(e,"DIV",{class:!0,"data-svelte-h":!0}),B(t)!=="svelte-505pc9"&&(t.textContent=a),this.h()},h(){w(t,"class","card")},m(e,r){$(e,t,r)},p:j,i:j,o:j,d(e){e&&h(t)}}}function At(o){let t,a,e=o[0]&&ft(o);return{c(){t=p("div"),e&&e.c(),this.h()},l(r){t=m(r,"DIV",{class:!0});var s=y(t);e&&e.l(s),s.forEach(h),this.h()},h(){w(t,"class","card")},m(r,s){$(r,t,s),e&&e.m(t,null),a=!0},p(r,s){r[0]?e?(e.p(r,s),s&1&&F(e,1)):(e=ft(r),e.c(),F(e,1),e.m(t,null)):e&&(ht(),H(e,1,1,()=>{e=null}),_t())},i(r){a||(F(e),a=!0)},o(r){H(e),a=!1},d(r){r&&h(t),e&&e.d()}}}function ft(o){let t,a,e,r,s,n,i,c,v=o[0].length+"",k,P,S,E,T;e=new Tt({props:{url:o[4].url}});let I=ot(o[0]),_=[];for(let l=0;l<I.length;l+=1)_[l]=ut(ct(o,I,l));return{c(){t=p("div"),a=p("div"),Y(e.$$.fragment),r=q(),s=p("div"),n=p("b"),i=p("i"),c=O("Extracted "),k=O(v),P=O(" unique IDs:"),S=q(),E=p("dl");for(let l=0;l<_.length;l+=1)_[l].c();this.h()},l(l){t=m(l,"DIV",{class:!0});var b=y(t);a=m(b,"DIV",{class:!0});var d=y(a);Q(e.$$.fragment,d),d.forEach(h),b.forEach(h),r=N(l),s=m(l,"DIV",{class:!0});var f=y(s);n=m(f,"B",{});var A=y(n);i=m(A,"I",{});var V=y(i);c=z(V,"Extracted "),k=z(V,v),P=z(V," unique IDs:"),V.forEach(h),A.forEach(h),S=N(f),E=m(f,"DL",{class:!0});var M=y(E);for(let L=0;L<_.length;L+=1)_[L].l(M);M.forEach(h),f.forEach(h),this.h()},h(){w(a,"class","text-right"),w(t,"class","stretch"),w(E,"class","flex flex-wrap svelte-1bg32kq"),w(s,"class","")},m(l,b){$(l,t,b),u(t,a),W(e,a,null),$(l,r,b),$(l,s,b),u(s,n),u(n,i),u(i,c),u(i,k),u(i,P),u(s,S),u(s,E);for(let d=0;d<_.length;d+=1)_[d]&&_[d].m(E,null);T=!0},p(l,b){const d={};if(b&16&&(d.url=l[4].url),e.$set(d),(!T||b&1)&&v!==(v=l[0].length+"")&&tt(k,v),b&1){I=ot(l[0]);let f;for(f=0;f<I.length;f+=1){const A=ct(l,I,f);_[f]?_[f].p(A,b):(_[f]=ut(A),_[f].c(),_[f].m(E,null))}for(;f<_.length;f+=1)_[f].d(1);_.length=I.length}},i(l){T||(F(e.$$.fragment,l),T=!0)},o(l){H(e.$$.fragment,l),T=!1},d(l){l&&(h(t),h(r),h(s)),Z(e),kt(_,l)}}}function ut(o){let t,a,e=o[19]+"",r,s;return{c(){t=p("dd"),a=p("a"),r=O(e),this.h()},l(n){t=m(n,"DD",{});var i=y(t);a=m(i,"A",{href:!0});var c=y(a);r=z(c,e),c.forEach(h),i.forEach(h),this.h()},h(){w(a,"href",s="/dao/artifact/"+o[19])},m(n,i){$(n,t,i),u(t,a),u(a,r)},p(n,i){i&1&&e!==(e=n[19]+"")&&tt(r,e),i&1&&s!==(s="/dao/artifact/"+n[19])&&w(a,"href",s)},d(n){n&&h(t)}}}function Ft(o){let t;return{c(){t=O("enter text and click go")},l(a){t=z(a,"enter text and click go")},m(a,e){$(a,t,e)},p:j,i:j,o:j,d(a){a&&h(t)}}}function Pt(o){let t,a,e,r,s,n,i,c="D3FEND Artifact Extractor",v,k,P=`Extracts D3FEND artifacts from blobs of text. You may also want to try the <a href="/tools/d3fend-extractor">D3FEND Extractor</a>
      or <a href="/tools/attack-extractor">ATT&amp;CK Extractor.</a>`,S,E,T="<i>Paste any text containing D3FEND Artifacts:</i>",I,_,l,b,d,f,A="GO",V,M,L,K,U,G,R,J,et;t=new Ct({props:{title:"D3FEND Artifact Extractor | Tools | "}}),r=new yt({});let x={ctx:o,current:null,token:null,hasCatch:!0,pending:Ft,then:$t,catch:Nt,value:18,error:22,blocks:[,,,]};return st(G=o[3],x),{c(){Y(t.$$.fragment),a=q(),e=p("section"),Y(r.$$.fragment),s=q(),n=p("div"),i=p("h1"),i.textContent=c,v=q(),k=p("p"),k.innerHTML=P,S=q(),E=p("p"),E.innerHTML=T,I=q(),_=p("div"),l=p("textarea"),b=q(),d=p("div"),f=p("button"),f.textContent=A,V=q(),M=p("br"),L=q(),K=p("br"),U=q(),x.block.c(),this.h()},l(D){Q(t.$$.fragment,D),a=N(D),e=m(D,"SECTION",{class:!0});var g=y(e);Q(r.$$.fragment,g),s=N(g),n=m(g,"DIV",{class:!0});var C=y(n);i=m(C,"H1",{"data-svelte-h":!0}),B(i)!=="svelte-1veabte"&&(i.textContent=c),v=N(C),k=m(C,"P",{"data-svelte-h":!0}),B(k)!=="svelte-5bld3z"&&(k.innerHTML=P),S=N(C),E=m(C,"P",{class:!0,"data-svelte-h":!0}),B(E)!=="svelte-16bzqxf"&&(E.innerHTML=T),I=N(C),_=m(C,"DIV",{});var at=y(_);l=m(at,"TEXTAREA",{class:!0}),y(l).forEach(h),at.forEach(h),b=N(C),d=m(C,"DIV",{});var lt=y(d);f=m(lt,"BUTTON",{class:!0,"data-svelte-h":!0}),B(f)!=="svelte-88k995"&&(f.textContent=A),lt.forEach(h),V=N(C),M=m(C,"BR",{}),C.forEach(h),L=N(g),K=m(g,"BR",{}),U=N(g),x.block.l(g),g.forEach(h),this.h()},h(){w(E,"class","text-2"),w(l,"class","svelte-1bg32kq"),w(f,"class","button"),w(n,"class","card"),w(e,"class"," svelte-1bg32kq")},m(D,g){W(t,D,g),$(D,a,g),$(D,e,g),W(r,e,null),u(e,s),u(e,n),u(n,i),u(n,v),u(n,k),u(n,S),u(n,E),u(n,I),u(n,_),u(_,l),rt(l,o[1]),u(n,b),u(n,d),u(d,f),u(n,V),u(n,M),u(e,L),u(e,K),u(e,U),x.block.m(e,x.anchor=null),x.mount=()=>e,x.anchor=null,R=!0,J||(et=[X(l,"input",o[8]),X(l,"keypress",o[6]),X(f,"click",o[5])],J=!0)},p(D,[g]){o=D,g&2&&rt(l,o[1]),x.ctx=o,g&8&&G!==(G=o[3])&&st(G,x)||Et(x,o,g)},i(D){R||(F(t.$$.fragment,D),F(r.$$.fragment,D),F(x.block),R=!0)},o(D){H(t.$$.fragment,D),H(r.$$.fragment,D);for(let g=0;g<3;g+=1){const C=x.blocks[g];H(C)}R=!1},d(D){D&&(h(a),h(e)),Z(t,D),Z(r),x.block.d(),x.token=null,x=null,J=!1,mt(et)}}}function Vt(o,t,a){let e;vt(o,It,l=>a(4,e=l));let{data:r}=t;const s=new it(r.techniques,{index:!0,index_key:"d3f:d3fend-id"});let n,i="",c=!0,v;v=e.url.searchParams.get("q"),console.log("Found params: "+v);let k=[];async function P(l){const b=`/api/dao/artifact/${l}.json`,d=await fetch(b);if(d.status==404)return{id:l,def_to_off:[],description:{graph:[]},status:d.status};if(d.ok){const f=await d.json();return{id:l,def_to_off:f.def_to_off,description:new it(f.description)}}else throw new Error(i)}async function S(){let l=a(0,n=Array.from(new Set(wt(i,s))));return l&&(l.forEach(function(b){let d=P(b);d&&k.push(d)}),e.url.searchParams.set("q",JSON.stringify(l)),history.replaceState(null,"mapping",e.url)),k}let E=S();function T(){a(3,E=S()),a(2,c=!1)}function I(l){l.ctrlKey==!0&&l.keyCode==13&&T()}gt(async()=>{v?(a(1,i=v),console.log("handlingclick"),T()):(console.log("starting blank"),a(1,i=""))});function _(){i=this.value,a(1,i)}return o.$$set=l=>{"data"in l&&a(7,r=l.data)},[n,i,c,E,e,T,I,r,_]}class Xt extends Dt{constructor(t){super(),xt(this,t,Vt,Pt,pt,{data:7})}}export{Xt as component,Jt as universal};
