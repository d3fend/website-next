import{s as pe,G as ke,k as I,i as _,o as ne,am as sn,c as He,e as y,b as S,d as w,f as E,j as A,q as g,D as se,B as ve,l as k,u as Re,g as Fe,a as Be,a0 as De,I as We,ao as an,t as fe,h as ue,S as Mt,O as W,m as Me,v as Te,R as Dt,ak as cn,ap as xe,p as we,F as Pe,n as G,V as yt,N as Y,w as fn,r as Ve,M as ze,aq as mt,ar as Jl,C as Wl,a4 as Qe,W as un,al as nt,Y as Yl,a3 as wt,as as dn}from"../chunks/scheduler.XFNaxh87.js";import{h as ht,u as $t}from"../chunks/await_block.CIfzu5Tj.js";import{S as ge,i as be,t as b,g as ie,a as C,e as re,p as Ae,c as V,b as F,m as j,d as H,h as Xe,j as Tt,f as Et}from"../chunks/index.CZJgJfrq.js";import{w as Ne,d as mn}from"../chunks/index.BQBQGMgF.js";import{p as hn}from"../chunks/stores.Dm656rTj.js";import{g as dt,b as pn}from"../chunks/entry.NSWEnHCd.js";import{D as _n}from"../chunks/D3FMatrix.9LLfhj3K.js";import{T as gn}from"../chunks/Title.CR5zmqnh.js";import{R as bn,T as vn}from"../chunks/Technique.Dp67zlAQ.js";import{s as $n,L as kn}from"../chunks/dialog.Clx1C0V2.js";import{l as _e,T as Pt,M as ce,s as Cn,j as yn,S as he,P as Ze}from"../chunks/layers.Ck_uwp_1.js";import{s as Ye,a as Oe,f as it}from"../chunks/index.C12qWex4.js";import{e as qe}from"../chunks/each.BM1lhngx.js";import{f as Je,a as qt,b as wn,c as St,m as Tn}from"../chunks/utils.xEKteSAW.js";import{S as Zl}from"../chunks/SimpleAutocomplete.DVzco0gJ.js";import{I as te,c as En,o as In,s as Nn}from"../chunks/Loading.CTph8kEV.js";import{c as At}from"../chunks/lib.CUWECZYK.js";/* empty css                             */import{a as Ke,T as Mn}from"../chunks/updateDefendTree.DKly-qUc.js";import{c as Dn,f as Ql}from"../chunks/actions.Db2EBVbi.js";import"../chunks/marked.esm.D23x4JZT.js";import"../chunks/Button.CL5AIWOv.js";/* empty css                                                    *//* empty css                                                      */import"../chunks/index.g5YcAAdQ.js";import"../chunks/config.-RkEKRcG.js";const Pn={crush:(n,e=50)=>{const l="",t=(a,c)=>{let f=c.length,u="";const d=p=>encodeURI(encodeURIComponent(p)).replace(/%../g,"i").length,m=p=>{let $=p.charCodeAt(0),v=p.charCodeAt(p.length-1);return $>=56320&&$<=57343||v>=55296&&v<=56319};let h={};for(let p=2;p<e;p++)for(let $=0;$<a.length-p;++$){let v=a.substr($,p);if(h[v]||m(v))continue;let N=1;for(let M=a.indexOf(v,$+p);M>=0;++N)M=a.indexOf(v,M+p);N>1&&(h[v]=N)}for(;;){for(;f--&&a.includes(c[f]););if(f<0)break;let p=c[f],$,v=0,N=d(p);for(let L in h){let P=h[L],T=(P-1)*d(L)-(P+1)*N;u.length||(T-=d(l)),T<=0?delete h[L]:T>v&&($=L,v=T)}if(!$)break;a=a.split($).join(p)+p+$,u=p+u;let M={};for(let L in h){let P=L.split($).join(p),T=0;for(let q=a.indexOf(P);q>=0;++T)q=a.indexOf(P,q+P.length);T>1&&(M[P]=T)}h=M}return{a,b:u}};let i=[];const r="-_.!~*'()";for(let a=127;--a;)(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||r.includes(String.fromCharCode(a)))&&i.push(String.fromCharCode(a));for(let a=32;a<255;++a){let c=String.fromCharCode(a);c!="\\"&&!i.includes(c)&&i.unshift(c)}n=n.replace(new RegExp(l,"g"),""),n=Ot(n);const o=t(n,i);let s=o.a;return o.b.length&&(s+=l+o.b),s+="_",s},uncrush:n=>{n=n.substring(0,n.length-1);const e=n.split("");let l=e[0];if(e.length>1){let t=e[1];for(let i of t){let r=l.split(i);l=r.join(r.pop())}}return Ot(l,0)}},Ot=(n,e=1)=>{const l=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],t=(i,r)=>{let o=new RegExp(`${(r[2]?r[2]:"")+r[0]}|${(r[3]?r[3]:"")+r[1]}`,"g");return i.replace(o,s=>s===r[0]?r[1]:r[0])};if(e)for(let i=0;i<l.length;++i)n=t(n,l[i]);else for(let i=l.length;i--;)n=t(n,l[i]);return n},Lt=(n,e=[])=>{let l=()=>{};for(let{query:t,transition:i,...r}of e)if(window.matchMedia(t).matches)return i(n,r);return l},qn=n=>({}),zt=n=>({}),Sn=n=>({}),Vt=n=>({}),An=n=>({}),jt=n=>({}),On=n=>({}),Ht=n=>({id:"matrix-slot"}),Ln=n=>({}),Rt=n=>({id:"drawer-content"});function Ft(n){let e,l,t,i,r,o,s,a=n[0].isDrawerOpen&&Bt(n);const c=n[3].matrix,f=He(c,n,n[2],Ht),u=n[3].legend,d=He(u,n,n[2],jt),m=n[3].matrixControls,h=He(m,n,n[2],Vt),p=n[3].sideToggle,$=He(p,n,n[2],zt);return{c(){e=y("main"),a&&a.c(),l=S(),t=y("section"),f&&f.c(),i=S(),d&&d.c(),r=S(),h&&h.c(),o=S(),$&&$.c(),this.h()},l(v){e=w(v,"MAIN",{style:!0,class:!0});var N=E(e);a&&a.l(N),l=A(N),t=w(N,"SECTION",{id:!0,class:!0});var M=E(t);f&&f.l(M),i=A(M),d&&d.l(M),r=A(M),h&&h.l(M),o=A(M),$&&$.l(M),M.forEach(_),N.forEach(_),this.h()},h(){g(t,"id","container-matrix"),g(t,"class","svelte-mlvs39"),se(t,"expand-matrix",n[0].isDrawerOpen),ve(e,"--drawer-width",Vn),ve(e,"--ANIMATION_TIMING",lt),g(e,"class","svelte-mlvs39")},m(v,N){I(v,e,N),a&&a.m(e,null),k(e,l),k(e,t),f&&f.m(t,null),k(t,i),d&&d.m(t,null),k(t,r),h&&h.m(t,null),k(t,o),$&&$.m(t,null),s=!0},p(v,N){v[0].isDrawerOpen?a?(a.p(v,N),N&1&&b(a,1)):(a=Bt(v),a.c(),b(a,1),a.m(e,l)):a&&(ie(),C(a,1,1,()=>{a=null}),re()),f&&f.p&&(!s||N&4)&&Re(f,c,v,v[2],s?Be(c,v[2],N,On):Fe(v[2]),Ht),d&&d.p&&(!s||N&4)&&Re(d,u,v,v[2],s?Be(u,v[2],N,An):Fe(v[2]),jt),h&&h.p&&(!s||N&4)&&Re(h,m,v,v[2],s?Be(m,v[2],N,Sn):Fe(v[2]),Vt),$&&$.p&&(!s||N&4)&&Re($,p,v,v[2],s?Be(p,v[2],N,qn):Fe(v[2]),zt),(!s||N&1)&&se(t,"expand-matrix",v[0].isDrawerOpen)},i(v){s||(b(a),b(f,v),b(d,v),b(h,v),b($,v),s=!0)},o(v){C(a),C(f,v),C(d,v),C(h,v),C($,v),s=!1},d(v){v&&_(e),a&&a.d(),f&&f.d(v),d&&d.d(v),h&&h.d(v),$&&$.d(v)}}}function Bt(n){let e,l,t;const i=n[3].drawer,r=He(i,n,n[2],Rt);return{c(){e=y("aside"),r&&r.c(),this.h()},l(o){e=w(o,"ASIDE",{id:!0,class:!0});var s=E(e);r&&r.l(s),s.forEach(_),this.h()},h(){g(e,"id","container-drawer"),g(e,"class","svelte-mlvs39"),se(e,"drawer-closed",!n[0].isDrawerOpen)},m(o,s){I(o,e,s),r&&r.m(e,null),t=!0},p(o,s){n=o,r&&r.p&&(!t||s&4)&&Re(r,i,n,n[2],t?Be(i,n[2],s,Ln):Fe(n[2]),Rt),(!t||s&1)&&se(e,"drawer-closed",!n[0].isDrawerOpen)},i(o){t||(b(r,o),o&&De(()=>{t&&(l||(l=Ae(e,Lt,[{query:"(min-width: 501px)",transition:Ye,duration:lt,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:Ye,duration:lt,axis:"y"}],!0)),l.run(1))}),t=!0)},o(o){C(r,o),o&&(l||(l=Ae(e,Lt,[{query:"(min-width: 501px)",transition:Ye,duration:lt,axis:"x"},{query:"(max-width: 500px), screen and (orientation: portrait)",transition:Ye,duration:lt,axis:"y"}],!1)),l.run(0)),t=!1},d(o){o&&_(e),r&&r.d(o),o&&l&&l.end()}}}function zn(n){let e,l,t=n[0]&&Ft(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[0]?t?(t.p(i,r),r&1&&b(t,1)):(t=Ft(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}const Se=28,pt=33,lt=1e3;let Vn="25vw";function jn(n,e,l){let t;ne(n,_e,s=>l(0,t=s));let{$$slots:i={},$$scope:r}=e,{profileConfig:o}=e;return sn("profile-config",o),n.$$set=s=>{"profileConfig"in s&&l(1,o=s.profileConfig),"$$scope"in s&&l(2,r=s.$$scope)},[t,o,r,i]}class Hn extends ge{constructor(e){super(),be(this,e,jn,zn,pe,{profileConfig:1})}}function Ut(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Gt(n,e,l){const t=n.slice();return t[10]=e[l],t}const Rn=n=>({}),Kt=n=>({});function Jt(n){let e,l;const t=n[6].header,i=He(t,n,n[5],Kt);return{c(){e=y("div"),i&&i.c(),this.h()},l(r){e=w(r,"DIV",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","header"),g(e,"class","svelte-zl7ap5")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,o){i&&i.p&&(!l||o&32)&&Re(i,t,r,r[5],l?Be(t,r[5],o,Rn):Fe(r[5]),Kt)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function Wt(n){let e,l,t=n[10].label+"",i,r,o,s,a;function c(...u){return n[7](n[10],...u)}function f(...u){return n[8](n[10],...u)}return{c(){e=y("li"),l=y("span"),i=fe(t),r=S(),this.h()},l(u){e=w(u,"LI",{class:!0});var d=E(e);l=w(d,"SPAN",{role:!0,tabindex:!0,class:!0});var m=E(l);i=ue(m,t),m.forEach(_),r=A(d),d.forEach(_),this.h()},h(){g(l,"role","menuitem"),g(l,"tabindex","0"),g(l,"class","svelte-zl7ap5"),g(e,"class",o=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")},m(u,d){I(u,e,d),k(e,l),k(l,i),k(e,r),s||(a=[W(l,"click",c),W(l,"keydown",f)],s=!0)},p(u,d){n=u,d&1&&t!==(t=n[10].label+"")&&Me(i,t),d&3&&o!==(o=Mt(n[1]===n[10].value?"active":"")+" svelte-zl7ap5")&&g(e,"class",o)},d(u){u&&_(e),s=!1,Te(a)}}}function Yt(n){let e,l,t,i,r,o,s;var a=n[10].component;function c(f,u){return{props:{component:f[0][f[12]],containerHeight:f[3]}}}return a&&(l=Dt(a,c(n))),{c(){e=y("div"),l&&V(l.$$.fragment),t=S(),this.h()},l(f){e=w(f,"DIV",{class:!0});var u=E(e);l&&F(l.$$.fragment,u),t=A(u),u.forEach(_),this.h()},h(){g(e,"class","tab svelte-zl7ap5"),De(()=>n[9].call(e))},m(f,u){I(f,e,u),l&&j(l,e,null),k(e,t),i=cn(e,n[9].bind(e)),s=!0},p(f,u){if(u&1&&a!==(a=f[10].component)){if(l){ie();const d=l;C(d.$$.fragment,1,0,()=>{H(d,1)}),re()}a?(l=Dt(a,c(f)),V(l.$$.fragment),b(l.$$.fragment,1),j(l,e,t)):l=null}else if(a){const d={};u&1&&(d.component=f[0][f[12]]),u&8&&(d.containerHeight=f[3]),l.$set(d)}},i(f){s||(l&&b(l.$$.fragment,f),f&&De(()=>{s&&(o&&o.end(1),r=Xe(e,Oe,{duration:400,delay:400}),r.start())}),s=!0)},o(f){l&&C(l.$$.fragment,f),r&&r.invalidate(),f&&(o=Tt(e,Oe,{duration:400})),s=!1},d(f){f&&_(e),l&&H(l),i(),f&&o&&o.end()}}}function Zt(n){let e,l,t=n[1]===n[10].value&&Yt(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,r){i[1]===i[10].value?t?(t.p(i,r),r&3&&b(t,1)):(t=Yt(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Fn(n){let e,l,t,i,r,o=n[4].header&&Jt(n),s=qe(n[0]),a=[];for(let d=0;d<s.length;d+=1)a[d]=Wt(Gt(n,s,d));let c=qe(n[0]),f=[];for(let d=0;d<c.length;d+=1)f[d]=Zt(Ut(n,c,d));const u=d=>C(f[d],1,1,()=>{f[d]=null});return{c(){e=y("section"),o&&o.c(),l=S(),t=y("ul");for(let d=0;d<a.length;d+=1)a[d].c();i=S();for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){e=w(d,"SECTION",{id:!0,class:!0});var m=E(e);o&&o.l(m),l=A(m),t=w(m,"UL",{class:!0});var h=E(t);for(let p=0;p<a.length;p+=1)a[p].l(h);h.forEach(_),i=A(m);for(let p=0;p<f.length;p+=1)f[p].l(m);m.forEach(_),this.h()},h(){g(t,"class","svelte-zl7ap5"),g(e,"id","tabs--container"),g(e,"class","svelte-zl7ap5")},m(d,m){I(d,e,m),o&&o.m(e,null),k(e,l),k(e,t);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(t,null);k(e,i);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(e,null);r=!0},p(d,[m]){if(d[4].header?o?(o.p(d,m),m&16&&b(o,1)):(o=Jt(d),o.c(),b(o,1),o.m(e,l)):o&&(ie(),C(o,1,1,()=>{o=null}),re()),m&7){s=qe(d[0]);let h;for(h=0;h<s.length;h+=1){const p=Gt(d,s,h);a[h]?a[h].p(p,m):(a[h]=Wt(p),a[h].c(),a[h].m(t,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=s.length}if(m&11){c=qe(d[0]);let h;for(h=0;h<c.length;h+=1){const p=Ut(d,c,h);f[h]?(f[h].p(p,m),b(f[h],1)):(f[h]=Zt(p),f[h].c(),b(f[h],1),f[h].m(e,null))}for(ie(),h=c.length;h<f.length;h+=1)u(h);re()}},i(d){if(!r){b(o);for(let m=0;m<c.length;m+=1)b(f[m]);r=!0}},o(d){C(o),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)C(f[m]);r=!1},d(d){d&&_(e),o&&o.d(),We(a,d),We(f,d)}}}function Bn(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=an(t);let{tabs:o=[]}=e,{activeTabValue:s}=e,{clickTab:a}=e,c;const f=(m,h)=>a(h,m.value),u=(m,h)=>Je(h,a,m.value);function d(){c=this.clientHeight,l(3,c)}return n.$$set=m=>{"tabs"in m&&l(0,o=m.tabs),"activeTabValue"in m&&l(1,s=m.activeTabValue),"clickTab"in m&&l(2,a=m.clickTab),"$$scope"in m&&l(5,i=m.$$scope)},[o,s,a,c,r,i,t,f,u,d]}class Xl extends ge{constructor(e){super(),be(this,e,Bn,Fn,pe,{tabs:0,activeTabValue:1,clickTab:2})}}function Qt(n,e,l){const t=n.slice();return t[34]=e[l],t}function Un(n){return{c:G,l:G,m:G,p:G,i:G,o:G,d:G}}function Gn(n){let e,l,t,i,r,o;function s(d){n[21](d)}let a={items:Object.values(n[37]),labelFunction:n[19],keywordsFunction:n[20],placeholder:"ATT&CK Lookup"};n[4]!==void 0&&(a.selectedItem=n[4]),l=new Zl({props:a}),Pe.push(()=>Et(l,"selectedItem",s));function c(d,m){return d[4]?Kn:Jn}let f=c(n),u=f(n);return{c(){e=y("span"),V(l.$$.fragment),i=S(),u.c(),r=ke(),this.h()},l(d){e=w(d,"SPAN",{id:!0});var m=E(e);F(l.$$.fragment,m),m.forEach(_),i=A(d),u.l(d),r=ke(),this.h()},h(){g(e,"id","offensive")},m(d,m){I(d,e,m),j(l,e,null),I(d,i,m),u.m(d,m),I(d,r,m),o=!0},p(d,m){const h={};!t&&m[0]&16&&(t=!0,h.selectedItem=d[4],yt(()=>t=!1)),l.$set(h),f===(f=c(d))&&u?u.p(d,m):(u.d(1),u=f(d),u&&(u.c(),u.m(r.parentNode,r)))},i(d){o||(b(l.$$.fragment,d),o=!0)},o(d){C(l.$$.fragment,d),o=!1},d(d){d&&(_(e),_(i),_(r)),H(l),u.d(d)}}}function Kn(n){let e,l,t="Justification:",i,r,o,s,a="save",c,f;return{c(){e=y("div"),l=y("label"),l.textContent=t,i=S(),r=y("input"),o=S(),s=y("button"),s.textContent=a,this.h()},l(u){e=w(u,"DIV",{});var d=E(e);l=w(d,"LABEL",{for:!0,"data-svelte-h":!0}),we(l)!=="svelte-u8h1xa"&&(l.textContent=t),i=A(d),r=w(d,"INPUT",{id:!0,type:!0}),o=A(d),s=w(d,"BUTTON",{"data-svelte-h":!0}),we(s)!=="svelte-4u68nx"&&(s.textContent=a),d.forEach(_),this.h()},h(){g(l,"for","attack--justification"),g(r,"id","attack--justification"),g(r,"type","text")},m(u,d){I(u,e,d),k(e,l),k(e,i),k(e,r),n[22](r),k(e,o),k(e,s),c||(f=W(s,"click",n[14]),c=!0)},p:G,d(u){u&&_(e),n[22](null),c=!1,f()}}}function Jn(n){let e,l="<i>Select ATT&amp;CK Technique to associate to Layer</i>";return{c(){e=y("span"),e.innerHTML=l},l(t){e=w(t,"SPAN",{"data-svelte-h":!0}),we(e)!=="svelte-1d39b1v"&&(e.innerHTML=l)},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function Wn(n){let e;return{c(){e=fe("...loading")},l(l){e=ue(l,"...loading")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function Xt(n){let e,l,t,i='<th class="svelte-pjnk5u">ID</th> <th class="svelte-pjnk5u">Tactic</th> <th class="svelte-pjnk5u">Technique</th> <th class="svelte-pjnk5u">SubTechnique</th> <th class="svelte-pjnk5u">Justification</th> <th class="svelte-pjnk5u"></th>',r,o,s,a=qe(n[2]),c=[];for(let u=0;u<a.length;u+=1)c[u]=xt(Qt(n,a,u));const f=u=>C(c[u],1,1,()=>{c[u]=null});return{c(){e=y("section"),l=y("table"),t=y("thead"),t.innerHTML=i,r=S(),o=y("tbody");for(let u=0;u<c.length;u+=1)c[u].c();this.h()},l(u){e=w(u,"SECTION",{});var d=E(e);l=w(d,"TABLE",{class:!0});var m=E(l);t=w(m,"THEAD",{"data-svelte-h":!0}),we(t)!=="svelte-1rtdzpr"&&(t.innerHTML=i),r=A(m),o=w(m,"TBODY",{});var h=E(o);for(let p=0;p<c.length;p+=1)c[p].l(h);h.forEach(_),m.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u")},m(u,d){I(u,e,d),k(e,l),k(l,t),k(l,r),k(l,o);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(o,null);s=!0},p(u,d){if(d[0]&32772){a=qe(u[2]);let m;for(m=0;m<a.length;m+=1){const h=Qt(u,a,m);c[m]?(c[m].p(h,d),b(c[m],1)):(c[m]=xt(h),c[m].c(),b(c[m],1),c[m].m(o,null))}for(ie(),m=a.length;m<c.length;m+=1)f(m);re()}},i(u){if(!s){for(let d=0;d<a.length;d+=1)b(c[d]);s=!0}},o(u){c=c.filter(Boolean);for(let d=0;d<c.length;d+=1)C(c[d]);s=!1},d(u){u&&_(e),We(c,u)}}}function xt(n){let e,l,t=n[34].id.replace("d3f:","")+"",i,r,o,s=n[34].tactic+"",a,c,f,u=n[34].technique+"",d,m,h,p=(n[34].subTechnique||"")+"",$,v,N,M=(n[34].justification||"")+"",L,P,T,q,O,z,Z,de;return q=new te({props:{size:33,iconName:"edit",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),q.$on("iconClick",n[23]),z=new te({props:{size:33,iconName:"delete",description:"Edit Justification",title:"Edit Justification",disabled:!0}}),z.$on("iconClick",n[24]),{c(){e=y("tr"),l=y("td"),i=fe(t),r=S(),o=y("td"),a=fe(s),c=S(),f=y("td"),d=fe(u),m=S(),h=y("td"),$=fe(p),v=S(),N=y("td"),L=fe(M),P=S(),T=y("td"),V(q.$$.fragment),O=S(),V(z.$$.fragment),Z=S(),this.h()},l(le){e=w(le,"TR",{});var x=E(e);l=w(x,"TD",{class:!0});var ee=E(l);i=ue(ee,t),ee.forEach(_),r=A(x),o=w(x,"TD",{class:!0});var Ie=E(o);a=ue(Ie,s),Ie.forEach(_),c=A(x),f=w(x,"TD",{class:!0});var me=E(f);d=ue(me,u),me.forEach(_),m=A(x),h=w(x,"TD",{class:!0});var U=E(h);$=ue(U,p),U.forEach(_),v=A(x),N=w(x,"TD",{class:!0});var J=E(N);L=ue(J,M),J.forEach(_),P=A(x),T=w(x,"TD",{class:!0});var K=E(T);F(q.$$.fragment,K),O=A(K),F(z.$$.fragment,K),K.forEach(_),Z=A(x),x.forEach(_),this.h()},h(){g(l,"class","svelte-pjnk5u"),g(o,"class","svelte-pjnk5u"),g(f,"class","svelte-pjnk5u"),g(h,"class","svelte-pjnk5u"),g(N,"class","svelte-pjnk5u"),g(T,"class","table--no--border svelte-pjnk5u")},m(le,x){I(le,e,x),k(e,l),k(l,i),k(e,r),k(e,o),k(o,a),k(e,c),k(e,f),k(f,d),k(e,m),k(e,h),k(h,$),k(e,v),k(e,N),k(N,L),k(e,P),k(e,T),j(q,T,null),k(T,O),j(z,T,null),k(e,Z),de=!0},p(le,x){(!de||x[0]&4)&&t!==(t=le[34].id.replace("d3f:","")+"")&&Me(i,t),(!de||x[0]&4)&&s!==(s=le[34].tactic+"")&&Me(a,s),(!de||x[0]&4)&&u!==(u=le[34].technique+"")&&Me(d,u),(!de||x[0]&4)&&p!==(p=(le[34].subTechnique||"")+"")&&Me($,p),(!de||x[0]&4)&&M!==(M=(le[34].justification||"")+"")&&Me(L,M)},i(le){de||(b(q.$$.fragment,le),b(z.$$.fragment,le),de=!0)},o(le){C(q.$$.fragment,le),C(z.$$.fragment,le),de=!1},d(le){le&&_(e),H(q),H(z)}}}function Yn(n){let e,l="Something Went Wrong";return{c(){e=y("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-14i7fbl"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Zn(n){let e,l,t,i,r;const o=[Xn,Qn],s=[];function a(c,f){return f[0]&64&&(e=null),e==null&&(e=Object.values(c[6]).length>0),e?0:1}return l=a(n,[-1,-1]),t=s[l]=o[l](n),{c(){t.c(),i=ke()},l(c){t.l(c),i=ke()},m(c,f){s[l].m(c,f),I(c,i,f),r=!0},p(c,f){let u=l;l=a(c,f),l===u?s[l].p(c,f):(ie(),C(s[u],1,1,()=>{s[u]=null}),re(),t=s[l],t?t.p(c,f):(t=s[l]=o[l](c),t.c()),b(t,1),t.m(i.parentNode,i))},i(c){r||(b(t),r=!0)},o(c){C(t),r=!1},d(c){c&&_(i),s[l].d(c)}}}function Qn(n){let e,l="No Associated ATT&CK Techniques...";return{c(){e=y("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-1l1k2ul"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Xn(n){let e,l;return e=new bn({props:{related_matrix:n[6],d_digital_artifacts:n[1].digital_artifacts,d_technique:n[3],d3fend_layer_color:n[8],additional_techniques:n[7]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&64&&(r.related_matrix=t[6]),i[0]&2&&(r.d_digital_artifacts=t[1].digital_artifacts),i[0]&8&&(r.d_technique=t[3]),i[0]&256&&(r.d3fend_layer_color=t[8]),i[0]&128&&(r.additional_techniques=t[7]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function xn(n){let e,l="loading...";return{c(){e=y("p"),e.textContent=l},l(t){e=w(t,"P",{"data-svelte-h":!0}),we(e)!=="svelte-qeejp2"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function ei(n){let e,l,t,i,r,o={ctx:n,current:null,token:null,hasCatch:!1,pending:Wn,then:Gn,catch:Un,value:37,blocks:[,,,]};ht(n[13],o);let s=n[2].length>0&&Xt(n),a={ctx:n,current:null,token:null,hasCatch:!0,pending:xn,then:Zn,catch:Yn,value:32,error:33,blocks:[,,,]};return ht(n[12],a),{c(){e=y("main"),l=y("section"),o.block.c(),t=S(),s&&s.c(),i=S(),a.block.c(),this.h()},l(c){e=w(c,"MAIN",{style:!0,class:!0});var f=E(e);l=w(f,"SECTION",{id:!0,class:!0});var u=E(l);o.block.l(u),u.forEach(_),t=A(f),s&&s.l(f),i=A(f),a.block.l(f),f.forEach(_),this.h()},h(){g(l,"id","attack--input"),g(l,"class","svelte-pjnk5u"),ve(e,"--container-height",n[0]+"px"),g(e,"class","svelte-pjnk5u")},m(c,f){I(c,e,f),k(e,l),o.block.m(l,o.anchor=null),o.mount=()=>l,o.anchor=null,k(e,t),s&&s.m(e,null),k(e,i),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null,r=!0},p(c,f){n=c,$t(o,n,f),n[2].length>0?s?(s.p(n,f),f[0]&4&&b(s,1)):(s=Xt(n),s.c(),b(s,1),s.m(e,i)):s&&(ie(),C(s,1,1,()=>{s=null}),re()),$t(a,n,f),(!r||f[0]&1)&&ve(e,"--container-height",n[0]+"px")},i(c){r||(b(o.block),b(s),b(a.block),r=!0)},o(c){for(let f=0;f<3;f+=1){const u=o.blocks[f];C(u)}C(s);for(let f=0;f<3;f+=1){const u=a.blocks[f];C(u)}r=!1},d(c){c&&_(e),o.block.d(),o.token=null,o=null,s&&s.d(),a.block.d(),a.token=null,a=null}}}function ti(n,e,l){let t,i,r,o,s,a,c;ne(n,_e,U=>l(18,c=U));let{containerHeight:f}=e;const{selectedD3fendId:u,selectedLayerId:d,selectedLayerColor:m}=xe("profile-config");ne(n,u,U=>l(3,o=U)),ne(n,d,U=>l(17,s=U)),ne(n,m,U=>l(8,a=U));let h,p,$,v,N=qt(`/api/technique/${o}.json`).then(U=>l(1,h=U)),M=qt("/api/offensive-technique/heirarchy.json").then(U=>(l(16,p=U["@graph"].reduce((J,K)=>(K!=null&&K["d3f:attack-id"]&&(J[K["@id"]]=K),J),{})),p));const L=(U,J)=>U&&J?U.map(({id:K,justification:Q,tactic:oe})=>({...O(J[K]),tactic:oe,justification:Q,id:K})):[],P=U=>U.reduce((J,{tactic:K,technique:Q,subTechnique:oe,id:B})=>(oe&&(J[oe]={tactic:K,name:oe,color:a,id:B}),J[Q]={name:Q,color:a,id:B},J),{}),T=(U,J)=>U?J.length===0?U:J.reduce((Q,{tactic:oe,technique:B,subTechnique:D,id:R})=>{const ae={off_tech_label:{type:"literal",value:B},off_tech_id:{type:"literal",value:R}},Ee=D?[ae,{off_tech_label:{type:"literal",value:D},off_tech_id:{type:"literal",value:R}}]:[ae];if(Q[oe]){const $e=Q[oe].findIndex(Ue=>Ue[0]===B);$e!==-1?(Q[oe][$e][1].push(ae),D&&Q[oe][$e][1].push(Ee[1])):Q[oe].push([B,Ee])}else Q[oe]=[[B,Ee]];return Q},{...U}):[],q=U=>U.replace("d3f:","").split(/(?=[A-Z])/).slice(0,-1).join(" "),O=(U,J={})=>{const K=U==null?void 0:U["rdfs:subClassOf"];return Object.values(J).length===0&&(J.id=U["@id"],J.subTechnique=U["rdfs:label"]),U.hasOwnProperty("d3f:attack-id")||(Array.isArray(U)?J.tactic=U.map(Q=>q(Q["@id"])):J.tactic=[q(U["@id"])]),typeof K=="object"||Array.isArray(K)?(J.technique=U["rdfs:label"],{...J,...O(K,J)}):J},z=U=>{const J=v.value,K=s,Q=o,oe=O(p[$["@id"]]);oe.technique===oe.subTechnique&&(oe.subTechnique=null),oe.tactic.reduce((D,R)=>(D.push({...oe,tactic:R,justification:J}),D),[]).forEach(D=>{const R={id:D.id,justification:D.justification,tactic:D.tactic};_e.addUserAssociatedAttack(K,Q,R)})},Z=U=>{},de=U=>{if(U!=null)return U["d3f:attack-id"]+" - "+At(U)},le=U=>U["d3f:attack-id"]+" - "+At(U);function x(U){$=U,l(4,$)}function ee(U){Pe[U?"unshift":"push"](()=>{v=U,l(5,v)})}const Ie=U=>Z(),me=U=>Z();return n.$$set=U=>{"containerHeight"in U&&l(0,f=U.containerHeight)},n.$$.update=()=>{var U,J;n.$$.dirty[0]&458760&&l(2,t=L((J=(U=c.attack)==null?void 0:U[s])==null?void 0:J[o],p)),n.$$.dirty[0]&4&&l(7,i=P(t)),n.$$.dirty[0]&6&&l(6,r=T(h==null?void 0:h.related_offensive_matrix,t))},[f,h,t,o,$,v,r,i,a,u,d,m,N,M,z,Z,p,s,c,de,le,x,ee,Ie,me]}class li extends ge{constructor(e){super(),be(this,e,ti,ei,pe,{containerHeight:0},null,[-1,-1])}}function ni(n){let e,l="D3FEND Layer Mapper";return{c(){e=y("h2"),e.textContent=l,this.h()},l(t){e=w(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-lb758t"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function ii(n){let e,l,t,i,r;return l=new Xl({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[ni]},$$scope:{ctx:n}}}),{c(){e=y("section"),V(l.$$.fragment),this.h()},l(o){e=w(o,"SECTION",{class:!0});var s=E(e);F(l.$$.fragment,s),s.forEach(_),this.h()},h(){g(e,"class","svelte-1ymr2vu")},m(o,s){I(o,e,s),j(l,e,null),r=!0},p(o,[s]){const a={};s&1&&(a.tabs=o[0]),s&2&&(a.activeTabValue=o[1]),s&16&&(a.$$scope={dirty:s,ctx:o}),l.$set(a)},i(o){r||(b(l.$$.fragment,o),o&&De(()=>{r&&(i&&i.end(1),t=Xe(e,Oe,{delay:400}),t.start())}),r=!0)},o(o){C(l.$$.fragment,o),t&&t.invalidate(),o&&(i=Tt(e,Oe,{duration:100})),r=!1},d(o){o&&_(e),H(l),o&&i&&i.end()}}}function ri(n,e,l){let t,i;const r=Ne(Pt.attack);ne(n,r,s=>l(1,i=s));const o=(s,a)=>{Y(r,i=a,i)};return l(0,t=[{label:"ATT&CK",value:Pt.attack,component:li}]),[t,i,r,o]}class oi extends ge{constructor(e){super(),be(this,e,ri,ii,pe,{})}}function si(n){let e,l,t,i;const r=n[1].default,o=He(r,n,n[0],null);return{c(){e=y("h2"),o&&o.c(),l=S(),t=y("hr"),this.h()},l(s){e=w(s,"H2",{class:!0});var a=E(e);o&&o.l(a),a.forEach(_),l=A(s),t=w(s,"HR",{class:!0}),this.h()},h(){g(e,"class","text-center svelte-1j2cwkl"),g(t,"class","svelte-1j2cwkl")},m(s,a){I(s,e,a),o&&o.m(e,null),I(s,l,a),I(s,t,a),i=!0},p(s,[a]){o&&o.p&&(!i||a&1)&&Re(o,r,s,s[0],i?Be(r,s[0],a,null):Fe(s[0]),null)},i(s){i||(b(o,s),i=!0)},o(s){C(o,s),i=!1},d(s){s&&(_(e),_(l),_(t)),o&&o.d(s)}}}function ai(n,e,l){let{$$slots:t={},$$scope:i}=e;return n.$$set=r=>{"$$scope"in r&&l(0,i=r.$$scope)},[i,t]}class ci extends ge{constructor(e){super(),be(this,e,ai,si,pe,{})}}const fi=n=>({}),el=n=>({}),ui=n=>({}),tl=n=>({});function di(n){let e,l,t,i,r,o,s,a,c;const f=n[5].submit,u=He(f,n,n[4],tl),d=n[5].cancel,m=He(d,n,n[4],el);return{c(){e=y("hr"),l=S(),t=y("section"),i=y("button"),u&&u.c(),r=S(),o=y("button"),m&&m.c(),this.h()},l(h){e=w(h,"HR",{class:!0}),l=A(h),t=w(h,"SECTION",{id:!0,class:!0});var p=E(t);i=w(p,"BUTTON",{});var $=E(i);u&&u.l($),$.forEach(_),r=A(p),o=w(p,"BUTTON",{});var v=E(o);m&&m.l(v),v.forEach(_),p.forEach(_),this.h()},h(){g(e,"class","svelte-7f2jjs"),g(t,"id","btns"),g(t,"class","svelte-7f2jjs")},m(h,p){I(h,e,p),I(h,l,p),I(h,t,p),k(t,i),u&&u.m(i,null),k(t,r),k(t,o),m&&m.m(o,null),s=!0,a||(c=[W(i,"click",n[6]),W(o,"click",function(){fn(n[2])&&n[2].apply(this,arguments)})],a=!0)},p(h,[p]){n=h,u&&u.p&&(!s||p&16)&&Re(u,f,n,n[4],s?Be(f,n[4],p,ui):Fe(n[4]),tl),m&&m.p&&(!s||p&16)&&Re(m,d,n,n[4],s?Be(d,n[4],p,fi):Fe(n[4]),el)},i(h){s||(b(u,h),b(m,h),s=!0)},o(h){C(u,h),C(m,h),s=!1},d(h){h&&(_(e),_(l),_(t)),u&&u.d(h),m&&m.d(h),a=!1,Te(c)}}}function mi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(a,d=>l(3,t=d)),a);n.$$.on_destroy.push(()=>i());let{$$slots:o={},$$scope:s}=e,{item:a}=e;r();let{handleOnSubmit:c}=e,{handleCloseModal:f}=e;const u=()=>c(t);return n.$$set=d=>{"item"in d&&r(l(0,a=d.item)),"handleOnSubmit"in d&&l(1,c=d.handleOnSubmit),"handleCloseModal"in d&&l(2,f=d.handleCloseModal),"$$scope"in d&&l(4,s=d.$$scope)},[a,c,f,t,s,o,u]}class hi extends ge{constructor(e){super(),be(this,e,mi,di,pe,{item:0,handleOnSubmit:1,handleCloseModal:2})}}function ll(n,e,l){const t=n.slice();return t[3]=e[l],t}function nl(n){let e,l=n[3].name+"",t,i;return{c(){e=y("option"),t=fe(l),this.h()},l(r){e=w(r,"OPTION",{});var o=E(e);t=ue(o,l),o.forEach(_),this.h()},h(){e.__value=i=n[3],ze(e,e.__value)},m(r,o){I(r,e,o),k(e,t)},p(r,o){o&2&&l!==(l=r[3].name+"")&&Me(t,l),o&2&&i!==(i=r[3])&&(e.__value=i,ze(e,e.__value))},d(r){r&&_(e)}}}function pi(n){let e,l,t="NAME",i,r,o,s,a=`Select Capability from Templates...
      `,c,f,u,d=n[0].name+"",m,h,p,$,v=qe(n[1]),N=[];for(let M=0;M<v.length;M+=1)N[M]=nl(ll(n,v,M));return{c(){e=y("div"),l=y("label"),l.textContent=t,i=S(),r=y("div"),o=y("select"),s=y("option"),s.textContent=a;for(let M=0;M<N.length;M+=1)N[M].c();c=S(),f=y("p"),u=fe("The Template Capability ("),m=fe(d),h=fe(`) will incorporate all
    child Capabilities and associated Techniques.`),this.h()},l(M){e=w(M,"DIV",{id:!0,class:!0});var L=E(e);l=w(L,"LABEL",{"aria-label":!0,for:!0,"data-svelte-h":!0}),we(l)!=="svelte-l4gr53"&&(l.textContent=t),i=A(L),r=w(L,"DIV",{id:!0});var P=E(r);o=w(P,"SELECT",{id:!0,class:!0});var T=E(o);s=w(T,"OPTION",{"data-svelte-h":!0}),we(s)!=="svelte-1t4hjue"&&(s.textContent=a);for(let O=0;O<N.length;O+=1)N[O].l(T);T.forEach(_),P.forEach(_),c=A(L),f=w(L,"P",{class:!0});var q=E(f);u=ue(q,"The Template Capability ("),m=ue(q,d),h=ue(q,`) will incorporate all
    child Capabilities and associated Techniques.`),q.forEach(_),L.forEach(_),this.h()},h(){g(l,"aria-label","Capability Name"),g(l,"for","capability-name"),s.selected=!0,s.disabled=!0,s.__value="",ze(s,s.__value),g(o,"id","capability--select"),o.required=!0,g(o,"class","svelte-3hjn8y"),n[0]===void 0&&De(()=>n[2].call(o)),g(r,"id","autocomplete"),g(f,"class","form-info"),se(f,"non--existing",n[0]),g(e,"id","layer-input-form"),g(e,"class","svelte-3hjn8y")},m(M,L){I(M,e,L),k(e,l),k(e,i),k(e,r),k(r,o),k(o,s);for(let P=0;P<N.length;P+=1)N[P]&&N[P].m(o,null);mt(o,n[0],!0),k(e,c),k(e,f),k(f,u),k(f,m),k(f,h),p||($=W(o,"change",n[2]),p=!0)},p(M,[L]){if(L&2){v=qe(M[1]);let P;for(P=0;P<v.length;P+=1){const T=ll(M,v,P);N[P]?N[P].p(T,L):(N[P]=nl(T),N[P].c(),N[P].m(o,null))}for(;P<N.length;P+=1)N[P].d(1);N.length=v.length}L&3&&mt(o,M[0]),L&1&&d!==(d=M[0].name+"")&&Me(m,d),L&1&&se(f,"non--existing",M[0])},i:G,o:G,d(M){M&&_(e),We(N,M),p=!1,$()}}}function _i(n,e,l){let{selectedCapability:t=null}=e,{capabilities:i}=e;function r(){t=Jl(this),l(0,t),l(1,i)}return n.$$set=o=>{"selectedCapability"in o&&l(0,t=o.selectedCapability),"capabilities"in o&&l(1,i=o.capabilities)},[t,i,r]}class gi extends ge{constructor(e){super(),be(this,e,_i,pi,pe,{selectedCapability:0,capabilities:1})}}function bi(n){let e,l,t,i,r,o,s,a,c,f,u,d,m,h,p;return{c(){e=y("div"),l=y("form"),t=y("label"),i=y("p"),r=fe(n[1]),o=S(),s=y("input"),a=S(),c=y("label"),f=y("p"),u=fe(n[2]),d=S(),m=y("textarea"),this.h()},l($){e=w($,"DIV",{id:!0,class:!0});var v=E(e);l=w(v,"FORM",{class:!0,autocomplete:!0});var N=E(l);t=w(N,"LABEL",{"aria-label":!0,for:!0});var M=E(t);i=w(M,"P",{});var L=E(i);r=ue(L,n[1]),L.forEach(_),M.forEach(_),o=A(N),s=w(N,"INPUT",{id:!0,type:!0,name:!0,class:!0,"aria-describedby":!0,oninvalid:!0}),a=A(N),c=w(N,"LABEL",{"aria-label":!0,for:!0});var P=E(c);f=w(P,"P",{});var T=E(f);u=ue(T,n[2]),T.forEach(_),P.forEach(_),d=A(N),m=w(N,"TEXTAREA",{id:!0,name:!0,class:!0}),E(m).forEach(_),N.forEach(_),v.forEach(_),this.h()},h(){g(t,"aria-label","layer name"),g(t,"for","layer-name"),g(s,"id","layer-name"),g(s,"type","text"),g(s,"name","Layer"),g(s,"class","layer-input svelte-s0zavs"),s.required=!0,g(s,"aria-describedby","layername-error"),g(s,"oninvalid",n[5]("This field is required.")),g(c,"aria-label","layer description"),g(c,"for","layer-description"),g(m,"id","layer-description"),g(m,"name","Description"),g(m,"class","layer-input svelte-s0zavs"),m.required=!0,g(l,"class","layer-input-form svelte-s0zavs"),g(l,"autocomplete","off"),g(e,"id","container-layer-form"),g(e,"class","svelte-s0zavs")},m($,v){I($,e,v),k(e,l),k(l,t),k(t,i),k(i,r),k(l,o),k(l,s),ze(s,n[4].name),k(l,a),k(l,c),k(c,f),k(f,u),k(l,d),k(l,m),ze(m,n[4].description),n[9](l),h||(p=[W(s,"input",n[7]),W(m,"input",n[8])],h=!0)},p($,[v]){v&2&&Me(r,$[1]),v&16&&s.value!==$[4].name&&ze(s,$[4].name),v&4&&Me(u,$[2]),v&16&&ze(m,$[4].description)},i:G,o:G,d($){$&&_(e),n[9](null),h=!1,Te(p)}}}function vi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,p=>l(4,t=p)),o);n.$$.on_destroy.push(()=>i());let{item:o}=e;r();let{textInput:s}=e,{textArea:a}=e,{submit:c}=e,f;Wl(()=>{Y(o,t.name="",t),Y(o,t.description="",t)});const u=p=>p;function d(){t.name=this.value,o.set(t)}function m(){t.description=this.value,o.set(t)}function h(p){Pe[p?"unshift":"push"](()=>{f=p,l(3,f)})}return n.$$set=p=>{"item"in p&&r(l(0,o=p.item)),"textInput"in p&&l(1,s=p.textInput),"textArea"in p&&l(2,a=p.textArea),"submit"in p&&l(6,c=p.submit)},[o,s,a,f,t,u,c,d,m,h]}class $i extends ge{constructor(e){super(),be(this,e,vi,bi,pe,{item:0,textInput:1,textArea:2,submit:6})}}const ki=n=>({}),il=n=>({M:n[1],item:n[0]});function Ci(n){let e,l;const t=n[3].default,i=He(t,n,n[2],il);return{c(){e=y("section"),i&&i.c(),this.h()},l(r){e=w(r,"SECTION",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","dialog--container"),g(e,"class","svelte-1jrgukv")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,[o]){i&&i.p&&(!l||o&4)&&Re(i,t,r,r[2],l?Be(t,r[2],o,ki):Fe(r[2]),il)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function yi(n,e,l){let{$$slots:t={},$$scope:i}=e;const r=Ne({}),o={Title:ci,Buttons:hi,Select:gi,Create:$i};return n.$$set=s=>{"$$scope"in s&&l(2,i=s.$$scope)},[r,o,i,t]}class It extends ge{constructor(e){super(),be(this,e,yi,Ci,pe,{})}}function rl(n){let e,l,t,i,r,o,s,a;e=new te({props:{size:33,iconName:"create profile",description:"Create Profile",title:"Create Profile"}}),e.$on("iconClick",n[9]),t=new te({props:{size:33,iconName:"delete",description:"Delete Profile",title:"Delete Profile"}}),t.$on("iconClick",n[10]);let c=n[3]&&ol(n);return{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),r=y("dialog"),c&&c.c(),this.h()},l(f){F(e.$$.fragment,f),l=A(f),F(t.$$.fragment,f),i=A(f),r=w(f,"DIALOG",{});var u=E(r);c&&c.l(u),u.forEach(_),this.h()},h(){r.open=n[3]},m(f,u){j(e,f,u),I(f,l,u),j(t,f,u),I(f,i,u),I(f,r,u),c&&c.m(r,null),n[12](r),o=!0,s||(a=W(r,"close",n[13]),s=!0)},p(f,u){f[3]?c?(c.p(f,u),u&8&&b(c,1)):(c=ol(f),c.c(),b(c,1),c.m(r,null)):c&&(ie(),C(c,1,1,()=>{c=null}),re()),(!o||u&8)&&(r.open=f[3])},i(f){o||(b(e.$$.fragment,f),b(t.$$.fragment,f),b(c),o=!0)},o(f){C(e.$$.fragment,f),C(t.$$.fragment,f),C(c),o=!1},d(f){f&&(_(l),_(i),_(r)),H(e,f),H(t,f),c&&c.d(),n[12](null),s=!1,a()}}}function ol(n){let e,l;return e=new It({props:{$$slots:{default:[Ii,({M:t,item:i})=>({15:t,16:i}),({M:t,item:i})=>(t?32768:0)|(i?65536:0)]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&196612&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function wi(n){let e;return{c(){e=fe("Create New Profile")},l(l){e=ue(l,"Create New Profile")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ti(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ei(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function Ii(n){let e,l,t,i,r,o;return e=new n[15].Title({props:{$$slots:{default:[wi]},$$scope:{ctx:n}}}),t=new n[15].Create({props:{item:n[16],textInput:"Name",textArea:"Description"}}),r=new n[15].Buttons({props:{item:n[16],handleCloseModal:n[8],handleOnSubmit:n[11],$$slots:{cancel:[Ei],submit:[Ti]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=A(s),F(t.$$.fragment,s),i=A(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a&131072&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a&65536&&(f.item=s[16]),t.$set(f);const u={};a&65536&&(u.item=s[16]),a&4&&(u.handleOnSubmit=s[11]),a&131072&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function Ni(n){let e,l,t=!n[4].isReadonly&&rl(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[4].isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(i,r),r&16&&b(t,1)):(t=rl(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Mi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(c,T=>l(4,t=T)),c),o,s=G,a=()=>(s(),s=Ve(f,T=>l(14,o=T)),f);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>s());let{store:c}=e;r();let{selectedProfile:f}=e;a();let u,d=!1;const m=()=>{l(3,d=!0),u.showModal()},h=T=>{confirm("Deleting Profile will delete all associated Capabilities.")&&(c.deleteProfile(),Y(f,o=t.profiles[t.selectedProfile]||{name:""},o))},p=({name:T,description:q},O)=>{c.createProfile({name:T,description:q}),Y(f,o=t.profiles[t.selectedProfile]||null,o),O.close()},$=()=>{l(3,d=!1),u.close()},v=T=>m(),N=T=>h(),M=T=>p(T,u);function L(T){Pe[T?"unshift":"push"](()=>{u=T,l(2,u)})}const P=()=>l(3,d=!1);return n.$$set=T=>{"store"in T&&r(l(0,c=T.store)),"selectedProfile"in T&&a(l(1,f=T.selectedProfile))},[c,f,u,d,t,m,h,p,$,v,N,M,L,P]}class Di extends ge{constructor(e){super(),be(this,e,Mi,Ni,pe,{store:0,selectedProfile:1})}}function Pi(n){var o;let e,l,t;function i(s){n[6](s)}let r={inputClassName:"autocomplete-cursor-select",items:(o=n[2])==null?void 0:o.profiles,readonly:!1,labelFieldName:"name",onChange:n[5]};return n[3]!==void 0&&(r.selectedItem=n[3]),e=new Zl({props:r}),Pe.push(()=>Et(e,"selectedItem",i)),{c(){V(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,a){j(e,s,a),t=!0},p(s,[a]){var f;const c={};a&4&&(c.items=(f=s[2])==null?void 0:f.profiles),!l&&a&8&&(l=!0,c.selectedItem=s[3],yt(()=>l=!1)),e.$set(c)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function qi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(c,h=>l(2,t=h)),c),o,s=G,a=()=>(s(),s=Ve(f,h=>l(3,o=h)),f);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>s());let{store:c}=e;r();let{selectedProfile:f}=e;a();const u=h=>{var p;if(h){const $=t==null?void 0:t.profiles.findIndex(({id:v})=>v===h.id);Y(c,t.selectedProfile=$,t),Y(f,o=((p=t==null?void 0:t.profiles)==null?void 0:p[$])||null,o),Ke.reset()}else Y(c,t.selectedProfile=null,t)},d=h=>u(h);function m(h){o=h,f.set(o)}return n.$$set=h=>{"store"in h&&r(l(0,c=h.store)),"selectedProfile"in h&&a(l(1,f=h.selectedProfile))},[c,f,t,o,u,d,m]}class Si extends ge{constructor(e){super(),be(this,e,qi,Pi,pe,{store:0,selectedProfile:1})}}const Ai=n=>({}),sl=n=>({}),Oi=n=>({}),al=n=>({});function cl(n){let e,l,t,i,r,o,s,a,c;const f=n[6].popover,u=He(f,n,n[5],sl);return{c(){e=y("div"),l=y("div"),i=S(),r=y("div"),u&&u.c(),this.h()},l(d){e=w(d,"DIV",{class:!0,role:!0,tabindex:!0,"aria-describedby":!0,style:!0});var m=E(e);l=w(m,"DIV",{class:!0,tabindex:!0,role:!0}),E(l).forEach(_),i=A(m),r=w(m,"DIV",{class:!0});var h=E(r);u&&u.l(h),h.forEach(_),m.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-zv51ll"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-zv51ll"),g(e,"class","popover svelte-zv51ll"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-describedby","Comment"),ve(e,"--popover-top",`${n[2]}px`),ve(e,"--popover-left",`${n[3]}px`)},m(d,m){I(d,e,m),k(e,l),k(e,i),k(e,r),u&&u.m(r,null),s=!0,a||(c=[W(l,"click",Qe(n[11])),W(e,"click",Qe(n[7]))],a=!0)},p(d,m){u&&u.p&&(!s||m&32)&&Re(u,f,d,d[5],s?Be(f,d[5],m,Ai):Fe(d[5]),sl),(!s||m&4)&&ve(e,"--popover-top",`${d[2]}px`),(!s||m&8)&&ve(e,"--popover-left",`${d[3]}px`)},i(d){s||(d&&De(()=>{s&&(t||(t=Ae(l,Oe,{delay:25,duration:150},!0)),t.run(1))}),b(u,d),d&&De(()=>{s&&(o||(o=Ae(e,Oe,{},!0)),o.run(1))}),s=!0)},o(d){d&&(t||(t=Ae(l,Oe,{delay:25,duration:150},!1)),t.run(0)),C(u,d),d&&(o||(o=Ae(e,Oe,{},!1)),o.run(0)),s=!1},d(d){d&&_(e),d&&t&&t.end(),u&&u.d(d),d&&o&&o.end(),a=!1,Te(c)}}}function Li(n){let e,l,t,i,r,o;const s=n[6].popoverClick,a=He(s,n,n[5],al);let c=n[1]&&cl(n);return{c(){e=y("div"),a&&a.c(),l=S(),c&&c.c(),t=ke(),this.h()},l(f){e=w(f,"DIV",{role:!0,tabindex:!0});var u=E(e);a&&a.l(u),u.forEach(_),l=A(f),c&&c.l(f),t=ke(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(f,u){I(f,e,u),a&&a.m(e,null),n[10](e),I(f,l,u),c&&c.m(f,u),I(f,t,u),i=!0,r||(o=[W(window,"resize",n[8]),W(e,"click",n[9])],r=!0)},p(f,[u]){a&&a.p&&(!i||u&32)&&Re(a,s,f,f[5],i?Be(s,f[5],u,Oi):Fe(f[5]),al),f[1]?c?(c.p(f,u),u&2&&b(c,1)):(c=cl(f),c.c(),b(c,1),c.m(t.parentNode,t)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){i||(b(a,f),b(c),i=!0)},o(f){C(a,f),C(c),i=!1},d(f){f&&(_(e),_(l),_(t)),a&&a.d(f),n[10](null),c&&c.d(f),r=!1,Te(o)}}}function zi(n,e,l){let{$$slots:t={},$$scope:i}=e,r=!1,o,s,a;const c=p=>setTimeout(()=>{l(2,{bottom:s,left:a}=(p==null?void 0:p.getBoundingClientRect())??{bottom:0,left:0},s,l(3,a))},1e3);function f(p){un.call(this,n,p)}const u=p=>c(o),d=()=>l(1,r=!0);function m(p){Pe[p?"unshift":"push"](()=>{o=p,l(0,o)})}const h=()=>l(1,r=!1);return n.$$set=p=>{"$$scope"in p&&l(5,i=p.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&c(o)},[o,r,s,a,c,i,t,f,u,d,m,h]}class xl extends ge{constructor(e){super(),be(this,e,zi,Li,pe,{})}}function Vi(n){let e,l;return e=new te({props:{size:30,iconName:"grid",description:"Select Visualization Mode",title:"Select Visualization Mode",slot:"popoverClick"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function ji(n){let e,l,t,i,r,o="Root Colored",s,a,c,f,u,d="Multi-Colored",m,h,p,$,v,N="Heatmap",M,L,P;return t=new te({props:{size:30,iconName:ce.rootColor,description:"Root Colored",title:"Root Colored"}}),c=new te({props:{size:30,viewBox:32,iconName:ce.childrenMultiColor,description:"Children Multi-Color",title:"Children Multi-Color"}}),p=new te({props:{size:30,iconName:ce.heatMap,description:"Heatmap",title:"Heatmap"}}),{c(){e=y("div"),l=y("button"),V(t.$$.fragment),i=S(),r=y("span"),r.textContent=o,s=S(),a=y("button"),V(c.$$.fragment),f=S(),u=y("span"),u.textContent=d,m=S(),h=y("button"),V(p.$$.fragment),$=S(),v=y("span"),v.textContent=N,this.h()},l(T){e=w(T,"DIV",{id:!0,slot:!0,class:!0});var q=E(e);l=w(q,"BUTTON",{class:!0});var O=E(l);F(t.$$.fragment,O),i=A(O),r=w(O,"SPAN",{class:!0,"data-svelte-h":!0}),we(r)!=="svelte-1mm9720"&&(r.textContent=o),O.forEach(_),s=A(q),a=w(q,"BUTTON",{class:!0});var z=E(a);F(c.$$.fragment,z),f=A(z),u=w(z,"SPAN",{class:!0,"data-svelte-h":!0}),we(u)!=="svelte-17kog5w"&&(u.textContent=d),z.forEach(_),m=A(q),h=w(q,"BUTTON",{class:!0});var Z=E(h);F(p.$$.fragment,Z),$=A(Z),v=w(Z,"SPAN",{class:!0,"data-svelte-h":!0}),we(v)!=="svelte-1cpq3q6"&&(v.textContent=N),Z.forEach(_),q.forEach(_),this.h()},h(){g(r,"class","pop-text"),g(l,"class","row--mode btn svelte-1l620nw"),se(l,"selected-mode",n[1].techniqueMappingMode===ce.rootColor),g(u,"class","pop-text"),g(a,"class","row--mode btn svelte-1l620nw"),se(a,"selected-mode",n[1].techniqueMappingMode===ce.childrenMultiColor),g(v,"class","pop-text"),g(h,"class","row--mode btn svelte-1l620nw"),se(h,"selected-mode",n[1].techniqueMappingMode===ce.heatMap),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-1l620nw")},m(T,q){I(T,e,q),k(e,l),j(t,l,null),k(l,i),k(l,r),k(e,s),k(e,a),j(c,a,null),k(a,f),k(a,u),k(e,m),k(e,h),j(p,h,null),k(h,$),k(h,v),M=!0,L||(P=[W(l,"click",n[3]),W(a,"click",n[4]),W(h,"click",n[5])],L=!0)},p(T,q){(!M||q&2)&&se(l,"selected-mode",T[1].techniqueMappingMode===ce.rootColor),(!M||q&2)&&se(a,"selected-mode",T[1].techniqueMappingMode===ce.childrenMultiColor),(!M||q&2)&&se(h,"selected-mode",T[1].techniqueMappingMode===ce.heatMap)},i(T){M||(b(t.$$.fragment,T),b(c.$$.fragment,T),b(p.$$.fragment,T),M=!0)},o(T){C(t.$$.fragment,T),C(c.$$.fragment,T),C(p.$$.fragment,T),M=!1},d(T){T&&_(e),H(t),H(c),H(p),L=!1,Te(P)}}}function Hi(n){let e,l,t;return l=new xl({props:{$$slots:{popover:[ji],popoverClick:[Vi]},$$scope:{ctx:n}}}),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"id","layer-btns"),g(e,"class","svelte-1l620nw")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,[r]){const o={};r&66&&(o.$$scope={dirty:r,ctx:i}),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Ri(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,u=>l(1,t=u)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();const s=u=>{Y(o,t.techniqueMappingMode=u,t)},a=()=>s(ce.rootColor),c=()=>s(ce.childrenMultiColor),f=()=>s(ce.heatMap);return n.$$set=u=>{"store"in u&&r(l(0,o=u.store))},[o,t,s,a,c,f]}class Fi extends ge{constructor(e){super(),be(this,e,Ri,Hi,pe,{store:0})}}function fl(n){let e=n[3],l,t,i=ul(n);return{c(){i.c(),l=ke()},l(r){i.l(r),l=ke()},m(r,o){i.m(r,o),I(r,l,o),t=!0},p(r,o){o&8&&pe(e,e=r[3])?(ie(),C(i,1,1,G),re(),i=ul(r),i.c(),b(i,1),i.m(l.parentNode,l)):i.p(r,o)},i(r){t||(b(i),t=!0)},o(r){C(i),t=!1},d(r){r&&_(l),i.d(r)}}}function Bi(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){g(e,"type","file"),g(e,"id","file"),g(e,"name","file"),e.hidden=!0,g(e,"accept",".json")},m(i,r){I(i,e,r),n[8](e),l||(t=[W(e,"change",n[9]),W(e,"change",n[6])],l=!0)},p:G,d(i){i&&_(e),n[8](null),l=!1,Te(t)}}}function ul(n){let e,l,t,i;return e=new te({props:{size:33,iconName:"import",description:"Import Profile",title:"Import Profile",$$slots:{default:[Bi]},$$scope:{ctx:n}}}),e.$on("iconClick",n[5]),t=new te({props:{size:33,iconName:"export",description:"Export Profile",title:"Export Profile"}}),t.$on("iconClick",n[7]),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=A(r),F(t.$$.fragment,r)},m(r,o){j(e,r,o),I(r,l,o),j(t,r,o),i=!0},p(r,o){const s={};o&1030&&(s.$$scope={dirty:o,ctx:r}),e.$set(s)},i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),i=!1},d(r){r&&_(l),H(e,r),H(t,r)}}}function Ui(n){let e,l,t=!n[4].isReadonly&&fl(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,[r]){i[4].isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(i,r),r&16&&b(t,1)):(t=fl(i),t.c(),b(t,1),t.m(e.parentNode,e))},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Gi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,p=>l(4,t=p)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s,a,c=!1;const f=()=>{s.click()},u=async()=>{const p=await s.files[0];if(p)try{const $=Cn.parser(yn,{requireStringValidation:!1,mode:"lax",includeErrors:!0,allErrors:!0}),v=await p.text();let N=JSON.parse(v);(N==null?void 0:N.version)!=="1"&&(N=wn(N));const{valid:M,error:L,errors:P,value:T}=$(JSON.stringify(N));if(!M)throw new AggregateError([L,...P||[]],`Error Parsing Initial Profile Layer: ${L}`);o.set(T),alert("Profile imported Successfully")}catch($){if(console.error($),($==null?void 0:$.errors)!==void 0)for(let v=0;v<$.errors.length;v++){const N=$.errors[v];console.error(N)}confirm("Error Importing/Parsing Profile. Check error logs.")}l(3,c=!c)},d=()=>{const p=JSON.stringify(t),$=new Blob([p],{type:"application/json;charset=utf-8"});$n($,"d3fend-profile.json")};function m(p){Pe[p?"unshift":"push"](()=>{s=p,l(1,s)})}function h(){a=this.files,l(2,a)}return n.$$set=p=>{"store"in p&&r(l(0,o=p.store))},[o,s,a,c,t,f,u,d,m,h]}class Ki extends ge{constructor(e){super(),be(this,e,Gi,Ui,pe,{store:0})}}function Ji(n){let e,l,t,i,r,o,s;return{c(){e=y("div"),l=y("span"),t=fe(n[1]),i=S(),r=y("button"),this.h()},l(a){e=w(a,"DIV",{class:!0,style:!0});var c=E(e);l=w(c,"SPAN",{id:!0});var f=E(l);t=ue(f,n[1]),f.forEach(_),i=A(c),r=w(c,"BUTTON",{role:!0,"aria-checked":!0,"aria-labelledby":!0,class:!0});var u=E(r);u.forEach(_),c.forEach(_),this.h()},h(){g(l,"id","switch"),g(r,"role","switch"),g(r,"aria-checked",n[0]),g(r,"aria-labelledby","switch"),g(r,"class","svelte-115nhtf"),g(e,"class","s--slider svelte-115nhtf"),ve(e,"font-size",n[2]+"px")},m(a,c){I(a,e,c),k(e,l),k(l,t),k(e,i),k(e,r),o||(s=W(r,"click",n[3]),o=!0)},p(a,[c]){c&2&&Me(t,a[1]),c&1&&g(r,"aria-checked",a[0]),c&4&&ve(e,"font-size",a[2]+"px")},i:G,o:G,d(a){a&&_(e),o=!1,s()}}}function Wi(n,e,l){let{label:t}=e,{fontSize:i=16}=e,{value:r="on"}=e,{checked:o}=e,{clickHandler:s}=e;function a(c){const u=c.target.getAttribute("aria-checked");l(0,o=u!=="true"),l(4,r=o===!0?"off":"on"),s()}return n.$$set=c=>{"label"in c&&l(1,t=c.label),"fontSize"in c&&l(2,i=c.fontSize),"value"in c&&l(4,r=c.value),"checked"in c&&l(0,o=c.checked),"clickHandler"in c&&l(5,s=c.clickHandler)},[o,t,i,a,r,s]}class Yi extends ge{constructor(e){super(),be(this,e,Wi,Ji,pe,{label:1,fontSize:2,value:4,checked:0,clickHandler:5})}}function Zi(n){let e,l;return e=new te({props:{size:30,iconName:"filter",description:"Tree Control",title:"Tree Control",slot:"popoverClick"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Qi(n){let e,l,t,i,r,o,s,a,c,f="ATT&CK Associations",u,d,m;function h($){n[5]($)}let p={label:"Mapping Mode",design:"slider",checked:n[2].associationMode,clickHandler:n[3]};return n[1]!==void 0&&(p.value=n[1]),t=new Yi({props:p}),Pe.push(()=>Et(t,"value",h)),s=new te({props:{size:30,iconName:"linking",description:"Associated ATT&CK Techniques",title:"Associated ATT&CK Techniques"}}),{c(){e=y("div"),l=y("div"),V(t.$$.fragment),r=S(),o=y("button"),V(s.$$.fragment),a=S(),c=y("span"),c.textContent=f,this.h()},l($){e=w($,"DIV",{id:!0,slot:!0,class:!0});var v=E(e);l=w(v,"DIV",{class:!0});var N=E(l);F(t.$$.fragment,N),N.forEach(_),r=A(v),o=w(v,"BUTTON",{class:!0});var M=E(o);F(s.$$.fragment,M),a=A(M),c=w(M,"SPAN",{class:!0,"data-svelte-h":!0}),we(c)!=="svelte-rreezx"&&(c.textContent=f),M.forEach(_),v.forEach(_),this.h()},h(){g(l,"class","row--mode toggle svelte-69rrcm"),g(c,"class","pop-text"),g(o,"class","row--mode btn svelte-69rrcm"),se(o,"selected-mode",n[2].techniqueMappingMode===ce["ATT&CK"]),g(e,"id","btn-group"),g(e,"slot","popover"),g(e,"class","svelte-69rrcm")},m($,v){I($,e,v),k(e,l),j(t,l,null),k(e,r),k(e,o),j(s,o,null),k(o,a),k(o,c),u=!0,d||(m=W(o,"click",n[6]),d=!0)},p($,v){const N={};v&4&&(N.checked=$[2].associationMode),!i&&v&2&&(i=!0,N.value=$[1],yt(()=>i=!1)),t.$set(N),(!u||v&4)&&se(o,"selected-mode",$[2].techniqueMappingMode===ce["ATT&CK"])},i($){u||(b(t.$$.fragment,$),b(s.$$.fragment,$),u=!0)},o($){C(t.$$.fragment,$),C(s.$$.fragment,$),u=!1},d($){$&&_(e),H(t),H(s),d=!1,m()}}}function Xi(n){let e,l,t;return l=new xl({props:{$$slots:{popover:[Qi],popoverClick:[Zi]},$$scope:{ctx:n}}}),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"id","layer-btns"),g(e,"class","svelte-69rrcm")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,[r]){const o={};r&134&&(o.$$scope={dirty:r,ctx:i}),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function xi(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,d=>l(2,t=d)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s;const a=()=>{Y(o,t.associationMode=!t.associationMode,t)},c=d=>{Y(o,t.techniqueMappingMode=d,t)};function f(d){s=d,l(1,s)}const u=()=>c(ce["ATT&CK"]);return n.$$set=d=>{"store"in d&&r(l(0,o=d.store))},[o,s,t,a,c,f,u]}class er extends ge{constructor(e){super(),be(this,e,xi,Xi,pe,{store:0})}}function dl(n){let e,l,t,i,r,o,s,a="Root Colored",c,f,u,d,m,h="Multi-Colored",p,$,v,N,M,L="Heatmap",P,T,q,O;return r=new te({props:{size:30,iconName:ce.rootColor,description:"Root Colored",title:"Root Colored"}}),u=new te({props:{size:30,viewBox:32,iconName:ce.childrenMultiColor,description:"Children Multi-Color",title:"Children Multi-Color"}}),v=new te({props:{size:30,iconName:ce.heatMap,description:"Heatmap",title:"Heatmap"}}),{c(){e=y("div"),l=y("div"),t=y("div"),i=y("button"),V(r.$$.fragment),o=S(),s=y("span"),s.textContent=a,c=S(),f=y("button"),V(u.$$.fragment),d=S(),m=y("span"),m.textContent=h,p=S(),$=y("button"),V(v.$$.fragment),N=S(),M=y("span"),M.textContent=L,this.h()},l(z){e=w(z,"DIV",{id:!0,class:!0});var Z=E(e);l=w(Z,"DIV",{class:!0});var de=E(l);t=w(de,"DIV",{id:!0,class:!0});var le=E(t);i=w(le,"BUTTON",{class:!0});var x=E(i);F(r.$$.fragment,x),o=A(x),s=w(x,"SPAN",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-1mm9720"&&(s.textContent=a),x.forEach(_),c=A(le),f=w(le,"BUTTON",{class:!0});var ee=E(f);F(u.$$.fragment,ee),d=A(ee),m=w(ee,"SPAN",{class:!0,"data-svelte-h":!0}),we(m)!=="svelte-17kog5w"&&(m.textContent=h),ee.forEach(_),p=A(le),$=w(le,"BUTTON",{class:!0});var Ie=E($);F(v.$$.fragment,Ie),N=A(Ie),M=w(Ie,"SPAN",{class:!0,"data-svelte-h":!0}),we(M)!=="svelte-1cpq3q6"&&(M.textContent=L),Ie.forEach(_),le.forEach(_),de.forEach(_),Z.forEach(_),this.h()},h(){g(s,"class","pop-text"),g(i,"class","row--mode btn svelte-1ya1wil"),se(i,"selected-mode",n[4].techniqueMappingMode===ce.rootColor),g(m,"class","pop-text"),g(f,"class","row--mode btn svelte-1ya1wil"),se(f,"selected-mode",n[4].techniqueMappingMode===ce.childrenMultiColor),g(M,"class","pop-text"),g($,"class","row--mode btn svelte-1ya1wil"),se($,"selected-mode",n[4].techniqueMappingMode===ce.heatMap),g(t,"id","btn-group"),g(t,"class","svelte-1ya1wil"),g(l,"class","mapping--popover svelte-1ya1wil"),g(e,"id","backdrop"),g(e,"class","svelte-1ya1wil")},m(z,Z){I(z,e,Z),k(e,l),k(l,t),k(t,i),j(r,i,null),k(i,o),k(i,s),k(t,c),k(t,f),j(u,f,null),k(f,d),k(f,m),k(t,p),k(t,$),j(v,$,null),k($,N),k($,M),n[14](l),T=!0,q||(O=[W(i,"click",n[11]),W(f,"click",n[12]),W($,"click",n[13]),nt(n[6].call(null,l)),nt(Dn.call(null,l)),W(l,"outsideclick",n[7])],q=!0)},p(z,Z){(!T||Z&16)&&se(i,"selected-mode",z[4].techniqueMappingMode===ce.rootColor),(!T||Z&16)&&se(f,"selected-mode",z[4].techniqueMappingMode===ce.childrenMultiColor),(!T||Z&16)&&se($,"selected-mode",z[4].techniqueMappingMode===ce.heatMap)},i(z){T||(b(r.$$.fragment,z),b(u.$$.fragment,z),b(v.$$.fragment,z),z&&De(()=>{T&&(P||(P=Ae(e,Oe,{delay:25,duration:150},!0)),P.run(1))}),T=!0)},o(z){C(r.$$.fragment,z),C(u.$$.fragment,z),C(v.$$.fragment,z),z&&(P||(P=Ae(e,Oe,{delay:25,duration:150},!1)),P.run(0)),T=!1},d(z){z&&_(e),H(r),H(u),H(v),n[14](null),z&&P&&P.end(),q=!1,Te(O)}}}function tr(n){let e,l,t,i,r,o,s;t=new te({props:{size:30,iconName:"grid",description:"Select Visualization Mode",title:"Select Visualization Mode"}});let a=n[1]&&dl(n);return{c(){e=y("div"),l=y("div"),V(t.$$.fragment),i=S(),a&&a.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=E(e);l=w(f,"DIV",{class:!0,href:!0,tabindex:!0,role:!0});var u=E(l);F(t.$$.fragment,u),u.forEach(_),i=A(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(l,"class","layer-trigger"),g(l,"href",null),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-container")},m(c,f){I(c,e,f),k(e,l),j(t,l,null),n[9](l),k(e,i),a&&a.m(e,null),r=!0,o||(s=[nt(n[5].call(null,l)),W(l,"click",n[7]),W(l,"keydown",n[10])],o=!0)},p(c,[f]){c[1]?a?(a.p(c,f),f&2&&b(a,1)):(a=dl(c),a.c(),b(a,1),a.m(e,null)):a&&(ie(),C(a,1,1,()=>{a=null}),re())},i(c){r||(b(t.$$.fragment,c),b(a),r=!0)},o(c){C(t.$$.fragment,c),C(a),r=!1},d(c){c&&_(e),H(t),n[9](null),a&&a.d(),o=!1,Te(s)}}}function lr(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,L=>l(4,t=L)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();let s,a,c;const[f,u]=En({strategy:"fixed",placement:"right-end",middleware:[In(20),Nn()]}),d=()=>{l(1,s=!s)},m=L=>{Y(o,t.techniqueMappingMode=L,t)};function h(L){Pe[L?"unshift":"push"](()=>{a=L,l(2,a)})}const p=L=>Je(L,d),$=()=>m(ce.rootColor),v=()=>m(ce.childrenMultiColor),N=()=>m(ce.heatMap);function M(L){Pe[L?"unshift":"push"](()=>{c=L,l(3,c)})}return n.$$set=L=>{"store"in L&&r(l(0,o=L.store))},[o,s,a,c,t,f,u,d,m,h,p,$,v,N,M]}class nr extends ge{constructor(e){super(),be(this,e,lr,tr,pe,{store:0})}}function ir(n){let e,l;return e=new te({props:{size:30,iconName:"noComment",description:"Select comment Mode",title:"Select comment Mode"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function rr(n){let e,l;return e=new te({props:{size:30,iconName:"commentOn",description:"Select comment Mode",title:"Select comment Mode"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function or(n){let e,l,t,i,r,o,s;const a=[rr,ir],c=[];function f(u,d){return u[1].matrixCommentMode?0:1}return t=f(n),i=c[t]=a[t](n),{c(){e=y("div"),l=y("div"),i.c(),this.h()},l(u){e=w(u,"DIV",{class:!0});var d=E(e);l=w(d,"DIV",{class:!0,href:!0,tabindex:!0,role:!0});var m=E(l);i.l(m),m.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","layer-trigger"),g(l,"href",null),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-container")},m(u,d){I(u,e,d),k(e,l),c[t].m(l,null),r=!0,o||(s=[W(l,"click",n[2]),W(l,"keydown",n[3])],o=!0)},p(u,[d]){let m=t;t=f(u),t!==m&&(ie(),C(c[m],1,1,()=>{c[m]=null}),re(),i=c[t],i||(i=c[t]=a[t](u),i.c()),b(i,1),i.m(l,null))},i(u){r||(b(i),r=!0)},o(u){C(i),r=!1},d(u){u&&_(e),c[t].d(),o=!1,Te(s)}}}function sr(n,e,l){let t,i=G,r=()=>(i(),i=Ve(o,c=>l(1,t=c)),o);n.$$.on_destroy.push(()=>i());let{store:o}=e;r();const s=()=>{Y(o,t.matrixCommentMode=!t.matrixCommentMode,t)},a=c=>Je(c,s);return n.$$set=c=>{"store"in c&&r(l(0,o=c.store))},[o,t,s,a]}class ar extends ge{constructor(e){super(),be(this,e,sr,or,pe,{store:0})}}const cr=n=>({store:n&1}),ml=n=>({H:n[1],store:n[0]});function fr(n){let e,l;const t=n[3].default,i=He(t,n,n[2],ml);return{c(){e=y("section"),i&&i.c(),this.h()},l(r){e=w(r,"SECTION",{id:!0,class:!0});var o=E(e);i&&i.l(o),o.forEach(_),this.h()},h(){g(e,"id","header--container"),g(e,"class","svelte-1yjouu8")},m(r,o){I(r,e,o),i&&i.m(e,null),l=!0},p(r,[o]){i&&i.p&&(!l||o&5)&&Re(i,t,r,r[2],l?Be(t,r[2],o,cr):Fe(r[2]),ml)},i(r){l||(b(i,r),l=!0)},o(r){C(i,r),l=!1},d(r){r&&_(e),i&&i.d(r)}}}function ur(n,e,l){let{$$slots:t={},$$scope:i}=e,{store:r}=e;const o={ProfileButtons:Di,ProfileSelect:Si,MappingMode:Fi,ExportImport:Ki,FilterMode:er,MatrixMappingPopover:nr,MatrixCommentToggle:ar};return n.$$set=s=>{"store"in s&&l(0,r=s.store),"$$scope"in s&&l(2,i=s.$$scope)},[r,o,i,t]}class kt extends ge{constructor(e){super(),be(this,e,ur,fr,pe,{store:0})}}function hl(n,e,l){const t=n.slice();return t[12]=e[l],t}function pl(n){let e,l=n[12].name+"",t;return{c(){e=y("option"),t=fe(l),this.h()},l(i){e=w(i,"OPTION",{});var r=E(e);t=ue(r,l),r.forEach(_),this.h()},h(){e.__value=n[12],ze(e,e.__value)},m(i,r){I(i,e,r),k(e,t)},p:G,d(i){i&&_(e)}}}function dr(n){let e,l,t,i,r,o,s,a,c,f="NAME",u,d,m,h,p=`Select Capability from Templates...
          `,$,v,N,M=n[0].name+"",L,P,T,q,O,z,Z,de="Save",le,x,ee="Cancel",Ie,me,U=qe(n[3]),J=[];for(let K=0;K<U.length;K+=1)J[K]=pl(hl(n,U,K));return{c(){e=y("section"),l=y("h2"),t=fe(n[1]),i=S(),r=y("hr"),o=S(),s=y("article"),a=y("div"),c=y("label"),c.textContent=f,u=S(),d=y("div"),m=y("select"),h=y("option"),h.textContent=p;for(let K=0;K<J.length;K+=1)J[K].c();$=S(),v=y("p"),N=fe("The Template Capability ("),L=fe(M),P=fe(`) will incorporate all
        associated Techniques.`),T=S(),q=y("hr"),O=S(),z=y("section"),Z=y("button"),Z.textContent=de,le=S(),x=y("button"),x.textContent=ee,this.h()},l(K){e=w(K,"SECTION",{id:!0,class:!0});var Q=E(e);l=w(Q,"H2",{class:!0});var oe=E(l);t=ue(oe,n[1]),oe.forEach(_),i=A(Q),r=w(Q,"HR",{}),o=A(Q),s=w(Q,"ARTICLE",{id:!0});var B=E(s);a=w(B,"DIV",{id:!0,class:!0});var D=E(a);c=w(D,"LABEL",{"aria-label":!0,for:!0,class:!0,"data-svelte-h":!0}),we(c)!=="svelte-l4gr53"&&(c.textContent=f),u=A(D),d=w(D,"DIV",{id:!0,class:!0});var R=E(d);m=w(R,"SELECT",{id:!0,class:!0});var ae=E(m);h=w(ae,"OPTION",{"data-svelte-h":!0}),we(h)!=="svelte-1lnlsc6"&&(h.textContent=p);for(let Ue=0;Ue<J.length;Ue+=1)J[Ue].l(ae);ae.forEach(_),R.forEach(_),$=A(D),v=w(D,"P",{class:!0});var Ee=E(v);N=ue(Ee,"The Template Capability ("),L=ue(Ee,M),P=ue(Ee,`) will incorporate all
        associated Techniques.`),Ee.forEach(_),D.forEach(_),T=A(B),q=w(B,"HR",{}),O=A(B),z=w(B,"SECTION",{id:!0,class:!0});var $e=E(z);Z=w($e,"BUTTON",{"data-svelte-h":!0}),we(Z)!=="svelte-syg9fy"&&(Z.textContent=de),le=A($e),x=w($e,"BUTTON",{"data-svelte-h":!0}),we(x)!=="svelte-1alkrs9"&&(x.textContent=ee),$e.forEach(_),B.forEach(_),Q.forEach(_),this.h()},h(){var K;g(l,"class","text-center"),g(c,"aria-label","Capability Name"),g(c,"for","capability-name"),g(c,"class","svelte-3ehrko"),h.selected=!0,h.disabled=!0,h.__value="",ze(h,h.__value),g(m,"id","capability--select"),m.required=!0,g(m,"class","svelte-3ehrko"),n[0]===void 0&&De(()=>n[9].call(m)),g(d,"id","autocomplete"),g(d,"class","svelte-3ehrko"),g(v,"class","form-info svelte-3ehrko"),se(v,"non--existing",!n[2].templates[(K=n[0])==null?void 0:K.id]),g(a,"id","layer-input-form"),g(a,"class","svelte-3ehrko"),g(z,"id","layer-btns"),g(z,"class","svelte-3ehrko"),g(s,"id","container-capability-form"),g(e,"id","dialog--container"),g(e,"class","svelte-3ehrko")},m(K,Q){I(K,e,Q),k(e,l),k(l,t),k(e,i),k(e,r),k(e,o),k(e,s),k(s,a),k(a,c),k(a,u),k(a,d),k(d,m),k(m,h);for(let oe=0;oe<J.length;oe+=1)J[oe]&&J[oe].m(m,null);mt(m,n[0],!0),k(a,$),k(a,v),k(v,N),k(v,L),k(v,P),k(s,T),k(s,q),k(s,O),k(s,z),k(z,Z),k(z,le),k(z,x),Ie||(me=[W(m,"change",n[9]),W(Z,"click",n[4]),W(x,"click",n[5])],Ie=!0)},p(K,[Q]){var oe;if(Q&2&&Me(t,K[1]),Q&8){U=qe(K[3]);let B;for(B=0;B<U.length;B+=1){const D=hl(K,U,B);J[B]?J[B].p(D,Q):(J[B]=pl(D),J[B].c(),J[B].m(m,null))}for(;B<J.length;B+=1)J[B].d(1);J.length=U.length}Q&9&&mt(m,K[0]),Q&1&&M!==(M=K[0].name+"")&&Me(L,M),Q&5&&se(v,"non--existing",!K[2].templates[(oe=K[0])==null?void 0:oe.id])},i:G,o:G,d(K){K&&_(e),We(J,K),Ie=!1,Te(me)}}}function mr(n,e,l){let t;ne(n,_e,p=>l(2,t=p));let{dialog:i}=e,{title:r}=e,{selectedCapability:o=""}=e,{store:s}=e,{copyHandler:a}=e;const c=Yl(),f=Object.values(t.rootTemplates.map(p=>t.templates[p])),u=(p,$,v=[])=>{v.push(p);for(const N of(p==null?void 0:p.children)||[])u($[N],$,v);return v},d=p=>{const $=u(o,s);a($),c("closeModal",{dialog:i,dialogName:"copy"})},m=p=>{c("closeModal",{dialog:i,dialogName:"copy"})};function h(){o=Jl(this),l(0,o),l(3,f)}return n.$$set=p=>{"dialog"in p&&l(6,i=p.dialog),"title"in p&&l(1,r=p.title),"selectedCapability"in p&&l(0,o=p.selectedCapability),"store"in p&&l(7,s=p.store),"copyHandler"in p&&l(8,a=p.copyHandler)},[o,r,t,f,d,m,i,s,a,h]}class hr extends ge{constructor(e){super(),be(this,e,mr,dr,pe,{dialog:6,title:1,selectedCapability:0,store:7,copyHandler:8})}}function _l(n){let e,l,t,i,r,o,s;return{c(){e=y("button"),l=fe("Save Techniques"),t=S(),i=y("button"),r=fe("Remove Techniques"),this.h()},l(a){e=w(a,"BUTTON",{class:!0,title:!0});var c=E(e);l=ue(c,"Save Techniques"),c.forEach(_),t=A(a),i=w(a,"BUTTON",{class:!0,title:!0});var f=E(i);r=ue(f,"Remove Techniques"),f.forEach(_),this.h()},h(){g(e,"class","control-btn svelte-1sz3pl3"),e.disabled=n[1],g(e,"title","Save Techniques to currently highlighted Capabilities"),g(i,"class","control-btn svelte-1sz3pl3"),i.disabled=n[1],g(i,"title","Remove Techniques from currently highlighted Capabilities")},m(a,c){I(a,e,c),k(e,l),I(a,t,c),I(a,i,c),k(i,r),o||(s=[W(e,"click",n[8]),W(i,"click",n[9])],o=!0)},p(a,c){c&2&&(e.disabled=a[1]),c&2&&(i.disabled=a[1])},d(a){a&&(_(e),_(t),_(i)),o=!1,Te(s)}}}function pr(n){let e,l=!n[2].isReadonly&&_l(n);return{c(){e=y("div"),l&&l.c(),this.h()},l(t){e=w(t,"DIV",{id:!0,class:!0});var i=E(e);l&&l.l(i),i.forEach(_),this.h()},h(){g(e,"id","row-persist-btns"),g(e,"class","svelte-1sz3pl3")},m(t,i){I(t,e,i),l&&l.m(e,null)},p(t,[i]){t[2].isReadonly?l&&(l.d(1),l=null):l?l.p(t,i):(l=_l(t),l.c(),l.m(e,null))},i:G,o:G,d(t){t&&_(e),l&&l.d()}}}function _r(n,e,l){let t,i,r,o;ne(n,_e,m=>l(2,r=m)),ne(n,Ke,m=>l(3,o=m));let{selectedStore:s}=e;const{selected:a}=xe("profile-config");ne(n,a,m=>l(0,i=m));const c=(m,h)=>{_e.saveTechniques(m,h,s),Ke.reset()},f=(m,h)=>{_e.removeTechniques(m,h,s),Ke.reset()},u=()=>c(o.treeMap,i),d=()=>f(o.treeMap,i);return n.$$set=m=>{"selectedStore"in m&&l(7,s=m.selectedStore)},n.$$.update=()=>{n.$$.dirty&1&&l(1,t=!Object.values(i).some(m=>m===he.selected))},[i,t,r,o,a,c,f,s,u,d]}class gr extends ge{constructor(e){super(),be(this,e,_r,pr,pe,{selectedStore:7})}}const br=n=>({}),gl=n=>({});function bl(n){let e,l,t,i,r,o,s,a,c,f,u;const d=[$r,vr],m=[];function h(p,$){return p[2]?0:1}return o=h(n),s=m[o]=d[o](n),{c(){e=y("div"),l=y("div"),i=S(),r=y("div"),s.c(),this.h()},l(p){e=w(p,"DIV",{class:!0,role:!0,tabindex:!0,"aria-describedby":!0,style:!0});var $=E(e);l=w($,"DIV",{class:!0,tabindex:!0,role:!0}),E(l).forEach(_),i=A($),r=w($,"DIV",{class:!0,role:!0,tabindex:!0});var v=E(r);s.l(v),v.forEach(_),$.forEach(_),this.h()},h(){g(l,"class","backdrop svelte-i6sid7"),g(l,"tabindex","0"),g(l,"role","button"),g(r,"class","wrapper svelte-i6sid7"),g(r,"role","button"),g(r,"tabindex","0"),g(e,"class","popover svelte-i6sid7"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"aria-describedby","Comment"),ve(e,"--popover-y",n[5].top+"px"),ve(e,"--popover-right",n[5].right+10+"px"),ve(e,"--color-icon",n[1])},m(p,$){I(p,e,$),k(e,l),k(e,i),k(e,r),m[o].m(r,null),c=!0,f||(u=[W(l,"click",wt(n[8])),W(r,"mouseleave",n[7])],f=!0)},p(p,$){let v=o;o=h(p),o===v?m[o].p(p,$):(ie(),C(m[v],1,1,()=>{m[v]=null}),re(),s=m[o],s?s.p(p,$):(s=m[o]=d[o](p),s.c()),b(s,1),s.m(r,null)),(!c||$&32)&&ve(e,"--popover-y",p[5].top+"px"),(!c||$&32)&&ve(e,"--popover-right",p[5].right+10+"px"),(!c||$&2)&&ve(e,"--color-icon",p[1])},i(p){c||(p&&De(()=>{c&&(t||(t=Ae(l,Oe,{delay:25,duration:150},!0)),t.run(1))}),b(s),p&&De(()=>{c&&(a||(a=Ae(e,Oe,{duration:150},!0)),a.run(1))}),c=!0)},o(p){p&&(t||(t=Ae(l,Oe,{delay:25,duration:150},!1)),t.run(0)),C(s),p&&(a||(a=Ae(e,Oe,{duration:150},!1)),a.run(0)),c=!1},d(p){p&&_(e),p&&t&&t.end(),m[o].d(),p&&a&&a.end(),f=!1,Te(u)}}}function vr(n){let e,l,t,i,r,o,s,a,c,f,u;return a=new te({props:{size:33,iconName:"edit",description:"Edit Description",title:"Edit Description",pathColor:"black"}}),{c(){e=y("div"),l=y("pre"),t=fe(n[3]),r=S(),o=y("div"),s=y("span"),V(a.$$.fragment),this.h()},l(d){e=w(d,"DIV",{class:!0,id:!0});var m=E(e);l=w(m,"PRE",{class:!0});var h=E(l);t=ue(h,n[3]),h.forEach(_),m.forEach(_),r=A(d),o=w(d,"DIV",{class:!0,role:!0,tabindex:!0});var p=E(o);s=w(p,"SPAN",{});var $=E(s);F(a.$$.fragment,$),$.forEach(_),p.forEach(_),this.h()},h(){g(l,"class","popover-text svelte-i6sid7"),g(e,"class","popover-comment svelte-i6sid7"),g(e,"id",i=n[0].id),g(o,"class","edit-btn svelte-i6sid7"),g(o,"role","button"),g(o,"tabindex","0")},m(d,m){I(d,e,m),k(e,l),k(l,t),I(d,r,m),I(d,o,m),k(o,s),j(a,s,null),c=!0,f||(u=[W(o,"click",n[9]),W(o,"keyup",null)],f=!0)},p(d,m){(!c||m&8)&&Me(t,d[3]),(!c||m&1&&i!==(i=d[0].id))&&g(e,"id",i)},i(d){c||(b(a.$$.fragment,d),c=!0)},o(d){C(a.$$.fragment,d),c=!1},d(d){d&&(_(e),_(r),_(o)),H(a),f=!1,Te(u)}}}function $r(n){let e,l,t,i,r,o,s,a,c,f,u;return o=new te({props:{size:33,iconName:"check",description:"Save Description",title:"Save Description"}}),o.$on("iconClick",n[10]),a=new te({props:{size:33,iconName:"close",description:"close",title:"close"}}),a.$on("iconClick",n[11]),{c(){e=y("div"),l=y("textarea"),i=S(),r=y("div"),V(o.$$.fragment),s=S(),V(a.$$.fragment),this.h()},l(d){e=w(d,"DIV",{class:!0,id:!0});var m=E(e);l=w(m,"TEXTAREA",{id:!0,name:!0,class:!0}),E(l).forEach(_),m.forEach(_),i=A(d),r=w(d,"DIV",{class:!0});var h=E(r);F(o.$$.fragment,h),s=A(h),F(a.$$.fragment,h),h.forEach(_),this.h()},h(){g(l,"id","layer-description"),g(l,"name","Description"),l.required=!0,g(l,"class","svelte-i6sid7"),g(e,"class","popover-comment svelte-i6sid7"),g(e,"id",t=n[0].id),g(r,"class","popover-btns svelte-i6sid7")},m(d,m){I(d,e,m),k(e,l),ze(l,n[3]),I(d,i,m),I(d,r,m),j(o,r,null),k(r,s),j(a,r,null),c=!0,f||(u=W(l,"input",n[16]),f=!0)},p(d,m){m&8&&ze(l,d[3]),(!c||m&1&&t!==(t=d[0].id))&&g(e,"id",t)},i(d){c||(b(o.$$.fragment,d),b(a.$$.fragment,d),c=!0)},o(d){C(o.$$.fragment,d),C(a.$$.fragment,d),c=!1},d(d){d&&(_(e),_(i),_(r)),H(o),H(a),f=!1,u()}}}function kr(n){let e,l,t,i,r,o;const s=n[14].popoverHover,a=He(s,n,n[13],gl);let c=(n[4]||n[2])&&bl(n);return{c(){e=y("div"),a&&a.c(),l=S(),c&&c.c(),t=ke(),this.h()},l(f){e=w(f,"DIV",{role:!0,tabindex:!0});var u=E(e);a&&a.l(u),u.forEach(_),l=A(f),c&&c.l(f),t=ke(),this.h()},h(){g(e,"role","button"),g(e,"tabindex","0")},m(f,u){I(f,e,u),a&&a.m(e,null),I(f,l,u),c&&c.m(f,u),I(f,t,u),i=!0,r||(o=[W(e,"click",n[6]),W(e,"keydown",n[15])],r=!0)},p(f,[u]){a&&a.p&&(!i||u&8192)&&Re(a,s,f,f[13],i?Be(s,f[13],u,br):Fe(f[13]),gl),f[4]||f[2]?c?(c.p(f,u),u&20&&b(c,1)):(c=bl(f),c.c(),b(c,1),c.m(t.parentNode,t)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){i||(b(a,f),b(c),i=!0)},o(f){C(a,f),C(c),i=!1},d(f){f&&(_(e),_(l),_(t)),a&&a.d(f),c&&c.d(f),r=!1,Te(o)}}}const _t=Ne(null),gt=Ne(!1),ft=Ne(!1),vl=Ne({}),bt=Ne({});let ut;const Cr=n=>(n==null?void 0:n.getBoundingClientRect())??{bottom:0,left:0};function yr(n,e,l){let t,i,r,o,s;ne(n,ft,T=>l(2,t=T)),ne(n,_t,T=>l(17,i=T)),ne(n,bt,T=>l(3,r=T)),ne(n,gt,T=>l(4,o=T)),ne(n,vl,T=>l(5,s=T));let{$$slots:a={},$$scope:c}=e,{item:f}=e,{color:u}=e,{comment:d}=e;const m=Yl(),h=T=>{clearTimeout(ut),ut=setTimeout(()=>{Y(_t,i=f.id,i),Y(vl,s=Cr(T.target),s),Y(gt,o=!0,o),Y(bt,r=d,r)},500)},p=T=>{clearTimeout(ut),ut=setTimeout(()=>{$()},1500)},$=()=>{Y(_t,i=null,i),Y(gt,o=!1,o),Y(ft,t=!1,t)},v=()=>{Y(ft,t=!0,t)},N=T=>{m("submit",{e:T,item:f,comment:r,layerId:i}),$()},M=()=>{Y(ft,t=!1,t),$()},L=T=>Je(T,h);function P(){r=this.value,bt.set(r)}return n.$$set=T=>{"item"in T&&l(0,f=T.item),"color"in T&&l(1,u=T.color),"comment"in T&&l(12,d=T.comment),"$$scope"in T&&l(13,c=T.$$scope)},[f,u,t,r,o,s,h,p,$,v,N,M,d,c,a,L,P]}class Nt extends ge{constructor(e){super(),be(this,e,yr,kr,pe,{item:0,color:1,comment:12})}}function wr(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{class:!0}),E(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-1pe53dj")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function Tr(n){let e,l,t;return l=new te({props:{size:Se,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[20]),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-1pe53dj"),se(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&se(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Er(n){let e,l=n[0].name+"",t,i,r;return{c(){e=y("span"),t=fe(l),this.h()},l(o){e=w(o,"SPAN",{class:!0,tabindex:!0,role:!0});var s=E(e);t=ue(s,l),s.forEach(_),this.h()},h(){var o;g(e,"class","layer-text svelte-1pe53dj"),g(e,"tabindex","0"),g(e,"role","button"),se(e,"root-layer",((o=n[0].children)==null?void 0:o.length)>0)},m(o,s){I(o,e,s),k(e,t),i||(r=[W(e,"click",n[24]),W(e,"keydown",n[25])],i=!0)},p(o,s){var a;s[0]&1&&l!==(l=o[0].name+"")&&Me(t,l),s[0]&1&&se(e,"root-layer",((a=o[0].children)==null?void 0:a.length)>0)},d(o){o&&_(e),i=!1,Te(r)}}}function Ir(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-1pe53dj")},m(i,r){I(i,e,r),ze(e,n[6]),l||(t=[nt(Ql.call(null,e)),W(e,"input",n[22]),W(e,"keydown",Qe(n[23]))],l=!0)},p(i,r){r[0]&64&&e.value!==i[6]&&ze(e,i[6])},d(i){i&&_(e),l=!1,Te(t)}}}function Nr(n){let e,l,t,i,r,o;return l=new te({props:{size:pt,iconName:"check",description:"Edit Capability",title:"Edit Capability"}}),l.$on("iconClick",n[32]),i=new te({props:{size:pt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[33]),{c(){e=y("div"),V(l.$$.fragment),t=S(),V(i.$$.fragment),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=E(e);F(l.$$.fragment,a),t=A(a),F(i.$$.fragment,a),a.forEach(_),this.h()},h(){g(e,"class","layer-form-btns svelte-1pe53dj")},m(s,a){I(s,e,a),j(l,e,null),k(e,t),j(i,e,null),o=!0},p:G,i(s){o||(b(l.$$.fragment,s),b(i.$$.fragment,s),s&&(r||De(()=>{r=Xe(e,it,{duration:700,delay:100,axis:"x",x:10}),r.start()})),o=!0)},o(s){C(l.$$.fragment,s),C(i.$$.fragment,s),o=!1},d(s){s&&_(e),H(l),H(i)}}}function Mr(n){let e,l,t,i,r,o,s,a,c,f,u;l=new te({props:{size:Se,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[26]),i=new te({props:{size:Se,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[27]),o=new te({props:{size:Se,iconName:"delete",description:"Delete Capability and Children",title:"Delete Capability and Children"}}),o.$on("iconClick",n[28]),a=new Nt({props:{item:n[0],color:n[0].color,comment:n[0].comment,$$slots:{popoverHover:[Dr]},$$scope:{ctx:n}}}),a.$on("submit",n[19]);let d=n[8].techniqueMappingMode!==ce.heatMap&&$l(n);return{c(){e=y("div"),V(l.$$.fragment),t=S(),V(i.$$.fragment),r=S(),V(o.$$.fragment),s=S(),V(a.$$.fragment),c=S(),d&&d.c(),this.h()},l(m){e=w(m,"DIV",{class:!0});var h=E(e);F(l.$$.fragment,h),t=A(h),F(i.$$.fragment,h),r=A(h),F(o.$$.fragment,h),s=A(h),F(a.$$.fragment,h),c=A(h),d&&d.l(h),h.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-1pe53dj")},m(m,h){I(m,e,h),j(l,e,null),k(e,t),j(i,e,null),k(e,r),j(o,e,null),k(e,s),j(a,e,null),k(e,c),d&&d.m(e,null),u=!0},p(m,h){const p={};h[0]&1&&(p.item=m[0]),h[0]&1&&(p.color=m[0].color),h[0]&1&&(p.comment=m[0].comment),h[1]&8&&(p.$$scope={dirty:h,ctx:m}),a.$set(p),m[8].techniqueMappingMode!==ce.heatMap?d?(d.p(m,h),h[0]&256&&b(d,1)):(d=$l(m),d.c(),b(d,1),d.m(e,null)):d&&(ie(),C(d,1,1,()=>{d=null}),re())},i(m){u||(b(l.$$.fragment,m),b(i.$$.fragment,m),b(o.$$.fragment,m),b(a.$$.fragment,m),b(d),m&&(f||De(()=>{f=Xe(e,it,{axis:"x",duration:100,x:-10}),f.start()})),u=!0)},o(m){C(l.$$.fragment,m),C(i.$$.fragment,m),C(o.$$.fragment,m),C(a.$$.fragment,m),C(d),u=!1},d(m){m&&_(e),H(l),H(i),H(o),H(a),d&&d.d()}}}function Dr(n){let e,l;return e=new te({props:{size:Se,iconName:"infoOutline",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function $l(n){let e,l,t,i,r,o,s;return e=new te({props:{size:Se,iconName:"color picker",description:"Pick Capability Family Color",title:"Pick Capability Family Color"}}),e.$on("iconClick",n[29]),{c(){V(e.$$.fragment),l=S(),t=y("input"),this.h()},l(a){F(e.$$.fragment,a),l=A(a),t=w(a,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,ve(t,"display","none")},m(a,c){j(e,a,c),I(a,l,c),I(a,t,c),n[30](t),r=!0,o||(s=W(t,"change",dn(wt(n[31]))),o=!0)},p(a,c){(!r||c[0]&1&&i!==(i=a[0].color))&&(t.value=i)},i(a){r||(b(e.$$.fragment,a),r=!0)},o(a){C(e.$$.fragment,a),r=!1},d(a){a&&(_(l),_(t)),H(e,a),n[30](null),o=!1,s()}}}function Pr(n){let e,l,t,i,r,o,s,a,c,f,u,d,m,h;const p=[Tr,wr],$=[];function v(O,z){return O[4]?0:1}l=v(n),t=$[l]=p[l](n);function N(O,z){return O[7][O[0].id]===he.editing?Ir:Er}let M=N(n),L=M(n);const P=[Mr,Nr],T=[];function q(O,z){return O[7][O[0].id]===he.selected||O[7][O[0].id]===he.root?0:O[7][O[0].id]===he.editing?1:-1}return~(f=q(n))&&(u=T[f]=P[f](n)),{c(){e=y("div"),t.c(),i=S(),r=y("form"),o=y("input"),a=S(),L.c(),c=S(),u&&u.c(),this.h()},l(O){e=w(O,"DIV",{class:!0,style:!0});var z=E(e);t.l(z),i=A(z),r=w(z,"FORM",{});var Z=E(r);o=w(Z,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0,style:!0}),Z.forEach(_),a=A(z),L.l(z),c=A(z),u&&u.l(z),z.forEach(_),this.h()},h(){var O,z,Z;g(o,"class","check-box svelte-1pe53dj"),g(o,"type","checkbox"),g(o,"name","include"),o.checked=s=(O=n[0])==null?void 0:O.checked,g(o,"tabindex","0"),ve(o,"accent-color",n[0].color),g(e,"class","layer-parent svelte-1pe53dj"),ve(e,"--expanded-width",Se+"px"),se(e,"selected-layer",n[7][n[0].id]===he.selected),se(e,"layer-hover",!((Z=(z=n[0])==null?void 0:z.children)!=null&&Z.length))},m(O,z){I(O,e,z),$[l].m(e,null),k(e,i),k(e,r),k(r,o),k(e,a),L.m(e,null),k(e,c),~f&&T[f].m(e,null),d=!0,m||(h=W(o,"click",Qe(n[21])),m=!0)},p(O,z){var le,x,ee;let Z=l;l=v(O),l===Z?$[l].p(O,z):(ie(),C($[Z],1,1,()=>{$[Z]=null}),re(),t=$[l],t?t.p(O,z):(t=$[l]=p[l](O),t.c()),b(t,1),t.m(e,i)),(!d||z[0]&1&&s!==(s=(le=O[0])==null?void 0:le.checked))&&(o.checked=s),(!d||z[0]&1)&&ve(o,"accent-color",O[0].color),M===(M=N(O))&&L?L.p(O,z):(L.d(1),L=M(O),L&&(L.c(),L.m(e,c)));let de=f;f=q(O),f===de?~f&&T[f].p(O,z):(u&&(ie(),C(T[de],1,1,()=>{T[de]=null}),re()),~f?(u=T[f],u?u.p(O,z):(u=T[f]=P[f](O),u.c()),b(u,1),u.m(e,null)):u=null),(!d||z[0]&129)&&se(e,"selected-layer",O[7][O[0].id]===he.selected),(!d||z[0]&1)&&se(e,"layer-hover",!((ee=(x=O[0])==null?void 0:x.children)!=null&&ee.length))},i(O){d||(b(t),b(u),d=!0)},o(O){C(t),C(u),d=!1},d(O){O&&_(e),$[l].d(),L.d(),~f&&T[f].d(),m=!1,h()}}}function qr(n,e,l){let t,i,r,o,s=G,a=()=>(s(),s=Ve(u,D=>l(8,o=D)),u),c;n.$$.on_destroy.push(()=>s());let{layer:f}=e,{store:u}=e;a();let{storeProp:d}=e,{handlers:m}=e,{expandable:h}=e;const{expanded:p,selected:$,editingName:v,colorPicker:N}=xe("profile-config");ne(n,p,D=>l(9,c=D)),ne(n,$,D=>l(7,r=D)),ne(n,v,D=>l(6,i=D)),ne(n,N,D=>l(5,t=D));const M=(D,R)=>{Y(p,c[R.id]=!c[R.id],c)},L=(D,R)=>{var Ee;const ae=R===void 0?o[d][D.id].checked:R;if(Y(u,o[d][D.id].checked=!ae,o),!!((Ee=D==null?void 0:D.children)!=null&&Ee.length))for(const $e of D.children)L(o[d][$e],ae)},P=(D,R,ae)=>{D.detail.event.stopPropagation(),Y($,r[R.id]=he.editing,r),Y($,r[ae.id]=he.noop,r),Y(v,i=R.name,i)},T=(D,R)=>{t[R.id].click()},q=(D,R,ae)=>{u.saveLayerColor(R,D.srcElement.value,ae)},O=D=>{const{item:R,comment:ae}=D.detail;u.editLayerComment(R.id,ae,d)},z=D=>M(D,f),Z=D=>L(f);function de(){i=this.value,v.set(i)}const le=D=>Je(D,m.saveCapabilityName,f.id,i,d),x=D=>m.selectLayer(D,f,f.children.length!==0),ee=D=>Je(D,m.selectLayer,f,f.children.length!==0),Ie=D=>m.showCreateLayerDialog(D,f,null),me=D=>P(D,f,parent),U=D=>m.deleteCapability(f),J=D=>T(D,f);function K(D){Pe[D?"unshift":"push"](()=>{t[f.id]=D,N.set(t)})}const Q=D=>q(D,f,d),oe=D=>m.saveCapabilityName(f.id,null,i,d),B=D=>m.cancelEdit(D,f);return n.$$set=D=>{"layer"in D&&l(0,f=D.layer),"store"in D&&a(l(1,u=D.store)),"storeProp"in D&&l(2,d=D.storeProp),"handlers"in D&&l(3,m=D.handlers),"expandable"in D&&l(4,h=D.expandable)},[f,u,d,m,h,t,i,r,o,c,p,$,v,N,M,L,P,T,q,O,z,Z,de,le,x,ee,Ie,me,U,J,K,Q,oe,B]}class Sr extends ge{constructor(e){super(),be(this,e,qr,Pr,pe,{layer:0,store:1,storeProp:2,handlers:3,expandable:4},null,[-1,-1])}}function Ar(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{class:!0}),E(e).forEach(_),this.h()},h(){g(e,"class","non-expandable svelte-bodng4")},m(l,t){I(l,e,t)},p:G,i:G,o:G,d(l){l&&_(e)}}}function Or(n){let e,l,t;return l=new te({props:{size:Se,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[20]),{c(){e=y("div"),V(l.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","expanded-btn svelte-bodng4"),se(e,"expanded",n[9][n[0].id])},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){(!t||r[0]&513)&&se(e,"expanded",i[9][i[0].id])},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Lr(n){let e,l=n[0].name+"",t,i,r;return{c(){e=y("span"),t=fe(l),this.h()},l(o){e=w(o,"SPAN",{class:!0,tabindex:!0,role:!0});var s=E(e);t=ue(s,l),s.forEach(_),this.h()},h(){g(e,"class","layer-text svelte-bodng4"),g(e,"tabindex","0"),g(e,"role","button")},m(o,s){I(o,e,s),k(e,t),i||(r=[W(e,"click",n[25]),W(e,"keydown",Qe(n[26]))],i=!0)},p(o,s){s[0]&1&&l!==(l=o[0].name+"")&&Me(t,l)},d(o){o&&_(e),i=!1,Te(r)}}}function zr(n){let e,l,t;return{c(){e=y("input"),this.h()},l(i){e=w(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){g(e,"type","text"),g(e,"name","capabilityName"),g(e,"class","layer-text text-cursor svelte-bodng4")},m(i,r){I(i,e,r),ze(e,n[11]),l||(t=[nt(Ql.call(null,e)),W(e,"input",n[23]),W(e,"keydown",Qe(n[24]))],l=!0)},p(i,r){r[0]&2048&&e.value!==i[11]&&ze(e,i[11])},d(i){i&&_(e),l=!1,Te(t)}}}function Vr(n){let e,l,t,i,r,o;return l=new te({props:{size:pt,iconName:"check",description:"Save Capability",title:"Save Capability"}}),l.$on("iconClick",n[33]),i=new te({props:{size:pt,iconName:"close",description:"close",title:"close"}}),i.$on("iconClick",n[34]),{c(){e=y("div"),V(l.$$.fragment),t=S(),V(i.$$.fragment),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=E(e);F(l.$$.fragment,a),t=A(a),F(i.$$.fragment,a),a.forEach(_),this.h()},h(){g(e,"class","layer-form-btns svelte-bodng4")},m(s,a){I(s,e,a),j(l,e,null),k(e,t),j(i,e,null),o=!0},p:G,i(s){o||(b(l.$$.fragment,s),b(i.$$.fragment,s),s&&(r||De(()=>{r=Xe(e,it,{duration:700,delay:100,axis:"x",x:10}),r.start()})),o=!0)},o(s){C(l.$$.fragment,s),C(i.$$.fragment,s),o=!1},d(s){s&&_(e),H(l),H(i)}}}function jr(n){let e,l,t,i,r,o,s,a,c,f,u;l=new te({props:{size:Se,iconName:"plus",description:"Create Capability Child",title:"Create Capability Child"}}),l.$on("iconClick",n[27]),i=new te({props:{size:Se,iconName:"edit",description:"Edit Capability",title:"Edit Capability"}}),i.$on("iconClick",n[28]),o=new te({props:{size:28,iconName:"delete",description:"Delete Capability",title:"Delete Capability"}}),o.$on("iconClick",n[29]),a=new Nt({props:{item:n[0],color:n[0].color,comment:n[0].comment,$$slots:{popoverHover:[Hr]},$$scope:{ctx:n}}}),a.$on("submit",n[19]);let d=n[8].techniqueMappingMode!==ce.heatMap&&kl(n);return{c(){e=y("div"),V(l.$$.fragment),t=S(),V(i.$$.fragment),r=S(),V(o.$$.fragment),s=S(),V(a.$$.fragment),c=S(),d&&d.c(),this.h()},l(m){e=w(m,"DIV",{class:!0});var h=E(e);F(l.$$.fragment,h),t=A(h),F(i.$$.fragment,h),r=A(h),F(o.$$.fragment,h),s=A(h),F(a.$$.fragment,h),c=A(h),d&&d.l(h),h.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-bodng4")},m(m,h){I(m,e,h),j(l,e,null),k(e,t),j(i,e,null),k(e,r),j(o,e,null),k(e,s),j(a,e,null),k(e,c),d&&d.m(e,null),u=!0},p(m,h){const p={};h[0]&1&&(p.item=m[0]),h[0]&1&&(p.color=m[0].color),h[0]&1&&(p.comment=m[0].comment),h[1]&16&&(p.$$scope={dirty:h,ctx:m}),a.$set(p),m[8].techniqueMappingMode!==ce.heatMap?d?(d.p(m,h),h[0]&256&&b(d,1)):(d=kl(m),d.c(),b(d,1),d.m(e,null)):d&&(ie(),C(d,1,1,()=>{d=null}),re())},i(m){u||(b(l.$$.fragment,m),b(i.$$.fragment,m),b(o.$$.fragment,m),b(a.$$.fragment,m),b(d),m&&(f||De(()=>{f=Xe(e,it,{axis:"x",duration:200,x:-5}),f.start()})),u=!0)},o(m){C(l.$$.fragment,m),C(i.$$.fragment,m),C(o.$$.fragment,m),C(a.$$.fragment,m),C(d),u=!1},d(m){m&&_(e),H(l),H(i),H(o),H(a),d&&d.d()}}}function Hr(n){let e,l;return e=new te({props:{size:Se,iconName:"infoOutline",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function kl(n){let e,l,t,i,r,o,s;return e=new te({props:{size:Se,iconName:"color picker",description:"Pick Capability Color",title:"Pick Capability Color"}}),e.$on("iconClick",n[30]),{c(){V(e.$$.fragment),l=S(),t=y("input"),this.h()},l(a){F(e.$$.fragment,a),l=A(a),t=w(a,"INPUT",{type:!0,id:!0,name:!0,style:!0}),this.h()},h(){g(t,"type","color"),g(t,"id","head"),g(t,"name","head"),t.value=i=n[0].color,ve(t,"display","none")},m(a,c){j(e,a,c),I(a,l,c),I(a,t,c),n[31](t),r=!0,o||(s=W(t,"change",n[32]),o=!0)},p(a,c){(!r||c[0]&1&&i!==(i=a[0].color))&&(t.value=i)},i(a){r||(b(e.$$.fragment,a),r=!0)},o(a){C(e.$$.fragment,a),r=!1},d(a){a&&(_(l),_(t)),H(e,a),n[31](null),o=!1,s()}}}function Rr(n){let e,l,t,i,r,o,s,a,c,f,u,d,m;const h=[Or,Ar],p=[];function $(q,O){return q[6]?0:1}l=$(n),t=p[l]=h[l](n);function v(q,O){return q[10][q[0].id]===he.editing?zr:Lr}let N=v(n),M=N(n);const L=[jr,Vr],P=[];function T(q,O){return q[10][q[0].id]===he.selected?0:q[10][q[0].id]===he.editing?1:-1}return~(c=T(n))&&(f=P[c]=L[c](n)),{c(){e=y("div"),t.c(),i=S(),r=y("input"),s=S(),M.c(),a=S(),f&&f.c(),this.h()},l(q){e=w(q,"DIV",{class:!0,style:!0});var O=E(e);t.l(O),i=A(O),r=w(O,"INPUT",{class:!0,type:!0,name:!0,style:!0}),s=A(O),M.l(O),a=A(O),f&&f.l(O),O.forEach(_),this.h()},h(){var q;g(r,"class","check-box svelte-bodng4"),g(r,"type","checkbox"),g(r,"name","include"),r.checked=o=(q=n[0])==null?void 0:q.checked,ve(r,"accent-color",n[0].color),g(e,"class","layer-child layer-hover svelte-bodng4"),ve(e,"--expanded-icon-width",Se+"px"),se(e,"selected-layer",n[10][n[0].id]===he.selected)},m(q,O){I(q,e,O),p[l].m(e,null),k(e,i),k(e,r),k(e,s),M.m(e,null),k(e,a),~c&&P[c].m(e,null),u=!0,d||(m=[W(r,"click",Qe(n[21])),W(r,"keydown",n[22])],d=!0)},p(q,O){var de;let z=l;l=$(q),l===z?p[l].p(q,O):(ie(),C(p[z],1,1,()=>{p[z]=null}),re(),t=p[l],t?t.p(q,O):(t=p[l]=h[l](q),t.c()),b(t,1),t.m(e,i)),(!u||O[0]&1&&o!==(o=(de=q[0])==null?void 0:de.checked))&&(r.checked=o),(!u||O[0]&1)&&ve(r,"accent-color",q[0].color),N===(N=v(q))&&M?M.p(q,O):(M.d(1),M=N(q),M&&(M.c(),M.m(e,a)));let Z=c;c=T(q),c===Z?~c&&P[c].p(q,O):(f&&(ie(),C(P[Z],1,1,()=>{P[Z]=null}),re()),~c?(f=P[c],f?f.p(q,O):(f=P[c]=L[c](q),f.c()),b(f,1),f.m(e,null)):f=null),(!u||O[0]&1025)&&se(e,"selected-layer",q[10][q[0].id]===he.selected)},i(q){u||(b(t),b(f),u=!0)},o(q){C(t),C(f),u=!1},d(q){q&&_(e),p[l].d(),M.d(),~c&&P[c].d(),d=!1,Te(m)}}}function Fr(n,e,l){let t,i,r=G,o=()=>(r(),r=Ve(m,R=>l(8,i=R)),m),s,a,c;n.$$.on_destroy.push(()=>r());let{layer:f}=e,{parent:u}=e,{root:d}=e,{store:m}=e;o();let{storeProp:h}=e,{handlers:p}=e,{expandable:$}=e;const{expanded:v,selected:N,editingName:M,colorPicker:L}=xe("profile-config");ne(n,v,R=>l(9,s=R)),ne(n,N,R=>l(10,a=R)),ne(n,M,R=>l(11,c=R)),ne(n,L,R=>l(7,t=R));const P=(R,ae)=>{Y(v,s[ae.id]=!s[ae.id],s)},T=R=>{const ae=i[h][R.id].checked;Y(m,i[h][R.id].checked=!ae,i)},q=(R,ae)=>{t[ae.id].click()},O=R=>{const{item:ae,comment:Ee}=R.detail;m.editLayerComment(ae.id,Ee,h)},z=R=>P(R,f),Z=R=>T(f),de=R=>Je(R,T,f);function le(){c=this.value,M.set(c)}const x=R=>Je(R,p.saveCapabilityName,f.id,d,c,h),ee=R=>p.selectLayer(R,f,!1,d),Ie=R=>Je(R,p.selectLayer,f,!1,d),me=R=>p.showCreateLayerDialog(R,f,d),U=R=>p.editCapability(R,f,u),J=R=>p.deleteChildCapability(f,u,h),K=R=>q(R,f);function Q(R){Pe[R?"unshift":"push"](()=>{t[f.id]=R,L.set(t)})}const oe=R=>p.updateCapabilityColor(R,f,h),B=R=>p.saveCapabilityName(f.id,d,c,h),D=R=>p.cancelEdit(R,f);return n.$$set=R=>{"layer"in R&&l(0,f=R.layer),"parent"in R&&l(1,u=R.parent),"root"in R&&l(2,d=R.root),"store"in R&&o(l(3,m=R.store)),"storeProp"in R&&l(4,h=R.storeProp),"handlers"in R&&l(5,p=R.handlers),"expandable"in R&&l(6,$=R.expandable)},[f,u,d,m,h,p,$,t,i,s,a,c,v,N,M,L,P,T,q,O,z,Z,de,le,x,ee,Ie,me,U,J,K,Q,oe,B,D]}class Br extends ge{constructor(e){super(),be(this,e,Fr,Rr,pe,{layer:0,parent:1,root:2,store:3,storeProp:4,handlers:5,expandable:6},null,[-1,-1])}}function Cl(n){let e;return{c(){e=y("div"),this.h()},l(l){e=w(l,"DIV",{title:!0,class:!0}),E(e).forEach(_),this.h()},h(){g(e,"title","Commented Technique"),g(e,"class","dot svelte-bodng4")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function yl(n){let e,l,t,i,r,o,s;l=new te({props:{size:Se,iconName:"info",description:"Technique Info",title:"Technique Info"}}),l.$on("iconClick",n[13]),i=new te({props:{size:Se,iconName:"linking",description:"Edit ATT&CK Associations",title:"Edit ATT&CK Associations"}}),i.$on("iconClick",n[14]);let a=!n[6].isReadonly&&wl(n);return{c(){e=y("div"),V(l.$$.fragment),t=S(),V(i.$$.fragment),r=S(),a&&a.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=E(e);F(l.$$.fragment,f),t=A(f),F(i.$$.fragment,f),r=A(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(e,"class","layer-btns svelte-bodng4")},m(c,f){I(c,e,f),j(l,e,null),k(e,t),j(i,e,null),k(e,r),a&&a.m(e,null),s=!0},p(c,f){c[6].isReadonly?a&&(ie(),C(a,1,1,()=>{a=null}),re()):a?(a.p(c,f),f&64&&b(a,1)):(a=wl(c),a.c(),b(a,1),a.m(e,null))},i(c){s||(b(l.$$.fragment,c),b(i.$$.fragment,c),b(a),c&&(o||De(()=>{o=Xe(e,it,{axis:"x",duration:200,x:-5}),o.start()})),s=!0)},o(c){C(l.$$.fragment,c),C(i.$$.fragment,c),C(a),s=!1},d(c){c&&_(e),H(l),H(i),a&&a.d()}}}function wl(n){let e,l;return e=new Nt({props:{item:n[1],color:n[1].color,comment:n[1].techniques.find(n[15]).comment,$$slots:{popoverHover:[Ur]},$$scope:{ctx:n}}}),e.$on("submit",n[9]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&2&&(r.item=t[1]),i&2&&(r.color=t[1].color),i&3&&(r.comment=t[1].techniques.find(t[15]).comment),i&65536&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ur(n){let e,l;return e=new te({props:{size:Se,iconName:"comment",description:"Add D3FEND Comment",title:"Add D3FEND Comment",slot:"popoverHover"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Gr(n){var d;let e,l,t=((d=n[5].treeMap)==null?void 0:d[n[0].id]["rdfs:label"])+"",i,r,o,s,a,c,f=n[0].comment!==""&&Cl(),u=n[4]===n[0].id&&yl(n);return{c(){e=y("li"),l=y("span"),i=fe(t),r=S(),f&&f.c(),o=S(),u&&u.c(),this.h()},l(m){e=w(m,"LI",{class:!0});var h=E(e);l=w(h,"SPAN",{class:!0,tabindex:!0,role:!0});var p=E(l);i=ue(p,t),r=A(p),f&&f.l(p),p.forEach(_),o=A(h),u&&u.l(h),h.forEach(_),this.h()},h(){g(l,"class","layer-text d3fend-technique svelte-bodng4"),g(l,"tabindex","0"),g(l,"role","button"),g(e,"class","layer-child layer-technique svelte-bodng4"),se(e,"selected-layer",n[4]===n[0].id)},m(m,h){I(m,e,h),k(e,l),k(l,i),k(l,r),f&&f.m(l,null),k(e,o),u&&u.m(e,null),s=!0,a||(c=[W(l,"click",n[11]),W(l,"keydown",Qe(n[12]))],a=!0)},p(m,[h]){var p;(!s||h&33)&&t!==(t=((p=m[5].treeMap)==null?void 0:p[m[0].id]["rdfs:label"])+"")&&Me(i,t),m[0].comment!==""?f||(f=Cl(),f.c(),f.m(l,null)):f&&(f.d(1),f=null),m[4]===m[0].id?u?(u.p(m,h),h&17&&b(u,1)):(u=yl(m),u.c(),b(u,1),u.m(e,null)):u&&(ie(),C(u,1,1,()=>{u=null}),re()),(!s||h&17)&&se(e,"selected-layer",m[4]===m[0].id)},i(m){s||(b(u),s=!0)},o(m){C(u),s=!1},d(m){m&&_(e),f&&f.d(),u&&u.d(),a=!1,Te(c)}}}function Kr(n,e,l){let t,i=G,r=()=>(i(),i=Ve(f,P=>l(4,t=P)),f),o,s;ne(n,Ke,P=>l(5,o=P)),ne(n,_e,P=>l(6,s=P)),n.$$.on_destroy.push(()=>i());let{technique:a}=e,{layer:c}=e,{selectedTechnique:f}=e;r();let{handlers:u}=e,{storeProp:d}=e;const m=(P,T,q)=>{if(t===T){Y(f,t=null,t),Ke.deselectTechnique(T);return}if(t===null){Y(f,t=T,t),Ke.selectTechnique(T);return}Ke.deselectTechnique(t),Ke.selectTechnique(T),Y(f,t=T,t)},h=P=>{dt(`/profile/?technique_id=${a.id}`)},p=P=>{const{comment:T,layerId:q}=P.detail;_e.saveLayerTechniqueComment(q,a.id,T,d),Y(f,t=null,t)},$=P=>m(P,a.id),v=P=>Je(P,m,a.id,"keydown"),N=P=>h(a.id),M=P=>u.openAttackDialog(P,a.id,c.id,c.color),L=P=>P.id===a.id;return n.$$set=P=>{"technique"in P&&l(0,a=P.technique),"layer"in P&&l(1,c=P.layer),"selectedTechnique"in P&&r(l(2,f=P.selectedTechnique)),"handlers"in P&&l(3,u=P.handlers),"storeProp"in P&&l(10,d=P.storeProp)},[a,c,f,u,t,o,s,m,h,p,d,$,v,N,M,L]}class Jr extends ge{constructor(e){super(),be(this,e,Kr,Gr,pe,{technique:0,layer:1,selectedTechnique:2,handlers:3,storeProp:10})}}function Tl(n,e,l){const t=n.slice();return t[11]=e[l],t}function El(n){let e,l,t,i=qe(n[2]),r=[];for(let s=0;s<i.length;s+=1)r[s]=Il(Tl(n,i,s));const o=s=>C(r[s],1,1,()=>{r[s]=null});return{c(){e=y("ul");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=w(s,"UL",{class:!0});var a=E(e);for(let c=0;c<r.length;c+=1)r[c].l(a);a.forEach(_),this.h()},h(){g(e,"class","svelte-1vl1zhs")},m(s,a){I(s,e,a);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);t=!0},p(s,a){if(a&159){i=qe(s[2]);let c;for(c=0;c<i.length;c+=1){const f=Tl(s,i,c);r[c]?(r[c].p(f,a),b(r[c],1)):(r[c]=Il(f),r[c].c(),b(r[c],1),r[c].m(e,null))}for(ie(),c=i.length;c<r.length;c+=1)o(c);re()}},i(s){if(!t){for(let a=0;a<i.length;a+=1)b(r[a]);s&&De(()=>{t&&(l||(l=Ae(e,Ye,{duration:200},!0)),l.run(1))}),t=!0}},o(s){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)C(r[a]);s&&(l||(l=Ae(e,Ye,{duration:200},!1)),l.run(0)),t=!1},d(s){s&&_(e),We(r,s),s&&l&&l.end()}}}function Il(n){let e,l;return e=new Jr({props:{technique:n[11],root:n[1],layer:n[0],selectedTechnique:n[7],handlers:n[3],storeProp:n[4]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&4&&(r.technique=t[11]),i&2&&(r.root=t[1]),i&1&&(r.layer=t[0]),i&8&&(r.handlers=t[3]),i&16&&(r.storeProp=t[4]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Wr(n){let e,l,t,i,r,o,s,a=`D3FEND (${n[2].length||0})`,c,f,u,d,m,h;t=new te({props:{size:Se,iconName:"arrowRight",description:"Create Capability Child",title:"Create Capability Child"}}),r=new te({props:{size:Se,iconName:"folder",description:"Techniques"}});let p=n[5][n[0].id]&&El(n);return{c(){e=y("div"),l=y("div"),V(t.$$.fragment),i=S(),V(r.$$.fragment),o=S(),s=y("div"),c=fe(a),f=S(),p&&p.c(),u=ke(),this.h()},l($){e=w($,"DIV",{class:!0,role:!0,tabindex:!0});var v=E(e);l=w(v,"DIV",{class:!0});var N=E(l);F(t.$$.fragment,N),N.forEach(_),i=A(v),F(r.$$.fragment,v),o=A(v),s=w(v,"DIV",{});var M=E(s);c=ue(M,a),M.forEach(_),v.forEach(_),f=A($),p&&p.l($),u=ke(),this.h()},h(){g(l,"class","expanded-btn svelte-1vl1zhs"),se(l,"expanded",n[5][n[0].id]),g(e,"class","layer-parent svelte-1vl1zhs"),g(e,"role","button"),g(e,"tabindex","0")},m($,v){I($,e,v),k(e,l),j(t,l,null),k(e,i),j(r,e,null),k(e,o),k(e,s),k(s,c),I($,f,v),p&&p.m($,v),I($,u,v),d=!0,m||(h=[W(e,"click",n[9]),W(e,"keydown",n[10])],m=!0)},p($,[v]){(!d||v&33)&&se(l,"expanded",$[5][$[0].id]),(!d||v&4)&&a!==(a=`D3FEND (${$[2].length||0})`)&&Me(c,a),$[5][$[0].id]?p?(p.p($,v),v&33&&b(p,1)):(p=El($),p.c(),b(p,1),p.m(u.parentNode,u)):p&&(ie(),C(p,1,1,()=>{p=null}),re())},i($){d||(b(t.$$.fragment,$),b(r.$$.fragment,$),b(p),d=!0)},o($){C(t.$$.fragment,$),C(r.$$.fragment,$),C(p),d=!1},d($){$&&(_(e),_(f),_(u)),H(t),H(r),p&&p.d($),m=!1,Te(h)}}}function Yr(n,e,l){let t,{layer:i}=e,{root:r}=e,{techniques:o}=e,{handlers:s}=e,{storeProp:a}=e;const{expandedTechniques:c,selectedTechnique:f}=xe("profile-config");ne(n,c,h=>l(5,t=h));const u=(h,p)=>{Y(c,t[p]=!t[p],t)},d=h=>u(h,i.id),m=h=>Je(h,u,i.id);return n.$$set=h=>{"layer"in h&&l(0,i=h.layer),"root"in h&&l(1,r=h.root),"techniques"in h&&l(2,o=h.techniques),"handlers"in h&&l(3,s=h.handlers),"storeProp"in h&&l(4,a=h.storeProp)},[i,r,o,s,a,t,c,f,u,d,m]}class Zr extends ge{constructor(e){super(),be(this,e,Yr,Wr,pe,{layer:0,root:1,techniques:2,handlers:3,storeProp:4})}}function Nl(n,e,l){const t=n.slice();return t[13]=e[l],t}function vt(n){const e=n.slice(),l=e[2]?e[2]:e[7];return e[12]=l,e}function Qr(n){let e,l;return e=new Br({props:{layer:n[7],parent:n[3],root:n[2],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.layer=t[7]),i&8&&(r.parent=t[3]),i&4&&(r.root=t[2]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Xr(n){let e,l;return e=new Sr({props:{layer:n[7],store:n[4],storeProp:n[5],handlers:n[6],expandable:n[9]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.layer=t[7]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),i&64&&(r.handlers=t[6]),i&512&&(r.expandable=t[9]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ml(n){let e,l,t,i,r=qe(n[7].children||[]),o=[];for(let c=0;c<r.length;c+=1)o[c]=Dl(Nl(n,r,c));const s=c=>C(o[c],1,1,()=>{o[c]=null});let a=n[7].techniques.length>0&&n[8].associationMode&&Pl(n);return{c(){e=y("ul");for(let c=0;c<o.length;c+=1)o[c].c();l=S(),a&&a.c(),this.h()},l(c){e=w(c,"UL",{class:!0});var f=E(e);for(let u=0;u<o.length;u+=1)o[u].l(f);l=A(f),a&&a.l(f),f.forEach(_),this.h()},h(){g(e,"class","svelte-1pe53dj")},m(c,f){I(c,e,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null);k(e,l),a&&a.m(e,null),i=!0},p(c,f){if(n=c,f&244){r=qe(n[7].children||[]);let u;for(u=0;u<r.length;u+=1){const d=Nl(n,r,u);o[u]?(o[u].p(d,f),b(o[u],1)):(o[u]=Dl(d),o[u].c(),b(o[u],1),o[u].m(e,l))}for(ie(),u=r.length;u<o.length;u+=1)s(u);re()}n[7].techniques.length>0&&n[8].associationMode?a?(a.p(n,f),f&384&&b(a,1)):(a=Pl(n),a.c(),b(a,1),a.m(e,null)):a&&(ie(),C(a,1,1,()=>{a=null}),re())},i(c){if(!i){for(let f=0;f<r.length;f+=1)b(o[f]);b(a),c&&De(()=>{i&&(t||(t=Ae(e,Ye,{duration:ql},!0)),t.run(1))}),i=!0}},o(c){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)C(o[f]);C(a),c&&(t||(t=Ae(e,Ye,{duration:ql},!1)),t.run(0)),i=!1},d(c){c&&_(e),We(o,c),a&&a.d(),c&&t&&t.end()}}}function Dl(n){let e,l,t;return l=new en({props:{layerId:n[13],root:n[12],parent:n[7],store:n[4],storeProp:n[5],handlers:n[6]}}),{c(){e=y("li"),V(l.$$.fragment),this.h()},l(i){e=w(i,"LI",{class:!0});var r=E(e);F(l.$$.fragment,r),r.forEach(_),this.h()},h(){g(e,"class","svelte-1pe53dj")},m(i,r){I(i,e,r),j(l,e,null),t=!0},p(i,r){const o={};r&128&&(o.layerId=i[13]),r&132&&(o.root=i[12]),r&128&&(o.parent=i[7]),r&16&&(o.store=i[4]),r&32&&(o.storeProp=i[5]),r&64&&(o.handlers=i[6]),l.$set(o)},i(i){t||(b(l.$$.fragment,i),t=!0)},o(i){C(l.$$.fragment,i),t=!1},d(i){i&&_(e),H(l)}}}function Pl(n){let e,l;return e=new Zr({props:{techniques:n[7].techniques,handlers:n[6],root:n[2],layer:n[7],store:n[4],storeProp:n[5]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i&128&&(r.techniques=t[7].techniques),i&64&&(r.handlers=t[6]),i&4&&(r.root=t[2]),i&128&&(r.layer=t[7]),i&16&&(r.store=t[4]),i&32&&(r.storeProp=t[5]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function xr(n){let e,l,t,i,r;const o=[Xr,Qr],s=[];function a(f,u){return f[2]?f[1]?1:-1:0}~(e=a(n))&&(l=s[e]=o[e](n));let c=n[10][n[0]]&&n[1]&&Ml(vt(n));return{c(){l&&l.c(),t=S(),c&&c.c(),i=ke()},l(f){l&&l.l(f),t=A(f),c&&c.l(f),i=ke()},m(f,u){~e&&s[e].m(f,u),I(f,t,u),c&&c.m(f,u),I(f,i,u),r=!0},p(f,[u]){let d=e;e=a(f),e===d?~e&&s[e].p(f,u):(l&&(ie(),C(s[d],1,1,()=>{s[d]=null}),re()),~e?(l=s[e],l?l.p(f,u):(l=s[e]=o[e](f),l.c()),b(l,1),l.m(t.parentNode,t)):l=null),f[10][f[0]]&&f[1]?c?(c.p(vt(f),u),u&1027&&b(c,1)):(c=Ml(vt(f)),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(ie(),C(c,1,1,()=>{c=null}),re())},i(f){r||(b(l),b(c),r=!0)},o(f){C(l),C(c),r=!1},d(f){f&&(_(t),_(i)),~e&&s[e].d(f),c&&c.d(f)}}}const ql=200;function eo(n,e,l){let t,i,r,o=G,s=()=>(o(),o=Ve(m,v=>l(8,r=v)),m),a;n.$$.on_destroy.push(()=>o());let{layerId:c}=e,{isLayer:f=!0}=e,{root:u=null}=e,{parent:d=null}=e,{store:m}=e;s();let{storeProp:h}=e,{handlers:p}=e;const{expanded:$}=xe("profile-config");return ne(n,$,v=>l(10,a=v)),n.$$set=v=>{"layerId"in v&&l(0,c=v.layerId),"isLayer"in v&&l(1,f=v.isLayer),"root"in v&&l(2,u=v.root),"parent"in v&&l(3,d=v.parent),"store"in v&&s(l(4,m=v.store)),"storeProp"in v&&l(5,h=v.storeProp),"handlers"in v&&l(6,p=v.handlers)},n.$$.update=()=>{var v,N;n.$$.dirty&289&&l(7,t=r[h][c]),n.$$.dirty&386&&l(9,i=f?((v=t.children)==null?void 0:v.length)>0||((N=t.techniques)==null?void 0:N.length)>0&&r.associationMode:!1)},[c,f,u,d,m,h,p,t,r,i,a,$]}class en extends ge{constructor(e){super(),be(this,e,eo,xr,pe,{layerId:0,isLayer:1,root:2,parent:3,store:4,storeProp:5,handlers:6})}}function Sl(n,e,l){const t=n.slice();return t[55]=e[l],t}function to(n){let e,l,t,i,r,o;return e=new n[58].ProfileButtons({props:{store:_e,selectedProfile:n[16]}}),t=new n[58].ProfileSelect({props:{store:_e,selectedProfile:n[16]}}),r=new n[58].ExportImport({props:{store:_e,storeProp:Ze.layers}}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=A(s),F(t.$$.fragment,s),i=A(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p:G,i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function lo(n){let e,l;return e=new n[58].FilterMode({props:{store:_e}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Al(n){let e,l;return e=new en({props:{layerId:n[55],store:_e,storeProp:Ze.layers,handlers:n[22]}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&1024&&(r.layerId=t[55]),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ol(n){let e,l;return e=new te({props:{size:33,iconName:"plus_circle",description:"Create Capability",title:"Create Capability",disabled:!n[0].profiles.length>0}}),e.$on("iconClick",n[23]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&1&&(r.disabled=!t[0].profiles.length>0),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Ll(n){let e,l;return e=new It({props:{$$slots:{default:[oo,({M:t,item:i})=>({53:t,54:i}),({M:t,item:i})=>[0,(t?4194304:0)|(i?8388608:0)]]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&12|i[1]&276824064&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function no(n){let e;return{c(){e=fe("Create Capability")},l(l){e=ue(l,"Create Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function io(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function ro(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function oo(n){let e,l,t,i,r,o;return e=new n[53].Title({props:{$$slots:{default:[no]},$$scope:{ctx:n}}}),t=new n[53].Create({props:{item:n[54],textInput:"Name",textArea:"Description"}}),r=new n[53].Buttons({props:{item:n[54],handleCloseModal:n[24],handleOnSubmit:n[25],$$slots:{cancel:[ro],submit:[io]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=A(s),F(t.$$.fragment,s),i=A(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a[1]&268435456&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a[1]&8388608&&(f.item=s[54]),t.$set(f);const u={};a[1]&8388608&&(u.item=s[54]),a[0]&12&&(u.handleCloseModal=s[24]),a[0]&4&&(u.handleOnSubmit=s[25]),a[1]&268435456&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function zl(n){let e,l;return e=new It({props:{$$slots:{default:[fo,({M:t,item:i})=>({53:t,54:i}),({M:t,item:i})=>[0,(t?4194304:0)|(i?8388608:0)]]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&50|i[1]&276824064&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function so(n){let e;return{c(){e=fe("Create Child Capability")},l(l){e=ue(l,"Create Child Capability")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function ao(n){let e;return{c(){e=fe("Create")},l(l){e=ue(l,"Create")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function co(n){let e;return{c(){e=fe("Cancel")},l(l){e=ue(l,"Cancel")},m(l,t){I(l,e,t)},d(l){l&&_(e)}}}function fo(n){let e,l,t,i,r,o;return e=new n[53].Title({props:{$$slots:{default:[so]},$$scope:{ctx:n}}}),t=new n[53].Create({props:{item:n[54],textInput:"Name",textArea:"Description"}}),r=new n[53].Buttons({props:{item:n[54],handleCloseModal:n[28],handleOnSubmit:n[29],$$slots:{cancel:[co],submit:[ao]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),V(r.$$.fragment)},l(s){F(e.$$.fragment,s),l=A(s),F(t.$$.fragment,s),i=A(s),F(r.$$.fragment,s)},m(s,a){j(e,s,a),I(s,l,a),j(t,s,a),I(s,i,a),j(r,s,a),o=!0},p(s,a){const c={};a[1]&268435456&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const f={};a[1]&8388608&&(f.item=s[54]),t.$set(f);const u={};a[1]&8388608&&(u.item=s[54]),a[0]&48&&(u.handleCloseModal=s[28]),a[0]&18&&(u.handleOnSubmit=s[29]),a[1]&268435456&&(u.$$scope={dirty:a,ctx:s}),r.$set(u)},i(s){o||(b(e.$$.fragment,s),b(t.$$.fragment,s),b(r.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),C(t.$$.fragment,s),C(r.$$.fragment,s),o=!1},d(s){s&&(_(l),_(i)),H(e,s),H(t,s),H(r,s)}}}function Vl(n){let e,l;return e=new hr({props:{dialog:n[8],title:"Copy Capability From Templates",store:n[0].templates,copyHandler:n[19]}}),e.$on("closeModal",n[32]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p(t,i){const r={};i[0]&256&&(r.dialog=t[8]),i[0]&1&&(r.store=t[0].templates),e.$set(r)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function jl(n){let e,l;return e=new oi({}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function uo(n){var oe;let e,l,t,i,r,o,s,a="LAYERS",c,f,u,d,m,h,p,$,v,N,M,L,P,T,q,O,z,Z,de,le;t=new kt({props:{$$slots:{default:[to,({H:B})=>({58:B}),({H:B})=>[0,B?134217728:0]]},$$scope:{ctx:n}}}),f=new kt({props:{$$slots:{default:[lo,({H:B})=>({58:B}),({H:B})=>[0,B?134217728:0]]},$$scope:{ctx:n}}});let x=qe(((oe=n[10])==null?void 0:oe.includedLayers)||[]),ee=[];for(let B=0;B<x.length;B+=1)ee[B]=Al(Sl(n,x,B));const Ie=B=>C(ee[B],1,1,()=>{ee[B]=null});let me=!n[0].isReadonly&&Ol(n);v=new gr({});let U=n[3]&&Ll(n),J=n[5]&&zl(n),K=n[9]&&Vl(n),Q=n[7]&&jl();return{c(){e=y("main"),l=y("section"),V(t.$$.fragment),i=S(),r=y("section"),o=y("div"),s=y("div"),s.textContent=a,c=S(),u=y("div"),V(f.$$.fragment),d=S();for(let B=0;B<ee.length;B+=1)ee[B].c();m=S(),h=y("div"),me&&me.c(),p=S(),$=y("section"),V(v.$$.fragment),N=S(),M=y("dialog"),U&&U.c(),L=S(),P=y("dialog"),J&&J.c(),T=S(),q=y("dialog"),K&&K.c(),O=S(),z=y("dialog"),Q&&Q.c(),this.h()},l(B){e=w(B,"MAIN",{class:!0});var D=E(e);l=w(D,"SECTION",{id:!0});var R=E(l);F(t.$$.fragment,R),R.forEach(_),i=A(D),r=w(D,"SECTION",{id:!0});var ae=E(r);o=w(ae,"DIV",{id:!0});var Ee=E(o);s=w(Ee,"DIV",{class:!0,"data-svelte-h":!0}),we(s)!=="svelte-2ugh1g"&&(s.textContent=a),c=A(Ee),u=w(Ee,"DIV",{style:!0});var $e=E(u);F(f.$$.fragment,$e),Ee.forEach(_),d=A(ae);for(let tt=0;tt<ee.length;tt+=1)ee[tt].l(ae);m=A(ae),h=w(ae,"DIV",{id:!0});var Ue=E(h);me&&me.l(Ue),Ue.forEach(_),ae.forEach(_),p=A(D),$=w(D,"SECTION",{id:!0});var rt=E($);F(v.$$.fragment,rt),rt.forEach(_),N=A(D),M=w(D,"DIALOG",{id:!0});var ot=E(M);U&&U.l(ot),ot.forEach(_),L=A(D),P=w(D,"DIALOG",{id:!0});var st=E(P);J&&J.l(st),st.forEach(_),T=A(D),q=w(D,"DIALOG",{id:!0});var at=E(q);K&&K.l(at),at.forEach(_),O=A(D),z=w(D,"DIALOG",{id:!0,class:!0});var ct=E(z);Q&&Q.l(ct),ct.forEach(_),D.forEach(_),this.h()},h(){g(l,"id","container-header"),g(s,"class","layer-header-text text-center fancy-font"),ve(u,"display","contents"),ve(u,"--margin","0"),g(o,"id","layer-header"),g(h,"id","capability--btns"),g(r,"id","container-layer"),g($,"id","container-btns"),M.open=n[3],g(M,"id","capability--dialog"),P.open=n[5],g(P,"id","create--capability--dialog"),q.open=n[9],g(q,"id","capability--dialog"),z.open=n[7],g(z,"id","attack--dialog"),g(z,"class","svelte-1jgw4yd"),g(e,"class","svelte-1jgw4yd")},m(B,D){I(B,e,D),k(e,l),j(t,l,null),k(e,i),k(e,r),k(r,o),k(o,s),k(o,c),k(o,u),j(f,u,null),k(r,d);for(let R=0;R<ee.length;R+=1)ee[R]&&ee[R].m(r,null);k(r,m),k(r,h),me&&me.m(h,null),k(e,p),k(e,$),j(v,$,null),k(e,N),k(e,M),U&&U.m(M,null),n[26](M),k(e,L),k(e,P),J&&J.m(P,null),n[30](P),k(e,T),k(e,q),K&&K.m(q,null),n[33](q),k(e,O),k(e,z),Q&&Q.m(z,null),n[35](z),Z=!0,de||(le=[W(M,"close",n[27]),W(P,"close",n[31]),W(q,"close",n[34]),W(z,"close",n[36])],de=!0)},p(B,D){var Ee;const R={};D[1]&268435456&&(R.$$scope={dirty:D,ctx:B}),t.$set(R);const ae={};if(D[1]&268435456&&(ae.$$scope={dirty:D,ctx:B}),f.$set(ae),D[0]&4195328){x=qe(((Ee=B[10])==null?void 0:Ee.includedLayers)||[]);let $e;for($e=0;$e<x.length;$e+=1){const Ue=Sl(B,x,$e);ee[$e]?(ee[$e].p(Ue,D),b(ee[$e],1)):(ee[$e]=Al(Ue),ee[$e].c(),b(ee[$e],1),ee[$e].m(r,m))}for(ie(),$e=x.length;$e<ee.length;$e+=1)Ie($e);re()}B[0].isReadonly?me&&(ie(),C(me,1,1,()=>{me=null}),re()):me?(me.p(B,D),D[0]&1&&b(me,1)):(me=Ol(B),me.c(),b(me,1),me.m(h,null)),B[3]?U?(U.p(B,D),D[0]&8&&b(U,1)):(U=Ll(B),U.c(),b(U,1),U.m(M,null)):U&&(ie(),C(U,1,1,()=>{U=null}),re()),(!Z||D[0]&8)&&(M.open=B[3]),B[5]?J?(J.p(B,D),D[0]&32&&b(J,1)):(J=zl(B),J.c(),b(J,1),J.m(P,null)):J&&(ie(),C(J,1,1,()=>{J=null}),re()),(!Z||D[0]&32)&&(P.open=B[5]),B[9]?K?(K.p(B,D),D[0]&512&&b(K,1)):(K=Vl(B),K.c(),b(K,1),K.m(q,null)):K&&(ie(),C(K,1,1,()=>{K=null}),re()),(!Z||D[0]&512)&&(q.open=B[9]),B[7]?Q?D[0]&128&&b(Q,1):(Q=jl(),Q.c(),b(Q,1),Q.m(z,null)):Q&&(ie(),C(Q,1,1,()=>{Q=null}),re()),(!Z||D[0]&128)&&(z.open=B[7])},i(B){if(!Z){b(t.$$.fragment,B),b(f.$$.fragment,B);for(let D=0;D<x.length;D+=1)b(ee[D]);b(me),b(v.$$.fragment,B),b(U),b(J),b(K),b(Q),Z=!0}},o(B){C(t.$$.fragment,B),C(f.$$.fragment,B),ee=ee.filter(Boolean);for(let D=0;D<ee.length;D+=1)C(ee[D]);C(me),C(v.$$.fragment,B),C(U),C(J),C(K),C(Q),Z=!1},d(B){B&&_(e),H(t),H(f),We(ee,B),me&&me.d(),H(v),U&&U.d(),n[26](null),J&&J.d(),n[30](null),K&&K.d(),n[33](null),Q&&Q.d(),n[35](null),de=!1,Te(le)}}}function mo(n,e,l){let t,i,r,o,s,a,c;ne(n,_e,X=>l(0,a=X));const{selected:f,editingName:u,selectedD3fendId:d,selectedLayerId:m,selectedLayerColor:h}=xe("profile-config");ne(n,f,X=>l(38,t=X)),ne(n,u,X=>l(42,s=X)),ne(n,d,X=>l(41,o=X)),ne(n,m,X=>l(40,r=X)),ne(n,h,X=>l(39,i=X));const p=Ne(a.profiles[a==null?void 0:a.selectedProfile]);ne(n,p,X=>l(10,c=X));let $,v=null,N,M=!1,L,P=!1,T,q=!1,O,z=!1;const Z=X=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&_e.deleteLayer(X.id)},de=(X,Ce,ye=null)=>{X.detail.event.stopPropagation(),l(1,$=Ce),v=ye,l(5,P=!0),L.showModal()},le=(X,Ce,ye,je=null)=>{if(a.isReadonly)return;const Le=Ce.id;if(t[Le]||Y(f,t[Le]=he.noop,t),ye){t[Le]===he.noop?Y(f,t[Le]=he.root,t):Y(f,t[Le]=he.noop,t);return}X.shiftKey?t[Le]===he.noop?Y(f,t[Le]=he.selected,t):Y(f,t[Le]=he.noop,t):(Object.entries(t).forEach(([Ge,et])=>{Ge===Le?((!et||et===he.noop)&&Y(f,t[Ge]=he.selected,t),et===he.selected&&Y(f,t[Ge]=he.noop,t)):Y(f,t[Ge]=he.noop,t)}),Y(f,t[je.id]=he.root,t))},x=(X,Ce,ye,je)=>{_e.editName(X,ye,je),Y(f,t[X]=he.selected,t),Ce&&Y(f,t[Ce.id]=he.parent,t)},ee=(X,Ce,ye)=>{X.detail.event.stopPropagation(),Y(f,t[Ce.id]=he.editing,t),Y(f,t[ye==null?void 0:ye.id]=he.noop,t),Y(u,s=Ce.name,s)},Ie=(X,Ce,ye)=>{X.detail.event.stopPropagation(),Y(f,t[Ce.id]=he.selected,t),ye&&Y(f,t[ye.id]=he.parent,t),Y(u,s="",s)},me=(X,Ce,ye)=>{confirm("Deleting Capability with remove all subcapabilities and associated Techniques.")&&_e.deleteSublayer(X,Ce.id,ye)},U=(X,Ce,ye)=>{_e.saveLayerColor(Ce,X.srcElement.value,ye)},J=(X,Ce,ye,je)=>{X.detail.event.stopPropagation(),Y(d,o=Ce,o),Y(m,r=ye,r),Y(h,i=je,i),l(7,q=!0),T.showModal()},K=X=>{l(3,M=!0),N.showModal()},Q=({name:X,description:Ce},ye)=>{const je={id:St(X),name:X,description:Ce,techniques:[],children:[],checked:!1,color:"#0075FF"};_e.addLayer(je),ye.close()},oe=X=>{const{newArray:Ce,mappedIds:ye}=X.reduce((Le,Ge)=>{const et=St(Ge.name);return Le.newArray.push({...Ge,id:et}),Le.mappedIds[Ge.id]=et,Le},{newArray:[],mappedIds:{}}),je=Tn(Ce,ye);_e.bulkAddLayer(je,je[0].id)},B=(X,Ce)=>{Ce.close()},D=({name:X,description:Ce},ye,je,Le)=>{const Ge={id:null,name:X,description:Ce,techniques:[],children:[],checked:!1,color:"#0075FF"};v?_e.addNonRootChild(ye,Ge,je):(Y(f,t[ye.id]=he.root,t),_e.addChild(ye,Ge,je)),Le.close()},R={deleteCapability:Z,showCreateLayerDialog:de,selectLayer:le,saveCapabilityName:x,editCapability:ee,cancelEdit:Ie,deleteChildCapability:me,updateCapabilityColor:U,openAttackDialog:J},ae=X=>K(),Ee=()=>B(M,N),$e=X=>Q(X,N);function Ue(X){Pe[X?"unshift":"push"](()=>{N=X,l(2,N)})}const rt=()=>l(3,M=!1),ot=()=>B(P,L),st=X=>D(X,$,Ze.layers,L);function at(X){Pe[X?"unshift":"push"](()=>{L=X,l(4,L)})}const ct=()=>l(5,P=!1),tt=()=>B(z,O);function ln(X){Pe[X?"unshift":"push"](()=>{O=X,l(8,O)})}const nn=()=>l(9,z=!1);function rn(X){Pe[X?"unshift":"push"](()=>{T=X,l(6,T)})}const on=()=>l(7,q=!1);return n.$$.update=()=>{n.$$.dirty[0]&1&&Y(p,c=(a==null?void 0:a.profiles[a==null?void 0:a.selectedProfile])||{name:""},c)},[a,$,N,M,L,P,T,q,O,z,c,f,u,d,m,h,p,K,Q,oe,B,D,R,ae,Ee,$e,Ue,rt,ot,st,at,ct,tt,ln,nn,rn,on]}class ho extends ge{constructor(e){super(),be(this,e,mo,uo,pe,{},null,[-1,-1])}}function po(n){let e,l="D3FEND PROFILE";return{c(){e=y("h2"),e.textContent=l,this.h()},l(t){e=w(t,"H2",{class:!0,slot:!0,"data-svelte-h":!0}),we(e)!=="svelte-u9fo7w"&&(e.textContent=l),this.h()},h(){g(e,"class","text-center fancy-font"),g(e,"slot","header")},m(t,i){I(t,e,i)},p:G,d(t){t&&_(e)}}}function _o(n){let e,l,t,i,r;return l=new Xl({props:{tabs:n[0],activeTabValue:n[1],clickTab:n[3],$$slots:{header:[po]},$$scope:{ctx:n}}}),{c(){e=y("section"),V(l.$$.fragment),this.h()},l(o){e=w(o,"SECTION",{class:!0});var s=E(e);F(l.$$.fragment,s),s.forEach(_),this.h()},h(){g(e,"class","svelte-qzr7y6")},m(o,s){I(o,e,s),j(l,e,null),r=!0},p(o,[s]){const a={};s&1&&(a.tabs=o[0]),s&2&&(a.activeTabValue=o[1]),s&32&&(a.$$scope={dirty:s,ctx:o}),l.$set(a)},i(o){r||(b(l.$$.fragment,o),o&&De(()=>{r&&(i&&i.end(1),t=Xe(e,Oe,{delay:400}),t.start())}),r=!0)},o(o){C(l.$$.fragment,o),t&&t.invalidate(),o&&(i=Tt(e,Oe,{duration:100})),r=!1},d(o){o&&_(e),H(l),o&&i&&i.end()}}}function go(n,e,l){let t,i,r;ne(n,_e,a=>l(4,i=a));const o=Ne(i.selectedStore);ne(n,o,a=>l(1,r=a));const s=(a,c)=>{Y(o,r=c,r),Y(_e,i.selectedStore=c,i)};return l(0,t=[{label:"Profiles",value:Ze.layers,component:ho}]),[t,r,o,s]}class bo extends ge{constructor(e){super(),be(this,e,go,_o,pe,{})}}function vo(n){let e,l,t,i;return e=new n[0].MatrixMappingPopover({props:{store:_e}}),t=new n[0].MatrixCommentToggle({props:{store:_e}}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment)},l(r){F(e.$$.fragment,r),l=A(r),F(t.$$.fragment,r)},m(r,o){j(e,r,o),I(r,l,o),j(t,r,o),i=!0},p:G,i(r){i||(b(e.$$.fragment,r),b(t.$$.fragment,r),i=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),i=!1},d(r){r&&_(l),H(e,r),H(t,r)}}}function $o(n){let e,l,t,i;return l=new kt({props:{$$slots:{default:[vo,({H:r})=>({0:r}),({H:r})=>r?1:0]},$$scope:{ctx:n}}}),{c(){e=y("div"),t=y("div"),V(l.$$.fragment),this.h()},l(r){e=w(r,"DIV",{id:!0,class:!0});var o=E(e);t=w(o,"DIV",{style:!0});var s=E(t);F(l.$$.fragment,s),o.forEach(_),this.h()},h(){ve(t,"display","contents"),ve(t,"--flexDir","column-reverse"),ve(t,"--margin","0"),g(e,"id","matrix-controls"),g(e,"class","svelte-1h1ci9x")},m(r,o){I(r,e,o),k(e,t),j(l,t,null),i=!0},p(r,[o]){const s={};o&2&&(s.$$scope={dirty:o,ctx:r}),l.$set(s)},i(r){i||(b(l.$$.fragment,r),i=!0)},o(r){C(l.$$.fragment,r),i=!1},d(r){r&&_(e),H(l)}}}class ko extends ge{constructor(e){super(),be(this,e,null,$o,pe,{})}}function Hl(n){var s;let e,l,t,i,r,o;return t=new te({props:{size:33,iconName:(s=n[0])!=null&&s.isDrawerOpen?"arrowLeft":"arrowRight",description:"Profile Controls",title:"Profile Controls",pathColor:"white"}}),{c(){e=y("div"),l=y("span"),V(t.$$.fragment),this.h()},l(a){e=w(a,"DIV",{id:!0,role:!0,tabindex:!0,class:!0});var c=E(e);l=w(c,"SPAN",{});var f=E(l);F(t.$$.fragment,f),f.forEach(_),c.forEach(_),this.h()},h(){g(e,"id","drawer-btn"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"class","svelte-9eyiwp")},m(a,c){I(a,e,c),k(e,l),j(t,l,null),i=!0,r||(o=[W(e,"click",n[1]),W(e,"keyup",null)],r=!0)},p(a,c){var u;const f={};c&1&&(f.iconName=(u=a[0])!=null&&u.isDrawerOpen?"arrowLeft":"arrowRight"),t.$set(f)},i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){C(t.$$.fragment,a),i=!1},d(a){a&&_(e),H(t),r=!1,Te(o)}}}function Co(n){var i;let e,l,t=!((i=n[0])!=null&&i.isReadonly)&&Hl(n);return{c(){t&&t.c(),e=ke()},l(r){t&&t.l(r),e=ke()},m(r,o){t&&t.m(r,o),I(r,e,o),l=!0},p(r,[o]){var s;(s=r[0])!=null&&s.isReadonly?t&&(ie(),C(t,1,1,()=>{t=null}),re()):t?(t.p(r,o),o&1&&b(t,1)):(t=Hl(r),t.c(),b(t,1),t.m(e.parentNode,e))},i(r){l||(b(t),l=!0)},o(r){C(t),l=!1},d(r){r&&_(e),t&&t.d(r)}}}function yo(n,e,l){let t;return ne(n,_e,r=>l(0,t=r)),[t,()=>{Y(_e,t.isDrawerOpen=!t.isDrawerOpen,t)}]}class wo extends ge{constructor(e){super(),be(this,e,yo,Co,pe,{})}}function Rl(n,e,l){const t=n.slice();return t[3]=e[l],t}function Fl(n){let e,l=qe(n[1].list.map(n[2]).reverse()),t=[];for(let i=0;i<l.length;i+=1)t[i]=Ul(Rl(n,l,i));return{c(){e=y("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=w(i,"DIV",{id:!0,class:!0});var r=E(e);for(let o=0;o<t.length;o+=1)t[o].l(r);r.forEach(_),this.h()},h(){g(e,"id","legend"),g(e,"class","svelte-1pkg19y")},m(i,r){I(i,e,r);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(i,r){if(r&3){l=qe(i[1].list.map(i[2]).reverse());let o;for(o=0;o<l.length;o+=1){const s=Rl(i,l,o);t[o]?t[o].p(s,r):(t[o]=Ul(s),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(i){i&&_(e),We(t,i)}}}function Bl(n){let e,l=n[3].name+"",t,i;return{c(){e=y("div"),t=fe(l),i=S(),this.h()},l(r){e=w(r,"DIV",{class:!0,style:!0});var o=E(e);t=ue(o,l),i=A(o),o.forEach(_),this.h()},h(){g(e,"class","legend-item svelte-1pkg19y"),ve(e,"background",n[3].color)},m(r,o){I(r,e,o),k(e,t),k(e,i)},p(r,o){o&3&&l!==(l=r[3].name+"")&&Me(t,l),o&3&&ve(e,"background",r[3].color)},d(r){r&&_(e)}}}function Ul(n){let e,l=n[3].checked&&Bl(n);return{c(){l&&l.c(),e=ke()},l(t){l&&l.l(t),e=ke()},m(t,i){l&&l.m(t,i),I(t,e,i)},p(t,i){t[3].checked?l?l.p(t,i):(l=Bl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&_(e),l&&l.d(t)}}}function To(n){var t,i,r;let e,l=((t=n[0])==null?void 0:t.showLegend)&&((i=n[0])==null?void 0:i.techniqueMappingMode)!=="heatMap"&&((r=n[1].list)==null?void 0:r.length)>0&&Fl(n);return{c(){e=y("div"),l&&l.c(),this.h()},l(o){e=w(o,"DIV",{id:!0,class:!0});var s=E(e);l&&l.l(s),s.forEach(_),this.h()},h(){g(e,"id","container-legend"),g(e,"class","svelte-1pkg19y")},m(o,s){I(o,e,s),l&&l.m(e,null)},p(o,[s]){var a,c,f;(a=o[0])!=null&&a.showLegend&&((c=o[0])==null?void 0:c.techniqueMappingMode)!=="heatMap"&&((f=o[1].list)==null?void 0:f.length)>0?l?l.p(o,s):(l=Fl(o),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:G,o:G,d(o){o&&_(e),l&&l.d()}}}function Eo(n,e,l){let t,i;ne(n,_e,o=>l(0,i=o));const r=o=>i[t.store][o];return n.$$.update=()=>{var o;n.$$.dirty&1&&l(1,t=i.selectedStore===Ze.layers?{list:(o=i==null?void 0:i.profiles[i.selectedProfile])==null?void 0:o.includedLayers,store:Ze.layers}:{list:i==null?void 0:i.rootTemplates,store:Ze.templates})},[i,t,r]}class Io extends ge{constructor(e){super(),be(this,e,Eo,To,pe,{})}}const No=(n,e)=>{const l={max:0,count:{},highlighted:{}};return mn([n,e],([t,i],r)=>{if(!(i!=null&&i.tree.length)||!n){r(Mn);return}l.count={},l.highlighted=Object.entries(l.highlighted).reduce((c,[f,u])=>(c[f]=!1,c),{});const{highlightedTechniques:o,techniqueColors:s}=qo(t),a=Object.entries(s).reduce((c,[f,u])=>(c[f]=[...new Set(u)],c),{});o.forEach(c=>{l.highlighted[c]=!0,l.count[c]?l.count[c]+=1:l.count[c]=1}),l.max=Object.values(l.count).reduce((c,f)=>c>f?c:f,-1/0),Object.entries(l.highlighted).forEach(([c,f])=>{if(f){const u=Po[t.techniqueMappingMode]({colors:a[c],count:l.count,max:l.max,technique:c,attack:t.attack});i.treeMap[c].classes.isHighlighted=!0,i.treeMap[c].classes.color=u}else i.treeMap[c].classes.isHighlighted=!1,i.treeMap[c].classes.color=null}),r(i)})},Gl=n=>{const{colors:e}=n,l=e.length,t=l-1,i=(1/l*100).toFixed(1);if(l===1)return e[0];let r="linear-gradient( to right,";for(let o=0;o<l;o++){const s=e[o];if(o===0){r+=` ${s} ${i}%`;continue}if(o===t){r+=`, ${s} ${i*t}%`;continue}r+=`, ${s} ${i*o}% ${i*(o+1)}%`}return r+=")",r},Mo=n=>{const{count:e,max:l,technique:t}=n,i=e[t]/l*100;return`color-mix(in srgb, green ${i<20?20:i}%, white)`},Do=n=>{const{colors:e,attack:l,technique:t}=n;for(const i of Object.values(l))if(i[t]){const r=e.length,o=r-1,s=(1/r*100).toFixed(1);if(r===1)return e[0];let a="linear-gradient( to right,";for(let c=0;c<r;c++){const f=e[c];if(c===0){a+=` ${f} ${s}%`;continue}if(c===o){a+=`, ${f} ${s*o}%`;continue}a+=`, ${f} ${s*c}% ${s*(c+1)}%`}return a+=")",a}},Po={[ce.rootColor]:n=>Gl(n),[ce.heatMap]:n=>Mo(n),[ce.childrenMultiColor]:n=>Gl(n),[ce["ATT&CK"]]:n=>Do(n)},qo=n=>{var t;let e=(t=n.profiles[n==null?void 0:n.selectedProfile])==null?void 0:t.includedLayers,l=n==null?void 0:n.layers;return n.selectedStore===Ze.templates&&(e=n.rootTemplates,l=n.templates),n.techniqueMappingMode===ce.rootColor?Ct(e,l,!0,0):n.techniqueMappingMode===ce["ATT&CK"]?tn(e,l,n.attack,!1,0):Ct(e,l,!1,0)},tn=(n=[],e,l,t=!1,i=0,r=null,o=[],s={})=>{const a=i===0||!t;for(let c=0;c<n.length;c++){const f=e[n[c]],u=a?f.color:r,d=i+1;if(f.checked){const m=l[n[c]];m&&Object.keys(m).map(h=>{o.push(h),(s[h]||(s[h]=[]))&&s[h].push(u)})}f.children&&tn(f.children,e,l,t,d,u,o,s)}return{highlightedTechniques:o,techniqueColors:s}},Ct=(n=[],e,l,t,i=null,r=[],o={})=>{const s=t===0||!l;for(let a=0;a<n.length;a++){const c=e[n[a]],f=s?c.color:i,u=t+1;c.checked&&(r.push(...c.techniques.map(d=>d.id)),c.techniques.forEach(d=>{(o[d.id]||(o[d.id]=[]))&&o[d.id].push(f)})),c.children&&Ct(c.children,e,l,u,f,r,o)}return{highlightedTechniques:r,techniqueColors:o}},So=No(_e,Ke);function Ao(n){let e,l;return e=new bo({props:{slot:"drawer"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Oo(n){let e,l;return e=new _n({props:{treeStore:So,theme:"main",slot:"matrix",scroll_indicator:!1}}),e.$on("elementClick",n[6]),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Lo(n){let e,l;return e=new ko({props:{slot:"matrixControls"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function zo(n){let e,l;return e=new wo({props:{slot:"sideToggle"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Vo(n){let e,l;return e=new Io({props:{slot:"legend"}}),{c(){V(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){j(e,t,i),l=!0},p:G,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function jo(n){return{c:G,l:G,m:G,p:G,i:G,o:G,d:G}}function Ho(n){let e,l,t=n[3]&&Kl(n);return{c(){t&&t.c(),e=ke()},l(i){t&&t.l(i),e=ke()},m(i,r){t&&t.m(i,r),I(i,e,r),l=!0},p(i,r){i[3]?t?(t.p(i,r),r&8&&b(t,1)):(t=Kl(i),t.c(),b(t,1),t.m(e.parentNode,e)):t&&(ie(),C(t,1,1,()=>{t=null}),re())},i(i){l||(b(t),l=!0)},o(i){C(t),l=!1},d(i){i&&_(e),t&&t.d(i)}}}function Kl(n){let e,l="esc",t,i,r,o,s;return i=new vn({props:{technique_id:n[0].technique_id,technique:n[19]}}),{c(){e=y("button"),e.textContent=l,t=S(),V(i.$$.fragment)},l(a){e=w(a,"BUTTON",{"data-svelte-h":!0}),we(e)!=="svelte-1ejhv6h"&&(e.textContent=l),t=A(a),F(i.$$.fragment,a)},m(a,c){I(a,e,c),I(a,t,c),j(i,a,c),r=!0,o||(s=W(e,"click",wt(n[10])),o=!0)},p(a,c){const f={};c&1&&(f.technique_id=a[0].technique_id),c&8&&(f.technique=a[19]),i.$set(f)},i(a){r||(b(i.$$.fragment,a),r=!0)},o(a){C(i.$$.fragment,a),r=!1},d(a){a&&(_(e),_(t)),H(i,a),o=!1,s()}}}function Ro(n){let e,l="loading...";return{c(){e=y("span"),e.textContent=l},l(t){e=w(t,"SPAN",{"data-svelte-h":!0}),we(e)!=="svelte-sermp4"&&(e.textContent=l)},m(t,i){I(t,e,i)},p:G,i:G,o:G,d(t){t&&_(e)}}}function Fo(n){let e,l,t,i,r,o,s,a,c,f,u,d;e=new gn({props:{title:"D3FEND Profile Studio",og_title:"D3FEND Profile Studio",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Profile Studio lets you organize and communicate your defensive cyber capabilities!"}}),t=new Hn({props:{profileConfig:n[4],$$slots:{legend:[Vo],sideToggle:[zo],matrixControls:[Lo],matrix:[Oo],drawer:[Ao]},$$scope:{ctx:n}}});let m={ctx:n,current:null,token:null,hasCatch:!1,pending:Ro,then:Ho,catch:jo,value:19,blocks:[,,,]};return ht(o=n[3],m),c=new kn({}),{c(){V(e.$$.fragment),l=S(),V(t.$$.fragment),i=S(),r=y("dialog"),m.block.c(),s=S(),a=y("dialog"),V(c.$$.fragment),this.h()},l(h){F(e.$$.fragment,h),l=A(h),F(t.$$.fragment,h),i=A(h),r=w(h,"DIALOG",{class:!0});var p=E(r);m.block.l(p),p.forEach(_),s=A(h),a=w(h,"DIALOG",{class:!0});var $=E(a);F(c.$$.fragment,$),$.forEach(_),this.h()},h(){g(r,"class","technique-dialog"),g(a,"class","iframe-dialog")},m(h,p){j(e,h,p),I(h,l,p),j(t,h,p),I(h,i,p),I(h,r,p),m.block.m(r,m.anchor=null),m.mount=()=>r,m.anchor=null,n[11](r),I(h,s,p),I(h,a,p),j(c,a,null),n[13](a),f=!0,u||(d=[W(r,"close",n[12]),W(a,"close",n[14])],u=!0)},p(h,[p]){n=h;const $={};p&1048576&&($.$$scope={dirty:p,ctx:n}),t.$set($),m.ctx=n,p&8&&o!==(o=n[3])&&ht(o,m)||$t(m,n,p)},i(h){f||(b(e.$$.fragment,h),b(t.$$.fragment,h),b(m.block),b(c.$$.fragment,h),f=!0)},o(h){C(e.$$.fragment,h),C(t.$$.fragment,h);for(let p=0;p<3;p+=1){const $=m.blocks[p];C($)}C(c.$$.fragment,h),f=!1},d(h){h&&(_(l),_(i),_(r),_(s),_(a)),H(e,h),H(t,h),m.block.d(),m.token=null,m=null,n[11](null),H(c),n[13](null),u=!1,Te(d)}}}function Bo(n,e,l){let t,i,r;ne(n,hn,T=>l(9,i=T)),ne(n,_e,T=>l(17,r=T));let{data:o}=e,s,a,c,f=null,u=!1;const d={expanded:Ne({}),expandedTechniques:Ne({}),selected:Ne({}),editingName:Ne(""),isCreateLayerDialogOpen:Ne(!1),colorPicker:Ne({}),selectedD3fendId:Ne(null),selectedLayerId:Ne(null),selectedTechnique:Ne(null),selectedLayerColor:Ne("#e1e1e1"),mappings:Ne(!1)},{selectedD3fendId:m}=d;ne(n,m,T=>l(16,t=T)),Wl(()=>{if(window.location!==window.parent.location&&(u=!0),!u&&r.localStorageWarning&&c.showModal(),l(8,s=document.getElementsByTagName("body")[0]),i.url.searchParams.get("technique_id")){const T=i.url.searchParams.get("technique_id");T&&(l(3,f=$(o.technique_id)),dt(`/profile/?technique_id=${T}`))}if(i.url.searchParams.get("profile")){const T=i.url.searchParams.get("profile"),q=Pn.uncrush(T),O=JSON.parse(q);Y(_e,r=O,r)}}),pn(()=>{s==null||s.classList.remove("scroll--none")});const h=T=>{const q=T.detail.element["@id"],{href:O,event:{ctrlKey:z,metaKey:Z}}=T.detail;if(!z&&!Z){if(O){Y(m,t=q,t),l(3,f=$(q)),dt(`/profile/?technique_id=${q}`);return}return}Ke.toggleTechnique(q)},p=T=>{T.close(),dt("/profile/")},$=async T=>{const q=await fetch(`/api/technique/${T}.json`),O=await q.json();if(q.ok)return O;throw new Error(O)},v=()=>p(a);function N(T){Pe[T?"unshift":"push"](()=>{a=T,l(1,a)})}const M=()=>p(a);function L(T){Pe[T?"unshift":"push"](()=>{c=T,l(2,c)})}const P=()=>p(c);return n.$$set=T=>{"data"in T&&l(0,o=T.data)},n.$$.update=()=>{n.$$.dirty&770&&(a&&i.url.searchParams.size?(a.showModal(),s==null||s.classList.add("scroll--none")):a&&(a.close(),s==null||s.classList.remove("scroll--none")))},[o,a,c,f,d,m,h,p,s,i,v,N,M,L,P]}class _s extends ge{constructor(e){super(),be(this,e,Bo,Fo,pe,{data:0})}}export{_s as component};
