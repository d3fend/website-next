import{e as Je}from"../chunks/index.g5YcAAdQ.js";import{s as qe,N as Ue,e as A,b as M,A as ae,d as B,j as V,f as X,i as s,w as z,k as u,X as Xe,v as be,n as me,t as v,h as d,I as ze,m as j,c as Qe,J as We,K as Ye,l as D,u as Ze,g as ye,a as xe}from"../chunks/scheduler.Cph8Trd5.js";import{S as Ke,i as Fe,f as el,c as re,b as ce,m as oe,g as $e,a as K,e as ke,t as H,d as ve}from"../chunks/index.CThJCPP4.js";import{e as ge}from"../chunks/each.DkdHin5j.js";import{g as ll}from"../chunks/entry.CEmYRLZr.js";import{j as tl,T as fl,i as G,f as he,G as Ne,k as al,h as il}from"../chunks/lib.C6z0nzwW.js";import{T as _l}from"../chunks/Title.B0Sa5AEO.js";import{B as Te}from"../chunks/Button.CwTVc5Xk.js";import{A as sl}from"../chunks/Alert.Bz6mou4k.js";import{M as ul}from"../chunks/Modal_full.isN3bRLJ.js";import{G as nl}from"../chunks/_Graph.p-FWlNtk.js";import{T as rl,t as De}from"../chunks/ToggleBar.C3luqttO.js";async function cl({params:i,fetch:f}){const a=i.technique,l=await f(`/api/offensive-technique/attack/${a}.json`),{description:e,off_to_def:t,subtechniques:_}=await l.json();return l.status!==200&&Je(500,data.message),{description:e,off_to_def:t,technique_id:a,subtechniques:_}}const Pl=Object.freeze(Object.defineProperty({__proto__:null,load:cl},Symbol.toStringTag,{value:"Module"}));function Ie(i,f,a){const l=i.slice();return l[6]=f[a],l}function ol(i){let f,a=`There are no digital artifacts defined on this offensive technique (yet).
    Please consider <a href="/contribute">contributing</a> an addition to D3FEND.`;return{c(){f=A("small"),f.innerHTML=a},l(l){f=B(l,"SMALL",{"data-svelte-h":!0}),be(f)!=="svelte-1ymw1cs"&&(f.innerHTML=a)},m(l,e){u(l,f,e)},p:me,i:me,o:me,d(l){l&&s(f)}}}function vl(i){let f=i[1],a,l,e=Me(i);return{c(){e.c(),a=ae()},l(t){e.l(t),a=ae()},m(t,_){e.m(t,_),u(t,a,_),l=!0},p(t,_){_&2&&qe(f,f=t[1])?($e(),K(e,1,1,me),ke(),e=Me(t),e.c(),H(e,1),e.m(a.parentNode,a)):e.p(t,_)},i(t){l||(H(e),l=!0)},o(t){K(e),l=!1},d(t){t&&s(a),e.d(t)}}}function Ae(i){let f=i[2].edge_is_unique(i[6].def_tech_label.value,i[6].def_artifact_rel_label.value,i[6].off_artifact_label.value),a,l=f&&Be(i);return{c(){l&&l.c(),a=ae()},l(e){l&&l.l(e),a=ae()},m(e,t){l&&l.m(e,t),u(e,a,t)},p(e,t){t&1&&(f=e[2].edge_is_unique(e[6].def_tech_label.value,e[6].def_artifact_rel_label.value,e[6].off_artifact_label.value)),f?l?l.p(e,t):(l=Be(e),l.c(),l.m(a.parentNode,a)):l&&(l.d(1),l=null)},d(e){e&&s(a),l&&l.d(e)}}}function Be(i){let f=!i[1].includes(i[6].def_tactic_label.value),a,l=f&&Re(i);return{c(){l&&l.c(),a=ae()},l(e){l&&l.l(e),a=ae()},m(e,t){l&&l.m(e,t),u(e,a,t)},p(e,t){t&3&&(f=!e[1].includes(e[6].def_tactic_label.value)),f?l?l.p(e,t):(l=Re(e),l.c(),l.m(a.parentNode,a)):l&&(l.d(1),l=null)},d(e){e&&s(a),l&&l.d(e)}}}function Re(i){let f=G(i[6].def_tech.value)+"",a,l,e=i[6].def_tech_label.value+"",t,_,p="-->",C,b,g=i[6].def_artifact_rel_label.value.replace(/ /g,"")+"",o,$,m=G(i[6].off_artifact.value)+"",I,R,q=i[6].off_artifact_label.value+"",T,N,k=i[2].edge_is_unique(i[6].def_tech.value,i[6].def_tactic_label.value,i[6].off_tech_id.value),r,E=i[6].def_tech_label.value.replace(/ |\./g,"")+"",P,Q,Z=i[6].off_artifact_label.value.replace(/ /g,"")+"",Y,y,x=G(i[6].def_tech.value)+"",F,ee,W=G(i[6].def_tech.value)+"",J,le,L=k&&Se(i);return{c(){a=v(f),l=v('["'),t=v(e),_=v('"] '),C=v(p),b=v(`
          | `),o=v(g),$=v(" | "),I=v(m),R=v('["'),T=v(q),N=v(`"];

          `),L&&L.c(),r=v(`
          class `),P=v(E),Q=v(` DefensiveTechniqueNode;
          class `),Y=v(Z),y=v(` ArtifactNode;
          click `),F=v(x),ee=v(' href "/technique/d3f:'),J=v(W),le=v('";')},l(c){a=d(c,f),l=d(c,'["'),t=d(c,e),_=d(c,'"] '),C=d(c,p),b=d(c,`
          | `),o=d(c,g),$=d(c," | "),I=d(c,m),R=d(c,'["'),T=d(c,q),N=d(c,`"];

          `),L&&L.l(c),r=d(c,`
          class `),P=d(c,E),Q=d(c,` DefensiveTechniqueNode;
          class `),Y=d(c,Z),y=d(c,` ArtifactNode;
          click `),F=d(c,x),ee=d(c,' href "/technique/d3f:'),J=d(c,W),le=d(c,'";')},m(c,w){u(c,a,w),u(c,l,w),u(c,t,w),u(c,_,w),u(c,C,w),u(c,b,w),u(c,o,w),u(c,$,w),u(c,I,w),u(c,R,w),u(c,T,w),u(c,N,w),L&&L.m(c,w),u(c,r,w),u(c,P,w),u(c,Q,w),u(c,Y,w),u(c,y,w),u(c,F,w),u(c,ee,w),u(c,J,w),u(c,le,w)},p(c,w){w&1&&f!==(f=G(c[6].def_tech.value)+"")&&j(a,f),w&1&&e!==(e=c[6].def_tech_label.value+"")&&j(t,e),w&1&&g!==(g=c[6].def_artifact_rel_label.value.replace(/ /g,"")+"")&&j(o,g),w&1&&m!==(m=G(c[6].off_artifact.value)+"")&&j(I,m),w&1&&q!==(q=c[6].off_artifact_label.value+"")&&j(T,q),w&1&&(k=c[2].edge_is_unique(c[6].def_tech.value,c[6].def_tactic_label.value,c[6].off_tech_id.value)),k?L?L.p(c,w):(L=Se(c),L.c(),L.m(r.parentNode,r)):L&&(L.d(1),L=null),w&1&&E!==(E=c[6].def_tech_label.value.replace(/ |\./g,"")+"")&&j(P,E),w&1&&Z!==(Z=c[6].off_artifact_label.value.replace(/ /g,"")+"")&&j(Y,Z),w&1&&x!==(x=G(c[6].def_tech.value)+"")&&j(F,x),w&1&&W!==(W=G(c[6].def_tech.value)+"")&&j(J,W)},d(c){c&&(s(a),s(l),s(t),s(_),s(C),s(b),s(o),s($),s(I),s(R),s(T),s(N),s(r),s(P),s(Q),s(Y),s(y),s(F),s(ee),s(J),s(le)),L&&L.d(c)}}}function Se(i){let f=G(i[6].def_tech.value)+"",a,l,e=i[6].def_tech_label.value+"",t,_,p="-.->",C,b,g="May "+i[6].def_tactic_label.value,o,$,m=i[6].off_tech_id.value.replace(/ |\./g,"")+"",I,R,q=i[6].off_tech_label.value+"",T,N;return{c(){a=v(f),l=v('["'),t=v(e),_=v('"] '),C=v(p),b=v(`
            | `),o=v(g),$=v(" | "),I=v(m),R=v('["'),T=v(q),N=v('"] ;')},l(k){a=d(k,f),l=d(k,'["'),t=d(k,e),_=d(k,'"] '),C=d(k,p),b=d(k,`
            | `),o=d(k,g),$=d(k," | "),I=d(k,m),R=d(k,'["'),T=d(k,q),N=d(k,'"] ;')},m(k,r){u(k,a,r),u(k,l,r),u(k,t,r),u(k,_,r),u(k,C,r),u(k,b,r),u(k,o,r),u(k,$,r),u(k,I,r),u(k,R,r),u(k,T,r),u(k,N,r)},p(k,r){r&1&&f!==(f=G(k[6].def_tech.value)+"")&&j(a,f),r&1&&e!==(e=k[6].def_tech_label.value+"")&&j(t,e),r&1&&g!==(g="May "+k[6].def_tactic_label.value)&&j(o,g),r&1&&m!==(m=k[6].off_tech_id.value.replace(/ |\./g,"")+"")&&j(I,m),r&1&&q!==(q=k[6].off_tech_label.value+"")&&j(T,q)},d(k){k&&(s(a),s(l),s(t),s(_),s(C),s(b),s(o),s($),s(I),s(R),s(T),s(N))}}}function je(i){let f=i[6].off_tech_id.value.replace(/ |\./g,"")+"",a,l,e=i[6].off_tech_label.value+"",t,_,p="-->",C,b,g=i[6].off_artifact_rel_label.value.replace(/ /g,"")+"",o,$,m=G(i[6].off_artifact.value)+"",I,R,q=i[6].off_artifact_label.value+"",T,N,k=i[6].off_tech_id.value.replace(/ |\./g,"")+"",r,E,P=G(i[6].off_artifact.value)+"",Q,Z,Y=G(i[6].off_artifact.value)+"",y,x,F=G(i[6].off_artifact.value)+"",ee,W,J=i[6].off_tech_id.value.replace(/ |\./g,"")+"",le,L,c=he(i[6].off_tech_id.value)+"",w,de,se=G(i[6].off_artifact.value)+"",ue,te,ne=G(i[6].off_artifact.value)+"",ie,U;return{c(){a=v(f),l=v('["'),t=v(e),_=v('"] '),C=v(p),b=v(" |"),o=v(g),$=v("| "),I=v(m),R=v('["'),T=v(q),N=v('"]; class '),r=v(k),E=v(` OffensiveTechniqueNode;
        class `),Q=v(P),Z=v(" ArtifactNode; click "),y=v(Y),x=v(' href "/dao/artifact/d3f:'),ee=v(F),W=v(`";
        click `),le=v(J),L=v(' href "'),w=v(c),de=v('"; click '),ue=v(se),te=v(' href "/dao/artifact/d3f:'),ie=v(ne),U=v('";')},l(n){a=d(n,f),l=d(n,'["'),t=d(n,e),_=d(n,'"] '),C=d(n,p),b=d(n," |"),o=d(n,g),$=d(n,"| "),I=d(n,m),R=d(n,'["'),T=d(n,q),N=d(n,'"]; class '),r=d(n,k),E=d(n,` OffensiveTechniqueNode;
        class `),Q=d(n,P),Z=d(n," ArtifactNode; click "),y=d(n,Y),x=d(n,' href "/dao/artifact/d3f:'),ee=d(n,F),W=d(n,`";
        click `),le=d(n,J),L=d(n,' href "'),w=d(n,c),de=d(n,'"; click '),ue=d(n,se),te=d(n,' href "/dao/artifact/d3f:'),ie=d(n,ne),U=d(n,'";')},m(n,h){u(n,a,h),u(n,l,h),u(n,t,h),u(n,_,h),u(n,C,h),u(n,b,h),u(n,o,h),u(n,$,h),u(n,I,h),u(n,R,h),u(n,T,h),u(n,N,h),u(n,r,h),u(n,E,h),u(n,Q,h),u(n,Z,h),u(n,y,h),u(n,x,h),u(n,ee,h),u(n,W,h),u(n,le,h),u(n,L,h),u(n,w,h),u(n,de,h),u(n,ue,h),u(n,te,h),u(n,ie,h),u(n,U,h)},p(n,h){h&1&&f!==(f=n[6].off_tech_id.value.replace(/ |\./g,"")+"")&&j(a,f),h&1&&e!==(e=n[6].off_tech_label.value+"")&&j(t,e),h&1&&g!==(g=n[6].off_artifact_rel_label.value.replace(/ /g,"")+"")&&j(o,g),h&1&&m!==(m=G(n[6].off_artifact.value)+"")&&j(I,m),h&1&&q!==(q=n[6].off_artifact_label.value+"")&&j(T,q),h&1&&k!==(k=n[6].off_tech_id.value.replace(/ |\./g,"")+"")&&j(r,k),h&1&&P!==(P=G(n[6].off_artifact.value)+"")&&j(Q,P),h&1&&Y!==(Y=G(n[6].off_artifact.value)+"")&&j(y,Y),h&1&&F!==(F=G(n[6].off_artifact.value)+"")&&j(ee,F),h&1&&J!==(J=n[6].off_tech_id.value.replace(/ |\./g,"")+"")&&j(le,J),h&1&&c!==(c=he(n[6].off_tech_id.value)+"")&&j(w,c),h&1&&se!==(se=G(n[6].off_artifact.value)+"")&&j(ue,se),h&1&&ne!==(ne=G(n[6].off_artifact.value)+"")&&j(ie,ne)},d(n){n&&(s(a),s(l),s(t),s(_),s(C),s(b),s(o),s($),s(I),s(R),s(T),s(N),s(r),s(E),s(Q),s(Z),s(y),s(x),s(ee),s(W),s(le),s(L),s(w),s(de),s(ue),s(te),s(ie),s(U))}}}function Le(i){let f,a=i[2].edge_is_unique(i[6].off_tech_label.value,i[6].off_artifact_rel_label.value,i[6].off_artifact_label.value),l,e="def_tech"in i[6]&&Ae(i),t=a&&je(i);return{c(){e&&e.c(),f=M(),t&&t.c(),l=ae()},l(_){e&&e.l(_),f=V(_),t&&t.l(_),l=ae()},m(_,p){e&&e.m(_,p),u(_,f,p),t&&t.m(_,p),u(_,l,p)},p(_,p){"def_tech"in _[6]?e?e.p(_,p):(e=Ae(_),e.c(),e.m(f.parentNode,f)):e&&(e.d(1),e=null),p&1&&(a=_[2].edge_is_unique(_[6].off_tech_label.value,_[6].off_artifact_rel_label.value,_[6].off_artifact_label.value)),a?t?t.p(_,p):(t=je(_),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},d(_){_&&(s(f),s(l)),e&&e.d(_),t&&t.d(_)}}}function dl(i){let f,a,l=ge(i[0].results.bindings),e=[];for(let t=0;t<l.length;t+=1)e[t]=Le(Ie(i,l,t));return{c(){f=v(`graph LR;

    `);for(let t=0;t<e.length;t+=1)e[t].c();a=ae()},l(t){f=d(t,`graph LR;

    `);for(let _=0;_<e.length;_+=1)e[_].l(t);a=ae()},m(t,_){u(t,f,_);for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(t,_);u(t,a,_)},p(t,_){if(_&7){l=ge(t[0].results.bindings);let p;for(p=0;p<l.length;p+=1){const C=Ie(t,l,p);e[p]?e[p].p(C,_):(e[p]=Le(C),e[p].c(),e[p].m(a.parentNode,a))}for(;p<e.length;p+=1)e[p].d(1);e.length=l.length}},d(t){t&&(s(f),s(a)),ze(e,t)}}}function Me(i){let f,a;return f=new nl({props:{$$slots:{default:[dl]},$$scope:{ctx:i}}}),{c(){re(f.$$.fragment)},l(l){ce(f.$$.fragment,l)},m(l,e){oe(f,l,e),a=!0},p(l,e){const t={};e&515&&(t.$$scope={dirty:e,ctx:l}),f.$set(t)},i(l){a||(H(f.$$.fragment,l),a=!0)},o(l){K(f.$$.fragment,l),a=!1},d(l){ve(f,l)}}}function pl(i){let f,a,l,e,t,_,p,C,b,g,o,$,m,I;function R(r){i[4](r)}let q={toggles:i[3]};i[1]!==void 0&&(q.selected=i[1]),e=new rl({props:q}),Ue.push(()=>el(e,"selected",R));const T=[vl,ol],N=[];function k(r,E){return r[0].results.bindings.length>0?0:1}return o=k(i),$=N[o]=T[o](i),{c(){f=A("br"),a=M(),l=A("div"),re(e.$$.fragment),_=M(),p=A("br"),C=M(),b=A("br"),g=M(),$.c(),m=ae(),this.h()},l(r){f=B(r,"BR",{}),a=V(r),l=B(r,"DIV",{class:!0});var E=X(l);ce(e.$$.fragment,E),E.forEach(s),_=V(r),p=B(r,"BR",{}),C=V(r),b=B(r,"BR",{}),g=V(r),$.l(r),m=ae(),this.h()},h(){z(l,"class","center shrink")},m(r,E){u(r,f,E),u(r,a,E),u(r,l,E),oe(e,l,null),u(r,_,E),u(r,p,E),u(r,C,E),u(r,b,E),u(r,g,E),N[o].m(r,E),u(r,m,E),I=!0},p(r,[E]){const P={};!t&&E&2&&(t=!0,P.selected=r[1],Xe(()=>t=!1)),e.$set(P);let Q=o;o=k(r),o===Q?N[o].p(r,E):($e(),K(N[Q],1,1,()=>{N[Q]=null}),ke(),$=N[o],$?$.p(r,E):($=N[o]=T[o](r),$.c()),H($,1),$.m(m.parentNode,m))},i(r){I||(H(e.$$.fragment,r),H($),I=!0)},o(r){K(e.$$.fragment,r),K($),I=!1},d(r){r&&(s(f),s(a),s(l),s(_),s(p),s(C),s(b),s(g),s(m)),ve(e),N[o].d(r)}}}function ml(i,f,a){let{off_to_def:l}=f,e=new fl,t=new Set;l.results.bindings.forEach(b=>{"def_tactic_label"in b&&t.add(b.def_tactic_label.value)});let _=Array.from(t).sort(function(b,g){return De[b]-De[g]}),p=["Model"];tl(_,p)&&(p=[]);function C(b){p=b,a(1,p)}return i.$$set=b=>{"off_to_def"in b&&a(0,l=b.off_to_def)},i.$$.update=()=>{i.$$.dirty&2&&e.reset(p)},[l,p,e,_,C]}class bl extends Ke{constructor(f){super(),Fe(this,f,ml,pl,qe,{off_to_def:0})}}function Ve(i,f,a){const l=i.slice();return l[9]=f[a],l}const hl=i=>({}),He=i=>({});function Oe(i){let f,a,l;return a=new Te({props:{href:he(i[1]),size:"small",$$slots:{default:[$l]},$$scope:{ctx:i}}}),{c(){f=A("span"),re(a.$$.fragment),this.h()},l(e){f=B(e,"SPAN",{class:!0});var t=X(f);ce(a.$$.fragment,t),t.forEach(s),this.h()},h(){z(f,"class","left")},m(e,t){u(e,f,t),oe(a,f,null),l=!0},p(e,t){const _={};t&2&&(_.href=he(e[1])),t&130&&(_.$$scope={dirty:t,ctx:e}),a.$set(_)},i(e){l||(H(a.$$.fragment,e),l=!0)},o(e){K(a.$$.fragment,e),l=!1},d(e){e&&s(f),ve(a)}}}function $l(i){let f,a;return{c(){f=v("Parent: "),a=v(i[1])},l(l){f=d(l,"Parent: "),a=d(l,i[1])},m(l,e){u(l,f,e),u(l,a,e)},p(l,e){e&2&&j(a,l[1])},d(l){l&&(s(f),s(a))}}}function kl(i){let f;return{c(){f=v("MITRE ATT&CK® Link")},l(a){f=d(a,"MITRE ATT&CK® Link")},m(a,l){u(a,f,l)},d(a){a&&s(f)}}}function gl(i){let f,a,l,e,t,_,p=i[3]["rdfs:label"]+"",C,b,g=i[3]["d3f:attack-id"]+"",o,$,m,I="(ATT&CK® Technique)",R,q=i[1]&&Oe(i);return e=new Te({props:{href:il(i[3]["d3f:attack-id"]),size:"small",$$slots:{default:[kl]},$$scope:{ctx:i}}}),{c(){f=A("div"),q&&q.c(),a=M(),l=A("span"),re(e.$$.fragment),t=M(),_=A("h1"),C=v(p),b=v(" - "),o=v(g),$=M(),m=A("div"),m.textContent=I,this.h()},l(T){f=B(T,"DIV",{class:!0});var N=X(f);q&&q.l(N),a=V(N),l=B(N,"SPAN",{class:!0});var k=X(l);ce(e.$$.fragment,k),k.forEach(s),N.forEach(s),t=V(T),_=B(T,"H1",{class:!0});var r=X(_);C=d(r,p),b=d(r," - "),o=d(r,g),r.forEach(s),$=V(T),m=B(T,"DIV",{class:!0,"data-svelte-h":!0}),be(m)!=="svelte-1scusry"&&(m.textContent=I),this.h()},h(){z(l,"class","right"),z(f,"class","flex"),z(_,"class","text-center svelte-14efray"),z(m,"class","center text-center")},m(T,N){u(T,f,N),q&&q.m(f,null),D(f,a),D(f,l),oe(e,l,null),u(T,t,N),u(T,_,N),D(_,C),D(_,b),D(_,o),u(T,$,N),u(T,m,N),R=!0},p(T,N){T[1]?q?(q.p(T,N),N&2&&H(q,1)):(q=Oe(T),q.c(),H(q,1),q.m(f,a)):q&&($e(),K(q,1,1,()=>{q=null}),ke());const k={};N&128&&(k.$$scope={dirty:N,ctx:T}),e.$set(k)},i(T){R||(H(q),H(e.$$.fragment,T),R=!0)},o(T){K(q),K(e.$$.fragment,T),R=!1},d(T){T&&(s(f),s(t),s(_),s($),s(m)),q&&q.d(),ve(e)}}}function ql(i){let f,a,l="Subtechniques",e,t,_,p,C=ge(i[2].i(i[3]["@id"])["rdfs:hasSubClass"]),b=[];for(let o=0;o<C.length;o+=1)b[o]=Pe(Ve(i,C,o));const g=o=>K(b[o],1,1,()=>{b[o]=null});return{c(){f=A("div"),a=A("h2"),a.textContent=l,e=M(),t=A("div"),_=A("ul");for(let o=0;o<b.length;o+=1)b[o].c();this.h()},l(o){f=B(o,"DIV",{class:!0});var $=X(f);a=B($,"H2",{class:!0,"data-svelte-h":!0}),be(a)!=="svelte-flst9x"&&(a.textContent=l),e=V($),t=B($,"DIV",{class:!0});var m=X(t);_=B(m,"UL",{class:!0});var I=X(_);for(let R=0;R<b.length;R+=1)b[R].l(I);I.forEach(s),m.forEach(s),$.forEach(s),this.h()},h(){z(a,"class","text-center"),z(_,"class","center stretch shrink no-style"),z(t,"class","center"),z(f,"class","card")},m(o,$){u(o,f,$),D(f,a),D(f,e),D(f,t),D(t,_);for(let m=0;m<b.length;m+=1)b[m]&&b[m].m(_,null);p=!0},p(o,$){if($&12){C=ge(o[2].i(o[3]["@id"])["rdfs:hasSubClass"]);let m;for(m=0;m<C.length;m+=1){const I=Ve(o,C,m);b[m]?(b[m].p(I,$),H(b[m],1)):(b[m]=Pe(I),b[m].c(),H(b[m],1),b[m].m(_,null))}for($e(),m=C.length;m<b.length;m+=1)g(m);ke()}},i(o){if(!p){for(let $=0;$<C.length;$+=1)H(b[$]);p=!0}},o(o){b=b.filter(Boolean);for(let $=0;$<b.length;$+=1)K(b[$]);p=!1},d(o){o&&s(f),ze(b,o)}}}function Tl(i){let f=i[2].i(i[9]["@id"])["d3f:attack-id"]+"",a,l,e=i[2].i(i[9]["@id"])["rdfs:label"]+"",t;return{c(){a=v(f),l=v(" - "),t=v(e)},l(_){a=d(_,f),l=d(_," - "),t=d(_,e)},m(_,p){u(_,a,p),u(_,l,p),u(_,t,p)},p:me,d(_){_&&(s(a),s(l),s(t))}}}function Pe(i){let f,a,l,e;return a=new Te({props:{href:he(i[2].i(i[9]["@id"])["d3f:attack-id"]),size:"small",$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){f=A("li"),re(a.$$.fragment),l=M()},l(t){f=B(t,"LI",{});var _=X(f);ce(a.$$.fragment,_),l=V(_),_.forEach(s)},m(t,_){u(t,f,_),oe(a,f,null),D(f,l),e=!0},p(t,_){const p={};_&128&&(p.$$scope={dirty:_,ctx:t}),a.$set(p)},i(t){e||(H(a.$$.fragment,t),e=!0)},o(t){K(a.$$.fragment,t),e=!1},d(t){t&&s(f),ve(a)}}}function Ge(i){let f,a,l;return a=new sl({props:{$$slots:{default:[El]},$$scope:{ctx:i}}}),{c(){f=A("div"),re(a.$$.fragment),this.h()},l(e){f=B(e,"DIV",{class:!0});var t=X(f);ce(a.$$.fragment,t),t.forEach(s),this.h()},h(){z(f,"class","content")},m(e,t){u(e,f,t),oe(a,f,null),l=!0},i(e){l||(H(a.$$.fragment,e),l=!0)},o(e){K(a.$$.fragment,e),l=!1},d(e){e&&s(f),ve(a)}}}function El(i){let f,a="Browse the D3FEND knowledge graph by clicking on the nodes below.";return{c(){f=A("small"),f.textContent=a},l(l){f=B(l,"SMALL",{"data-svelte-h":!0}),be(f)!=="svelte-cj5juo"&&(f.textContent=a)},m(l,e){u(l,f,e)},p:me,d(l){l&&s(f)}}}function wl(i){let f,a,l,e,t,_,p,C,b,g,o,$,m="Definition",I,R,q,T=al(i[4])+"",N,k,r,E,P,Q="D3FEND Inferred Relationships",Z,Y,y,x,F,ee,W,J,le,L,c,w,de,se,ue,te;const ne=i[6].header,ie=Qe(ne,i,i[7],He),U=ie||gl(i);let n=i[2].graph.length>0&&ql(i),h=i[0].off_to_def.results.bindings.length>0&&Ge(i);return F=new bl({props:{off_to_def:i[0].off_to_def}}),{c(){U&&U.c(),f=M(),a=A("section"),l=A("div"),e=M(),n&&n.c(),t=M(),_=A("br"),p=M(),C=A("br"),b=M(),g=A("section"),o=A("div"),$=A("h2"),$.textContent=m,I=M(),R=A("div"),q=new We(!1),N=M(),k=A("br"),r=M(),E=A("div"),P=A("h2"),P.textContent=Q,Z=M(),h&&h.c(),Y=M(),y=A("br"),x=M(),re(F.$$.fragment),ee=M(),W=A("div"),J=A("a"),le=v("json"),c=M(),w=A("br"),de=A("br"),se=A("br"),ue=A("br"),this.h()},l(S){U&&U.l(S),f=V(S),a=B(S,"SECTION",{class:!0});var O=X(a);l=B(O,"DIV",{class:!0}),X(l).forEach(s),e=V(O),n&&n.l(O),t=V(O),_=B(O,"BR",{}),p=V(O),C=B(O,"BR",{}),O.forEach(s),b=V(S),g=B(S,"SECTION",{});var fe=X(g);o=B(fe,"DIV",{class:!0});var pe=X(o);$=B(pe,"H2",{class:!0,"data-svelte-h":!0}),be($)!=="svelte-thmaib"&&($.textContent=m),I=V(pe),R=B(pe,"DIV",{class:!0});var Ee=X(R);q=Ye(Ee,!1),Ee.forEach(s),N=V(pe),k=B(pe,"BR",{}),pe.forEach(s),r=V(fe),E=B(fe,"DIV",{class:!0});var _e=X(E);P=B(_e,"H2",{class:!0,"data-svelte-h":!0}),be(P)!=="svelte-u3n8h4"&&(P.textContent=Q),Z=V(_e),h&&h.l(_e),Y=V(_e),y=B(_e,"BR",{}),x=V(_e),ce(F.$$.fragment,_e),ee=V(_e),W=B(_e,"DIV",{class:!0});var we=X(W);J=B(we,"A",{href:!0});var Ce=X(J);le=d(Ce,"json"),Ce.forEach(s),we.forEach(s),_e.forEach(s),c=V(fe),w=B(fe,"BR",{}),de=B(fe,"BR",{}),se=B(fe,"BR",{}),ue=B(fe,"BR",{}),fe.forEach(s),this.h()},h(){z(l,"class","text-center"),z(a,"class","content"),z($,"class","text-center"),q.a=null,z(R,"class","text-justify"),z(o,"class","card"),z(P,"class","text-center"),z(J,"href",L=`/api/offensive-technique/attack/${i[0].technique_id}.json`),z(W,"class","text-right"),z(E,"class","text-center card")},m(S,O){U&&U.m(S,O),u(S,f,O),u(S,a,O),D(a,l),D(a,e),n&&n.m(a,null),D(a,t),D(a,_),D(a,p),D(a,C),u(S,b,O),u(S,g,O),D(g,o),D(o,$),D(o,I),D(o,R),q.m(T,R),D(o,N),D(o,k),D(g,r),D(g,E),D(E,P),D(E,Z),h&&h.m(E,null),D(E,Y),D(E,y),D(E,x),oe(F,E,null),D(E,ee),D(E,W),D(W,J),D(J,le),D(g,c),D(g,w),D(g,de),D(g,se),D(g,ue),te=!0},p(S,O){ie?ie.p&&(!te||O&128)&&Ze(ie,ne,S,S[7],te?xe(ne,S[7],O,hl):ye(S[7]),He):U&&U.p&&(!te||O&2)&&U.p(S,te?O:-1),S[2].graph.length>0&&n.p(S,O),S[0].off_to_def.results.bindings.length>0?h?O&1&&H(h,1):(h=Ge(S),h.c(),H(h,1),h.m(E,Y)):h&&($e(),K(h,1,1,()=>{h=null}),ke());const fe={};O&1&&(fe.off_to_def=S[0].off_to_def),F.$set(fe),(!te||O&1&&L!==(L=`/api/offensive-technique/attack/${S[0].technique_id}.json`))&&z(J,"href",L)},i(S){te||(H(U,S),H(n),H(h),H(F.$$.fragment,S),te=!0)},o(S){K(U,S),K(n),K(h),K(F.$$.fragment,S),te=!1},d(S){S&&(s(f),s(a),s(b),s(g)),U&&U.d(S),n&&n.d(),h&&h.d(),ve(F)}}}function Cl(i){let f,a,l,e;return f=new _l({props:{title:"Offensive Technique Details"}}),l=new ul({props:{$$slots:{default:[wl]},$$scope:{ctx:i}}}),l.$on("close",i[5]),{c(){re(f.$$.fragment),a=M(),re(l.$$.fragment)},l(t){ce(f.$$.fragment,t),a=V(t),ce(l.$$.fragment,t)},m(t,_){oe(f,t,_),u(t,a,_),oe(l,t,_),e=!0},p(t,[_]){const p={};_&131&&(p.$$scope={dirty:_,ctx:t}),l.$set(p)},i(t){e||(H(f.$$.fragment,t),H(l.$$.fragment,t),e=!0)},o(t){K(f.$$.fragment,t),K(l.$$.fragment,t),e=!1},d(t){t&&s(a),ve(f,t),ve(l,t)}}}function Nl(i,f,a){var $;let{$$slots:l={},$$scope:e}=f,{data:t}=f,_=new Ne(t.description),p=new Ne(t.subtechniques,{index:!0}),C=_.get("d3f:attack-id",t.technique_id),b=(($=C["d3f:definition"])==null?void 0:$.replace(/\(Citation: [^)]*\)/g,""))??"No definition available.",g;function o(m){ll("/")}return i.$$set=m=>{"data"in m&&a(0,t=m.data),"$$scope"in m&&a(7,e=m.$$scope)},i.$$.update=()=>{i.$$.dirty&1&&t.technique_id.includes(".")&&a(1,g=t.technique_id.split(".")[0])},[t,g,p,C,b,o,l,e]}class Gl extends Ke{constructor(f){super(),Fe(this,f,Nl,Cl,qe,{data:0})}}export{Gl as component,Pl as universal};
