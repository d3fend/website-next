import{s as Nt,e as u,b as A,t as y,d as h,f as _,j as w,v as Pe,i as f,h as T,w as o,k as j,l as i,p as L,H as Ct,y as at,o as kt,q as Vt,m as Me,M as Ot,V as Bt,E as mt,n as Ae,x as Mt,F as bt,L as yt}from"../chunks/scheduler.BPS8Q4IK.js";import{h as Ut,u as Ft}from"../chunks/await_block.B3GDgYsA.js";import{e as Tt}from"../chunks/each.BvFyIW-M.js";import{S as $t,i as Ht,t as me,e as st,a as je,f as Wt,c as it,b as rt,m as ct,d as ot,g as nt}from"../chunks/index.RHoRrSTo.js";import{w as tt}from"../chunks/index.CUya3-XI.js";import{S as Rt}from"../chunks/Search-Result.C1SpKlsG.js";import{p as zt}from"../chunks/stores.CeDY58-m.js";import{A as Gt}from"../chunks/Alert.C_Nawi40.js";import{G as Jt}from"../chunks/Graph-off_to_def.BHnVKmET.js";function jt(t,e,l){const s=t.slice();return s[48]=e[l],s}function Kt(t){let e,l,s=t[52]+"",a;return{c(){e=u("div"),l=y("An unexpected error occurred: "),a=y(s),this.h()},l(r){e=h(r,"DIV",{class:!0});var n=_(e);l=T(n,"An unexpected error occurred: "),a=T(n,s),n.forEach(f),this.h()},h(){o(e,"class","font-large text-center")},m(r,n){j(r,e,n),i(e,l),i(e,a)},p:Ae,d(r){r&&f(e)}}}function Qt(t){let e;function l(r,n){return r[11]?Xt:Yt}let s=l(t),a=s(t);return{c(){a.c(),e=bt()},l(r){a.l(r),e=bt()},m(r,n){a.m(r,n),j(r,e,n)},p(r,n){s===(s=l(r))&&a?a.p(r,n):(a.d(1),a=s(r),a&&(a.c(),a.m(e.parentNode,e)))},d(r){r&&f(e),a.d(r)}}}function Yt(t){let e,l,s;return{c(){e=u("input"),this.h()},l(a){e=h(a,"INPUT",{class:!0,placeholder:!0}),this.h()},h(){o(e,"class","search svelte-jg9y1k"),o(e,"placeholder","Search...")},m(a,r){j(a,e,r),yt(e,t[0]),l||(s=[L(e,"input",t[20]),L(e,"input",t[21])],l=!0)},p(a,r){r[0]&1&&e.value!==a[0]&&yt(e,a[0])},d(a){a&&f(e),l=!1,at(s)}}}function Xt(t){let e,l;return{c(){e=u("div"),l=y(t[11]),this.h()},l(s){e=h(s,"DIV",{class:!0});var a=_(e);l=T(a,t[11]),a.forEach(f),this.h()},h(){o(e,"class","font-large text-center")},m(s,a){j(s,e,a),i(e,l)},p(s,a){a[0]&2048&&Me(l,s[11])},d(s){s&&f(e)}}}function Zt(t){let e;return{c(){e=y("loading...")},l(l){e=T(l,"loading...")},m(l,s){j(l,e,s)},p:Ae,d(l){l&&f(e)}}}function Et(t){let e,l,s=t[12].defensiveTactic+"",a,r;return{c(){e=y("("),l=u("span"),a=y(s),r=y(")"),this.h()},l(n){e=T(n,"("),l=h(n,"SPAN",{class:!0});var c=_(l);a=T(c,s),c.forEach(f),r=T(n,")"),this.h()},h(){o(l,"class","text-bold")},m(n,c){j(n,e,c),j(n,l,c),i(l,a),j(n,r,c)},p(n,c){c[0]&4096&&s!==(s=n[12].defensiveTactic+"")&&Me(a,s)},d(n){n&&(f(e),f(l),f(r))}}}function Dt(t){let e,l,s=t[12].defensiveTechnique+"",a,r;return{c(){e=y("("),l=u("span"),a=y(s),r=y(")"),this.h()},l(n){e=T(n,"("),l=h(n,"SPAN",{class:!0});var c=_(l);a=T(c,s),c.forEach(f),r=T(n,")"),this.h()},h(){o(l,"class","text-bold")},m(n,c){j(n,e,c),j(n,l,c),i(l,a),j(n,r,c)},p(n,c){c[0]&4096&&s!==(s=n[12].defensiveTechnique+"")&&Me(a,s)},d(n){n&&(f(e),f(l),f(r))}}}function At(t){let e,l,s=t[12].offensiveTechnique+"",a,r;return{c(){e=y("("),l=u("span"),a=y(s),r=y(")"),this.h()},l(n){e=T(n,"("),l=h(n,"SPAN",{class:!0});var c=_(l);a=T(c,s),c.forEach(f),r=T(n,")"),this.h()},h(){o(l,"class","text-bold")},m(n,c){j(n,e,c),j(n,l,c),i(l,a),j(n,r,c)},p(n,c){c[0]&4096&&s!==(s=n[12].offensiveTechnique+"")&&Me(a,s)},d(n){n&&(f(e),f(l),f(r))}}}function wt(t){let e,l,s=t[12].digitalArtifact+"",a,r;return{c(){e=y("("),l=u("span"),a=y(s),r=y(")"),this.h()},l(n){e=T(n,"("),l=h(n,"SPAN",{class:!0});var c=_(l);a=T(c,s),c.forEach(f),r=T(n,")"),this.h()},h(){o(l,"class","text-bold")},m(n,c){j(n,e,c),j(n,l,c),i(l,a),j(n,r,c)},p(n,c){c[0]&4096&&s!==(s=n[12].digitalArtifact+"")&&Me(a,s)},d(n){n&&(f(e),f(l),f(r))}}}function Lt(t){let e,l,s=t[12].weakness+"",a,r;return{c(){e=y("("),l=u("span"),a=y(s),r=y(")"),this.h()},l(n){e=T(n,"("),l=h(n,"SPAN",{class:!0});var c=_(l);a=T(c,s),c.forEach(f),r=T(n,")"),this.h()},h(){o(l,"class","text-bold")},m(n,c){j(n,e,c),j(n,l,c),i(l,a),j(n,r,c)},p(n,c){c[0]&4096&&s!==(s=n[12].weakness+"")&&Me(a,s)},d(n){n&&(f(e),f(l),f(r))}}}function qt(t){let e,l,s;function a(n){t[36](n)}let r={result:t[48],openDefendModal:t[16]};return t[2]!==void 0&&(r.isLoading=t[2]),e=new Rt({props:r}),Ot.push(()=>Wt(e,"isLoading",a)),{c(){it(e.$$.fragment)},l(n){rt(e.$$.fragment,n)},m(n,c){ct(e,n,c),s=!0},p(n,c){const p={};c[0]&1026&&(p.result=n[48]),!l&&c[0]&4&&(l=!0,p.isLoading=n[2],Bt(()=>l=!1)),e.$set(p)},i(n){s||(me(e.$$.fragment,n),s=!0)},o(n){je(e.$$.fragment,n),s=!1},d(n){ot(e,n)}}}function It(t){let e,l="Load more",s,a;return{c(){e=u("button"),e.textContent=l,this.h()},l(r){e=h(r,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-1i8pjer"&&(e.textContent=l),this.h()},h(){o(e,"class","load-more-btn svelte-jg9y1k"),mt(e,"margin","0 auto"),mt(e,"display","block")},m(r,n){j(r,e,n),s||(a=L(e,"click",t[37]),s=!0)},p:Ae,d(r){r&&f(e),s=!1,a()}}}function xt(t){let e,l,s,a="Ã—",r,n,c,p,M="D3FEND Inferred Relationships",W,fe,q,O,U,x,R,H,B,S,z,oe,Te,m=t[14].off_to_def.results.bindings.length>0&&Pt(t);return U=new Jt({props:{off_to_def:t[14].off_to_def}}),{c(){e=u("div"),l=u("div"),s=u("span"),s.textContent=a,r=A(),n=u("section"),c=u("div"),p=u("h2"),p.textContent=M,W=A(),m&&m.c(),fe=A(),q=u("br"),O=A(),it(U.$$.fragment),x=A(),R=u("div"),H=u("a"),B=y("json"),this.h()},l(b){e=h(b,"DIV",{class:!0,role:!0,tabindex:!0});var ee=_(e);l=h(ee,"DIV",{class:!0,role:!0,tabindex:!0});var le=_(l);s=h(le,"SPAN",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),Pe(s)!=="svelte-bibxzt"&&(s.textContent=a),r=w(le),n=h(le,"SECTION",{});var G=_(n);c=h(G,"DIV",{class:!0});var I=_(c);p=h(I,"H2",{class:!0,"data-svelte-h":!0}),Pe(p)!=="svelte-u3n8h4"&&(p.textContent=M),W=w(I),m&&m.l(I),fe=w(I),q=h(I,"BR",{}),O=w(I),rt(U.$$.fragment,I),x=w(I),R=h(I,"DIV",{class:!0});var Ee=_(R);H=h(Ee,"A",{href:!0});var be=_(H);B=T(be,"json"),be.forEach(f),Ee.forEach(f),I.forEach(f),G.forEach(f),le.forEach(f),ee.forEach(f),this.h()},h(){o(s,"class","close-button svelte-jg9y1k"),o(s,"role","button"),o(s,"tabindex","0"),o(p,"class","text-center"),o(H,"href",S=`/api/offensive-technique/attack/${t[14].technique_id}.json`),o(R,"class","text-right"),o(c,"class","text-center card"),o(l,"class","modal-content svelte-jg9y1k"),o(l,"role","button"),o(l,"tabindex","0"),o(e,"class","defend-modal svelte-jg9y1k"),o(e,"role","button"),o(e,"tabindex","0")},m(b,ee){j(b,e,ee),i(e,l),i(l,s),i(l,r),i(l,n),i(n,c),i(c,p),i(c,W),m&&m.m(c,null),i(c,fe),i(c,q),i(c,O),ct(U,c,null),i(c,x),i(c,R),i(R,H),i(H,B),z=!0,oe||(Te=[L(s,"click",t[17]),L(s,"keydown",lt),L(l,"click",nl),L(l,"keydown",lt),L(e,"click",t[17]),L(e,"keydown",lt)],oe=!0)},p(b,ee){b[14].off_to_def.results.bindings.length>0?m?ee[0]&16384&&me(m,1):(m=Pt(b),m.c(),me(m,1),m.m(c,fe)):m&&(nt(),je(m,1,1,()=>{m=null}),st());const le={};ee[0]&16384&&(le.off_to_def=b[14].off_to_def),U.$set(le),(!z||ee[0]&16384&&S!==(S=`/api/offensive-technique/attack/${b[14].technique_id}.json`))&&o(H,"href",S)},i(b){z||(me(m),me(U.$$.fragment,b),z=!0)},o(b){je(m),je(U.$$.fragment,b),z=!1},d(b){b&&f(e),m&&m.d(),ot(U),oe=!1,at(Te)}}}function el(t){let e,l='<div class="loading-message svelte-jg9y1k"><p>Loading...</p></div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-19nefe3"&&(e.innerHTML=l),this.h()},h(){o(e,"class","loading-overlay svelte-jg9y1k")},m(s,a){j(s,e,a)},p:Ae,i:Ae,o:Ae,d(s){s&&f(e)}}}function Pt(t){let e,l,s;return l=new Gt({props:{$$slots:{default:[tl]},$$scope:{ctx:t}}}),{c(){e=u("div"),it(l.$$.fragment),this.h()},l(a){e=h(a,"DIV",{class:!0});var r=_(e);rt(l.$$.fragment,r),r.forEach(f),this.h()},h(){o(e,"class","content")},m(a,r){j(a,e,r),ct(l,e,null),s=!0},i(a){s||(me(l.$$.fragment,a),s=!0)},o(a){je(l.$$.fragment,a),s=!1},d(a){a&&f(e),ot(l)}}}function tl(t){let e,l="Browse the D3FEND knowledge graph by clicking on the nodes below.";return{c(){e=u("small"),e.textContent=l},l(s){e=h(s,"SMALL",{"data-svelte-h":!0}),Pe(e)!=="svelte-cj5juo"&&(e.textContent=l)},m(s,a){j(s,e,a)},p:Ae,d(s){s&&f(e)}}}function ll(t){let e,l,s,a,r,n,c,p,M,W="Search By",fe,q,O,U,x,R,H,B,S,z,oe,Te,m,b,ee="Type",le,G,I,Ee,be,Se,se,ae,ue,Ue,we,Fe,$e,ie,he,He,Le,We,Re,re,de,ze,qe,Ge,Je,ce,ye,v,te,F,pe,_e,P,N,C,ne,ge,k,d,Xe,xe,ft,ve={ctx:t,current:null,token:null,hasCatch:!0,pending:Zt,then:Qt,catch:Kt,value:51,error:52};Ut(t[19],ve);let J=t[1].length>0&&Et(t),K=t[1].length>0&&Dt(t),Q=t[1].length>0&&At(t),Y=t[1].length>0&&wt(t),X=t[1].length>0&&Lt(t),Ie=Tt(t[1].slice(0,t[10])),D=[];for(let E=0;E<Ie.length;E+=1)D[E]=qt(jt(t,Ie,E));const St=E=>je(D[E],1,1,()=>{D[E]=null});let Z=t[1].length>t[10]&&It(t);const ut=[el,xt],De=[];function ht(E,g){return E[13]?0:E[14]?1:-1}return~(k=ht(t))&&(d=De[k]=ut[k](t)),{c(){e=u("body"),ve.block.c(),l=A(),s=u("div"),a=u("div"),r=u("div"),n=u("div"),c=u("div"),p=u("div"),M=u("h3"),M.textContent=W,fe=A(),q=u("label"),O=u("input"),U=A(),x=u("span"),R=y(" Title"),H=A(),B=u("label"),S=u("input"),z=A(),oe=u("span"),Te=y(" Definition"),m=A(),b=u("h3"),b.textContent=ee,le=A(),G=u("label"),I=u("input"),Ee=A(),be=u("span"),Se=y(" Defensive Tactic "),J&&J.c(),se=A(),ae=u("label"),ue=u("input"),Ue=A(),we=u("span"),Fe=y(" Defensive Technique "),K&&K.c(),$e=A(),ie=u("label"),he=u("input"),He=A(),Le=u("span"),We=y(" Offensive Technique "),Q&&Q.c(),Re=A(),re=u("label"),de=u("input"),ze=A(),qe=u("span"),Ge=y(" Digital Artifact "),Y&&Y.c(),Je=A(),ce=u("label"),ye=u("input"),v=A(),te=u("span"),F=y(" Weakness "),X&&X.c(),pe=A(),_e=u("div"),P=u("div"),N=u("div"),C=u("ul");for(let E=0;E<D.length;E+=1)D[E].c();ne=A(),Z&&Z.c(),ge=A(),d&&d.c(),this.h()},l(E){e=h(E,"BODY",{class:!0});var g=_(e);ve.block.l(g),l=w(g),s=h(g,"DIV",{class:!0});var ke=_(s);a=h(ke,"DIV",{class:!0});var V=_(a);r=h(V,"DIV",{class:!0});var Ke=_(r);n=h(Ke,"DIV",{class:!0});var dt=_(n);c=h(dt,"DIV",{class:!0});var pt=_(c);p=h(pt,"DIV",{class:!0});var $=_(p);M=h($,"H3",{class:!0,"data-svelte-h":!0}),Pe(M)!=="svelte-wehfah"&&(M.textContent=W),fe=w($),q=h($,"LABEL",{class:!0});var Qe=_(q);O=h(Qe,"INPUT",{type:!0,class:!0}),U=w(Qe),x=h(Qe,"SPAN",{class:!0}),_(x).forEach(f),R=T(Qe," Title"),Qe.forEach(f),H=w($),B=h($,"LABEL",{class:!0});var Ye=_(B);S=h(Ye,"INPUT",{type:!0,class:!0}),z=w(Ye),oe=h(Ye,"SPAN",{class:!0}),_(oe).forEach(f),Te=T(Ye," Definition"),Ye.forEach(f),m=w($),b=h($,"H3",{class:!0,"data-svelte-h":!0}),Pe(b)!=="svelte-7znsuk"&&(b.textContent=ee),le=w($),G=h($,"LABEL",{class:!0});var Ne=_(G);I=h(Ne,"INPUT",{type:!0,class:!0}),Ee=w(Ne),be=h(Ne,"SPAN",{class:!0}),_(be).forEach(f),Se=T(Ne," Defensive Tactic "),J&&J.l(Ne),Ne.forEach(f),se=w($),ae=h($,"LABEL",{class:!0});var Ce=_(ae);ue=h(Ce,"INPUT",{type:!0,class:!0}),Ue=w(Ce),we=h(Ce,"SPAN",{class:!0}),_(we).forEach(f),Fe=T(Ce," Defensive Technique "),K&&K.l(Ce),Ce.forEach(f),$e=w($),ie=h($,"LABEL",{class:!0});var Ve=_(ie);he=h(Ve,"INPUT",{type:!0,class:!0}),He=w(Ve),Le=h(Ve,"SPAN",{class:!0}),_(Le).forEach(f),We=T(Ve," Offensive Technique "),Q&&Q.l(Ve),Ve.forEach(f),Re=w($),re=h($,"LABEL",{class:!0});var Oe=_(re);de=h(Oe,"INPUT",{type:!0,class:!0}),ze=w(Oe),qe=h(Oe,"SPAN",{class:!0}),_(qe).forEach(f),Ge=T(Oe," Digital Artifact "),Y&&Y.l(Oe),Oe.forEach(f),Je=w($),ce=h($,"LABEL",{class:!0});var Be=_(ce);ye=h(Be,"INPUT",{type:!0,class:!0}),v=w(Be),te=h(Be,"SPAN",{class:!0}),_(te).forEach(f),F=T(Be," Weakness "),X&&X.l(Be),Be.forEach(f),$.forEach(f),pt.forEach(f),dt.forEach(f),Ke.forEach(f),pe=w(V),_e=h(V,"DIV",{class:!0});var _t=_(_e);P=h(_t,"DIV",{class:!0});var gt=_(P);N=h(gt,"DIV",{class:!0});var vt=_(N);C=h(vt,"UL",{class:!0});var Ze=_(C);for(let et=0;et<D.length;et+=1)D[et].l(Ze);ne=w(Ze),Z&&Z.l(Ze),Ze.forEach(f),vt.forEach(f),gt.forEach(f),_t.forEach(f),V.forEach(f),ke.forEach(f),ge=w(g),d&&d.l(g),g.forEach(f),this.h()},h(){o(M,"class","svelte-jg9y1k"),o(O,"type","checkbox"),o(O,"class","svelte-jg9y1k"),o(x,"class","checkmark svelte-jg9y1k"),o(q,"class","svelte-jg9y1k"),o(S,"type","checkbox"),o(S,"class","svelte-jg9y1k"),o(oe,"class","checkmark svelte-jg9y1k"),o(B,"class","svelte-jg9y1k"),o(b,"class","svelte-jg9y1k"),o(I,"type","checkbox"),o(I,"class","svelte-jg9y1k"),o(be,"class","checkmark svelte-jg9y1k"),o(G,"class","svelte-jg9y1k"),o(ue,"type","checkbox"),o(ue,"class","svelte-jg9y1k"),o(we,"class","checkmark svelte-jg9y1k"),o(ae,"class","svelte-jg9y1k"),o(he,"type","checkbox"),o(he,"class","svelte-jg9y1k"),o(Le,"class","checkmark svelte-jg9y1k"),o(ie,"class","svelte-jg9y1k"),o(de,"type","checkbox"),o(de,"class","svelte-jg9y1k"),o(qe,"class","checkmark svelte-jg9y1k"),o(re,"class","svelte-jg9y1k"),o(ye,"type","checkbox"),o(ye,"class","svelte-jg9y1k"),o(te,"class","checkmark svelte-jg9y1k"),o(ce,"class","svelte-jg9y1k"),o(p,"class","filters svelte-jg9y1k"),o(c,"class","content-container svelte-jg9y1k"),o(n,"class","left-column svelte-jg9y1k"),o(r,"class","column svelte-jg9y1k"),o(C,"class","svelte-jg9y1k"),o(N,"class","results svelte-jg9y1k"),o(P,"class","right-column svelte-jg9y1k"),o(_e,"class","column svelte-jg9y1k"),o(a,"class","row svelte-jg9y1k"),o(s,"class","wrapper svelte-jg9y1k"),o(e,"class","svelte-jg9y1k")},m(E,g){j(E,e,g),ve.block.m(e,ve.anchor=null),ve.mount=()=>e,ve.anchor=l,i(e,l),i(e,s),i(s,a),i(a,r),i(r,n),i(n,c),i(c,p),i(p,M),i(p,fe),i(p,q),i(q,O),O.checked=t[8],i(q,U),i(q,x),i(q,R),i(p,H),i(p,B),i(B,S),S.checked=t[9],i(B,z),i(B,oe),i(B,Te),i(p,m),i(p,b),i(p,le),i(p,G),i(G,I),I.checked=t[3],i(G,Ee),i(G,be),i(G,Se),J&&J.m(G,null),i(p,se),i(p,ae),i(ae,ue),ue.checked=t[5],i(ae,Ue),i(ae,we),i(ae,Fe),K&&K.m(ae,null),i(p,$e),i(p,ie),i(ie,he),he.checked=t[4],i(ie,He),i(ie,Le),i(ie,We),Q&&Q.m(ie,null),i(p,Re),i(p,re),i(re,de),de.checked=t[6],i(re,ze),i(re,qe),i(re,Ge),Y&&Y.m(re,null),i(p,Je),i(p,ce),i(ce,ye),ye.checked=t[7],i(ce,v),i(ce,te),i(ce,F),X&&X.m(ce,null),i(a,pe),i(a,_e),i(_e,P),i(P,N),i(N,C);for(let ke=0;ke<D.length;ke+=1)D[ke]&&D[ke].m(C,null);i(C,ne),Z&&Z.m(C,null),i(e,ge),~k&&De[k].m(e,null),Xe=!0,xe||(ft=[L(O,"change",t[22]),L(O,"change",t[23]),L(S,"change",t[24]),L(S,"change",t[25]),L(I,"change",t[26]),L(I,"change",t[27]),L(ue,"change",t[28]),L(ue,"change",t[29]),L(he,"change",t[30]),L(he,"change",t[31]),L(de,"change",t[32]),L(de,"change",t[33]),L(ye,"change",t[34]),L(ye,"change",t[35])],xe=!0)},p(E,g){if(t=E,Ft(ve,t,g),g[0]&256&&(O.checked=t[8]),g[0]&512&&(S.checked=t[9]),g[0]&8&&(I.checked=t[3]),t[1].length>0?J?J.p(t,g):(J=Et(t),J.c(),J.m(G,null)):J&&(J.d(1),J=null),g[0]&32&&(ue.checked=t[5]),t[1].length>0?K?K.p(t,g):(K=Dt(t),K.c(),K.m(ae,null)):K&&(K.d(1),K=null),g[0]&16&&(he.checked=t[4]),t[1].length>0?Q?Q.p(t,g):(Q=At(t),Q.c(),Q.m(ie,null)):Q&&(Q.d(1),Q=null),g[0]&64&&(de.checked=t[6]),t[1].length>0?Y?Y.p(t,g):(Y=wt(t),Y.c(),Y.m(re,null)):Y&&(Y.d(1),Y=null),g[0]&128&&(ye.checked=t[7]),t[1].length>0?X?X.p(t,g):(X=Lt(t),X.c(),X.m(ce,null)):X&&(X.d(1),X=null),g[0]&66566){Ie=Tt(t[1].slice(0,t[10]));let V;for(V=0;V<Ie.length;V+=1){const Ke=jt(t,Ie,V);D[V]?(D[V].p(Ke,g),me(D[V],1)):(D[V]=qt(Ke),D[V].c(),me(D[V],1),D[V].m(C,ne))}for(nt(),V=Ie.length;V<D.length;V+=1)St(V);st()}t[1].length>t[10]?Z?Z.p(t,g):(Z=It(t),Z.c(),Z.m(C,null)):Z&&(Z.d(1),Z=null);let ke=k;k=ht(t),k===ke?~k&&De[k].p(t,g):(d&&(nt(),je(De[ke],1,1,()=>{De[ke]=null}),st()),~k?(d=De[k],d?d.p(t,g):(d=De[k]=ut[k](t),d.c()),me(d,1),d.m(e,null)):d=null)},i(E){if(!Xe){for(let g=0;g<Ie.length;g+=1)me(D[g]);me(d),Xe=!0}},o(E){D=D.filter(Boolean);for(let g=0;g<D.length;g+=1)je(D[g]);je(d),Xe=!1},d(E){E&&f(e),ve.block.d(),ve.token=null,ve=null,J&&J.d(),K&&K.d(),Q&&Q.d(),Y&&Y.d(),X&&X.d(),Ct(D,E),Z&&Z.d(),~k&&De[k].d(),xe=!1,at(ft)}}}function lt(){console.log("keydown")}async function sl(t){try{const e=await fetch(`/api/offensive-technique/attack/${t}.json`);if(!e.ok)throw new Error(`Error fetching data: ${e.status}`);const{description:l,off_to_def:s,subtechniques:a}=await e.json();return{description:l,off_to_def:s,technique_id:t,subtechniques:a}}catch(e){return console.error("Error fetching defensive data:",e),{error:e.message}}}const nl=t=>t.stopPropagation();function al(t,e,l){let s,a,r=Ae,n=()=>(r(),r=Mt(q,v=>l(13,a=v)),q),c;kt(t,zt,v=>l(42,s=v)),t.$$.on_destroy.push(()=>r());let p=[],M="",W=[],fe=tt(null),q=tt(!1);n();let O=tt(null);kt(t,O,v=>l(14,c=v));let U=!1,x=!1,R=!1,H=!1,B=!1,S=!1,z=!1,oe=20,Te,m=null,b,ee="",le={defensiveTactic:0,defensiveTechnique:0,offensiveTechnique:0,digitalArtifact:0};b=s.url.searchParams.get("q"),console.log("Found params: "+b);async function G(v){q.set(!0),fe.set(v.item);try{const te=await sl(v.item["@id"].split(":")[1]);O.set(te)}catch(te){console.error("Error during data fetch:",te),O.set(null)}finally{q.set(!1)}}function I(){q.set(!1),fe.set(null),O.set(null)}async function Ee(){const v="d3fend_search_cache",te=localStorage.getItem(v);if(te)try{return p=JSON.parse(te),p}catch(F){console.error("Failed to parse cached data",F)}try{const F=await Promise.all([fetch("/api/matrix-graph.json"),fetch("/api/offensive-technique/all.json"),fetch("/api/dao/search.json"),fetch("/api/weakness/all.json")]);if(F.every(pe=>pe.ok)){const[pe,_e,P,N]=await Promise.all(F.map(d=>d.json()));let C=pe["@graph"].map(d=>({...d,itemType:d["@type"]&&d["@type"].includes("d3f:DefensiveTactic")?"Defensive Tactic":"Defensive Technique"})),ne=_e["@graph"].map(d=>({...d,itemType:"Offensive Technique"})),ge=P["@graph"].map(d=>({...d,itemType:"Digital Artifact"})),k=N["@graph"].map(d=>({...d,itemType:"Weakness"}));return p=[...C,...ne,...ge,...k],localStorage.setItem(v,JSON.stringify(p)),p}else throw new Error("One or more API responses were not OK.")}catch(F){l(11,m="Failed to load data, check console log for more details."),console.error("Failed to load data for search",F)}}function be(v){if(!U&&!x&&!R&&!H&&!B)return!0;switch(v){case"Defensive Tactic":return U;case"Offensive Technique":return x;case"Defensive Technique":return R;case"Digital Artifact":return H;case"Weakness":return B;default:return!1}}function Se(v,te){const F=te.toLowerCase();if(F==="")return[];const pe=P=>{const N=P.toLowerCase().indexOf(F);if(N===-1)return P;const C=P.substring(0,N),ne=P.substring(N,N+F.length),ge=P.substring(N+F.length);return`${C}<span class="highlight">${ne}</span>${ge}`};let _e=v.reduce((P,N)=>{let C=[],ne={...N},ge=0;try{if(S||!S&&!z){let d=N["rdfs:label"];Array.isArray(d)&&d.length>0&&(d=d[0]),d&&d.toLowerCase().includes(F)&&(C.push("label"),ne["rdfs:label"]=pe(d),ge+=10)}if(z||!S&&!z){let d=N["d3f:definition"];Array.isArray(d)&&d.length>0&&(d=d[0]),d&&d.toLowerCase().includes(F)&&(C.push("definition"),ne["d3f:definition"]=pe(d),ge+=5)}let k=N["rdfs:label"];Array.isArray(k)&&k.length>0&&(k=k[0]),k&&k.toLowerCase().includes(F)&&(C.push("off"),ne["rdfs:label"]=pe(k))}catch(k){l(11,m="Failed to load data, check console log for more details."),console.error("Failed to load data for search",k)}if(C.length>0){const k=ne.itemType;be(k)&&P.push({item:ne,matchedOn:C,score:ge})}return P},[]);return s.url.searchParams.set("q",te),history.replaceState(null,"",s.url),_e.sort((P,N)=>N.score-P.score),_e.map(P=>({item:P.item,matchedOn:P.matchedOn}))}function se(v=!1){v?l(1,W=Se(p,M)):(clearTimeout(Te),Te=setTimeout(()=>{l(1,W=Se(p,M)),ae()},500))}function ae(){l(12,le={defensiveTactic:W.filter(v=>v.item.itemType==="Defensive Tactic").length,defensiveTechnique:W.filter(v=>v.item.itemType==="Defensive Technique").length,offensiveTechnique:W.filter(v=>v.item.itemType==="Offensive Technique").length,digitalArtifact:W.filter(v=>v.item.itemType==="Digital Artifact").length,weakness:W.filter(v=>v.item.itemType==="Weakness").length})}let ue=Ee();Vt(async()=>{b?(ee=b,l(0,M=ee),se(!1)):ee="",s.url.searchParams.set("q",M),history.replaceState(null,"",s.url)});function Ue(){M=this.value,l(0,M)}const we=()=>{se(!1)};function Fe(){S=this.checked,l(8,S)}const $e=()=>{se(!0)};function ie(){z=this.checked,l(9,z)}const he=()=>{se(!0)};function He(){U=this.checked,l(3,U)}const Le=()=>{se(!0)};function We(){R=this.checked,l(5,R)}const Re=()=>{se(!0)};function re(){x=this.checked,l(4,x)}const de=()=>{se(!0)};function ze(){H=this.checked,l(6,H)}const qe=()=>{se(!0)};function Ge(){B=this.checked,l(7,B)}const Je=()=>{se(!0)};function ce(v){q=v,n(l(2,q))}return[M,W,q,U,x,R,H,B,S,z,oe,m,le,a,c,O,G,I,se,ue,Ue,we,Fe,$e,ie,he,He,Le,We,Re,re,de,ze,qe,Ge,Je,ce,()=>{l(10,oe=W.length)}]}class _l extends $t{constructor(e){super(),Ht(this,e,al,ll,Nt,{},null,[-1,-1])}}export{_l as component};
